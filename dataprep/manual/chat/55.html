<!DOCTYPE html>
<!-- saved from url=(0066)https://chat.openai.com/share/3b9e682b-9adb-464c-b749-e6aea774829d -->
<html data-build="prod-23c601c" class="light" lang="en-US" style="color-scheme: light;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="apple-touch-icon" sizes="180x180" href="https://cdn.oaistatic.com/_next/static/media/apple-touch-icon.59f2e898.png"><link rel="icon" type="image/png" sizes="32x32" href="https://cdn.oaistatic.com/_next/static/media/favicon-32x32.be48395e.png"><link rel="icon" type="image/png" sizes="16x16" href="https://cdn.oaistatic.com/_next/static/media/favicon-16x16.9b8dbb69.png"><link rel="preconnect" href="https://cdn.oaistatic.com/"><title>Nest.js Conditional DTO Validation</title><meta name="title" content="ChatGPT: Get instant answers, find inspiration, learn something new"><meta name="description" content="ChatGPT is a free-to-use AI system. Use it for engaging conversations, gain insights, automate tasks, and witness the future of AI, all in one place."><meta name="keywords" content="ai chat,ai,chap gpt,chat gbt,chat gpt 3,chat gpt login,chat gpt website,chat gpt,chat gtp,chat openai,chat,chatai,chatbot gpt,chatg,chatgpt login,chatgpt,gpt chat,open ai,openai chat,openai chatgpt,openai"><meta property="og:image" content="https://cdn.oaistatic.com/_next/static/media/chatgpt-share-og.49cbbffe.png"><meta property="og:url" content="https://chat.openai.com"><meta name="apple-itunes-app" content="app-id=6448311069"><meta property="og:site_name" content="ChatGPT"><meta name="robots" content="noindex,nofollow"><meta property="og:title" content="Nest.js Conditional DTO Validation"><meta property="og:description" content="Shared via ChatGPT"><meta name="next-head-count" content="18"><link rel="preload" href="https://cdn.oaistatic.com/_next/static/media/soehne-buch.13189857.woff2" as="font" crossorigin=""><link rel="preload" href="https://cdn.oaistatic.com/_next/static/media/soehne-halbfett.977f1845.woff2" as="font" crossorigin=""><link rel="preload" href="https://cdn.oaistatic.com/_next/static/media/soehne-mono-buch.de677af1.woff2" as="font" crossorigin=""><link rel="preload" href="https://cdn.oaistatic.com/_next/static/media/soehne-mono-halbfett.b082e8e2.woff2" as="font" crossorigin=""><link data-next-font="" rel="preconnect" href="https://chat.openai.com/" crossorigin="anonymous"><link rel="preload" href="./55_files/3479c143cbeebc46.css" as="style" crossorigin="anonymous"><link rel="stylesheet" href="./55_files/3479c143cbeebc46.css" crossorigin="anonymous" data-n-g=""><noscript data-n-css=""></noscript><script type="text/javascript" async="" src="./55_files/dgkjq2bp"></script><script defer="" crossorigin="anonymous" nomodule="" src="./55_files/polyfills-c67a75d1b6f99dc8.js"></script><script src="./55_files/webpack-836d80a3e891b51c.js" defer="" crossorigin="anonymous"></script><script src="./55_files/framework-31ffa51d236da229.js" defer="" crossorigin="anonymous"></script><script src="./55_files/main-6da2aad3a6c32aae.js" defer="" crossorigin="anonymous"></script><script src="./55_files/_app-5c61b5fdde330fed.js" defer="" crossorigin="anonymous"></script><script src="./55_files/[[...shareParams]]-700bc023a3c41732.js" defer="" crossorigin="anonymous"></script><script src="./55_files/_buildManifest.js" defer="" crossorigin="anonymous"></script><script src="./55_files/_ssgManifest.js" defer="" crossorigin="anonymous"></script><meta name="react-scroll-to-bottom:version" content="4.2.0"><link as="script" rel="prefetch" crossorigin="anonymous" href="./55_files/3975-727132bb57222b04.js"><link as="script" rel="prefetch" crossorigin="anonymous" href="./55_files/3754-c5372f0c589e2443.js"><link as="script" rel="prefetch" crossorigin="anonymous" href="./55_files/login-001159e4899e6e7a.js"><link as="script" rel="prefetch" crossorigin="anonymous" href="./55_files/gpts-5e3c4c0a2618076d.js"></head><body class="antialiased"><div id="__next"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="relative z-0 flex h-full w-full overflow-hidden"><div class="relative flex h-full max-w-full flex-1 flex-col overflow-hidden"><main class="relative h-full w-full flex-1 overflow-auto transition-width"><div role="presentation" class="flex h-full flex-col"><div class="flex-1 overflow-hidden"><div class="h-full overflow-auto bg-token-main-surface-primary"><div class="flex flex-col pb-9 text-sm pt-2"><div class="mx-auto w-full p-4 md:max-w-2xl md:px-0 lg:max-w-[38rem] xl:max-w-3xl"><div class="border-b border-gray-100 pb-4 pt-3 sm:mb-2 sm:pb-6 sm:pt-8"><h1 class="text-3xl font-semibold leading-tight text-token-text-primary sm:text-4xl">Nest.js Conditional DTO Validation</h1><div class="pt-3 text-base text-gray-400 sm:pt-4">December 24, 2023</div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-2" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(121, 137, 255); width: 24px; height: 24px;"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="icon-sm" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg></div></div></div></div></div><div class="relative flex w-full flex-col"><div class="font-semibold select-none">Anonymous</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div data-message-author-role="user" data-message-id="aaa21174-0a20-40c7-b39f-11f7b5f82925" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="">In Nest.JS, if you want to validate if dto has a and b or neither of them. How do you do it?</div></div></div></div></div></div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-3" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(25, 195, 125); width: 24px; height: 24px;"><svg width="41" height="41" viewBox="0 0 41 41" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm" role="img"><text x="-9999" y="-9999">ChatGPT</text><path d="M37.5324 16.8707C37.9808 15.5241 38.1363 14.0974 37.9886 12.6859C37.8409 11.2744 37.3934 9.91076 36.676 8.68622C35.6126 6.83404 33.9882 5.3676 32.0373 4.4985C30.0864 3.62941 27.9098 3.40259 25.8215 3.85078C24.8796 2.7893 23.7219 1.94125 22.4257 1.36341C21.1295 0.785575 19.7249 0.491269 18.3058 0.500197C16.1708 0.495044 14.0893 1.16803 12.3614 2.42214C10.6335 3.67624 9.34853 5.44666 8.6917 7.47815C7.30085 7.76286 5.98686 8.3414 4.8377 9.17505C3.68854 10.0087 2.73073 11.0782 2.02839 12.312C0.956464 14.1591 0.498905 16.2988 0.721698 18.4228C0.944492 20.5467 1.83612 22.5449 3.268 24.1293C2.81966 25.4759 2.66413 26.9026 2.81182 28.3141C2.95951 29.7256 3.40701 31.0892 4.12437 32.3138C5.18791 34.1659 6.8123 35.6322 8.76321 36.5013C10.7141 37.3704 12.8907 37.5973 14.9789 37.1492C15.9208 38.2107 17.0786 39.0587 18.3747 39.6366C19.6709 40.2144 21.0755 40.5087 22.4946 40.4998C24.6307 40.5054 26.7133 39.8321 28.4418 38.5772C30.1704 37.3223 31.4556 35.5506 32.1119 33.5179C33.5027 33.2332 34.8167 32.6547 35.9659 31.821C37.115 30.9874 38.0728 29.9178 38.7752 28.684C39.8458 26.8371 40.3023 24.6979 40.0789 22.5748C39.8556 20.4517 38.9639 18.4544 37.5324 16.8707ZM22.4978 37.8849C20.7443 37.8874 19.0459 37.2733 17.6994 36.1501C17.7601 36.117 17.8666 36.0586 17.936 36.0161L25.9004 31.4156C26.1003 31.3019 26.2663 31.137 26.3813 30.9378C26.4964 30.7386 26.5563 30.5124 26.5549 30.2825V19.0542L29.9213 20.998C29.9389 21.0068 29.9541 21.0198 29.9656 21.0359C29.977 21.052 29.9842 21.0707 29.9867 21.0902V30.3889C29.9842 32.375 29.1946 34.2791 27.7909 35.6841C26.3872 37.0892 24.4838 37.8806 22.4978 37.8849ZM6.39227 31.0064C5.51397 29.4888 5.19742 27.7107 5.49804 25.9832C5.55718 26.0187 5.66048 26.0818 5.73461 26.1244L13.699 30.7248C13.8975 30.8408 14.1233 30.902 14.3532 30.902C14.583 30.902 14.8088 30.8408 15.0073 30.7248L24.731 25.1103V28.9979C24.7321 29.0177 24.7283 29.0376 24.7199 29.0556C24.7115 29.0736 24.6988 29.0893 24.6829 29.1012L16.6317 33.7497C14.9096 34.7416 12.8643 35.0097 10.9447 34.4954C9.02506 33.9811 7.38785 32.7263 6.39227 31.0064ZM4.29707 13.6194C5.17156 12.0998 6.55279 10.9364 8.19885 10.3327C8.19885 10.4013 8.19491 10.5228 8.19491 10.6071V19.808C8.19351 20.0378 8.25334 20.2638 8.36823 20.4629C8.48312 20.6619 8.64893 20.8267 8.84863 20.9404L18.5723 26.5542L15.206 28.4979C15.1894 28.5089 15.1703 28.5155 15.1505 28.5173C15.1307 28.5191 15.1107 28.516 15.0924 28.5082L7.04046 23.8557C5.32135 22.8601 4.06716 21.2235 3.55289 19.3046C3.03862 17.3858 3.30624 15.3413 4.29707 13.6194ZM31.955 20.0556L22.2312 14.4411L25.5976 12.4981C25.6142 12.4872 25.6333 12.4805 25.6531 12.4787C25.6729 12.4769 25.6928 12.4801 25.7111 12.4879L33.7631 17.1364C34.9967 17.849 36.0017 18.8982 36.6606 20.1613C37.3194 21.4244 37.6047 22.849 37.4832 24.2684C37.3617 25.6878 36.8382 27.0432 35.9743 28.1759C35.1103 29.3086 33.9415 30.1717 32.6047 30.6641C32.6047 30.5947 32.6047 30.4733 32.6047 30.3889V21.188C32.6066 20.9586 32.5474 20.7328 32.4332 20.5338C32.319 20.3348 32.154 20.1698 31.955 20.0556ZM35.3055 15.0128C35.2464 14.9765 35.1431 14.9142 35.069 14.8717L27.1045 10.2712C26.906 10.1554 26.6803 10.0943 26.4504 10.0943C26.2206 10.0943 25.9948 10.1554 25.7963 10.2712L16.0726 15.8858V11.9982C16.0715 11.9783 16.0753 11.9585 16.0837 11.9405C16.0921 11.9225 16.1048 11.9068 16.1207 11.8949L24.1719 7.25025C25.4053 6.53903 26.8158 6.19376 28.2383 6.25482C29.6608 6.31589 31.0364 6.78077 32.2044 7.59508C33.3723 8.40939 34.2842 9.53945 34.8334 10.8531C35.3826 12.1667 35.5464 13.6095 35.3055 15.0128ZM14.2424 21.9419L10.8752 19.9981C10.8576 19.9893 10.8423 19.9763 10.8309 19.9602C10.8195 19.9441 10.8122 19.9254 10.8098 19.9058V10.6071C10.8107 9.18295 11.2173 7.78848 11.9819 6.58696C12.7466 5.38544 13.8377 4.42659 15.1275 3.82264C16.4173 3.21869 17.8524 2.99464 19.2649 3.1767C20.6775 3.35876 22.0089 3.93941 23.1034 4.85067C23.0427 4.88379 22.937 4.94215 22.8668 4.98473L14.9024 9.58517C14.7025 9.69878 14.5366 9.86356 14.4215 10.0626C14.3065 10.2616 14.2466 10.4877 14.2479 10.7175L14.2424 21.9419ZM16.071 17.9991L20.4018 15.4978L24.7325 17.9975V22.9985L20.4018 25.4983L16.071 22.9985V17.9991Z" fill="currentColor"></path></svg></div></div></div></div></div><div class="relative flex w-full flex-col agent-turn"><div class="font-semibold select-none">ChatGPT</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div data-message-author-role="assistant" data-message-id="f171c27f-2e5b-4657-a693-86d18595a809" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="markdown prose w-full break-words dark:prose-invert light"><p>To achieve this kind of conditional validation in Nest.js, where either both <code>a</code> and <code>b</code> should be present or neither of them should be, you can use class-validator with custom validation logic. Here's a step-by-step guide on how to do it:</p><ol><li><p><strong>Install class-validator and class-transformer</strong>: These packages are often used in NestJS for DTO validation and transformation. If you haven't already installed them, do so by running:</p><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>bash</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-bash">npm install class-validator class-transformer
</code></div></div></pre></li><li><p><strong>Create the DTO Class</strong>: Define your DTO class with the properties <code>a</code> and <code>b</code>.</p><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">IsOptional</span>, <span class="hljs-title class_">Validate</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'class-validator'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">YourDto</span> {
  <span class="hljs-meta">@IsOptional</span>()
  a?: <span class="hljs-built_in">string</span>;

  <span class="hljs-meta">@IsOptional</span>()
  b?: <span class="hljs-built_in">string</span>;
}
</code></div></div></pre></li><li><p><strong>Custom Validator</strong>: Create a custom validator that checks if either both <code>a</code> and <code>b</code> are present or neither of them.</p><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-keyword">import</span> { 
  registerDecorator, 
  <span class="hljs-title class_">ValidationOptions</span>, 
  <span class="hljs-title class_">ValidationArguments</span> 
} <span class="hljs-keyword">from</span> <span class="hljs-string">'class-validator'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">IsEitherBothOrNone</span>(<span class="hljs-params">validationOptions?: ValidationOptions</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"><span class="hljs-built_in">object</span>: <span class="hljs-built_in">any</span>, propertyName: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-title function_">registerDecorator</span>({
      <span class="hljs-attr">name</span>: <span class="hljs-string">'isEitherBothOrNone'</span>,
      <span class="hljs-attr">target</span>: <span class="hljs-built_in">object</span>.<span class="hljs-property">constructor</span>,
      <span class="hljs-attr">propertyName</span>: propertyName,
      <span class="hljs-attr">options</span>: validationOptions,
      <span class="hljs-attr">validator</span>: {
        <span class="hljs-title function_">validate</span>(<span class="hljs-params">value: <span class="hljs-built_in">any</span>, args: ValidationArguments</span>) {
          <span class="hljs-keyword">const</span> relatedPropertyName = args.<span class="hljs-property">constraints</span>[<span class="hljs-number">0</span>];
          <span class="hljs-keyword">const</span> relatedValue = (args.<span class="hljs-property">object</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>)[relatedPropertyName];
          <span class="hljs-keyword">return</span> (
            (value != <span class="hljs-literal">null</span> &amp;&amp; relatedValue != <span class="hljs-literal">null</span>) || 
            (value == <span class="hljs-literal">null</span> &amp;&amp; relatedValue == <span class="hljs-literal">null</span>)
          );
        },
      },
    });
  };
}
</code></div></div></pre></li><li><p><strong>Apply the Custom Validator</strong>: Use the custom validator in your DTO class.</p><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">YourDto</span> {
  <span class="hljs-meta">@IsOptional</span>()
  <span class="hljs-meta">@IsEitherBothOrNone</span>(<span class="hljs-string">'b'</span>, {
    <span class="hljs-attr">message</span>: <span class="hljs-string">'Both a and b must be present or neither'</span>,
  })
  a?: <span class="hljs-built_in">string</span>;

  <span class="hljs-meta">@IsOptional</span>()
  b?: <span class="hljs-built_in">string</span>;
}
</code></div></div></pre></li><li><p><strong>Use the DTO in Your Controller</strong>: Ensure that you use this DTO in your controller and enable validation in your NestJS application.</p><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-meta">@Post</span>()
<span class="hljs-keyword">async</span> <span class="hljs-title function_">create</span>(<span class="hljs-params"><span class="hljs-meta">@Body</span>() dto: YourDto</span>) {
  <span class="hljs-comment">// Your logic here</span>
}
</code></div></div></pre></li><li><p><strong>Enable Global Validation</strong>: In your main application file (usually <code>main.ts</code>), make sure to enable global validation.</p><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ValidationPipe</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">bootstrap</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">const</span> app = <span class="hljs-keyword">await</span> <span class="hljs-title class_">NestFactory</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">AppModule</span>);
  app.<span class="hljs-title function_">useGlobalPipes</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ValidationPipe</span>());
  <span class="hljs-keyword">await</span> app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);
}
<span class="hljs-title function_">bootstrap</span>();
</code></div></div></pre></li></ol><p>With this setup, your application will validate that either both <code>a</code> and <code>b</code> are provided in the request, or neither of them is. This kind of conditional validation is powerful for handling complex validation scenarios in Nest.js.</p></div></div></div></div></div></div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-4" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(121, 137, 255); width: 24px; height: 24px;"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="icon-sm" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg></div></div></div></div></div><div class="relative flex w-full flex-col"><div class="font-semibold select-none">Anonymous</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div data-message-author-role="user" data-message-id="aaa25d32-8ddd-484c-af9b-e17fd3893529" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="">What I actually want to do is
- allow password only when accessLevel is "PROTECTED"
- reject password when accessLevel is not "PROTECTED"

```
export class CreateRoomDto {
  @IsString()
  @IsNotEmpty()
  @ApiProperty()
  name: string;

  @IsString()
  @IsNotEmpty()
  @ApiProperty()
  accessLevel: 'PUBLIC' | 'PRIVATE' | 'PROTECTED';

  @ValidateIf((o) =&gt; o.accessLevel === 'PROTECTED')
  @IsString()
  @MinLength(4)
  @ApiProperty({ required: false })
  password?: string;
}
```</div></div></div></div></div></div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-5" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(25, 195, 125); width: 24px; height: 24px;"><svg width="41" height="41" viewBox="0 0 41 41" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm" role="img"><text x="-9999" y="-9999">ChatGPT</text><path d="M37.5324 16.8707C37.9808 15.5241 38.1363 14.0974 37.9886 12.6859C37.8409 11.2744 37.3934 9.91076 36.676 8.68622C35.6126 6.83404 33.9882 5.3676 32.0373 4.4985C30.0864 3.62941 27.9098 3.40259 25.8215 3.85078C24.8796 2.7893 23.7219 1.94125 22.4257 1.36341C21.1295 0.785575 19.7249 0.491269 18.3058 0.500197C16.1708 0.495044 14.0893 1.16803 12.3614 2.42214C10.6335 3.67624 9.34853 5.44666 8.6917 7.47815C7.30085 7.76286 5.98686 8.3414 4.8377 9.17505C3.68854 10.0087 2.73073 11.0782 2.02839 12.312C0.956464 14.1591 0.498905 16.2988 0.721698 18.4228C0.944492 20.5467 1.83612 22.5449 3.268 24.1293C2.81966 25.4759 2.66413 26.9026 2.81182 28.3141C2.95951 29.7256 3.40701 31.0892 4.12437 32.3138C5.18791 34.1659 6.8123 35.6322 8.76321 36.5013C10.7141 37.3704 12.8907 37.5973 14.9789 37.1492C15.9208 38.2107 17.0786 39.0587 18.3747 39.6366C19.6709 40.2144 21.0755 40.5087 22.4946 40.4998C24.6307 40.5054 26.7133 39.8321 28.4418 38.5772C30.1704 37.3223 31.4556 35.5506 32.1119 33.5179C33.5027 33.2332 34.8167 32.6547 35.9659 31.821C37.115 30.9874 38.0728 29.9178 38.7752 28.684C39.8458 26.8371 40.3023 24.6979 40.0789 22.5748C39.8556 20.4517 38.9639 18.4544 37.5324 16.8707ZM22.4978 37.8849C20.7443 37.8874 19.0459 37.2733 17.6994 36.1501C17.7601 36.117 17.8666 36.0586 17.936 36.0161L25.9004 31.4156C26.1003 31.3019 26.2663 31.137 26.3813 30.9378C26.4964 30.7386 26.5563 30.5124 26.5549 30.2825V19.0542L29.9213 20.998C29.9389 21.0068 29.9541 21.0198 29.9656 21.0359C29.977 21.052 29.9842 21.0707 29.9867 21.0902V30.3889C29.9842 32.375 29.1946 34.2791 27.7909 35.6841C26.3872 37.0892 24.4838 37.8806 22.4978 37.8849ZM6.39227 31.0064C5.51397 29.4888 5.19742 27.7107 5.49804 25.9832C5.55718 26.0187 5.66048 26.0818 5.73461 26.1244L13.699 30.7248C13.8975 30.8408 14.1233 30.902 14.3532 30.902C14.583 30.902 14.8088 30.8408 15.0073 30.7248L24.731 25.1103V28.9979C24.7321 29.0177 24.7283 29.0376 24.7199 29.0556C24.7115 29.0736 24.6988 29.0893 24.6829 29.1012L16.6317 33.7497C14.9096 34.7416 12.8643 35.0097 10.9447 34.4954C9.02506 33.9811 7.38785 32.7263 6.39227 31.0064ZM4.29707 13.6194C5.17156 12.0998 6.55279 10.9364 8.19885 10.3327C8.19885 10.4013 8.19491 10.5228 8.19491 10.6071V19.808C8.19351 20.0378 8.25334 20.2638 8.36823 20.4629C8.48312 20.6619 8.64893 20.8267 8.84863 20.9404L18.5723 26.5542L15.206 28.4979C15.1894 28.5089 15.1703 28.5155 15.1505 28.5173C15.1307 28.5191 15.1107 28.516 15.0924 28.5082L7.04046 23.8557C5.32135 22.8601 4.06716 21.2235 3.55289 19.3046C3.03862 17.3858 3.30624 15.3413 4.29707 13.6194ZM31.955 20.0556L22.2312 14.4411L25.5976 12.4981C25.6142 12.4872 25.6333 12.4805 25.6531 12.4787C25.6729 12.4769 25.6928 12.4801 25.7111 12.4879L33.7631 17.1364C34.9967 17.849 36.0017 18.8982 36.6606 20.1613C37.3194 21.4244 37.6047 22.849 37.4832 24.2684C37.3617 25.6878 36.8382 27.0432 35.9743 28.1759C35.1103 29.3086 33.9415 30.1717 32.6047 30.6641C32.6047 30.5947 32.6047 30.4733 32.6047 30.3889V21.188C32.6066 20.9586 32.5474 20.7328 32.4332 20.5338C32.319 20.3348 32.154 20.1698 31.955 20.0556ZM35.3055 15.0128C35.2464 14.9765 35.1431 14.9142 35.069 14.8717L27.1045 10.2712C26.906 10.1554 26.6803 10.0943 26.4504 10.0943C26.2206 10.0943 25.9948 10.1554 25.7963 10.2712L16.0726 15.8858V11.9982C16.0715 11.9783 16.0753 11.9585 16.0837 11.9405C16.0921 11.9225 16.1048 11.9068 16.1207 11.8949L24.1719 7.25025C25.4053 6.53903 26.8158 6.19376 28.2383 6.25482C29.6608 6.31589 31.0364 6.78077 32.2044 7.59508C33.3723 8.40939 34.2842 9.53945 34.8334 10.8531C35.3826 12.1667 35.5464 13.6095 35.3055 15.0128ZM14.2424 21.9419L10.8752 19.9981C10.8576 19.9893 10.8423 19.9763 10.8309 19.9602C10.8195 19.9441 10.8122 19.9254 10.8098 19.9058V10.6071C10.8107 9.18295 11.2173 7.78848 11.9819 6.58696C12.7466 5.38544 13.8377 4.42659 15.1275 3.82264C16.4173 3.21869 17.8524 2.99464 19.2649 3.1767C20.6775 3.35876 22.0089 3.93941 23.1034 4.85067C23.0427 4.88379 22.937 4.94215 22.8668 4.98473L14.9024 9.58517C14.7025 9.69878 14.5366 9.86356 14.4215 10.0626C14.3065 10.2616 14.2466 10.4877 14.2479 10.7175L14.2424 21.9419ZM16.071 17.9991L20.4018 15.4978L24.7325 17.9975V22.9985L20.4018 25.4983L16.071 22.9985V17.9991Z" fill="currentColor"></path></svg></div></div></div></div></div><div class="relative flex w-full flex-col agent-turn"><div class="font-semibold select-none">ChatGPT</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div data-message-author-role="assistant" data-message-id="cf477ecc-f017-4622-81f8-d2e002544c1b" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="markdown prose w-full break-words dark:prose-invert light"><p>Your approach is mostly correct for the requirement you've described. You're using the <code>@ValidateIf</code> decorator to conditionally apply validation rules based on the <code>accessLevel</code> property. This decorator is part of the <code>class-validator</code> package and is used for conditional validation.</p><p>In your <code>CreateRoomDto</code>, you want to:</p><ul><li>Require a <code>password</code> only when <code>accessLevel</code> is <code>"PROTECTED"</code>.</li><li>Reject or ignore <code>password</code> when <code>accessLevel</code> is not <code>"PROTECTED"</code>.</li></ul><p>Here's how you can modify your DTO to meet these requirements:</p><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">IsString</span>, <span class="hljs-title class_">IsNotEmpty</span>, <span class="hljs-title class_">MinLength</span>, <span class="hljs-title class_">ValidateIf</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'class-validator'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ApiProperty</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/swagger'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CreateRoomDto</span> {
  <span class="hljs-meta">@IsString</span>()
  <span class="hljs-meta">@IsNotEmpty</span>()
  <span class="hljs-meta">@ApiProperty</span>()
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;

  <span class="hljs-meta">@IsString</span>()
  <span class="hljs-meta">@IsNotEmpty</span>()
  <span class="hljs-meta">@ApiProperty</span>()
  <span class="hljs-attr">accessLevel</span>: <span class="hljs-string">'PUBLIC'</span> | <span class="hljs-string">'PRIVATE'</span> | <span class="hljs-string">'PROTECTED'</span>;

  <span class="hljs-meta">@ValidateIf</span>(<span class="hljs-function">(<span class="hljs-params">o</span>) =&gt;</span> o.<span class="hljs-property">accessLevel</span> === <span class="hljs-string">'PROTECTED'</span>)
  <span class="hljs-meta">@IsString</span>()
  <span class="hljs-meta">@MinLength</span>(<span class="hljs-number">4</span>)
  <span class="hljs-meta">@ApiProperty</span>({ <span class="hljs-attr">required</span>: <span class="hljs-literal">false</span> })
  password?: <span class="hljs-built_in">string</span>;

  <span class="hljs-meta">@ValidateIf</span>(<span class="hljs-function">(<span class="hljs-params">o</span>) =&gt;</span> o.<span class="hljs-property">accessLevel</span> !== <span class="hljs-string">'PROTECTED'</span> &amp;&amp; o.<span class="hljs-property">password</span> != <span class="hljs-literal">null</span>)
  <span class="hljs-title function_">passwordNotAllowed</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// This will always fail validation if condition is true</span>
  }
}
</code></div></div></pre><p>Explanation:</p><ul><li>The <code>@ValidateIf</code> decorator for <code>password</code> ensures that the <code>password</code> field is validated only when <code>accessLevel</code> is <code>'PROTECTED'</code>. This includes checking that it's a string and has a minimum length of 4.</li><li>The <code>passwordNotAllowed</code> method, decorated with <code>@ValidateIf</code>, checks if <code>accessLevel</code> is not <code>'PROTECTED'</code> and a <code>password</code> is provided. If both conditions are true, it returns <code>false</code>, failing the validation. This method effectively rejects the <code>password</code> field when <code>accessLevel</code> is not <code>'PROTECTED'</code>.</li></ul><p>This setup ensures that a <code>password</code> is only allowed and validated when <code>accessLevel</code> is <code>'PROTECTED'</code>, and it is rejected otherwise.</p></div></div></div></div></div></div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-6" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(121, 137, 255); width: 24px; height: 24px;"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="icon-sm" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg></div></div></div></div></div><div class="relative flex w-full flex-col"><div class="font-semibold select-none">Anonymous</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div data-message-author-role="user" data-message-id="aaa27caa-e51d-44f0-b314-f7c794c642de" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="">can you send me a doc that descirbes that you can define a function like this? </div></div></div></div></div></div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-7" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(25, 195, 125); width: 24px; height: 24px;"><svg width="41" height="41" viewBox="0 0 41 41" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm" role="img"><text x="-9999" y="-9999">ChatGPT</text><path d="M37.5324 16.8707C37.9808 15.5241 38.1363 14.0974 37.9886 12.6859C37.8409 11.2744 37.3934 9.91076 36.676 8.68622C35.6126 6.83404 33.9882 5.3676 32.0373 4.4985C30.0864 3.62941 27.9098 3.40259 25.8215 3.85078C24.8796 2.7893 23.7219 1.94125 22.4257 1.36341C21.1295 0.785575 19.7249 0.491269 18.3058 0.500197C16.1708 0.495044 14.0893 1.16803 12.3614 2.42214C10.6335 3.67624 9.34853 5.44666 8.6917 7.47815C7.30085 7.76286 5.98686 8.3414 4.8377 9.17505C3.68854 10.0087 2.73073 11.0782 2.02839 12.312C0.956464 14.1591 0.498905 16.2988 0.721698 18.4228C0.944492 20.5467 1.83612 22.5449 3.268 24.1293C2.81966 25.4759 2.66413 26.9026 2.81182 28.3141C2.95951 29.7256 3.40701 31.0892 4.12437 32.3138C5.18791 34.1659 6.8123 35.6322 8.76321 36.5013C10.7141 37.3704 12.8907 37.5973 14.9789 37.1492C15.9208 38.2107 17.0786 39.0587 18.3747 39.6366C19.6709 40.2144 21.0755 40.5087 22.4946 40.4998C24.6307 40.5054 26.7133 39.8321 28.4418 38.5772C30.1704 37.3223 31.4556 35.5506 32.1119 33.5179C33.5027 33.2332 34.8167 32.6547 35.9659 31.821C37.115 30.9874 38.0728 29.9178 38.7752 28.684C39.8458 26.8371 40.3023 24.6979 40.0789 22.5748C39.8556 20.4517 38.9639 18.4544 37.5324 16.8707ZM22.4978 37.8849C20.7443 37.8874 19.0459 37.2733 17.6994 36.1501C17.7601 36.117 17.8666 36.0586 17.936 36.0161L25.9004 31.4156C26.1003 31.3019 26.2663 31.137 26.3813 30.9378C26.4964 30.7386 26.5563 30.5124 26.5549 30.2825V19.0542L29.9213 20.998C29.9389 21.0068 29.9541 21.0198 29.9656 21.0359C29.977 21.052 29.9842 21.0707 29.9867 21.0902V30.3889C29.9842 32.375 29.1946 34.2791 27.7909 35.6841C26.3872 37.0892 24.4838 37.8806 22.4978 37.8849ZM6.39227 31.0064C5.51397 29.4888 5.19742 27.7107 5.49804 25.9832C5.55718 26.0187 5.66048 26.0818 5.73461 26.1244L13.699 30.7248C13.8975 30.8408 14.1233 30.902 14.3532 30.902C14.583 30.902 14.8088 30.8408 15.0073 30.7248L24.731 25.1103V28.9979C24.7321 29.0177 24.7283 29.0376 24.7199 29.0556C24.7115 29.0736 24.6988 29.0893 24.6829 29.1012L16.6317 33.7497C14.9096 34.7416 12.8643 35.0097 10.9447 34.4954C9.02506 33.9811 7.38785 32.7263 6.39227 31.0064ZM4.29707 13.6194C5.17156 12.0998 6.55279 10.9364 8.19885 10.3327C8.19885 10.4013 8.19491 10.5228 8.19491 10.6071V19.808C8.19351 20.0378 8.25334 20.2638 8.36823 20.4629C8.48312 20.6619 8.64893 20.8267 8.84863 20.9404L18.5723 26.5542L15.206 28.4979C15.1894 28.5089 15.1703 28.5155 15.1505 28.5173C15.1307 28.5191 15.1107 28.516 15.0924 28.5082L7.04046 23.8557C5.32135 22.8601 4.06716 21.2235 3.55289 19.3046C3.03862 17.3858 3.30624 15.3413 4.29707 13.6194ZM31.955 20.0556L22.2312 14.4411L25.5976 12.4981C25.6142 12.4872 25.6333 12.4805 25.6531 12.4787C25.6729 12.4769 25.6928 12.4801 25.7111 12.4879L33.7631 17.1364C34.9967 17.849 36.0017 18.8982 36.6606 20.1613C37.3194 21.4244 37.6047 22.849 37.4832 24.2684C37.3617 25.6878 36.8382 27.0432 35.9743 28.1759C35.1103 29.3086 33.9415 30.1717 32.6047 30.6641C32.6047 30.5947 32.6047 30.4733 32.6047 30.3889V21.188C32.6066 20.9586 32.5474 20.7328 32.4332 20.5338C32.319 20.3348 32.154 20.1698 31.955 20.0556ZM35.3055 15.0128C35.2464 14.9765 35.1431 14.9142 35.069 14.8717L27.1045 10.2712C26.906 10.1554 26.6803 10.0943 26.4504 10.0943C26.2206 10.0943 25.9948 10.1554 25.7963 10.2712L16.0726 15.8858V11.9982C16.0715 11.9783 16.0753 11.9585 16.0837 11.9405C16.0921 11.9225 16.1048 11.9068 16.1207 11.8949L24.1719 7.25025C25.4053 6.53903 26.8158 6.19376 28.2383 6.25482C29.6608 6.31589 31.0364 6.78077 32.2044 7.59508C33.3723 8.40939 34.2842 9.53945 34.8334 10.8531C35.3826 12.1667 35.5464 13.6095 35.3055 15.0128ZM14.2424 21.9419L10.8752 19.9981C10.8576 19.9893 10.8423 19.9763 10.8309 19.9602C10.8195 19.9441 10.8122 19.9254 10.8098 19.9058V10.6071C10.8107 9.18295 11.2173 7.78848 11.9819 6.58696C12.7466 5.38544 13.8377 4.42659 15.1275 3.82264C16.4173 3.21869 17.8524 2.99464 19.2649 3.1767C20.6775 3.35876 22.0089 3.93941 23.1034 4.85067C23.0427 4.88379 22.937 4.94215 22.8668 4.98473L14.9024 9.58517C14.7025 9.69878 14.5366 9.86356 14.4215 10.0626C14.3065 10.2616 14.2466 10.4877 14.2479 10.7175L14.2424 21.9419ZM16.071 17.9991L20.4018 15.4978L24.7325 17.9975V22.9985L20.4018 25.4983L16.071 22.9985V17.9991Z" fill="currentColor"></path></svg></div></div></div></div></div><div class="relative flex w-full flex-col agent-turn"><div class="font-semibold select-none">ChatGPT</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div class="my-2.5 flex items-center gap-2.5"><div class="relative h-5 w-5 shrink-0"><div class="absolute left-0 top-0 flex h-full w-full items-center justify-center rounded-full text-white bg-orange-500" style="opacity: 1; transform: none;"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 4 12" fill="none" width="4" height="12"><mask id="path-1-inside-1_1975_4008" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 6.5C1 7.05228 1.44772 7.5 2 7.5C2.55228 7.5 3 7.05228 3 6.5V1.5C3 0.947715 2.55228 0.5 2 0.5C1.44772 0.5 1 0.947715 1 1.5L1 6.5ZM0.75 10.25C0.75 10.9404 1.30964 11.5 2 11.5C2.69036 11.5 3.25 10.9404 3.25 10.25C3.25 9.55964 2.69036 9 2 9C1.30964 9 0.75 9.55964 0.75 10.25Z"></path></mask><path fill-rule="evenodd" clip-rule="evenodd" d="M1 6.5C1 7.05228 1.44772 7.5 2 7.5C2.55228 7.5 3 7.05228 3 6.5V1.5C3 0.947715 2.55228 0.5 2 0.5C1.44772 0.5 1 0.947715 1 1.5L1 6.5ZM0.75 10.25C0.75 10.9404 1.30964 11.5 2 11.5C2.69036 11.5 3.25 10.9404 3.25 10.25C3.25 9.55964 2.69036 9 2 9C1.30964 9 0.75 9.55964 0.75 10.25Z" fill="currentColor"></path><path d="M1 6.5H-0.25H1ZM1 1.5L-0.25 1.5L-0.25 1.5L1 1.5ZM2 6.25C2.13807 6.25 2.25 6.36193 2.25 6.5H-0.25C-0.25 7.74264 0.757359 8.75 2 8.75V6.25ZM1.75 6.5C1.75 6.36193 1.86193 6.25 2 6.25V8.75C3.24264 8.75 4.25 7.74264 4.25 6.5H1.75ZM1.75 1.5V6.5H4.25V1.5H1.75ZM2 1.75C1.86193 1.75 1.75 1.63807 1.75 1.5H4.25C4.25 0.257359 3.24264 -0.75 2 -0.75V1.75ZM2.25 1.5C2.25 1.63807 2.13807 1.75 2 1.75V-0.75C0.757359 -0.75 -0.25 0.257359 -0.25 1.5L2.25 1.5ZM2.25 6.5L2.25 1.5L-0.25 1.5L-0.25 6.5L2.25 6.5ZM2 10.25H-0.5C-0.5 11.6307 0.619288 12.75 2 12.75V10.25ZM2 10.25V12.75C3.38071 12.75 4.5 11.6307 4.5 10.25H2ZM2 10.25H2H4.5C4.5 8.86929 3.38071 7.75 2 7.75V10.25ZM2 10.25H2V7.75C0.619288 7.75 -0.5 8.86929 -0.5 10.25H2Z" fill="currentColor" mask="url(#path-1-inside-1_1975_4008)"></path></svg></div></div><div class="relative h-5 w-full leading-5 mt-[-0.75px] text-token-text-tertiary"><div class="absolute left-0 top-0 overflow-visible line-clamp-1" style="opacity: 1; transform: none;"><button class="inline-flex items-center gap-1">Error analyzing<svg width="16" height="17" viewBox="0 0 16 17" fill="none"><path d="M11.3346 7.83203L8.00131 11.1654L4.66797 7.83203" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div></div><div data-message-author-role="assistant" data-message-id="7bc77edd-f6ab-457e-9664-a09a0d5c5b80" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="markdown prose w-full break-words dark:prose-invert light"><p>I wasn't able to find a specific documentation reference that describes the use of a function in a DTO class for custom validation in NestJS with class-validator. The official class-validator documentation and NestJS documentation primarily focus on using decorators for validation rules.</p><p>However, based on the principles of class-validator and NestJS, custom validation logic can be implemented in various ways, including custom decorators or custom validation classes. The approach I suggested earlier aligns with the extensibility and customization options provided by these libraries, but it might not be explicitly documented in this exact form.</p><p>For detailed information and official documentation, you may want to refer to the following resources:</p><ol><li><a target="_new" href="https://docs.nestjs.com/techniques/validation">NestJS Techniques - Validation</a>: This section in the NestJS documentation provides information on how to use class-validator and class-transformer for validation in NestJS.</li><li><a target="_new">class-validator GitHub Repository</a>: The GitHub repository of class-validator might have examples and issues that discuss various ways to implement custom validation logic.</li><li><a target="_new">class-validator Documentation</a>: This provides detailed information about decorators and how to create custom validation decorators.</li></ol><p>If you have a specific implementation in mind, you might also consider seeking assistance from the NestJS community or on platforms like Stack Overflow, where you can find discussions and solutions for custom validation scenarios in NestJS.</p></div></div></div></div></div></div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-8" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(121, 137, 255); width: 24px; height: 24px;"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="icon-sm" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg></div></div></div></div></div><div class="relative flex w-full flex-col"><div class="font-semibold select-none">Anonymous</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div data-message-author-role="user" data-message-id="aaa28eab-e061-443d-b65c-633006394439" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="">Can we do it by defining a custom validator?</div></div></div></div></div></div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-9" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(25, 195, 125); width: 24px; height: 24px;"><svg width="41" height="41" viewBox="0 0 41 41" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm" role="img"><text x="-9999" y="-9999">ChatGPT</text><path d="M37.5324 16.8707C37.9808 15.5241 38.1363 14.0974 37.9886 12.6859C37.8409 11.2744 37.3934 9.91076 36.676 8.68622C35.6126 6.83404 33.9882 5.3676 32.0373 4.4985C30.0864 3.62941 27.9098 3.40259 25.8215 3.85078C24.8796 2.7893 23.7219 1.94125 22.4257 1.36341C21.1295 0.785575 19.7249 0.491269 18.3058 0.500197C16.1708 0.495044 14.0893 1.16803 12.3614 2.42214C10.6335 3.67624 9.34853 5.44666 8.6917 7.47815C7.30085 7.76286 5.98686 8.3414 4.8377 9.17505C3.68854 10.0087 2.73073 11.0782 2.02839 12.312C0.956464 14.1591 0.498905 16.2988 0.721698 18.4228C0.944492 20.5467 1.83612 22.5449 3.268 24.1293C2.81966 25.4759 2.66413 26.9026 2.81182 28.3141C2.95951 29.7256 3.40701 31.0892 4.12437 32.3138C5.18791 34.1659 6.8123 35.6322 8.76321 36.5013C10.7141 37.3704 12.8907 37.5973 14.9789 37.1492C15.9208 38.2107 17.0786 39.0587 18.3747 39.6366C19.6709 40.2144 21.0755 40.5087 22.4946 40.4998C24.6307 40.5054 26.7133 39.8321 28.4418 38.5772C30.1704 37.3223 31.4556 35.5506 32.1119 33.5179C33.5027 33.2332 34.8167 32.6547 35.9659 31.821C37.115 30.9874 38.0728 29.9178 38.7752 28.684C39.8458 26.8371 40.3023 24.6979 40.0789 22.5748C39.8556 20.4517 38.9639 18.4544 37.5324 16.8707ZM22.4978 37.8849C20.7443 37.8874 19.0459 37.2733 17.6994 36.1501C17.7601 36.117 17.8666 36.0586 17.936 36.0161L25.9004 31.4156C26.1003 31.3019 26.2663 31.137 26.3813 30.9378C26.4964 30.7386 26.5563 30.5124 26.5549 30.2825V19.0542L29.9213 20.998C29.9389 21.0068 29.9541 21.0198 29.9656 21.0359C29.977 21.052 29.9842 21.0707 29.9867 21.0902V30.3889C29.9842 32.375 29.1946 34.2791 27.7909 35.6841C26.3872 37.0892 24.4838 37.8806 22.4978 37.8849ZM6.39227 31.0064C5.51397 29.4888 5.19742 27.7107 5.49804 25.9832C5.55718 26.0187 5.66048 26.0818 5.73461 26.1244L13.699 30.7248C13.8975 30.8408 14.1233 30.902 14.3532 30.902C14.583 30.902 14.8088 30.8408 15.0073 30.7248L24.731 25.1103V28.9979C24.7321 29.0177 24.7283 29.0376 24.7199 29.0556C24.7115 29.0736 24.6988 29.0893 24.6829 29.1012L16.6317 33.7497C14.9096 34.7416 12.8643 35.0097 10.9447 34.4954C9.02506 33.9811 7.38785 32.7263 6.39227 31.0064ZM4.29707 13.6194C5.17156 12.0998 6.55279 10.9364 8.19885 10.3327C8.19885 10.4013 8.19491 10.5228 8.19491 10.6071V19.808C8.19351 20.0378 8.25334 20.2638 8.36823 20.4629C8.48312 20.6619 8.64893 20.8267 8.84863 20.9404L18.5723 26.5542L15.206 28.4979C15.1894 28.5089 15.1703 28.5155 15.1505 28.5173C15.1307 28.5191 15.1107 28.516 15.0924 28.5082L7.04046 23.8557C5.32135 22.8601 4.06716 21.2235 3.55289 19.3046C3.03862 17.3858 3.30624 15.3413 4.29707 13.6194ZM31.955 20.0556L22.2312 14.4411L25.5976 12.4981C25.6142 12.4872 25.6333 12.4805 25.6531 12.4787C25.6729 12.4769 25.6928 12.4801 25.7111 12.4879L33.7631 17.1364C34.9967 17.849 36.0017 18.8982 36.6606 20.1613C37.3194 21.4244 37.6047 22.849 37.4832 24.2684C37.3617 25.6878 36.8382 27.0432 35.9743 28.1759C35.1103 29.3086 33.9415 30.1717 32.6047 30.6641C32.6047 30.5947 32.6047 30.4733 32.6047 30.3889V21.188C32.6066 20.9586 32.5474 20.7328 32.4332 20.5338C32.319 20.3348 32.154 20.1698 31.955 20.0556ZM35.3055 15.0128C35.2464 14.9765 35.1431 14.9142 35.069 14.8717L27.1045 10.2712C26.906 10.1554 26.6803 10.0943 26.4504 10.0943C26.2206 10.0943 25.9948 10.1554 25.7963 10.2712L16.0726 15.8858V11.9982C16.0715 11.9783 16.0753 11.9585 16.0837 11.9405C16.0921 11.9225 16.1048 11.9068 16.1207 11.8949L24.1719 7.25025C25.4053 6.53903 26.8158 6.19376 28.2383 6.25482C29.6608 6.31589 31.0364 6.78077 32.2044 7.59508C33.3723 8.40939 34.2842 9.53945 34.8334 10.8531C35.3826 12.1667 35.5464 13.6095 35.3055 15.0128ZM14.2424 21.9419L10.8752 19.9981C10.8576 19.9893 10.8423 19.9763 10.8309 19.9602C10.8195 19.9441 10.8122 19.9254 10.8098 19.9058V10.6071C10.8107 9.18295 11.2173 7.78848 11.9819 6.58696C12.7466 5.38544 13.8377 4.42659 15.1275 3.82264C16.4173 3.21869 17.8524 2.99464 19.2649 3.1767C20.6775 3.35876 22.0089 3.93941 23.1034 4.85067C23.0427 4.88379 22.937 4.94215 22.8668 4.98473L14.9024 9.58517C14.7025 9.69878 14.5366 9.86356 14.4215 10.0626C14.3065 10.2616 14.2466 10.4877 14.2479 10.7175L14.2424 21.9419ZM16.071 17.9991L20.4018 15.4978L24.7325 17.9975V22.9985L20.4018 25.4983L16.071 22.9985V17.9991Z" fill="currentColor"></path></svg></div></div></div></div></div><div class="relative flex w-full flex-col agent-turn"><div class="font-semibold select-none">ChatGPT</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div data-message-author-role="assistant" data-message-id="40f666c6-d848-4bc1-8ce4-d7407c40b2eb" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="markdown prose w-full break-words dark:prose-invert light"><p>Yes, you can achieve your validation requirement by defining a custom validator in NestJS using <code>class-validator</code>. This approach is well-suited for more complex validation logic that isn't directly achievable through the standard decorators. Here's how you can do it:</p><ol><li><p><strong>Define a Custom Validation Class</strong>: You'll need to create a custom validation class that implements the <code>ValidatorConstraintInterface</code>. This class will contain the logic for your conditional validation.</p></li><li><p><strong>Register the Custom Validator</strong>: Use the <code>@ValidatorConstraint</code> decorator to register your custom validation class.</p></li><li><p><strong>Use the Custom Validator in your DTO</strong>: Apply your custom validator to the relevant field in your DTO using the <code>@Validate</code> decorator.</p></li></ol><p>Here's an example of how you might implement this for your <code>CreateRoomDto</code>:</p><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ValidatorConstraint</span>, <span class="hljs-title class_">ValidatorConstraintInterface</span>, <span class="hljs-title class_">ValidationArguments</span>, <span class="hljs-title class_">Validate</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'class-validator'</span>;

<span class="hljs-meta">@ValidatorConstraint</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'passwordConditional'</span>, <span class="hljs-attr">async</span>: <span class="hljs-literal">false</span> })
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PasswordConditionalValidator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ValidatorConstraintInterface</span> {
  <span class="hljs-title function_">validate</span>(<span class="hljs-params">password: <span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span>, args: ValidationArguments</span>) {
    <span class="hljs-keyword">const</span> <span class="hljs-built_in">object</span> = args.<span class="hljs-property">object</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">CreateRoomDto</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">object</span>.<span class="hljs-property">accessLevel</span> === <span class="hljs-string">'PROTECTED'</span> &amp;&amp; !password) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// Fail validation if accessLevel is PROTECTED and password is not provided</span>
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">object</span>.<span class="hljs-property">accessLevel</span> !== <span class="hljs-string">'PROTECTED'</span> &amp;&amp; password) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// Fail validation if accessLevel is not PROTECTED and password is provided</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// Pass validation in all other cases</span>
  }

  <span class="hljs-title function_">defaultMessage</span>(<span class="hljs-params">args: ValidationArguments</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Password is <span class="hljs-subst">${args.value ? <span class="hljs-string">'not allowed'</span> : <span class="hljs-string">'required'</span>}</span> when access level is <span class="hljs-subst">${args.<span class="hljs-built_in">object</span>[<span class="hljs-string">'accessLevel'</span>]}</span>`</span>;
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CreateRoomDto</span> {
  <span class="hljs-meta">@IsString</span>()
  <span class="hljs-meta">@IsNotEmpty</span>()
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;

  <span class="hljs-meta">@IsString</span>()
  <span class="hljs-meta">@IsNotEmpty</span>()
  <span class="hljs-attr">accessLevel</span>: <span class="hljs-string">'PUBLIC'</span> | <span class="hljs-string">'PRIVATE'</span> | <span class="hljs-string">'PROTECTED'</span>;

  <span class="hljs-meta">@Validate</span>(<span class="hljs-title class_">PasswordConditionalValidator</span>)
  password?: <span class="hljs-built_in">string</span>;
}
</code></div></div></pre><p>In this example:</p><ul><li>The <code>PasswordConditionalValidator</code> class defines the custom logic for validating the <code>password</code> field based on the <code>accessLevel</code>.</li><li>The <code>@ValidatorConstraint</code> decorator registers this class as a custom validator.</li><li>The <code>validate</code> method contains the conditional logic, and the <code>defaultMessage</code> method provides a custom error message.</li><li>The <code>CreateRoomDto</code> uses the <code>@Validate</code> decorator to apply this custom validation to the <code>password</code> field.</li></ul><p>This approach allows you to encapsulate complex validation logic in a reusable and testable format, making your DTOs cleaner and more maintainable.</p></div></div></div></div></div></div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-10" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(121, 137, 255); width: 24px; height: 24px;"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="icon-sm" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg></div></div></div></div></div><div class="relative flex w-full flex-col"><div class="font-semibold select-none">Anonymous</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div data-message-author-role="user" data-message-id="aaa2ecb4-ccb2-431a-b4e9-145f33a5feb3" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="">How about when updating?</div></div></div></div></div></div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-11" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(25, 195, 125); width: 24px; height: 24px;"><svg width="41" height="41" viewBox="0 0 41 41" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm" role="img"><text x="-9999" y="-9999">ChatGPT</text><path d="M37.5324 16.8707C37.9808 15.5241 38.1363 14.0974 37.9886 12.6859C37.8409 11.2744 37.3934 9.91076 36.676 8.68622C35.6126 6.83404 33.9882 5.3676 32.0373 4.4985C30.0864 3.62941 27.9098 3.40259 25.8215 3.85078C24.8796 2.7893 23.7219 1.94125 22.4257 1.36341C21.1295 0.785575 19.7249 0.491269 18.3058 0.500197C16.1708 0.495044 14.0893 1.16803 12.3614 2.42214C10.6335 3.67624 9.34853 5.44666 8.6917 7.47815C7.30085 7.76286 5.98686 8.3414 4.8377 9.17505C3.68854 10.0087 2.73073 11.0782 2.02839 12.312C0.956464 14.1591 0.498905 16.2988 0.721698 18.4228C0.944492 20.5467 1.83612 22.5449 3.268 24.1293C2.81966 25.4759 2.66413 26.9026 2.81182 28.3141C2.95951 29.7256 3.40701 31.0892 4.12437 32.3138C5.18791 34.1659 6.8123 35.6322 8.76321 36.5013C10.7141 37.3704 12.8907 37.5973 14.9789 37.1492C15.9208 38.2107 17.0786 39.0587 18.3747 39.6366C19.6709 40.2144 21.0755 40.5087 22.4946 40.4998C24.6307 40.5054 26.7133 39.8321 28.4418 38.5772C30.1704 37.3223 31.4556 35.5506 32.1119 33.5179C33.5027 33.2332 34.8167 32.6547 35.9659 31.821C37.115 30.9874 38.0728 29.9178 38.7752 28.684C39.8458 26.8371 40.3023 24.6979 40.0789 22.5748C39.8556 20.4517 38.9639 18.4544 37.5324 16.8707ZM22.4978 37.8849C20.7443 37.8874 19.0459 37.2733 17.6994 36.1501C17.7601 36.117 17.8666 36.0586 17.936 36.0161L25.9004 31.4156C26.1003 31.3019 26.2663 31.137 26.3813 30.9378C26.4964 30.7386 26.5563 30.5124 26.5549 30.2825V19.0542L29.9213 20.998C29.9389 21.0068 29.9541 21.0198 29.9656 21.0359C29.977 21.052 29.9842 21.0707 29.9867 21.0902V30.3889C29.9842 32.375 29.1946 34.2791 27.7909 35.6841C26.3872 37.0892 24.4838 37.8806 22.4978 37.8849ZM6.39227 31.0064C5.51397 29.4888 5.19742 27.7107 5.49804 25.9832C5.55718 26.0187 5.66048 26.0818 5.73461 26.1244L13.699 30.7248C13.8975 30.8408 14.1233 30.902 14.3532 30.902C14.583 30.902 14.8088 30.8408 15.0073 30.7248L24.731 25.1103V28.9979C24.7321 29.0177 24.7283 29.0376 24.7199 29.0556C24.7115 29.0736 24.6988 29.0893 24.6829 29.1012L16.6317 33.7497C14.9096 34.7416 12.8643 35.0097 10.9447 34.4954C9.02506 33.9811 7.38785 32.7263 6.39227 31.0064ZM4.29707 13.6194C5.17156 12.0998 6.55279 10.9364 8.19885 10.3327C8.19885 10.4013 8.19491 10.5228 8.19491 10.6071V19.808C8.19351 20.0378 8.25334 20.2638 8.36823 20.4629C8.48312 20.6619 8.64893 20.8267 8.84863 20.9404L18.5723 26.5542L15.206 28.4979C15.1894 28.5089 15.1703 28.5155 15.1505 28.5173C15.1307 28.5191 15.1107 28.516 15.0924 28.5082L7.04046 23.8557C5.32135 22.8601 4.06716 21.2235 3.55289 19.3046C3.03862 17.3858 3.30624 15.3413 4.29707 13.6194ZM31.955 20.0556L22.2312 14.4411L25.5976 12.4981C25.6142 12.4872 25.6333 12.4805 25.6531 12.4787C25.6729 12.4769 25.6928 12.4801 25.7111 12.4879L33.7631 17.1364C34.9967 17.849 36.0017 18.8982 36.6606 20.1613C37.3194 21.4244 37.6047 22.849 37.4832 24.2684C37.3617 25.6878 36.8382 27.0432 35.9743 28.1759C35.1103 29.3086 33.9415 30.1717 32.6047 30.6641C32.6047 30.5947 32.6047 30.4733 32.6047 30.3889V21.188C32.6066 20.9586 32.5474 20.7328 32.4332 20.5338C32.319 20.3348 32.154 20.1698 31.955 20.0556ZM35.3055 15.0128C35.2464 14.9765 35.1431 14.9142 35.069 14.8717L27.1045 10.2712C26.906 10.1554 26.6803 10.0943 26.4504 10.0943C26.2206 10.0943 25.9948 10.1554 25.7963 10.2712L16.0726 15.8858V11.9982C16.0715 11.9783 16.0753 11.9585 16.0837 11.9405C16.0921 11.9225 16.1048 11.9068 16.1207 11.8949L24.1719 7.25025C25.4053 6.53903 26.8158 6.19376 28.2383 6.25482C29.6608 6.31589 31.0364 6.78077 32.2044 7.59508C33.3723 8.40939 34.2842 9.53945 34.8334 10.8531C35.3826 12.1667 35.5464 13.6095 35.3055 15.0128ZM14.2424 21.9419L10.8752 19.9981C10.8576 19.9893 10.8423 19.9763 10.8309 19.9602C10.8195 19.9441 10.8122 19.9254 10.8098 19.9058V10.6071C10.8107 9.18295 11.2173 7.78848 11.9819 6.58696C12.7466 5.38544 13.8377 4.42659 15.1275 3.82264C16.4173 3.21869 17.8524 2.99464 19.2649 3.1767C20.6775 3.35876 22.0089 3.93941 23.1034 4.85067C23.0427 4.88379 22.937 4.94215 22.8668 4.98473L14.9024 9.58517C14.7025 9.69878 14.5366 9.86356 14.4215 10.0626C14.3065 10.2616 14.2466 10.4877 14.2479 10.7175L14.2424 21.9419ZM16.071 17.9991L20.4018 15.4978L24.7325 17.9975V22.9985L20.4018 25.4983L16.071 22.9985V17.9991Z" fill="currentColor"></path></svg></div></div></div></div></div><div class="relative flex w-full flex-col agent-turn"><div class="font-semibold select-none">ChatGPT</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div data-message-author-role="assistant" data-message-id="665ec06c-e0c2-420e-b5d9-8b018ecae498" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="markdown prose w-full break-words dark:prose-invert light"><p>When updating data in NestJS, especially when using Data Transfer Objects (DTOs), you might encounter different validation requirements compared to creating new data. For instance, certain fields might be optional during an update but required during creation. To handle this, you can use a separate DTO for updates or modify your validation logic to accommodate update scenarios.</p><p>Here are two common approaches:</p><h3>1. Using a Separate Update DTO</h3><p>You can create a separate DTO for update operations. This Update DTO may have more optional fields compared to the Create DTO, reflecting the fact that not all fields need to be provided during an update.</p><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">PartialType</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/mapped-types'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UpdateRoomDto</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">PartialType</span>(<span class="hljs-title class_">CreateRoomDto</span>) {
    <span class="hljs-comment">// Additional fields or overrides for update-specific logic can be added here</span>
}
</code></div></div></pre><p>In this <code>UpdateRoomDto</code>, fields from <code>CreateRoomDto</code> are made optional using <code>PartialType</code>. This is a NestJS utility that automatically sets all fields of a class to optional.</p><h3>2. Adjusting Validation in the Existing DTO</h3><p>Alternatively, you can adjust the validation logic within your existing DTO to account for updates. This might involve using additional decorators or custom validation logic to distinguish between creation and update scenarios.</p><p>For example, you might add a flag to your DTO that indicates whether it's being used for creation or updating:</p><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RoomDto</span> {
    <span class="hljs-meta">@IsDefined</span>({ <span class="hljs-attr">groups</span>: [<span class="hljs-string">'create'</span>] })
    <span class="hljs-meta">@IsOptional</span>({ <span class="hljs-attr">groups</span>: [<span class="hljs-string">'update'</span>] })
    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;

    <span class="hljs-comment">// ... other fields and validations</span>

    <span class="hljs-comment">// Custom validation logic for password</span>
    <span class="hljs-meta">@Validate</span>(<span class="hljs-title class_">PasswordConditionalValidator</span>, { <span class="hljs-attr">groups</span>: [<span class="hljs-string">'create'</span>, <span class="hljs-string">'update'</span>] })
    password?: <span class="hljs-built_in">string</span>;
}
</code></div></div></pre><p>Here, the <code>groups</code> option in the decorators is used to apply different validation rules based on the context ('create' or 'update'). When you validate this DTO, you specify the group:</p><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-comment">// For creation</span>
<span class="hljs-keyword">await</span> <span class="hljs-title function_">validate</span>(dto, { <span class="hljs-attr">groups</span>: [<span class="hljs-string">'create'</span>] });

<span class="hljs-comment">// For updating</span>
<span class="hljs-keyword">await</span> <span class="hljs-title function_">validate</span>(dto, { <span class="hljs-attr">groups</span>: [<span class="hljs-string">'update'</span>] });
</code></div></div></pre><h3>Choosing the Right Approach</h3><p>The choice between these two approaches depends on your specific use case:</p><ul><li>If the validation logic for creating and updating is significantly different, using separate DTOs can keep your code cleaner and more understandable.</li><li>If the differences are minor, adjusting the validation logic within the same DTO may be more efficient and easier to maintain.</li></ul><p>In both cases, it's important to carefully consider the validation requirements for each field in the context of both creation and updating, ensuring that your API remains consistent and secure.</p></div></div></div></div></div></div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-12" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(121, 137, 255); width: 24px; height: 24px;"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="icon-sm" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg></div></div></div></div></div><div class="relative flex w-full flex-col"><div class="font-semibold select-none">Anonymous</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div data-message-author-role="user" data-message-id="aaa2cd63-819a-444a-a7b1-c1857916edbf" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="">can you give an example of separate DTO? Since accessLevel and password are option when updating, I'm not sure how to validate it</div></div></div></div></div></div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-13" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(25, 195, 125); width: 24px; height: 24px;"><svg width="41" height="41" viewBox="0 0 41 41" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm" role="img"><text x="-9999" y="-9999">ChatGPT</text><path d="M37.5324 16.8707C37.9808 15.5241 38.1363 14.0974 37.9886 12.6859C37.8409 11.2744 37.3934 9.91076 36.676 8.68622C35.6126 6.83404 33.9882 5.3676 32.0373 4.4985C30.0864 3.62941 27.9098 3.40259 25.8215 3.85078C24.8796 2.7893 23.7219 1.94125 22.4257 1.36341C21.1295 0.785575 19.7249 0.491269 18.3058 0.500197C16.1708 0.495044 14.0893 1.16803 12.3614 2.42214C10.6335 3.67624 9.34853 5.44666 8.6917 7.47815C7.30085 7.76286 5.98686 8.3414 4.8377 9.17505C3.68854 10.0087 2.73073 11.0782 2.02839 12.312C0.956464 14.1591 0.498905 16.2988 0.721698 18.4228C0.944492 20.5467 1.83612 22.5449 3.268 24.1293C2.81966 25.4759 2.66413 26.9026 2.81182 28.3141C2.95951 29.7256 3.40701 31.0892 4.12437 32.3138C5.18791 34.1659 6.8123 35.6322 8.76321 36.5013C10.7141 37.3704 12.8907 37.5973 14.9789 37.1492C15.9208 38.2107 17.0786 39.0587 18.3747 39.6366C19.6709 40.2144 21.0755 40.5087 22.4946 40.4998C24.6307 40.5054 26.7133 39.8321 28.4418 38.5772C30.1704 37.3223 31.4556 35.5506 32.1119 33.5179C33.5027 33.2332 34.8167 32.6547 35.9659 31.821C37.115 30.9874 38.0728 29.9178 38.7752 28.684C39.8458 26.8371 40.3023 24.6979 40.0789 22.5748C39.8556 20.4517 38.9639 18.4544 37.5324 16.8707ZM22.4978 37.8849C20.7443 37.8874 19.0459 37.2733 17.6994 36.1501C17.7601 36.117 17.8666 36.0586 17.936 36.0161L25.9004 31.4156C26.1003 31.3019 26.2663 31.137 26.3813 30.9378C26.4964 30.7386 26.5563 30.5124 26.5549 30.2825V19.0542L29.9213 20.998C29.9389 21.0068 29.9541 21.0198 29.9656 21.0359C29.977 21.052 29.9842 21.0707 29.9867 21.0902V30.3889C29.9842 32.375 29.1946 34.2791 27.7909 35.6841C26.3872 37.0892 24.4838 37.8806 22.4978 37.8849ZM6.39227 31.0064C5.51397 29.4888 5.19742 27.7107 5.49804 25.9832C5.55718 26.0187 5.66048 26.0818 5.73461 26.1244L13.699 30.7248C13.8975 30.8408 14.1233 30.902 14.3532 30.902C14.583 30.902 14.8088 30.8408 15.0073 30.7248L24.731 25.1103V28.9979C24.7321 29.0177 24.7283 29.0376 24.7199 29.0556C24.7115 29.0736 24.6988 29.0893 24.6829 29.1012L16.6317 33.7497C14.9096 34.7416 12.8643 35.0097 10.9447 34.4954C9.02506 33.9811 7.38785 32.7263 6.39227 31.0064ZM4.29707 13.6194C5.17156 12.0998 6.55279 10.9364 8.19885 10.3327C8.19885 10.4013 8.19491 10.5228 8.19491 10.6071V19.808C8.19351 20.0378 8.25334 20.2638 8.36823 20.4629C8.48312 20.6619 8.64893 20.8267 8.84863 20.9404L18.5723 26.5542L15.206 28.4979C15.1894 28.5089 15.1703 28.5155 15.1505 28.5173C15.1307 28.5191 15.1107 28.516 15.0924 28.5082L7.04046 23.8557C5.32135 22.8601 4.06716 21.2235 3.55289 19.3046C3.03862 17.3858 3.30624 15.3413 4.29707 13.6194ZM31.955 20.0556L22.2312 14.4411L25.5976 12.4981C25.6142 12.4872 25.6333 12.4805 25.6531 12.4787C25.6729 12.4769 25.6928 12.4801 25.7111 12.4879L33.7631 17.1364C34.9967 17.849 36.0017 18.8982 36.6606 20.1613C37.3194 21.4244 37.6047 22.849 37.4832 24.2684C37.3617 25.6878 36.8382 27.0432 35.9743 28.1759C35.1103 29.3086 33.9415 30.1717 32.6047 30.6641C32.6047 30.5947 32.6047 30.4733 32.6047 30.3889V21.188C32.6066 20.9586 32.5474 20.7328 32.4332 20.5338C32.319 20.3348 32.154 20.1698 31.955 20.0556ZM35.3055 15.0128C35.2464 14.9765 35.1431 14.9142 35.069 14.8717L27.1045 10.2712C26.906 10.1554 26.6803 10.0943 26.4504 10.0943C26.2206 10.0943 25.9948 10.1554 25.7963 10.2712L16.0726 15.8858V11.9982C16.0715 11.9783 16.0753 11.9585 16.0837 11.9405C16.0921 11.9225 16.1048 11.9068 16.1207 11.8949L24.1719 7.25025C25.4053 6.53903 26.8158 6.19376 28.2383 6.25482C29.6608 6.31589 31.0364 6.78077 32.2044 7.59508C33.3723 8.40939 34.2842 9.53945 34.8334 10.8531C35.3826 12.1667 35.5464 13.6095 35.3055 15.0128ZM14.2424 21.9419L10.8752 19.9981C10.8576 19.9893 10.8423 19.9763 10.8309 19.9602C10.8195 19.9441 10.8122 19.9254 10.8098 19.9058V10.6071C10.8107 9.18295 11.2173 7.78848 11.9819 6.58696C12.7466 5.38544 13.8377 4.42659 15.1275 3.82264C16.4173 3.21869 17.8524 2.99464 19.2649 3.1767C20.6775 3.35876 22.0089 3.93941 23.1034 4.85067C23.0427 4.88379 22.937 4.94215 22.8668 4.98473L14.9024 9.58517C14.7025 9.69878 14.5366 9.86356 14.4215 10.0626C14.3065 10.2616 14.2466 10.4877 14.2479 10.7175L14.2424 21.9419ZM16.071 17.9991L20.4018 15.4978L24.7325 17.9975V22.9985L20.4018 25.4983L16.071 22.9985V17.9991Z" fill="currentColor"></path></svg></div></div></div></div></div><div class="relative flex w-full flex-col agent-turn"><div class="font-semibold select-none">ChatGPT</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div data-message-author-role="assistant" data-message-id="dcfaddbb-a32d-4f75-a371-144f0edbfd05" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="markdown prose w-full break-words dark:prose-invert light"><p>Certainly! When dealing with an update operation in NestJS, especially when certain fields become optional and require conditional validation, using a separate DTO can be very effective. Let's create an <code>UpdateRoomDto</code> based on your <code>CreateRoomDto</code> scenario, where <code>accessLevel</code> and <code>password</code> are optional during an update, but still need to be validated conditionally.</p><h3>Base CreateRoomDto</h3><p>First, here's your <code>CreateRoomDto</code> for reference:</p><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">IsString</span>, <span class="hljs-title class_">IsNotEmpty</span>, <span class="hljs-title class_">ValidateIf</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'class-validator'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CreateRoomDto</span> {
  <span class="hljs-meta">@IsString</span>()
  <span class="hljs-meta">@IsNotEmpty</span>()
  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;

  <span class="hljs-meta">@IsString</span>()
  <span class="hljs-meta">@IsNotEmpty</span>()
  <span class="hljs-attr">accessLevel</span>: <span class="hljs-string">'PUBLIC'</span> | <span class="hljs-string">'PRIVATE'</span> | <span class="hljs-string">'PROTECTED'</span>;

  <span class="hljs-meta">@ValidateIf</span>(<span class="hljs-function">(<span class="hljs-params">o</span>) =&gt;</span> o.<span class="hljs-property">accessLevel</span> === <span class="hljs-string">'PROTECTED'</span>)
  <span class="hljs-meta">@IsString</span>()
  password?: <span class="hljs-built_in">string</span>;
}
</code></div></div></pre><h3>UpdateRoomDto</h3><p>Now, let's create an <code>UpdateRoomDto</code>. In this DTO, both <code>accessLevel</code> and <code>password</code> are optional. We'll add conditional validation to ensure that if <code>accessLevel</code> is set to <code>'PROTECTED'</code>, a <code>password</code> must also be provided.</p><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">IsString</span>, <span class="hljs-title class_">IsOptional</span>, <span class="hljs-title class_">ValidateIf</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'class-validator'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UpdateRoomDto</span> {
  <span class="hljs-meta">@IsOptional</span>()
  <span class="hljs-meta">@IsString</span>()
  name?: <span class="hljs-built_in">string</span>;

  <span class="hljs-meta">@IsOptional</span>()
  <span class="hljs-meta">@IsString</span>()
  accessLevel?: <span class="hljs-string">'PUBLIC'</span> | <span class="hljs-string">'PRIVATE'</span> | <span class="hljs-string">'PROTECTED'</span>;

  <span class="hljs-meta">@IsOptional</span>()
  <span class="hljs-meta">@IsString</span>()
  <span class="hljs-meta">@ValidateIf</span>(<span class="hljs-function">(<span class="hljs-params">o</span>) =&gt;</span> o.<span class="hljs-property">accessLevel</span> === <span class="hljs-string">'PROTECTED'</span>)
  password?: <span class="hljs-built_in">string</span>;
}
</code></div></div></pre><p>In <code>UpdateRoomDto</code>, both <code>name</code> and <code>accessLevel</code> are marked as optional. The password field is also optional but has a conditional validator. The <code>@ValidateIf</code> decorator ensures that <code>password</code> is validated only if <code>accessLevel</code> is set to <code>'PROTECTED'</code>.</p><h3>Handling Partial Updates</h3><p>When updating, you often deal with partial updates, where not all fields are provided. In such cases, it's important to merge the existing data with the new data before validation. This ensures that the validation logic takes into account the full context of the data, including both existing and new values.</p><h3>Usage in a Service or Controller</h3><p>When using this DTO in your service or controller, you'll typically fetch the existing data from your database, merge it with the incoming update data, and then perform validation on the merged object. This approach ensures that your validation logic correctly handles partial updates.</p><h3>Conclusion</h3><p>This setup allows you to have different validation rules for creation and updating operations, which is a common requirement in many applications. The use of separate DTOs helps in maintaining clear separation of concerns and makes your codebase more maintainable and understandable.</p></div></div></div></div></div></div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-14" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(121, 137, 255); width: 24px; height: 24px;"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="icon-sm" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg></div></div></div></div></div><div class="relative flex w-full flex-col"><div class="font-semibold select-none">Anonymous</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div data-message-author-role="user" data-message-id="aaa238be-7e18-4c4e-b13a-2a7c9d4e4a3b" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="">Add PasswordConditionalValidator to updateRoomDto</div></div></div></div></div></div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-15" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(25, 195, 125); width: 24px; height: 24px;"><svg width="41" height="41" viewBox="0 0 41 41" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm" role="img"><text x="-9999" y="-9999">ChatGPT</text><path d="M37.5324 16.8707C37.9808 15.5241 38.1363 14.0974 37.9886 12.6859C37.8409 11.2744 37.3934 9.91076 36.676 8.68622C35.6126 6.83404 33.9882 5.3676 32.0373 4.4985C30.0864 3.62941 27.9098 3.40259 25.8215 3.85078C24.8796 2.7893 23.7219 1.94125 22.4257 1.36341C21.1295 0.785575 19.7249 0.491269 18.3058 0.500197C16.1708 0.495044 14.0893 1.16803 12.3614 2.42214C10.6335 3.67624 9.34853 5.44666 8.6917 7.47815C7.30085 7.76286 5.98686 8.3414 4.8377 9.17505C3.68854 10.0087 2.73073 11.0782 2.02839 12.312C0.956464 14.1591 0.498905 16.2988 0.721698 18.4228C0.944492 20.5467 1.83612 22.5449 3.268 24.1293C2.81966 25.4759 2.66413 26.9026 2.81182 28.3141C2.95951 29.7256 3.40701 31.0892 4.12437 32.3138C5.18791 34.1659 6.8123 35.6322 8.76321 36.5013C10.7141 37.3704 12.8907 37.5973 14.9789 37.1492C15.9208 38.2107 17.0786 39.0587 18.3747 39.6366C19.6709 40.2144 21.0755 40.5087 22.4946 40.4998C24.6307 40.5054 26.7133 39.8321 28.4418 38.5772C30.1704 37.3223 31.4556 35.5506 32.1119 33.5179C33.5027 33.2332 34.8167 32.6547 35.9659 31.821C37.115 30.9874 38.0728 29.9178 38.7752 28.684C39.8458 26.8371 40.3023 24.6979 40.0789 22.5748C39.8556 20.4517 38.9639 18.4544 37.5324 16.8707ZM22.4978 37.8849C20.7443 37.8874 19.0459 37.2733 17.6994 36.1501C17.7601 36.117 17.8666 36.0586 17.936 36.0161L25.9004 31.4156C26.1003 31.3019 26.2663 31.137 26.3813 30.9378C26.4964 30.7386 26.5563 30.5124 26.5549 30.2825V19.0542L29.9213 20.998C29.9389 21.0068 29.9541 21.0198 29.9656 21.0359C29.977 21.052 29.9842 21.0707 29.9867 21.0902V30.3889C29.9842 32.375 29.1946 34.2791 27.7909 35.6841C26.3872 37.0892 24.4838 37.8806 22.4978 37.8849ZM6.39227 31.0064C5.51397 29.4888 5.19742 27.7107 5.49804 25.9832C5.55718 26.0187 5.66048 26.0818 5.73461 26.1244L13.699 30.7248C13.8975 30.8408 14.1233 30.902 14.3532 30.902C14.583 30.902 14.8088 30.8408 15.0073 30.7248L24.731 25.1103V28.9979C24.7321 29.0177 24.7283 29.0376 24.7199 29.0556C24.7115 29.0736 24.6988 29.0893 24.6829 29.1012L16.6317 33.7497C14.9096 34.7416 12.8643 35.0097 10.9447 34.4954C9.02506 33.9811 7.38785 32.7263 6.39227 31.0064ZM4.29707 13.6194C5.17156 12.0998 6.55279 10.9364 8.19885 10.3327C8.19885 10.4013 8.19491 10.5228 8.19491 10.6071V19.808C8.19351 20.0378 8.25334 20.2638 8.36823 20.4629C8.48312 20.6619 8.64893 20.8267 8.84863 20.9404L18.5723 26.5542L15.206 28.4979C15.1894 28.5089 15.1703 28.5155 15.1505 28.5173C15.1307 28.5191 15.1107 28.516 15.0924 28.5082L7.04046 23.8557C5.32135 22.8601 4.06716 21.2235 3.55289 19.3046C3.03862 17.3858 3.30624 15.3413 4.29707 13.6194ZM31.955 20.0556L22.2312 14.4411L25.5976 12.4981C25.6142 12.4872 25.6333 12.4805 25.6531 12.4787C25.6729 12.4769 25.6928 12.4801 25.7111 12.4879L33.7631 17.1364C34.9967 17.849 36.0017 18.8982 36.6606 20.1613C37.3194 21.4244 37.6047 22.849 37.4832 24.2684C37.3617 25.6878 36.8382 27.0432 35.9743 28.1759C35.1103 29.3086 33.9415 30.1717 32.6047 30.6641C32.6047 30.5947 32.6047 30.4733 32.6047 30.3889V21.188C32.6066 20.9586 32.5474 20.7328 32.4332 20.5338C32.319 20.3348 32.154 20.1698 31.955 20.0556ZM35.3055 15.0128C35.2464 14.9765 35.1431 14.9142 35.069 14.8717L27.1045 10.2712C26.906 10.1554 26.6803 10.0943 26.4504 10.0943C26.2206 10.0943 25.9948 10.1554 25.7963 10.2712L16.0726 15.8858V11.9982C16.0715 11.9783 16.0753 11.9585 16.0837 11.9405C16.0921 11.9225 16.1048 11.9068 16.1207 11.8949L24.1719 7.25025C25.4053 6.53903 26.8158 6.19376 28.2383 6.25482C29.6608 6.31589 31.0364 6.78077 32.2044 7.59508C33.3723 8.40939 34.2842 9.53945 34.8334 10.8531C35.3826 12.1667 35.5464 13.6095 35.3055 15.0128ZM14.2424 21.9419L10.8752 19.9981C10.8576 19.9893 10.8423 19.9763 10.8309 19.9602C10.8195 19.9441 10.8122 19.9254 10.8098 19.9058V10.6071C10.8107 9.18295 11.2173 7.78848 11.9819 6.58696C12.7466 5.38544 13.8377 4.42659 15.1275 3.82264C16.4173 3.21869 17.8524 2.99464 19.2649 3.1767C20.6775 3.35876 22.0089 3.93941 23.1034 4.85067C23.0427 4.88379 22.937 4.94215 22.8668 4.98473L14.9024 9.58517C14.7025 9.69878 14.5366 9.86356 14.4215 10.0626C14.3065 10.2616 14.2466 10.4877 14.2479 10.7175L14.2424 21.9419ZM16.071 17.9991L20.4018 15.4978L24.7325 17.9975V22.9985L20.4018 25.4983L16.071 22.9985V17.9991Z" fill="currentColor"></path></svg></div></div></div></div></div><div class="relative flex w-full flex-col agent-turn"><div class="font-semibold select-none">ChatGPT</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div data-message-author-role="assistant" data-message-id="12b9d84a-60de-4ae5-be06-79a4d209f317" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="markdown prose w-full break-words dark:prose-invert light"><p>Certainly! Let's integrate the <code>PasswordConditionalValidator</code> into the <code>UpdateRoomDto</code>. This custom validator will ensure that a password is provided if the <code>accessLevel</code> is set to <code>'PROTECTED'</code> and reject the password if the <code>accessLevel</code> is not <code>'PROTECTED'</code>.</p><h3>PasswordConditionalValidator</h3><p>First, here's a reminder of what the <code>PasswordConditionalValidator</code> looks like:</p><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ValidatorConstraint</span>, <span class="hljs-title class_">ValidatorConstraintInterface</span>, <span class="hljs-title class_">ValidationArguments</span>, <span class="hljs-title class_">Validate</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'class-validator'</span>;

<span class="hljs-meta">@ValidatorConstraint</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'passwordConditional'</span>, <span class="hljs-attr">async</span>: <span class="hljs-literal">false</span> })
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PasswordConditionalValidator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ValidatorConstraintInterface</span> {
  <span class="hljs-title function_">validate</span>(<span class="hljs-params">password: <span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span>, args: ValidationArguments</span>) {
    <span class="hljs-keyword">const</span> <span class="hljs-built_in">object</span> = args.<span class="hljs-property">object</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">UpdateRoomDto</span>; <span class="hljs-comment">// Now using UpdateRoomDto</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">object</span>.<span class="hljs-property">accessLevel</span> === <span class="hljs-string">'PROTECTED'</span> &amp;&amp; !password) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// Fail validation if accessLevel is PROTECTED and password is not provided</span>
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">object</span>.<span class="hljs-property">accessLevel</span> !== <span class="hljs-string">'PROTECTED'</span> &amp;&amp; password) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// Fail validation if accessLevel is not PROTECTED and password is provided</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// Pass validation in all other cases</span>
  }

  <span class="hljs-title function_">defaultMessage</span>(<span class="hljs-params">args: ValidationArguments</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Password is <span class="hljs-subst">${args.value ? <span class="hljs-string">'not allowed'</span> : <span class="hljs-string">'required'</span>}</span> when access level is <span class="hljs-subst">${args.<span class="hljs-built_in">object</span>[<span class="hljs-string">'accessLevel'</span>]}</span>`</span>;
  }
}
</code></div></div></pre><h3>UpdateRoomDto with PasswordConditionalValidator</h3><p>Now, let's integrate this validator into the <code>UpdateRoomDto</code>:</p><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">IsString</span>, <span class="hljs-title class_">IsOptional</span>, <span class="hljs-title class_">Validate</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'class-validator'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UpdateRoomDto</span> {
  <span class="hljs-meta">@IsOptional</span>()
  <span class="hljs-meta">@IsString</span>()
  name?: <span class="hljs-built_in">string</span>;

  <span class="hljs-meta">@IsOptional</span>()
  <span class="hljs-meta">@IsString</span>()
  accessLevel?: <span class="hljs-string">'PUBLIC'</span> | <span class="hljs-string">'PRIVATE'</span> | <span class="hljs-string">'PROTECTED'</span>;

  <span class="hljs-meta">@IsOptional</span>()
  <span class="hljs-meta">@IsString</span>()
  <span class="hljs-meta">@Validate</span>(<span class="hljs-title class_">PasswordConditionalValidator</span>)
  password?: <span class="hljs-built_in">string</span>;
}
</code></div></div></pre><p>In this <code>UpdateRoomDto</code>, both <code>accessLevel</code> and <code>password</code> are optional fields. The <code>PasswordConditionalValidator</code> is applied to the <code>password</code> field to enforce the conditional logic:</p><ul><li>If <code>accessLevel</code> is <code>'PROTECTED'</code>, a <code>password</code> must be provided, and it must be a string.</li><li>If <code>accessLevel</code> is anything other than <code>'PROTECTED'</code>, the <code>password</code> must not be provided.</li><li>If <code>accessLevel</code> is not provided at all, the <code>password</code> field is ignored since it's marked as optional.</li></ul><h3>Usage in Application</h3><p>When using this DTO for update operations, it's important to handle partial updates correctly. Typically, you should fetch the existing data from the database and compare it with the incoming DTO to apply the validation rules effectively.</p><p>This approach allows you to maintain robust validation rules that are specific to the update operation, ensuring the integrity of your data while accommodating the flexible nature of update requests.</p></div></div></div></div></div></div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-16" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(121, 137, 255); width: 24px; height: 24px;"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="icon-sm" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg></div></div></div></div></div><div class="relative flex w-full flex-col"><div class="font-semibold select-none">Anonymous</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div data-message-author-role="user" data-message-id="aaa2e8a4-7ddd-4f91-817c-d92f6b2e6912" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="">The problem with this approach is when room's access level is already "PROTECTED", this doesn't allow update of password, which it should</div></div></div></div></div></div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-17" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(25, 195, 125); width: 24px; height: 24px;"><svg width="41" height="41" viewBox="0 0 41 41" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm" role="img"><text x="-9999" y="-9999">ChatGPT</text><path d="M37.5324 16.8707C37.9808 15.5241 38.1363 14.0974 37.9886 12.6859C37.8409 11.2744 37.3934 9.91076 36.676 8.68622C35.6126 6.83404 33.9882 5.3676 32.0373 4.4985C30.0864 3.62941 27.9098 3.40259 25.8215 3.85078C24.8796 2.7893 23.7219 1.94125 22.4257 1.36341C21.1295 0.785575 19.7249 0.491269 18.3058 0.500197C16.1708 0.495044 14.0893 1.16803 12.3614 2.42214C10.6335 3.67624 9.34853 5.44666 8.6917 7.47815C7.30085 7.76286 5.98686 8.3414 4.8377 9.17505C3.68854 10.0087 2.73073 11.0782 2.02839 12.312C0.956464 14.1591 0.498905 16.2988 0.721698 18.4228C0.944492 20.5467 1.83612 22.5449 3.268 24.1293C2.81966 25.4759 2.66413 26.9026 2.81182 28.3141C2.95951 29.7256 3.40701 31.0892 4.12437 32.3138C5.18791 34.1659 6.8123 35.6322 8.76321 36.5013C10.7141 37.3704 12.8907 37.5973 14.9789 37.1492C15.9208 38.2107 17.0786 39.0587 18.3747 39.6366C19.6709 40.2144 21.0755 40.5087 22.4946 40.4998C24.6307 40.5054 26.7133 39.8321 28.4418 38.5772C30.1704 37.3223 31.4556 35.5506 32.1119 33.5179C33.5027 33.2332 34.8167 32.6547 35.9659 31.821C37.115 30.9874 38.0728 29.9178 38.7752 28.684C39.8458 26.8371 40.3023 24.6979 40.0789 22.5748C39.8556 20.4517 38.9639 18.4544 37.5324 16.8707ZM22.4978 37.8849C20.7443 37.8874 19.0459 37.2733 17.6994 36.1501C17.7601 36.117 17.8666 36.0586 17.936 36.0161L25.9004 31.4156C26.1003 31.3019 26.2663 31.137 26.3813 30.9378C26.4964 30.7386 26.5563 30.5124 26.5549 30.2825V19.0542L29.9213 20.998C29.9389 21.0068 29.9541 21.0198 29.9656 21.0359C29.977 21.052 29.9842 21.0707 29.9867 21.0902V30.3889C29.9842 32.375 29.1946 34.2791 27.7909 35.6841C26.3872 37.0892 24.4838 37.8806 22.4978 37.8849ZM6.39227 31.0064C5.51397 29.4888 5.19742 27.7107 5.49804 25.9832C5.55718 26.0187 5.66048 26.0818 5.73461 26.1244L13.699 30.7248C13.8975 30.8408 14.1233 30.902 14.3532 30.902C14.583 30.902 14.8088 30.8408 15.0073 30.7248L24.731 25.1103V28.9979C24.7321 29.0177 24.7283 29.0376 24.7199 29.0556C24.7115 29.0736 24.6988 29.0893 24.6829 29.1012L16.6317 33.7497C14.9096 34.7416 12.8643 35.0097 10.9447 34.4954C9.02506 33.9811 7.38785 32.7263 6.39227 31.0064ZM4.29707 13.6194C5.17156 12.0998 6.55279 10.9364 8.19885 10.3327C8.19885 10.4013 8.19491 10.5228 8.19491 10.6071V19.808C8.19351 20.0378 8.25334 20.2638 8.36823 20.4629C8.48312 20.6619 8.64893 20.8267 8.84863 20.9404L18.5723 26.5542L15.206 28.4979C15.1894 28.5089 15.1703 28.5155 15.1505 28.5173C15.1307 28.5191 15.1107 28.516 15.0924 28.5082L7.04046 23.8557C5.32135 22.8601 4.06716 21.2235 3.55289 19.3046C3.03862 17.3858 3.30624 15.3413 4.29707 13.6194ZM31.955 20.0556L22.2312 14.4411L25.5976 12.4981C25.6142 12.4872 25.6333 12.4805 25.6531 12.4787C25.6729 12.4769 25.6928 12.4801 25.7111 12.4879L33.7631 17.1364C34.9967 17.849 36.0017 18.8982 36.6606 20.1613C37.3194 21.4244 37.6047 22.849 37.4832 24.2684C37.3617 25.6878 36.8382 27.0432 35.9743 28.1759C35.1103 29.3086 33.9415 30.1717 32.6047 30.6641C32.6047 30.5947 32.6047 30.4733 32.6047 30.3889V21.188C32.6066 20.9586 32.5474 20.7328 32.4332 20.5338C32.319 20.3348 32.154 20.1698 31.955 20.0556ZM35.3055 15.0128C35.2464 14.9765 35.1431 14.9142 35.069 14.8717L27.1045 10.2712C26.906 10.1554 26.6803 10.0943 26.4504 10.0943C26.2206 10.0943 25.9948 10.1554 25.7963 10.2712L16.0726 15.8858V11.9982C16.0715 11.9783 16.0753 11.9585 16.0837 11.9405C16.0921 11.9225 16.1048 11.9068 16.1207 11.8949L24.1719 7.25025C25.4053 6.53903 26.8158 6.19376 28.2383 6.25482C29.6608 6.31589 31.0364 6.78077 32.2044 7.59508C33.3723 8.40939 34.2842 9.53945 34.8334 10.8531C35.3826 12.1667 35.5464 13.6095 35.3055 15.0128ZM14.2424 21.9419L10.8752 19.9981C10.8576 19.9893 10.8423 19.9763 10.8309 19.9602C10.8195 19.9441 10.8122 19.9254 10.8098 19.9058V10.6071C10.8107 9.18295 11.2173 7.78848 11.9819 6.58696C12.7466 5.38544 13.8377 4.42659 15.1275 3.82264C16.4173 3.21869 17.8524 2.99464 19.2649 3.1767C20.6775 3.35876 22.0089 3.93941 23.1034 4.85067C23.0427 4.88379 22.937 4.94215 22.8668 4.98473L14.9024 9.58517C14.7025 9.69878 14.5366 9.86356 14.4215 10.0626C14.3065 10.2616 14.2466 10.4877 14.2479 10.7175L14.2424 21.9419ZM16.071 17.9991L20.4018 15.4978L24.7325 17.9975V22.9985L20.4018 25.4983L16.071 22.9985V17.9991Z" fill="currentColor"></path></svg></div></div></div></div></div><div class="relative flex w-full flex-col agent-turn"><div class="font-semibold select-none">ChatGPT</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div data-message-author-role="assistant" data-message-id="af5a3730-98f1-4780-bfff-c5705fdf777c" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="markdown prose w-full break-words dark:prose-invert light"><p>You're right. The validation logic needs to accommodate the scenario where the room's <code>accessLevel</code> is already set to <code>"PROTECTED"</code> and you want to update the <code>password</code>. For this, we need to adjust the validation logic to consider the current state of the room's access level in the database.</p><p>Since DTOs in NestJS are typically stateless and do not have access to the database or the current state of the entity, you need a way to incorporate this state into your validation logic. This can be achieved by using a custom validation class that has access to the necessary services to fetch the current state from the database.</p><p>Here's an example of how you can modify the <code>PasswordConditionalValidator</code> to include a service that fetches the current state of the room:</p><ol><li><p><strong>Modify the PasswordConditionalValidator</strong>:</p><p>Modify the <code>PasswordConditionalValidator</code> to include a service that can fetch the current state of the room from the database. This service can be injected into the validator.</p><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Injectable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ValidatorConstraint</span>, <span class="hljs-title class_">ValidatorConstraintInterface</span>, <span class="hljs-title class_">ValidationArguments</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'class-validator'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">RoomService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./room.service'</span>; <span class="hljs-comment">// Import your Room service</span>

<span class="hljs-meta">@ValidatorConstraint</span>({ <span class="hljs-attr">async</span>: <span class="hljs-literal">true</span> })
<span class="hljs-meta">@Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PasswordConditionalValidator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ValidatorConstraintInterface</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> roomService: RoomService</span>) {}

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">validate</span>(<span class="hljs-params">password: <span class="hljs-built_in">string</span>, args: ValidationArguments</span>) {
    <span class="hljs-keyword">const</span> roomDto = args.<span class="hljs-property">object</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">UpdateRoomDto</span>;
    <span class="hljs-keyword">const</span> roomId = roomDto.<span class="hljs-property">id</span>; <span class="hljs-comment">// Assume you have the room's ID in the DTO</span>

    <span class="hljs-keyword">if</span> (!roomId) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// If no room ID is provided, skip the check (or handle as needed)</span>
    }

    <span class="hljs-keyword">const</span> room = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">roomService</span>.<span class="hljs-title function_">findOne</span>(roomId); <span class="hljs-comment">// Fetch the current room state</span>

    <span class="hljs-keyword">if</span> (room.<span class="hljs-property">accessLevel</span> === <span class="hljs-string">'PROTECTED'</span> &amp;&amp; !password) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// Fail validation if accessLevel is PROTECTED and no password is provided</span>
    }

    <span class="hljs-keyword">if</span> (room.<span class="hljs-property">accessLevel</span> !== <span class="hljs-string">'PROTECTED'</span> &amp;&amp; password) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// Fail validation if accessLevel is not PROTECTED and password is provided</span>
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// Pass validation in all other cases</span>
  }

  <span class="hljs-title function_">defaultMessage</span>(<span class="hljs-params">args: ValidationArguments</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Password is <span class="hljs-subst">${args.value ? <span class="hljs-string">'not allowed'</span> : <span class="hljs-string">'required'</span>}</span> when access level is <span class="hljs-subst">${args.<span class="hljs-built_in">object</span>[<span class="hljs-string">'accessLevel'</span>]}</span>`</span>;
  }
}
</code></div></div></pre></li><li><p><strong>Register the Custom Validator as a Provider</strong>:</p><p>Since the custom validator now has a dependency (the <code>RoomService</code>), you need to register it as a provider in your module.</p><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Module</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-variable constant_">APP_PIPE</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/core'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">PasswordConditionalValidator</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./password-conditional.validator'</span>;

<span class="hljs-meta">@Module</span>({
  <span class="hljs-comment">// ... other module settings</span>
  <span class="hljs-attr">providers</span>: [
    <span class="hljs-title class_">PasswordConditionalValidator</span>,
    <span class="hljs-comment">// ... other providers</span>
  ],
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">YourModule</span> {}
</code></div></div></pre></li><li><p><strong>Usage in UpdateRoomDto</strong>:</p><p>The usage in <code>UpdateRoomDto</code> remains the same, but ensure that you provide the necessary room ID or other identifiers needed for the validator to fetch the current room state.</p><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-comment">// UpdateRoomDto remains the same as before</span>
</code></div></div></pre></li></ol><p>This approach allows you to use the current state of the entity in your validation logic, enabling more complex scenarios like the one you described. Make sure your services and modules are set up correctly to support dependency injection into the custom validator.</p></div></div></div></div></div></div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-18" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(121, 137, 255); width: 24px; height: 24px;"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="icon-sm" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg></div></div></div></div></div><div class="relative flex w-full flex-col"><div class="font-semibold select-none">Anonymous</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div data-message-author-role="user" data-message-id="aaa2617c-c30f-407b-a203-78064781d8cd" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="">When there are multiple validations like this, how to reduce the DB calls?</div></div></div></div></div></div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-19" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(25, 195, 125); width: 24px; height: 24px;"><svg width="41" height="41" viewBox="0 0 41 41" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm" role="img"><text x="-9999" y="-9999">ChatGPT</text><path d="M37.5324 16.8707C37.9808 15.5241 38.1363 14.0974 37.9886 12.6859C37.8409 11.2744 37.3934 9.91076 36.676 8.68622C35.6126 6.83404 33.9882 5.3676 32.0373 4.4985C30.0864 3.62941 27.9098 3.40259 25.8215 3.85078C24.8796 2.7893 23.7219 1.94125 22.4257 1.36341C21.1295 0.785575 19.7249 0.491269 18.3058 0.500197C16.1708 0.495044 14.0893 1.16803 12.3614 2.42214C10.6335 3.67624 9.34853 5.44666 8.6917 7.47815C7.30085 7.76286 5.98686 8.3414 4.8377 9.17505C3.68854 10.0087 2.73073 11.0782 2.02839 12.312C0.956464 14.1591 0.498905 16.2988 0.721698 18.4228C0.944492 20.5467 1.83612 22.5449 3.268 24.1293C2.81966 25.4759 2.66413 26.9026 2.81182 28.3141C2.95951 29.7256 3.40701 31.0892 4.12437 32.3138C5.18791 34.1659 6.8123 35.6322 8.76321 36.5013C10.7141 37.3704 12.8907 37.5973 14.9789 37.1492C15.9208 38.2107 17.0786 39.0587 18.3747 39.6366C19.6709 40.2144 21.0755 40.5087 22.4946 40.4998C24.6307 40.5054 26.7133 39.8321 28.4418 38.5772C30.1704 37.3223 31.4556 35.5506 32.1119 33.5179C33.5027 33.2332 34.8167 32.6547 35.9659 31.821C37.115 30.9874 38.0728 29.9178 38.7752 28.684C39.8458 26.8371 40.3023 24.6979 40.0789 22.5748C39.8556 20.4517 38.9639 18.4544 37.5324 16.8707ZM22.4978 37.8849C20.7443 37.8874 19.0459 37.2733 17.6994 36.1501C17.7601 36.117 17.8666 36.0586 17.936 36.0161L25.9004 31.4156C26.1003 31.3019 26.2663 31.137 26.3813 30.9378C26.4964 30.7386 26.5563 30.5124 26.5549 30.2825V19.0542L29.9213 20.998C29.9389 21.0068 29.9541 21.0198 29.9656 21.0359C29.977 21.052 29.9842 21.0707 29.9867 21.0902V30.3889C29.9842 32.375 29.1946 34.2791 27.7909 35.6841C26.3872 37.0892 24.4838 37.8806 22.4978 37.8849ZM6.39227 31.0064C5.51397 29.4888 5.19742 27.7107 5.49804 25.9832C5.55718 26.0187 5.66048 26.0818 5.73461 26.1244L13.699 30.7248C13.8975 30.8408 14.1233 30.902 14.3532 30.902C14.583 30.902 14.8088 30.8408 15.0073 30.7248L24.731 25.1103V28.9979C24.7321 29.0177 24.7283 29.0376 24.7199 29.0556C24.7115 29.0736 24.6988 29.0893 24.6829 29.1012L16.6317 33.7497C14.9096 34.7416 12.8643 35.0097 10.9447 34.4954C9.02506 33.9811 7.38785 32.7263 6.39227 31.0064ZM4.29707 13.6194C5.17156 12.0998 6.55279 10.9364 8.19885 10.3327C8.19885 10.4013 8.19491 10.5228 8.19491 10.6071V19.808C8.19351 20.0378 8.25334 20.2638 8.36823 20.4629C8.48312 20.6619 8.64893 20.8267 8.84863 20.9404L18.5723 26.5542L15.206 28.4979C15.1894 28.5089 15.1703 28.5155 15.1505 28.5173C15.1307 28.5191 15.1107 28.516 15.0924 28.5082L7.04046 23.8557C5.32135 22.8601 4.06716 21.2235 3.55289 19.3046C3.03862 17.3858 3.30624 15.3413 4.29707 13.6194ZM31.955 20.0556L22.2312 14.4411L25.5976 12.4981C25.6142 12.4872 25.6333 12.4805 25.6531 12.4787C25.6729 12.4769 25.6928 12.4801 25.7111 12.4879L33.7631 17.1364C34.9967 17.849 36.0017 18.8982 36.6606 20.1613C37.3194 21.4244 37.6047 22.849 37.4832 24.2684C37.3617 25.6878 36.8382 27.0432 35.9743 28.1759C35.1103 29.3086 33.9415 30.1717 32.6047 30.6641C32.6047 30.5947 32.6047 30.4733 32.6047 30.3889V21.188C32.6066 20.9586 32.5474 20.7328 32.4332 20.5338C32.319 20.3348 32.154 20.1698 31.955 20.0556ZM35.3055 15.0128C35.2464 14.9765 35.1431 14.9142 35.069 14.8717L27.1045 10.2712C26.906 10.1554 26.6803 10.0943 26.4504 10.0943C26.2206 10.0943 25.9948 10.1554 25.7963 10.2712L16.0726 15.8858V11.9982C16.0715 11.9783 16.0753 11.9585 16.0837 11.9405C16.0921 11.9225 16.1048 11.9068 16.1207 11.8949L24.1719 7.25025C25.4053 6.53903 26.8158 6.19376 28.2383 6.25482C29.6608 6.31589 31.0364 6.78077 32.2044 7.59508C33.3723 8.40939 34.2842 9.53945 34.8334 10.8531C35.3826 12.1667 35.5464 13.6095 35.3055 15.0128ZM14.2424 21.9419L10.8752 19.9981C10.8576 19.9893 10.8423 19.9763 10.8309 19.9602C10.8195 19.9441 10.8122 19.9254 10.8098 19.9058V10.6071C10.8107 9.18295 11.2173 7.78848 11.9819 6.58696C12.7466 5.38544 13.8377 4.42659 15.1275 3.82264C16.4173 3.21869 17.8524 2.99464 19.2649 3.1767C20.6775 3.35876 22.0089 3.93941 23.1034 4.85067C23.0427 4.88379 22.937 4.94215 22.8668 4.98473L14.9024 9.58517C14.7025 9.69878 14.5366 9.86356 14.4215 10.0626C14.3065 10.2616 14.2466 10.4877 14.2479 10.7175L14.2424 21.9419ZM16.071 17.9991L20.4018 15.4978L24.7325 17.9975V22.9985L20.4018 25.4983L16.071 22.9985V17.9991Z" fill="currentColor"></path></svg></div></div></div></div></div><div class="relative flex w-full flex-col agent-turn"><div class="font-semibold select-none">ChatGPT</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div data-message-author-role="assistant" data-message-id="e53a760d-6e97-4f88-b80e-9af86a2210dc" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="markdown prose w-full break-words dark:prose-invert light"><p>Reducing database calls when performing multiple validations in NestJS, especially when dealing with complex conditional validations, is crucial for optimizing performance. Here are several strategies to minimize database interactions:</p><h3>1. <strong>Aggregate Validations into a Single Custom Validator</strong></h3><p>Instead of having multiple custom validators each making their own database calls, you can create a single, more comprehensive validator that handles all the necessary logic. This validator can make a single database call to retrieve all the required information and then perform all validations.</p><p>For example, if you have multiple validations that depend on the current state of a <code>Room</code>, you can fetch the <code>Room</code> once and then perform all the validations against this fetched data.</p><h3>2. <strong>Cache the Required Data</strong></h3><p>If the data required for validation is relatively static or doesn't change frequently, you can cache it. This way, you can avoid repetitive database calls for data that hasn’t changed.</p><p>You can implement caching at the service level or use a dedicated caching mechanism like Redis. The cache can store the fetched data for a predetermined amount of time, and subsequent validation requests can first check the cache before querying the database.</p><h3>3. <strong>Optimize Your Database Queries</strong></h3><p>Ensure that your database queries are optimized and fetch only the necessary data. Sometimes, using projections to select only specific fields or using efficient query methods can significantly reduce the load and improve performance.</p><h3>4. <strong>Use Database Transactions</strong></h3><p>If you are performing multiple update operations that each require validation, consider using database transactions. This way, you can group multiple operations into a single transaction. Although this doesn't reduce the number of validation checks, it can optimize the update operations and ensure data consistency.</p><h3>5. <strong>Front-End Validation as a Preliminary Step</strong></h3><p>While front-end validation is not a substitute for back-end validation, it can reduce unnecessary requests to the server. By validating input on the client side first, you can catch many common errors before they even reach your back-end.</p><h3>6. <strong>Service Layer Validation</strong></h3><p>Perform validation at the service layer where you can control the flow of operations more granularly. This allows you to make a single call to the database to retrieve all necessary information and then pass this data to various validation functions as needed.</p><h3>7. <strong>Optimize Application Architecture</strong></h3><p>Sometimes the solution lies in optimizing the overall application architecture. For instance, using a CQRS pattern (Command Query Responsibility Segregation) can separate read and write operations, allowing for more efficient handling of data and reducing unnecessary database interactions.</p><p>Implementing these strategies requires a balance between maintaining data integrity and optimizing performance. The best approach depends on the specific requirements and constraints of your application.</p></div></div></div></div></div></div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-20" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(121, 137, 255); width: 24px; height: 24px;"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="icon-sm" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg></div></div></div></div></div><div class="relative flex w-full flex-col"><div class="font-semibold select-none">Anonymous</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div data-message-author-role="user" data-message-id="aaa21ec1-1afe-4091-ac4b-f798ade556fd" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="">can you provide an example source code for each case?</div></div></div></div></div></div></div></div><div class="w-full text-token-text-primary" data-testid="conversation-turn-21" style="--avatar-color: #19c37d;"><div class="px-4 py-2 justify-center text-base md:gap-6 m-auto"><div class="flex flex-1 text-base mx-auto gap-3 md:max-w-3xl lg:max-w-[40rem] xl:max-w-[48rem] group final-completion"><div class="flex-shrink-0 flex flex-col relative items-end"><div><div class="pt-0.5"><div class="gizmo-shadow-stroke flex h-6 w-6 items-center justify-center overflow-hidden rounded-full"><div class="relative p-1 rounded-sm h-9 w-9 text-white flex items-center justify-center" style="background-color: rgb(25, 195, 125); width: 24px; height: 24px;"><svg width="41" height="41" viewBox="0 0 41 41" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm" role="img"><text x="-9999" y="-9999">ChatGPT</text><path d="M37.5324 16.8707C37.9808 15.5241 38.1363 14.0974 37.9886 12.6859C37.8409 11.2744 37.3934 9.91076 36.676 8.68622C35.6126 6.83404 33.9882 5.3676 32.0373 4.4985C30.0864 3.62941 27.9098 3.40259 25.8215 3.85078C24.8796 2.7893 23.7219 1.94125 22.4257 1.36341C21.1295 0.785575 19.7249 0.491269 18.3058 0.500197C16.1708 0.495044 14.0893 1.16803 12.3614 2.42214C10.6335 3.67624 9.34853 5.44666 8.6917 7.47815C7.30085 7.76286 5.98686 8.3414 4.8377 9.17505C3.68854 10.0087 2.73073 11.0782 2.02839 12.312C0.956464 14.1591 0.498905 16.2988 0.721698 18.4228C0.944492 20.5467 1.83612 22.5449 3.268 24.1293C2.81966 25.4759 2.66413 26.9026 2.81182 28.3141C2.95951 29.7256 3.40701 31.0892 4.12437 32.3138C5.18791 34.1659 6.8123 35.6322 8.76321 36.5013C10.7141 37.3704 12.8907 37.5973 14.9789 37.1492C15.9208 38.2107 17.0786 39.0587 18.3747 39.6366C19.6709 40.2144 21.0755 40.5087 22.4946 40.4998C24.6307 40.5054 26.7133 39.8321 28.4418 38.5772C30.1704 37.3223 31.4556 35.5506 32.1119 33.5179C33.5027 33.2332 34.8167 32.6547 35.9659 31.821C37.115 30.9874 38.0728 29.9178 38.7752 28.684C39.8458 26.8371 40.3023 24.6979 40.0789 22.5748C39.8556 20.4517 38.9639 18.4544 37.5324 16.8707ZM22.4978 37.8849C20.7443 37.8874 19.0459 37.2733 17.6994 36.1501C17.7601 36.117 17.8666 36.0586 17.936 36.0161L25.9004 31.4156C26.1003 31.3019 26.2663 31.137 26.3813 30.9378C26.4964 30.7386 26.5563 30.5124 26.5549 30.2825V19.0542L29.9213 20.998C29.9389 21.0068 29.9541 21.0198 29.9656 21.0359C29.977 21.052 29.9842 21.0707 29.9867 21.0902V30.3889C29.9842 32.375 29.1946 34.2791 27.7909 35.6841C26.3872 37.0892 24.4838 37.8806 22.4978 37.8849ZM6.39227 31.0064C5.51397 29.4888 5.19742 27.7107 5.49804 25.9832C5.55718 26.0187 5.66048 26.0818 5.73461 26.1244L13.699 30.7248C13.8975 30.8408 14.1233 30.902 14.3532 30.902C14.583 30.902 14.8088 30.8408 15.0073 30.7248L24.731 25.1103V28.9979C24.7321 29.0177 24.7283 29.0376 24.7199 29.0556C24.7115 29.0736 24.6988 29.0893 24.6829 29.1012L16.6317 33.7497C14.9096 34.7416 12.8643 35.0097 10.9447 34.4954C9.02506 33.9811 7.38785 32.7263 6.39227 31.0064ZM4.29707 13.6194C5.17156 12.0998 6.55279 10.9364 8.19885 10.3327C8.19885 10.4013 8.19491 10.5228 8.19491 10.6071V19.808C8.19351 20.0378 8.25334 20.2638 8.36823 20.4629C8.48312 20.6619 8.64893 20.8267 8.84863 20.9404L18.5723 26.5542L15.206 28.4979C15.1894 28.5089 15.1703 28.5155 15.1505 28.5173C15.1307 28.5191 15.1107 28.516 15.0924 28.5082L7.04046 23.8557C5.32135 22.8601 4.06716 21.2235 3.55289 19.3046C3.03862 17.3858 3.30624 15.3413 4.29707 13.6194ZM31.955 20.0556L22.2312 14.4411L25.5976 12.4981C25.6142 12.4872 25.6333 12.4805 25.6531 12.4787C25.6729 12.4769 25.6928 12.4801 25.7111 12.4879L33.7631 17.1364C34.9967 17.849 36.0017 18.8982 36.6606 20.1613C37.3194 21.4244 37.6047 22.849 37.4832 24.2684C37.3617 25.6878 36.8382 27.0432 35.9743 28.1759C35.1103 29.3086 33.9415 30.1717 32.6047 30.6641C32.6047 30.5947 32.6047 30.4733 32.6047 30.3889V21.188C32.6066 20.9586 32.5474 20.7328 32.4332 20.5338C32.319 20.3348 32.154 20.1698 31.955 20.0556ZM35.3055 15.0128C35.2464 14.9765 35.1431 14.9142 35.069 14.8717L27.1045 10.2712C26.906 10.1554 26.6803 10.0943 26.4504 10.0943C26.2206 10.0943 25.9948 10.1554 25.7963 10.2712L16.0726 15.8858V11.9982C16.0715 11.9783 16.0753 11.9585 16.0837 11.9405C16.0921 11.9225 16.1048 11.9068 16.1207 11.8949L24.1719 7.25025C25.4053 6.53903 26.8158 6.19376 28.2383 6.25482C29.6608 6.31589 31.0364 6.78077 32.2044 7.59508C33.3723 8.40939 34.2842 9.53945 34.8334 10.8531C35.3826 12.1667 35.5464 13.6095 35.3055 15.0128ZM14.2424 21.9419L10.8752 19.9981C10.8576 19.9893 10.8423 19.9763 10.8309 19.9602C10.8195 19.9441 10.8122 19.9254 10.8098 19.9058V10.6071C10.8107 9.18295 11.2173 7.78848 11.9819 6.58696C12.7466 5.38544 13.8377 4.42659 15.1275 3.82264C16.4173 3.21869 17.8524 2.99464 19.2649 3.1767C20.6775 3.35876 22.0089 3.93941 23.1034 4.85067C23.0427 4.88379 22.937 4.94215 22.8668 4.98473L14.9024 9.58517C14.7025 9.69878 14.5366 9.86356 14.4215 10.0626C14.3065 10.2616 14.2466 10.4877 14.2479 10.7175L14.2424 21.9419ZM16.071 17.9991L20.4018 15.4978L24.7325 17.9975V22.9985L20.4018 25.4983L16.071 22.9985V17.9991Z" fill="currentColor"></path></svg></div></div></div></div></div><div class="relative flex w-full flex-col agent-turn"><div class="font-semibold select-none">ChatGPT</div><div class="flex-col gap-1 md:gap-3"><div class="flex flex-grow flex-col max-w-full"><div data-message-author-role="assistant" data-message-id="103a5ed8-66ec-4d8d-b0e9-a3b9123436fa" class="min-h-[20px] text-message flex flex-col items-start gap-3 whitespace-pre-wrap break-words [.text-message+&amp;]:mt-5 overflow-x-auto"><div class="markdown prose w-full break-words dark:prose-invert light"><p>Sure, I can provide example source code snippets for each of the strategies mentioned to reduce database calls during validation in NestJS.</p><h3>1. Aggregate Validations into a Single Custom Validator</h3><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Injectable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ValidatorConstraint</span>, <span class="hljs-title class_">ValidatorConstraintInterface</span>, <span class="hljs-title class_">ValidationArguments</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'class-validator'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">RoomService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./room.service'</span>;

<span class="hljs-meta">@ValidatorConstraint</span>({ <span class="hljs-attr">async</span>: <span class="hljs-literal">true</span> })
<span class="hljs-meta">@Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RoomValidationConstraint</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ValidatorConstraintInterface</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> roomService: RoomService</span>) {}

    <span class="hljs-keyword">async</span> <span class="hljs-title function_">validate</span>(<span class="hljs-params">value: <span class="hljs-built_in">any</span>, args: ValidationArguments</span>) {
        <span class="hljs-keyword">const</span> room = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">roomService</span>.<span class="hljs-title function_">findOne</span>(args.<span class="hljs-property">object</span>[<span class="hljs-string">'id'</span>]);
        <span class="hljs-comment">// Add all your complex validation logic here using the room data</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// or false based on validation</span>
    }

    <span class="hljs-title function_">defaultMessage</span>(<span class="hljs-params">args: ValidationArguments</span>) {
        <span class="hljs-comment">// Default error message</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">'Validation failed'</span>;
    }
}
</code></div></div></pre><h3>2. Cache the Required Data</h3><p>This example assumes you have a caching mechanism like Redis in place:</p><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-meta">@Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RoomService</span> {
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">findOneWithCache</span>(<span class="hljs-params">roomId: <span class="hljs-built_in">number</span></span>) {
        <span class="hljs-keyword">let</span> room = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheManager</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">`room_<span class="hljs-subst">${roomId}</span>`</span>);
        <span class="hljs-keyword">if</span> (!room) {
            room = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">roomRepository</span>.<span class="hljs-title function_">findOne</span>(roomId);
            <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheManager</span>.<span class="hljs-title function_">set</span>(<span class="hljs-string">`room_<span class="hljs-subst">${roomId}</span>`</span>, room, { <span class="hljs-attr">ttl</span>: <span class="hljs-number">3600</span> });
        }
        <span class="hljs-keyword">return</span> room;
    }
}
</code></div></div></pre><h3>3. Optimize Your Database Queries</h3><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-meta">@Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RoomService</span> {
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">findOne</span>(<span class="hljs-params">roomId: <span class="hljs-built_in">number</span></span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">roomRepository</span>.<span class="hljs-title function_">findOne</span>(roomId, { 
            <span class="hljs-attr">select</span>: [<span class="hljs-string">'id'</span>, <span class="hljs-string">'accessLevel'</span>, <span class="hljs-string">'name'</span>] <span class="hljs-comment">// Only fetch necessary fields</span>
        });
    }
}
</code></div></div></pre><h3>4. Use Database Transactions</h3><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-meta">@Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RoomService</span> {
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">updateRoom</span>(<span class="hljs-params">roomId: <span class="hljs-built_in">number</span>, updateDto: UpdateRoomDto</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">connection</span>.<span class="hljs-title function_">transaction</span>(<span class="hljs-keyword">async</span> entityManager =&gt; {
            <span class="hljs-comment">// multiple database operations within a single transaction</span>
            <span class="hljs-keyword">await</span> entityManager.<span class="hljs-title function_">save</span>(<span class="hljs-title class_">Room</span>, updateDto);
            <span class="hljs-comment">// other operations...</span>
        });
    }
}
</code></div></div></pre><h3>5. Front-End Validation as a Preliminary Step</h3><p>Front-end validation is typically handled in your client-side code (JavaScript/TypeScript), ensuring that the data sent to the back-end is already validated as per basic rules.</p><h3>6. Service Layer Validation</h3><pre><div class="dark bg-gray-950 rounded-md"><div class="flex items-center relative text-token-text-secondary bg-token-main-surface-secondary px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>typescript</span><span class="" data-state="closed"><button class="flex gap-1 items-center"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-sm"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 4C10.8954 4 10 4.89543 10 6H14C14 4.89543 13.1046 4 12 4ZM8.53513 4C9.22675 2.8044 10.5194 2 12 2C13.4806 2 14.7733 2.8044 15.4649 4H17C18.6569 4 20 5.34315 20 7V19C20 20.6569 18.6569 22 17 22H7C5.34315 22 4 20.6569 4 19V7C4 5.34315 5.34315 4 7 4H8.53513ZM8 6H7C6.44772 6 6 6.44772 6 7V19C6 19.5523 6.44772 20 7 20H17C17.5523 20 18 19.5523 18 19V7C18 6.44772 17.5523 6 17 6H16C16 7.10457 15.1046 8 14 8H10C8.89543 8 8 7.10457 8 6Z" fill="currentColor"></path></svg>Copy code</button></span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-typescript"><span class="hljs-meta">@Injectable</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RoomService</span> {
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">validateAndUpdate</span>(<span class="hljs-params">roomId: <span class="hljs-built_in">number</span>, updateDto: UpdateRoomDto</span>) {
        <span class="hljs-keyword">const</span> room = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">findOne</span>(roomId);
        <span class="hljs-comment">// perform validation using room data</span>
        <span class="hljs-comment">// if validation passes, update the room</span>
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">roomRepository</span>.<span class="hljs-title function_">update</span>(roomId, updateDto);
    }
}
</code></div></div></pre><h3>7. Optimize Application Architecture</h3><p>Implementing a CQRS pattern often involves a significant restructuring of your application. It's not just a simple code snippet but rather a design approach where you separate the read operations (queries) from the write operations (commands).</p><p>For example, you could have two different models: one for reading data (e.g., DTOs for API responses) and another for writing data (e.g., Commands for creating/updating data). Each model would be handled by separate services or controllers, optimized for their specific use case.</p><p>Implementing these strategies will depend heavily on the specific context and needs of your application. Each approach has its own set of trade-offs and should be chosen based on the application's requirements and constraints.</p></div></div></div></div></div></div></div></div></div></div></div><div class="w-full pt-2 md:pt-0 dark:border-white/20 md:border-transparent md:dark:border-transparent md:w-[calc(100%-.5rem)]"><div class="relative flex w-full flex-1 items-center justify-center gap-2 pt-3 empty:hidden"><a class="flex items-center gap-2 rounded-xl bg-green-600 px-5 py-3.5 font-medium text-white transition hover:opacity-70 w-40 justify-center" href="https://chat.openai.com/gpts"><div>Upgrade to Plus to create your own <span class="font-bold">GPT</span></div></a></div><div class="relative px-2 py-2 text-center text-xs text-token-text-secondary md:px-[60px]"><div class="flex justify-center gap-3 text-token-text-tertiary"><button>Report content</button><span>|</span><a href="https://openai.com/policies/terms-of-use" target="_blank" rel="noreferrer">Terms of use</a><span>|</span><a href="https://openai.com/policies/privacy-policy" target="_blank" rel="noreferrer">Privacy policy</a><span>|</span></div></div></div></div><div class="group fixed bottom-3 right-3 z-10 hidden gap-1 lg:flex"><div class="group relative" data-headlessui-state=""><button class="flex items-center justify-center rounded-full border border-token-border-light text-token-text-secondary" id="headlessui-menu-button-:rp:" type="button" aria-haspopup="true" aria-expanded="false" data-headlessui-state=""><div class="flex h-6 w-6 items-center justify-center text-xs">?</div></button></div></div></main></div></div><div class="absolute left-0 right-0 top-0 z-[2]"></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="anonymous">{"props":{"pageProps":{"serverPrimedAllowBrowserStorageValue":true,"isStorageComplianceEnabled":false,"user":{"id":"user-DiQTGiGVFqze6dprFzmFn9HU","name":"Daniel Ogenrwot","email":"ogenrwot@unlv.nevada.edu","image":"https://lh3.googleusercontent.com/a/ACg8ocJs3eXuKK9Cvxw--rhfLSyMa7t75KLFfn8RZjuspp7ofw=s96-c","picture":"https://lh3.googleusercontent.com/a/ACg8ocJs3eXuKK9Cvxw--rhfLSyMa7t75KLFfn8RZjuspp7ofw=s96-c","idp":"google-oauth2","iat":1704763431,"mfa":false,"groups":[],"intercom_hash":"b1696c9b7c3e106e5e1562cebe511d91a2b7ecaada4affd27e426cd79ce86e2f"},"serviceStatus":{},"serviceAnnouncement":{"public":{},"paid":{}},"cfConnectingIp":"2600:8801:359a:b200:10b1:c381:2196:e960","statsig":{"payload":{"feature_gates":{"mC7arE5IsSMGuGv+JtQNn6PkLNjGMgnPGm4lNwCVcd4=":{"name":"mC7arE5IsSMGuGv+JtQNn6PkLNjGMgnPGm4lNwCVcd4=","value":false,"rule_id":"default","secondary_exposures":[{"gate":"segment:chatgpt_voice_team","gateValue":"false","ruleID":"default"}]},"4bxrZiqrvUhz7pNmrq7/hje8GGth3CK38a+UCoGT55w=":{"name":"4bxrZiqrvUhz7pNmrq7/hje8GGth3CK38a+UCoGT55w=","value":false,"rule_id":"6Usmt3Th0mkUkVQJ0oyeST:0.00:1","secondary_exposures":[]},"BwgqaCydMQQ3DfMuT3le70YG2UMR90ZQUizkz8s87Og=":{"name":"BwgqaCydMQQ3DfMuT3le70YG2UMR90ZQUizkz8s87Og=","value":false,"rule_id":"default","secondary_exposures":[{"gate":"segment:chatgpt_voice_team","gateValue":"false","ruleID":"default"}]},"sB09rxeNC0dm+q105n4ilqzJPvZ+fb8Adgn7dgHyAJs=":{"name":"sB09rxeNC0dm+q105n4ilqzJPvZ+fb8Adgn7dgHyAJs=","value":false,"rule_id":"default","secondary_exposures":[{"gate":"segment:chatgpt_voice_team","gateValue":"false","ruleID":"default"}]},"/sqBSo8CbSfm33mGuPq/xK+GiRwPnbT26mPKmQkikn4=":{"name":"/sqBSo8CbSfm33mGuPq/xK+GiRwPnbT26mPKmQkikn4=","value":false,"rule_id":"default","secondary_exposures":[]},"8YdWfy6BaXA6MDnlnTc17AwNRhxQ4rcfy5G+sYaHQ/A=":{"name":"8YdWfy6BaXA6MDnlnTc17AwNRhxQ4rcfy5G+sYaHQ/A=","value":false,"rule_id":"63qNN95X7P6VSHVff2nL76","secondary_exposures":[]},"9frMP2Uapo9+GZFF/eyDv3qypmVGR3bBx7kQxlUjFL0=":{"name":"9frMP2Uapo9+GZFF/eyDv3qypmVGR3bBx7kQxlUjFL0=","value":false,"rule_id":"4Cs7bnD6u8s4FIa2CdgJ7i","secondary_exposures":[]},"zP79mMrzyNTmUIk4BvnRSRf1QyskcWqpVbgx/DuBSlk=":{"name":"zP79mMrzyNTmUIk4BvnRSRf1QyskcWqpVbgx/DuBSlk=","value":false,"rule_id":"default","secondary_exposures":[]},"G4FKkwqOMLlLXCjFizXkc6Fbyds7IQgmeDgcOnlzXcc=":{"name":"G4FKkwqOMLlLXCjFizXkc6Fbyds7IQgmeDgcOnlzXcc=","value":false,"rule_id":"default","secondary_exposures":[]},"Ot01tCFiILXHbMzQliq1LFtcH9p484nys9JQ3jNBBSc=":{"name":"Ot01tCFiILXHbMzQliq1LFtcH9p484nys9JQ3jNBBSc=","value":false,"rule_id":"default","secondary_exposures":[{"gate":"segment:european_legal_restricted","gateValue":"false","ruleID":"default"}]},"ZB1N+sYIfld1iUD73LMNp+7PHtb5fjkv1Fqd9stCmhM=":{"name":"ZB1N+sYIfld1iUD73LMNp+7PHtb5fjkv1Fqd9stCmhM=","value":false,"rule_id":"default","secondary_exposures":[]},"AmHQM8fzcDgvtrUTWfKdHeeC+liSx6Ap3mIjS2v2T7k=":{"name":"AmHQM8fzcDgvtrUTWfKdHeeC+liSx6Ap3mIjS2v2T7k=","value":false,"rule_id":"1IdfApkb0f3RHjOg804mYI:5.00:5","secondary_exposures":[]},"v6yV8GS0zH+VdEey3WZ8OCkuXSPit1tWZ1w5XGJKgwU=":{"name":"v6yV8GS0zH+VdEey3WZ8OCkuXSPit1tWZ1w5XGJKgwU=","value":true,"rule_id":"VNBdYfNSNNUyDdMpaiaZ9:100.00:1","secondary_exposures":[]},"bZIChv8u2y59nAdcmf3Sxu+c4LOtTeRmbLn99GUUOrQ=":{"name":"bZIChv8u2y59nAdcmf3Sxu+c4LOtTeRmbLn99GUUOrQ=","value":false,"rule_id":"default","secondary_exposures":[{"gate":"segment:gizmo_store_team","gateValue":"false","ruleID":"default"},{"gate":"segment:memory_team","gateValue":"false","ruleID":"default"}]},"NFLu/8gcH3+m9yHiY/kPxE83zLFYMhk3cWVEq2zR+NM=":{"name":"NFLu/8gcH3+m9yHiY/kPxE83zLFYMhk3cWVEq2zR+NM=","value":false,"rule_id":"default","secondary_exposures":[{"gate":"segment:employees","gateValue":"false","ruleID":"default"}]},"XrhPGbeUzfIBQaHMWl4/GYZzdDnDMzHb96RYes5lw2w=":{"name":"XrhPGbeUzfIBQaHMWl4/GYZzdDnDMzHb96RYes5lw2w=","value":false,"rule_id":"default","secondary_exposures":[{"gate":"segment:employees","gateValue":"false","ruleID":"default"}]},"FEo7XK0f7Hn3U2RwSds2DTiEYNIpKCqrSVA2UP0BK2M=":{"name":"FEo7XK0f7Hn3U2RwSds2DTiEYNIpKCqrSVA2UP0BK2M=","value":true,"rule_id":"6sEu91zwlBGSKOqFiNpGlA:100.00:2","secondary_exposures":[{"gate":"segment:employees","gateValue":"false","ruleID":"default"},{"gate":"segment:enterprise","gateValue":"false","ruleID":"default"},{"gate":"segment:teams_plan","gateValue":"false","ruleID":"default"}]},"9WcM78XE5AQPxf3Yv9FxM5g14rV2Sk3HsGRha1mAnxc=":{"name":"9WcM78XE5AQPxf3Yv9FxM5g14rV2Sk3HsGRha1mAnxc=","value":false,"rule_id":"default","secondary_exposures":[{"gate":"segment:employees","gateValue":"false","ruleID":"default"}]},"+ZnfGOKTXqj/PUluVHtQHH4xXcWomraW0OeynJkthMA=":{"name":"+ZnfGOKTXqj/PUluVHtQHH4xXcWomraW0OeynJkthMA=","value":true,"rule_id":"2LpyNTIfbYC4R6XS6dfdIL","secondary_exposures":[{"gate":"segment:employees","gateValue":"false","ruleID":"default"}]},"a2qAmsyD94P0/7pZ6SpRYRKL9Odkp+5z2KgEZEYvsJg=":{"name":"a2qAmsyD94P0/7pZ6SpRYRKL9Odkp+5z2KgEZEYvsJg=","value":false,"rule_id":"default","secondary_exposures":[]}},"dynamic_configs":{"krxquX5lr9NsWYuE6AxcgDMKBdc3hX7WV56L3qm2h+k=":{"name":"krxquX5lr9NsWYuE6AxcgDMKBdc3hX7WV56L3qm2h+k=","value":{},"group":"default","rule_id":"default","is_device_based":false,"secondary_exposures":[{"gate":"segment:employees","gateValue":"false","ruleID":"default"},{"gate":"chatgpt-browse-sahara","gateValue":"false","ruleID":"default"}]},"Xxhhbjq3NEImgVIfGzx+Ubl6ebJS1kwRjV/2YlHJ3Zs=":{"name":"Xxhhbjq3NEImgVIfGzx+Ubl6ebJS1kwRjV/2YlHJ3Zs=","value":{"google.com":["google.com","googleapis.com","www.googleapis.com","oauth2.googleapis.com"],"microsoftonline.com":["microsoft.com","microsoftonline.com"],"adobelogin.com":["adobe.com","adobelogin.com"],"useflorian.com":["useflorian.com","convex.site"],"yahoo.com":["yahooapis.com","yahoo.com"],"app.vssps.visualstudio.com":["app.vssps.visualstudio.com","dev.azure.com"]},"group":"default","rule_id":"default","is_device_based":true,"secondary_exposures":[]},"LH4aXUWdAthHnhoeezgqr9XUAj+EyFN9/INZTPgB8Rw=":{"name":"LH4aXUWdAthHnhoeezgqr9XUAj+EyFN9/INZTPgB8Rw=","value":{},"group":"prestart","rule_id":"prestart","is_device_based":false,"secondary_exposures":[],"is_user_in_experiment":false,"is_experiment_active":false},"/NA6RKoyvTPtJS+65jbxYPRbn4zCKaPi28t+RGlIi74=":{"name":"/NA6RKoyvTPtJS+65jbxYPRbn4zCKaPi28t+RGlIi74=","value":{},"group":"prestart","rule_id":"prestart","is_device_based":false,"secondary_exposures":[],"is_user_in_experiment":false,"is_experiment_active":false},"d88zqiv5tj+jTJIQj6D5/mZRDEaFP6YEIqcwlz6Nh+8=":{"name":"d88zqiv5tj+jTJIQj6D5/mZRDEaFP6YEIqcwlz6Nh+8=","value":{},"group":"targetingGate","rule_id":"targetingGate","is_device_based":false,"secondary_exposures":[{"gate":"targeting-aa-web-240206","gateValue":"false","ruleID":"63qNN95X7P6VSHVff2nL76"}],"is_user_in_experiment":false,"is_experiment_active":true},"hxxW3hikZ7rigchg97AizJTpHbpMCwkwvbZd7t9sblc=":{"name":"hxxW3hikZ7rigchg97AizJTpHbpMCwkwvbZd7t9sblc=","value":{},"group":"targetingGate","rule_id":"targetingGate","is_device_based":false,"secondary_exposures":[{"gate":"targeting-aa-web-anon-240206","gateValue":"false","ruleID":"4Cs7bnD6u8s4FIa2CdgJ7i"}],"is_user_in_experiment":false,"is_experiment_active":true},"2gcgWHw6EUQ7WzuausBVbg88/jglfC1LmtqhBF35u2c=":{"name":"2gcgWHw6EUQ7WzuausBVbg88/jglfC1LmtqhBF35u2c=","value":{"show_new_ui":true},"group":"launchedGroup","rule_id":"launchedGroup","is_device_based":false,"secondary_exposures":[],"is_user_in_experiment":false,"is_experiment_active":false}},"layer_configs":{},"sdkParams":{},"has_updates":true,"generator":"statsig-node-sdk","time":0,"evaluated_keys":{"userID":"user-DiQTGiGVFqze6dprFzmFn9HU","customIDs":{"WebAnonymousCookieID":"d05bbaf3-27d4-4fc2-bdd4-5faafc9a8093","DeviceId":"d05bbaf3-27d4-4fc2-bdd4-5faafc9a8093","stableID":"d05bbaf3-27d4-4fc2-bdd4-5faafc9a8093"}},"hash_used":"sha256","user_hash":"2623322862"},"user":{"country":"US","custom":{"auth_status":"logged_in","is_paid":false},"customIDs":{"WebAnonymousCookieID":"d05bbaf3-27d4-4fc2-bdd4-5faafc9a8093","DeviceId":"d05bbaf3-27d4-4fc2-bdd4-5faafc9a8093","stableID":"d05bbaf3-27d4-4fc2-bdd4-5faafc9a8093"},"ip":"2600:8801:359a:b200:10b1:c381:2196:e960","locale":"en-US","privateAttributes":{"email":"ogenrwot@unlv.nevada.edu"},"userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36","userID":"user-DiQTGiGVFqze6dprFzmFn9HU"}},"showCookieConsentBanner":false,"ageVerificationDeadline":null,"ageVerificationType":"none","logOutUser":false,"sharedConversationId":"3b9e682b-9adb-464c-b749-e6aea774829d","serverResponse":{"type":"data","data":{"title":"Nest.js Conditional DTO Validation","create_time":1703482783.603658,"update_time":1703482786,"mapping":{"103a5ed8-66ec-4d8d-b0e9-a3b9123436fa":{"id":"103a5ed8-66ec-4d8d-b0e9-a3b9123436fa","message":{"id":"103a5ed8-66ec-4d8d-b0e9-a3b9123436fa","author":{"role":"assistant","metadata":{}},"create_time":1703482766.24832,"content":{"content_type":"text","parts":["Sure, I can provide example source code snippets for each of the strategies mentioned to reduce database calls during validation in NestJS.\n\n### 1. Aggregate Validations into a Single Custom Validator\n\n```typescript\nimport { Injectable } from '@nestjs/common';\nimport { ValidatorConstraint, ValidatorConstraintInterface, ValidationArguments } from 'class-validator';\nimport { RoomService } from './room.service';\n\n@ValidatorConstraint({ async: true })\n@Injectable()\nexport class RoomValidationConstraint implements ValidatorConstraintInterface {\n    constructor(private roomService: RoomService) {}\n\n    async validate(value: any, args: ValidationArguments) {\n        const room = await this.roomService.findOne(args.object['id']);\n        // Add all your complex validation logic here using the room data\n        return true; // or false based on validation\n    }\n\n    defaultMessage(args: ValidationArguments) {\n        // Default error message\n        return 'Validation failed';\n    }\n}\n```\n\n### 2. Cache the Required Data\n\nThis example assumes you have a caching mechanism like Redis in place:\n\n```typescript\n@Injectable()\nexport class RoomService {\n    async findOneWithCache(roomId: number) {\n        let room = await this.cacheManager.get(`room_${roomId}`);\n        if (!room) {\n            room = await this.roomRepository.findOne(roomId);\n            await this.cacheManager.set(`room_${roomId}`, room, { ttl: 3600 });\n        }\n        return room;\n    }\n}\n```\n\n### 3. Optimize Your Database Queries\n\n```typescript\n@Injectable()\nexport class RoomService {\n    async findOne(roomId: number) {\n        return this.roomRepository.findOne(roomId, { \n            select: ['id', 'accessLevel', 'name'] // Only fetch necessary fields\n        });\n    }\n}\n```\n\n### 4. Use Database Transactions\n\n```typescript\n@Injectable()\nexport class RoomService {\n    async updateRoom(roomId: number, updateDto: UpdateRoomDto) {\n        return this.connection.transaction(async entityManager =\u003e {\n            // multiple database operations within a single transaction\n            await entityManager.save(Room, updateDto);\n            // other operations...\n        });\n    }\n}\n```\n\n### 5. Front-End Validation as a Preliminary Step\n\nFront-end validation is typically handled in your client-side code (JavaScript/TypeScript), ensuring that the data sent to the back-end is already validated as per basic rules.\n\n### 6. Service Layer Validation\n\n```typescript\n@Injectable()\nexport class RoomService {\n    async validateAndUpdate(roomId: number, updateDto: UpdateRoomDto) {\n        const room = await this.findOne(roomId);\n        // perform validation using room data\n        // if validation passes, update the room\n        return this.roomRepository.update(roomId, updateDto);\n    }\n}\n```\n\n### 7. Optimize Application Architecture\n\nImplementing a CQRS pattern often involves a significant restructuring of your application. It's not just a simple code snippet but rather a design approach where you separate the read operations (queries) from the write operations (commands).\n\nFor example, you could have two different models: one for reading data (e.g., DTOs for API responses) and another for writing data (e.g., Commands for creating/updating data). Each model would be handled by separate services or controllers, optimized for their specific use case.\n\nImplementing these strategies will depend heavily on the specific context and needs of your application. Each approach has its own set of trade-offs and should be chosen based on the application's requirements and constraints."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa21ec1-1afe-4091-ac4b-f798ade556fd","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"aaa21ec1-1afe-4091-ac4b-f798ade556fd","children":[]},"aaa21ec1-1afe-4091-ac4b-f798ade556fd":{"id":"aaa21ec1-1afe-4091-ac4b-f798ade556fd","message":{"id":"aaa21ec1-1afe-4091-ac4b-f798ade556fd","author":{"role":"user","metadata":{}},"create_time":1703482712.166885,"content":{"content_type":"text","parts":["can you provide an example source code for each case?"]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"e53a760d-6e97-4f88-b80e-9af86a2210dc","children":["103a5ed8-66ec-4d8d-b0e9-a3b9123436fa"]},"e53a760d-6e97-4f88-b80e-9af86a2210dc":{"id":"e53a760d-6e97-4f88-b80e-9af86a2210dc","message":{"id":"e53a760d-6e97-4f88-b80e-9af86a2210dc","author":{"role":"assistant","metadata":{}},"create_time":1703482684.764403,"content":{"content_type":"text","parts":["Reducing database calls when performing multiple validations in NestJS, especially when dealing with complex conditional validations, is crucial for optimizing performance. Here are several strategies to minimize database interactions:\n\n### 1. **Aggregate Validations into a Single Custom Validator**\n\nInstead of having multiple custom validators each making their own database calls, you can create a single, more comprehensive validator that handles all the necessary logic. This validator can make a single database call to retrieve all the required information and then perform all validations.\n\nFor example, if you have multiple validations that depend on the current state of a `Room`, you can fetch the `Room` once and then perform all the validations against this fetched data.\n\n### 2. **Cache the Required Data**\n\nIf the data required for validation is relatively static or doesn't change frequently, you can cache it. This way, you can avoid repetitive database calls for data that hasn’t changed.\n\nYou can implement caching at the service level or use a dedicated caching mechanism like Redis. The cache can store the fetched data for a predetermined amount of time, and subsequent validation requests can first check the cache before querying the database.\n\n### 3. **Optimize Your Database Queries**\n\nEnsure that your database queries are optimized and fetch only the necessary data. Sometimes, using projections to select only specific fields or using efficient query methods can significantly reduce the load and improve performance.\n\n### 4. **Use Database Transactions**\n\nIf you are performing multiple update operations that each require validation, consider using database transactions. This way, you can group multiple operations into a single transaction. Although this doesn't reduce the number of validation checks, it can optimize the update operations and ensure data consistency.\n\n### 5. **Front-End Validation as a Preliminary Step**\n\nWhile front-end validation is not a substitute for back-end validation, it can reduce unnecessary requests to the server. By validating input on the client side first, you can catch many common errors before they even reach your back-end.\n\n### 6. **Service Layer Validation**\n\nPerform validation at the service layer where you can control the flow of operations more granularly. This allows you to make a single call to the database to retrieve all necessary information and then pass this data to various validation functions as needed.\n\n### 7. **Optimize Application Architecture**\n\nSometimes the solution lies in optimizing the overall application architecture. For instance, using a CQRS pattern (Command Query Responsibility Segregation) can separate read and write operations, allowing for more efficient handling of data and reducing unnecessary database interactions.\n\nImplementing these strategies requires a balance between maintaining data integrity and optimizing performance. The best approach depends on the specific requirements and constraints of your application."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa2617c-c30f-407b-a203-78064781d8cd","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"aaa2617c-c30f-407b-a203-78064781d8cd","children":["aaa21ec1-1afe-4091-ac4b-f798ade556fd"]},"aaa2617c-c30f-407b-a203-78064781d8cd":{"id":"aaa2617c-c30f-407b-a203-78064781d8cd","message":{"id":"aaa2617c-c30f-407b-a203-78064781d8cd","author":{"role":"user","metadata":{}},"create_time":1703482652.598723,"content":{"content_type":"text","parts":["When there are multiple validations like this, how to reduce the DB calls?"]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"af5a3730-98f1-4780-bfff-c5705fdf777c","children":["e53a760d-6e97-4f88-b80e-9af86a2210dc"]},"af5a3730-98f1-4780-bfff-c5705fdf777c":{"id":"af5a3730-98f1-4780-bfff-c5705fdf777c","message":{"id":"af5a3730-98f1-4780-bfff-c5705fdf777c","author":{"role":"assistant","metadata":{}},"create_time":1703482308.312524,"content":{"content_type":"text","parts":["You're right. The validation logic needs to accommodate the scenario where the room's `accessLevel` is already set to `\"PROTECTED\"` and you want to update the `password`. For this, we need to adjust the validation logic to consider the current state of the room's access level in the database.\n\nSince DTOs in NestJS are typically stateless and do not have access to the database or the current state of the entity, you need a way to incorporate this state into your validation logic. This can be achieved by using a custom validation class that has access to the necessary services to fetch the current state from the database.\n\nHere's an example of how you can modify the `PasswordConditionalValidator` to include a service that fetches the current state of the room:\n\n1. **Modify the PasswordConditionalValidator**:\n\n   Modify the `PasswordConditionalValidator` to include a service that can fetch the current state of the room from the database. This service can be injected into the validator.\n\n    ```typescript\n    import { Injectable } from '@nestjs/common';\n    import { ValidatorConstraint, ValidatorConstraintInterface, ValidationArguments } from 'class-validator';\n    import { RoomService } from './room.service'; // Import your Room service\n\n    @ValidatorConstraint({ async: true })\n    @Injectable()\n    export class PasswordConditionalValidator implements ValidatorConstraintInterface {\n      constructor(private roomService: RoomService) {}\n\n      async validate(password: string, args: ValidationArguments) {\n        const roomDto = args.object as UpdateRoomDto;\n        const roomId = roomDto.id; // Assume you have the room's ID in the DTO\n\n        if (!roomId) {\n          return true; // If no room ID is provided, skip the check (or handle as needed)\n        }\n\n        const room = await this.roomService.findOne(roomId); // Fetch the current room state\n\n        if (room.accessLevel === 'PROTECTED' \u0026\u0026 !password) {\n          return false; // Fail validation if accessLevel is PROTECTED and no password is provided\n        }\n\n        if (room.accessLevel !== 'PROTECTED' \u0026\u0026 password) {\n          return false; // Fail validation if accessLevel is not PROTECTED and password is provided\n        }\n\n        return true; // Pass validation in all other cases\n      }\n\n      defaultMessage(args: ValidationArguments) {\n        return `Password is ${args.value ? 'not allowed' : 'required'} when access level is ${args.object['accessLevel']}`;\n      }\n    }\n    ```\n\n2. **Register the Custom Validator as a Provider**:\n\n   Since the custom validator now has a dependency (the `RoomService`), you need to register it as a provider in your module.\n\n    ```typescript\n    import { Module } from '@nestjs/common';\n    import { APP_PIPE } from '@nestjs/core';\n    import { PasswordConditionalValidator } from './password-conditional.validator';\n\n    @Module({\n      // ... other module settings\n      providers: [\n        PasswordConditionalValidator,\n        // ... other providers\n      ],\n    })\n    export class YourModule {}\n    ```\n\n3. **Usage in UpdateRoomDto**:\n\n   The usage in `UpdateRoomDto` remains the same, but ensure that you provide the necessary room ID or other identifiers needed for the validator to fetch the current room state.\n\n    ```typescript\n    // UpdateRoomDto remains the same as before\n    ```\n\nThis approach allows you to use the current state of the entity in your validation logic, enabling more complex scenarios like the one you described. Make sure your services and modules are set up correctly to support dependency injection into the custom validator."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa2e8a4-7ddd-4f91-817c-d92f6b2e6912","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"aaa2e8a4-7ddd-4f91-817c-d92f6b2e6912","children":["aaa2617c-c30f-407b-a203-78064781d8cd"]},"aaa2e8a4-7ddd-4f91-817c-d92f6b2e6912":{"id":"aaa2e8a4-7ddd-4f91-817c-d92f6b2e6912","message":{"id":"aaa2e8a4-7ddd-4f91-817c-d92f6b2e6912","author":{"role":"user","metadata":{}},"create_time":1703482268.283456,"content":{"content_type":"text","parts":["The problem with this approach is when room's access level is already \"PROTECTED\", this doesn't allow update of password, which it should"]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"12b9d84a-60de-4ae5-be06-79a4d209f317","children":["af5a3730-98f1-4780-bfff-c5705fdf777c"]},"12b9d84a-60de-4ae5-be06-79a4d209f317":{"id":"12b9d84a-60de-4ae5-be06-79a4d209f317","message":{"id":"12b9d84a-60de-4ae5-be06-79a4d209f317","author":{"role":"assistant","metadata":{}},"create_time":1703481278.035425,"content":{"content_type":"text","parts":["Certainly! Let's integrate the `PasswordConditionalValidator` into the `UpdateRoomDto`. This custom validator will ensure that a password is provided if the `accessLevel` is set to `'PROTECTED'` and reject the password if the `accessLevel` is not `'PROTECTED'`.\n\n### PasswordConditionalValidator\n\nFirst, here's a reminder of what the `PasswordConditionalValidator` looks like:\n\n```typescript\nimport { ValidatorConstraint, ValidatorConstraintInterface, ValidationArguments, Validate } from 'class-validator';\n\n@ValidatorConstraint({ name: 'passwordConditional', async: false })\nexport class PasswordConditionalValidator implements ValidatorConstraintInterface {\n  validate(password: string | undefined, args: ValidationArguments) {\n    const object = args.object as UpdateRoomDto; // Now using UpdateRoomDto\n    if (object.accessLevel === 'PROTECTED' \u0026\u0026 !password) {\n      return false; // Fail validation if accessLevel is PROTECTED and password is not provided\n    }\n    if (object.accessLevel !== 'PROTECTED' \u0026\u0026 password) {\n      return false; // Fail validation if accessLevel is not PROTECTED and password is provided\n    }\n    return true; // Pass validation in all other cases\n  }\n\n  defaultMessage(args: ValidationArguments) {\n    return `Password is ${args.value ? 'not allowed' : 'required'} when access level is ${args.object['accessLevel']}`;\n  }\n}\n```\n\n### UpdateRoomDto with PasswordConditionalValidator\n\nNow, let's integrate this validator into the `UpdateRoomDto`:\n\n```typescript\nimport { IsString, IsOptional, Validate } from 'class-validator';\n\nexport class UpdateRoomDto {\n  @IsOptional()\n  @IsString()\n  name?: string;\n\n  @IsOptional()\n  @IsString()\n  accessLevel?: 'PUBLIC' | 'PRIVATE' | 'PROTECTED';\n\n  @IsOptional()\n  @IsString()\n  @Validate(PasswordConditionalValidator)\n  password?: string;\n}\n```\n\nIn this `UpdateRoomDto`, both `accessLevel` and `password` are optional fields. The `PasswordConditionalValidator` is applied to the `password` field to enforce the conditional logic:\n\n- If `accessLevel` is `'PROTECTED'`, a `password` must be provided, and it must be a string.\n- If `accessLevel` is anything other than `'PROTECTED'`, the `password` must not be provided.\n- If `accessLevel` is not provided at all, the `password` field is ignored since it's marked as optional.\n\n### Usage in Application\n\nWhen using this DTO for update operations, it's important to handle partial updates correctly. Typically, you should fetch the existing data from the database and compare it with the incoming DTO to apply the validation rules effectively.\n\nThis approach allows you to maintain robust validation rules that are specific to the update operation, ensuring the integrity of your data while accommodating the flexible nature of update requests."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa238be-7e18-4c4e-b13a-2a7c9d4e4a3b","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"aaa238be-7e18-4c4e-b13a-2a7c9d4e4a3b","children":["aaa2e8a4-7ddd-4f91-817c-d92f6b2e6912"]},"aaa238be-7e18-4c4e-b13a-2a7c9d4e4a3b":{"id":"aaa238be-7e18-4c4e-b13a-2a7c9d4e4a3b","message":{"id":"aaa238be-7e18-4c4e-b13a-2a7c9d4e4a3b","author":{"role":"user","metadata":{}},"create_time":1703481245.417429,"content":{"content_type":"text","parts":["Add PasswordConditionalValidator to updateRoomDto"]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"dcfaddbb-a32d-4f75-a371-144f0edbfd05","children":["12b9d84a-60de-4ae5-be06-79a4d209f317"]},"dcfaddbb-a32d-4f75-a371-144f0edbfd05":{"id":"dcfaddbb-a32d-4f75-a371-144f0edbfd05","message":{"id":"dcfaddbb-a32d-4f75-a371-144f0edbfd05","author":{"role":"assistant","metadata":{}},"create_time":1703480660.9539,"content":{"content_type":"text","parts":["Certainly! When dealing with an update operation in NestJS, especially when certain fields become optional and require conditional validation, using a separate DTO can be very effective. Let's create an `UpdateRoomDto` based on your `CreateRoomDto` scenario, where `accessLevel` and `password` are optional during an update, but still need to be validated conditionally.\n\n### Base CreateRoomDto\n\nFirst, here's your `CreateRoomDto` for reference:\n\n```typescript\nimport { IsString, IsNotEmpty, ValidateIf } from 'class-validator';\n\nexport class CreateRoomDto {\n  @IsString()\n  @IsNotEmpty()\n  name: string;\n\n  @IsString()\n  @IsNotEmpty()\n  accessLevel: 'PUBLIC' | 'PRIVATE' | 'PROTECTED';\n\n  @ValidateIf((o) =\u003e o.accessLevel === 'PROTECTED')\n  @IsString()\n  password?: string;\n}\n```\n\n### UpdateRoomDto\n\nNow, let's create an `UpdateRoomDto`. In this DTO, both `accessLevel` and `password` are optional. We'll add conditional validation to ensure that if `accessLevel` is set to `'PROTECTED'`, a `password` must also be provided.\n\n```typescript\nimport { IsString, IsOptional, ValidateIf } from 'class-validator';\n\nexport class UpdateRoomDto {\n  @IsOptional()\n  @IsString()\n  name?: string;\n\n  @IsOptional()\n  @IsString()\n  accessLevel?: 'PUBLIC' | 'PRIVATE' | 'PROTECTED';\n\n  @IsOptional()\n  @IsString()\n  @ValidateIf((o) =\u003e o.accessLevel === 'PROTECTED')\n  password?: string;\n}\n```\n\nIn `UpdateRoomDto`, both `name` and `accessLevel` are marked as optional. The password field is also optional but has a conditional validator. The `@ValidateIf` decorator ensures that `password` is validated only if `accessLevel` is set to `'PROTECTED'`.\n\n### Handling Partial Updates\n\nWhen updating, you often deal with partial updates, where not all fields are provided. In such cases, it's important to merge the existing data with the new data before validation. This ensures that the validation logic takes into account the full context of the data, including both existing and new values.\n\n### Usage in a Service or Controller\n\nWhen using this DTO in your service or controller, you'll typically fetch the existing data from your database, merge it with the incoming update data, and then perform validation on the merged object. This approach ensures that your validation logic correctly handles partial updates.\n\n### Conclusion\n\nThis setup allows you to have different validation rules for creation and updating operations, which is a common requirement in many applications. The use of separate DTOs helps in maintaining clear separation of concerns and makes your codebase more maintainable and understandable."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa2cd63-819a-444a-a7b1-c1857916edbf","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"aaa2cd63-819a-444a-a7b1-c1857916edbf","children":["aaa238be-7e18-4c4e-b13a-2a7c9d4e4a3b"]},"aaa2cd63-819a-444a-a7b1-c1857916edbf":{"id":"aaa2cd63-819a-444a-a7b1-c1857916edbf","message":{"id":"aaa2cd63-819a-444a-a7b1-c1857916edbf","author":{"role":"user","metadata":{}},"create_time":1703480641.069343,"content":{"content_type":"text","parts":["can you give an example of separate DTO? Since accessLevel and password are option when updating, I'm not sure how to validate it"]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"665ec06c-e0c2-420e-b5d9-8b018ecae498","children":["dcfaddbb-a32d-4f75-a371-144f0edbfd05"]},"665ec06c-e0c2-420e-b5d9-8b018ecae498":{"id":"665ec06c-e0c2-420e-b5d9-8b018ecae498","message":{"id":"665ec06c-e0c2-420e-b5d9-8b018ecae498","author":{"role":"assistant","metadata":{}},"create_time":1703480568.049924,"content":{"content_type":"text","parts":["When updating data in NestJS, especially when using Data Transfer Objects (DTOs), you might encounter different validation requirements compared to creating new data. For instance, certain fields might be optional during an update but required during creation. To handle this, you can use a separate DTO for updates or modify your validation logic to accommodate update scenarios.\n\nHere are two common approaches:\n\n### 1. Using a Separate Update DTO\n\nYou can create a separate DTO for update operations. This Update DTO may have more optional fields compared to the Create DTO, reflecting the fact that not all fields need to be provided during an update.\n\n```typescript\nimport { PartialType } from '@nestjs/mapped-types';\n\nexport class UpdateRoomDto extends PartialType(CreateRoomDto) {\n    // Additional fields or overrides for update-specific logic can be added here\n}\n```\n\nIn this `UpdateRoomDto`, fields from `CreateRoomDto` are made optional using `PartialType`. This is a NestJS utility that automatically sets all fields of a class to optional.\n\n### 2. Adjusting Validation in the Existing DTO\n\nAlternatively, you can adjust the validation logic within your existing DTO to account for updates. This might involve using additional decorators or custom validation logic to distinguish between creation and update scenarios.\n\nFor example, you might add a flag to your DTO that indicates whether it's being used for creation or updating:\n\n```typescript\nexport class RoomDto {\n    @IsDefined({ groups: ['create'] })\n    @IsOptional({ groups: ['update'] })\n    name: string;\n\n    // ... other fields and validations\n\n    // Custom validation logic for password\n    @Validate(PasswordConditionalValidator, { groups: ['create', 'update'] })\n    password?: string;\n}\n```\n\nHere, the `groups` option in the decorators is used to apply different validation rules based on the context ('create' or 'update'). When you validate this DTO, you specify the group:\n\n```typescript\n// For creation\nawait validate(dto, { groups: ['create'] });\n\n// For updating\nawait validate(dto, { groups: ['update'] });\n```\n\n### Choosing the Right Approach\n\nThe choice between these two approaches depends on your specific use case:\n\n- If the validation logic for creating and updating is significantly different, using separate DTOs can keep your code cleaner and more understandable.\n- If the differences are minor, adjusting the validation logic within the same DTO may be more efficient and easier to maintain.\n\nIn both cases, it's important to carefully consider the validation requirements for each field in the context of both creation and updating, ensuring that your API remains consistent and secure."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa2ecb4-ccb2-431a-b4e9-145f33a5feb3","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"aaa2ecb4-ccb2-431a-b4e9-145f33a5feb3","children":["aaa2cd63-819a-444a-a7b1-c1857916edbf"]},"aaa2ecb4-ccb2-431a-b4e9-145f33a5feb3":{"id":"aaa2ecb4-ccb2-431a-b4e9-145f33a5feb3","message":{"id":"aaa2ecb4-ccb2-431a-b4e9-145f33a5feb3","author":{"role":"user","metadata":{}},"create_time":1703480544.369137,"content":{"content_type":"text","parts":["How about when updating?"]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"40f666c6-d848-4bc1-8ce4-d7407c40b2eb","children":["665ec06c-e0c2-420e-b5d9-8b018ecae498"]},"40f666c6-d848-4bc1-8ce4-d7407c40b2eb":{"id":"40f666c6-d848-4bc1-8ce4-d7407c40b2eb","message":{"id":"40f666c6-d848-4bc1-8ce4-d7407c40b2eb","author":{"role":"assistant","metadata":{}},"create_time":1703480311.456641,"content":{"content_type":"text","parts":["Yes, you can achieve your validation requirement by defining a custom validator in NestJS using `class-validator`. This approach is well-suited for more complex validation logic that isn't directly achievable through the standard decorators. Here's how you can do it:\n\n1. **Define a Custom Validation Class**: You'll need to create a custom validation class that implements the `ValidatorConstraintInterface`. This class will contain the logic for your conditional validation.\n\n2. **Register the Custom Validator**: Use the `@ValidatorConstraint` decorator to register your custom validation class.\n\n3. **Use the Custom Validator in your DTO**: Apply your custom validator to the relevant field in your DTO using the `@Validate` decorator.\n\nHere's an example of how you might implement this for your `CreateRoomDto`:\n\n```typescript\nimport { ValidatorConstraint, ValidatorConstraintInterface, ValidationArguments, Validate } from 'class-validator';\n\n@ValidatorConstraint({ name: 'passwordConditional', async: false })\nexport class PasswordConditionalValidator implements ValidatorConstraintInterface {\n  validate(password: string | undefined, args: ValidationArguments) {\n    const object = args.object as CreateRoomDto;\n    if (object.accessLevel === 'PROTECTED' \u0026\u0026 !password) {\n      return false; // Fail validation if accessLevel is PROTECTED and password is not provided\n    }\n    if (object.accessLevel !== 'PROTECTED' \u0026\u0026 password) {\n      return false; // Fail validation if accessLevel is not PROTECTED and password is provided\n    }\n    return true; // Pass validation in all other cases\n  }\n\n  defaultMessage(args: ValidationArguments) {\n    return `Password is ${args.value ? 'not allowed' : 'required'} when access level is ${args.object['accessLevel']}`;\n  }\n}\n\nexport class CreateRoomDto {\n  @IsString()\n  @IsNotEmpty()\n  name: string;\n\n  @IsString()\n  @IsNotEmpty()\n  accessLevel: 'PUBLIC' | 'PRIVATE' | 'PROTECTED';\n\n  @Validate(PasswordConditionalValidator)\n  password?: string;\n}\n```\n\nIn this example:\n- The `PasswordConditionalValidator` class defines the custom logic for validating the `password` field based on the `accessLevel`.\n- The `@ValidatorConstraint` decorator registers this class as a custom validator.\n- The `validate` method contains the conditional logic, and the `defaultMessage` method provides a custom error message.\n- The `CreateRoomDto` uses the `@Validate` decorator to apply this custom validation to the `password` field.\n\nThis approach allows you to encapsulate complex validation logic in a reusable and testable format, making your DTOs cleaner and more maintainable."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa28eab-e061-443d-b65c-633006394439","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"aaa28eab-e061-443d-b65c-633006394439","children":["aaa2ecb4-ccb2-431a-b4e9-145f33a5feb3"]},"aaa28eab-e061-443d-b65c-633006394439":{"id":"aaa28eab-e061-443d-b65c-633006394439","message":{"id":"aaa28eab-e061-443d-b65c-633006394439","author":{"role":"user","metadata":{}},"create_time":1703480282.937129,"content":{"content_type":"text","parts":["Can we do it by defining a custom validator?"]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"7bc77edd-f6ab-457e-9664-a09a0d5c5b80","children":["40f666c6-d848-4bc1-8ce4-d7407c40b2eb"]},"7bc77edd-f6ab-457e-9664-a09a0d5c5b80":{"id":"7bc77edd-f6ab-457e-9664-a09a0d5c5b80","message":{"id":"7bc77edd-f6ab-457e-9664-a09a0d5c5b80","author":{"role":"assistant","metadata":{}},"create_time":1703480183.410437,"content":{"content_type":"text","parts":["I wasn't able to find a specific documentation reference that describes the use of a function in a DTO class for custom validation in NestJS with class-validator. The official class-validator documentation and NestJS documentation primarily focus on using decorators for validation rules.\n\nHowever, based on the principles of class-validator and NestJS, custom validation logic can be implemented in various ways, including custom decorators or custom validation classes. The approach I suggested earlier aligns with the extensibility and customization options provided by these libraries, but it might not be explicitly documented in this exact form.\n\nFor detailed information and official documentation, you may want to refer to the following resources:\n1. [NestJS Techniques - Validation](https://docs.nestjs.com/techniques/validation): This section in the NestJS documentation provides information on how to use class-validator and class-transformer for validation in NestJS.\n2. [class-validator GitHub Repository](https://github.com/typestack/class-validator): The GitHub repository of class-validator might have examples and issues that discuss various ways to implement custom validation logic.\n3. [class-validator Documentation](https://github.com/typestack/class-validator#readme): This provides detailed information about decorators and how to create custom validation decorators.\n\nIf you have a specific implementation in mind, you might also consider seeking assistance from the NestJS community or on platforms like Stack Overflow, where you can find discussions and solutions for custom validation scenarios in NestJS."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"7de6f89c-d331-4865-b726-ad1847f2d9b4","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"7de6f89c-d331-4865-b726-ad1847f2d9b4","children":["aaa28eab-e061-443d-b65c-633006394439"]},"7de6f89c-d331-4865-b726-ad1847f2d9b4":{"id":"7de6f89c-d331-4865-b726-ad1847f2d9b4","message":{"id":"7de6f89c-d331-4865-b726-ad1847f2d9b4","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.395778,"content":{"content_type":"tether_browsing_display","result":"L0: \nL1: URL: https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1\nL2: \nL3: \nL4: [Image 0: prisma_logo]\nL5: \nL6: Products \nL7: \nL8: #### Prisma ORM\nL9: \nL10: 【0†Client Write Queries the way you think】【1†Migrate Generate customizable SQL migrations】\nL11: \nL12: #### Prisma Data Platform\nL13: \nL14: 【2†Accelerate Query up to 1000x faster】【3†Pulse Early Access Real-time database events】\nL15: \nL16: 【4†Pricing】\nL17: \nL18: Resources\nL19: \nL20: 【5†Documentation】【6†Get started】【7†Tutorials】【8†Examples†github.com】【9†Prisma in your stack】【10†Ecosystem】【11†Customer stories】【12†Data guide】\nL21: \nL22: 【13†Playground†playground.prisma.io】\nL23: \nL24: 【14†Blog】\nL25: \nL26: 【15†Login†console.prisma.io】【6†Get started】\nL27: \nL28: July 19, 2022 \nL29: \nL30: # Building a REST API with NestJS and Prisma: Input Validation \u0026 Transformation\nL31: \nL32: 【16†Series】\nL33: \nL34: 【17†Tasin Ishmam @ tasinishmam†twitter.com】\nL35: \nL36: 8 min read\nL37: \nL38: Welcome to the second tutorial on the series about building a REST API with NestJS, Prisma and PostgreSQL! In this tutorial, you will learn how to perform input validation and transformation in your API.\nL39: \nL40: [Image 1]\nL41: \nL42: 【18†Part 1 Building a REST API with NestJS and Prisma】\nL43: \nL44: Part 2\nL45: \nL46: (Currently reading)\nL47: \nL48: Building a REST API with NestJS and Prisma: Input Validation \u0026 Transformation\nL49: \nL50: 【19†Part 3 Building a REST API with NestJS and Prisma: Error Handling】【20†Part 4 Building a REST API with NestJS and Prisma: Handling Relational Data】【21†Part 5 Building a REST API with NestJS and Prisma: Authentication】\nL51: \nL52: ## Table Of Contents\nL53: \nL54:   * 【22†Introduction】\nL55:     * 【23†Development environment】\nL56:     * 【24†Clone the repository】\nL57:     * 【25†Project structure and files】\nL58:   * 【26†Perform input validation】\nL59:     * 【27†Set up ValidationPipe globally】\nL60:     * 【28†Add validation rules to CreateArticleDto】\nL61:     * 【29†Strip unnecessary properties from client requests】\nL62:   * 【30†Use ParseIntPipe to transform dynamic URL paths】\nL63:   * 【31†Summary and final remarks】\nL64: \nL65: ## Introduction \nL66: \nL67: In the 【18†first part】 of this series, you created a new NestJS project and integrated it with Prisma, PostgreSQL and Swagger. Then, you built a rudimentary REST API for the backend of a blog application.\nL68: \nL69: In this part, you will learn how to validate the input, so it conforms to your API specifications. Input validation is performed to ensure only properly formed data from the client passes through your API. It is best practice to validate the correctness of any data sent into a web application. This can help prevent malformed data and abuse of your API.\nL70: \nL71: You will also learn how to perform input transformation. Input transformation is a technique that allows you to intercept and transform data sent from the client before being processed by the route handler for that request. This is useful for converting data to appropriate types, applying default values to missing fields, sanitizing input, etc.\nL72: \nL73: ### Development environment \nL74: \nL75: To follow along with this tutorial, you will be expected to have:\nL76: \nL77:   * 【32†Node.js†nodejs.org】 installed.\nL78:   * 【33†Docker†www.docker.com】 or 【34†PostgreSQL†www.postgresql.org】 installed.\nL79:   * Installed the 【35†Prisma VSCode Extension†marketplace.visualstudio.com】. (optional)\nL80:   * Access to a Unix shell (like the terminal/shell in Linux and macOS) to run the commands provided in this series. (optional)\nL81: \nL82: \u003e Note:\nL83: \u003e \nL84: \u003e   1. The optional Prisma VS Code extension adds some nice IntelliSense and syntax highlighting for Prisma.\nL85: \u003e \nL86: \u003e   2. If you don't have a Unix shell (for example, you are on a Windows machine), you can still follow along, but the shell commands may need to be modified for your machine.\nL87: \u003e \nL88: \u003e \nL89: \nL90: ### Clone the repository \nL91: \nL92: The starting point for this tutorial is the ending of 【18†part one】 of this series. It contains a rudimentary REST API built with NestJS. I would recommend finishing the first tutorial before starting this one.\nL93: \nL94: The starting point for this tutorial is available in the 【36†begin-validation†github.com】 branch of the 【37†GitHub repository†github.com】. To get started, clone the repository and checkout the `begin-validation` branch:\nL95: \nL96:     git clone -b begin-validation git@github.com:prisma/blog-backend-rest-api-nestjs-prisma.git \nL97: \nL98:     Copy\nL99: \nL100: Now, perform the following actions to get started:\nL101: \nL102:   1. Navigate to the cloned directory:\nL103: \nL104:         cd blog-backend-rest-api-nestjs-prisma \nL105: \nL106:     Copy\nL107: \nL108:   2. Install dependencies:\nL109: \nL110:         npm install \nL111: \nL112:     Copy\nL113: \nL114:   3. Start the PostgreSQL database with docker:\nL115: \nL116:         docker-compose up -d \nL117: \nL118:     Copy\nL119: \nL120:   4. Apply database migrations:\nL121: \nL122:         npx prisma migrate dev \nL123: \nL124:     Copy\nL125: \nL126:   5. Start the project:\nL127: \nL128:         npm run start:dev \nL129: \nL130:     Copy\nL131: \nL132: \u003e Note: Step 4 will also generate Prisma Client and seed the database.\nL133: \nL134: Now, you should be able to access the API documentation at 【38†http://localhost:3000/api/†localhost:3000】.\nL135: \nL136: ### Project structure and files \nL137: \nL138: The repository you cloned should have the following structure:\nL139: \nL140:     median\nL141: \nL142:       ├── node_modules\nL143: \nL144:       ├── prisma\nL145: \nL146:       │   ├── migrations\nL147: \nL148:       │   ├── schema.prisma\nL149: \nL150:       │   └── seed.ts\nL151: \nL152:       ├── src\nL153: \nL154:       │   ├── app.controller.spec.ts\nL155: \nL156:       │   ├── app.controller.ts\nL157: \nL158:       │   ├── app.module.ts\nL159: \nL160:       │   ├── app.service.ts\nL161: \nL162:       │   ├── main.ts\nL163: \nL164:       │   ├── articles\nL165: \nL166:       │   └── prisma\nL167: \nL168:       ├── test\nL169: \nL170:       │   ├── app.e2e-spec.ts\nL171: \nL172:       │   └── jest-e2e.json\nL173: \nL174:       ├── README.md\nL175: \nL176:       ├── .env\nL177: \nL178:       ├── docker-compose.yml\nL179: \nL180:       ├── nest-cli.json\nL181: \nL182:       ├── package-lock.json\nL183: \nL184:       ├── package.json\nL185: \nL186:       ├── tsconfig.build.json\nL187: \nL188:       └── tsconfig.json \nL189: \nL190: The notable files and directories in this repository are:\nL191: \nL192:   * The `src` directory contains the source code for the application. There are three modules:\nL193:     * The `app` module is situated in the root of the `src` directory and is the entry point of the application. It is responsible for starting the web server.\nL194:     * The `prisma` module contains the Prisma Client, your database query builder.\nL195:     * The `articles` module defines the endpoints for the `/articles` route and accompanying business logic.\nL196:   * The `prisma` module has the following:\nL197:     * The `schema.prisma` file defines the database schema.\nL198:     * The `migrations` directory contains the database migration history.\nL199:     * The `seed.ts` file contains a script to seed your development database with dummy data.\nL200:   * The `docker-compose.yml` file defines the Docker image for your PostgreSQL database.\nL201:   * The `.env` file contains the database connection string for your PostgreSQL database.\nL202: \nL203: \u003e Note: For more information about these components, go through 【18†part one】 of this tutorial series.\nL204: \nL205: ## Perform input validation \nL206: \nL207: To perform input validation, you will be using 【39†NestJS Pipes†docs.nestjs.com】. Pipes operate on the arguments being processed by a route handler. Nest invokes a pipe before the route handler, and the pipe receives the arguments destined for the route handler. Pipes can do a number of things, like validate the input, add fields to the input, etc. Pipes are similar to 【40†middleware†docs.nestjs.com】, but the scope of pipes is limited to processing input arguments. NestJS provides a few pipes out-of-the-box, but you can also create your own 【41†custom pipes†docs.nestjs.com】.\nL208: \nL209: Pipes have two typical use cases:\nL210: \nL211:   * Validation: Evaluate input data and, if valid, pass it through unchanged; otherwise, throw an exception when the data is incorrect.\nL212:   * Transformation: Transform input data to the desired form (e.g., from string to integer).\nL213: \nL214: A NestJS validation pipe will check the arguments passed to a route. If the arguments are vaid, the pipe will pass the arguments to the route handler without any modification. However, if the arguments violate any of the specified validation rules, the pipe will throw an exception.\nL215: \nL216: The following two diagrams shows how validation pipe works, for an arbitrary `/example` route.\nL217: \nL218: [Image 2] [Image 3]\nL219: \nL220: In this section, you will focus on the validation use case.\nL221: \nL222: ### Set up `ValidationPipe` globally \nL223: \nL224: To perform input validation, you will be using the built-in NestJS `ValidationPipe`. The `ValidationPipe` provides a convenient approach to enforce validation rules for all incoming client payloads, where the validation rules are declared with decorators from the `class-validator` package.\nL225: \nL226: To use this feature, you will need to add two packages to your project:\nL227: \nL228:     npm install class-validator class-transformer \nL229: \nL230:     Copy\nL231: \nL232: The class-validator package provides decorators for validating input data, and the class-transformer package provides decorators to transform input data to the desired form. Both packages are well integrated with NestJS pipes.\nL233: \nL234: Now import the `ValidationPipe` in your `main.ts` file and use the `app.useGlobalPipes` method to make it available globally in your application:\nL235: \nL236:     // src/main.ts\nL237: \nL238:     import { NestFactory } from '@nestjs/core';\nL239: \nL240:     import { AppModule } from './app.module';\nL241: \nL242:     import { SwaggerModule, DocumentBuilder } from '@nestjs/swagger';\nL243: \nL244:     +import { ValidationPipe } from '@nestjs/common';\nL245: \nL246:     async function bootstrap() {\nL247: \nL248:       const app = await NestFactory.create(AppModule);\nL249: \nL250:     +  app.useGlobalPipes(new ValidationPipe());\nL251: \nL252:       const config = new DocumentBuilder()\nL253: \nL254:         .setTitle('Median')\nL255: \nL256:         .setDescription('The Median API description')\nL257: \nL258:         .setVersion('0.1')\nL259: \nL260:         .build();\nL261: \nL262:       const document = SwaggerModule.createDocument(app, config);\nL263: \nL264:       SwaggerModule.setup('api', app, document);\nL265: \nL266:       await app.listen(3000);\nL267: \nL268:     }\nL269: \nL270:     bootstrap();\nL271: \nL272:     Copy\nL273: \nL274: ### Add validation rules to `CreateArticleDto `\nL275: \nL276: You will now use the 【42†class-validator†github.com】 package to add validation decorators to `CreateArticleDto`. You will apply the following rules to `CreateArticleDto`:\nL277: \nL278:   1. `title` can't be empty or shorter than 5 characters.\nL279:   2. `description` has to have a maximum length of 300.\nL280:   3. `body` and `description` can't be empty.\nL281:   4. `title`, `description` and `body` must be of type `string` and `published` must be of type `boolean`.\nL282: \nL283: Open the `src/articles/dto/create-article.dto.ts` file and replace its contents with the following:\nL284: \nL285:     // src/articles/dto/create-article.dto.ts\nL286: \nL287:     import { ApiProperty } from '@nestjs/swagger';\nL288: \nL289:     import {\nL290: \nL291:       IsBoolean,\nL292: \nL293:       IsNotEmpty,\nL294: \nL295:       IsOptional,\nL296: \nL297:       IsString,\nL298: \nL299:       MaxLength,\nL300: \nL301:       MinLength,\nL302: \nL303:     } from 'class-validator';\nL304: \nL305:     export class CreateArticleDto {\nL306: \nL307:       @IsString()\nL308: \nL309:       @IsNotEmpty()\nL310: \nL311:       @MinLength(5)\nL312: \nL313:       @ApiProperty()\nL314: \nL315:       title: string;\nL316: \nL317:       @IsString()\nL318: \nL319:       @IsOptional()\nL320: \nL321:       @IsNotEmpty()\nL322: \nL323:       @MaxLength(300)\nL324: \nL325:       @ApiProperty({ required: false })\nL326: \nL327:       description?: string;\nL328: \nL329:       @IsString()\nL330: \nL331:       @IsNotEmpty()\nL332: \nL333:       @ApiProperty()\nL334: \nL335:       body: string;\nL336: \nL337:       @IsBoolean()\nL338: \nL339:       @IsOptional()\nL340: \nL341:       @ApiProperty({ required: false, default: false })\nL342: \nL343:       published?: boolean = false;\nL344: \nL345:     }\nL346: \nL347:     Copy\nL348: \nL349: These rules will be picked up by the `ValidationPipe` and applied automatically to your route handlers. One of the advantages of using decorators for validation is that the `CreateArticleDto` remains the single source of truth for all arguments to the `POST /articles` endpoint. So you don't need to define a separate validation class.\nL350: \nL351: Test out the validation rules you have in place. Try creating an article using the `POST /articles` endpoint with a very short placeholder `title` like this:\nL352: \nL353:     {\nL354: \nL355:       \"title\": \"Temp\",\nL356: \nL357:       \"description\": \"Learn about input validation\",\nL358: \nL359:       \"body\": \"Input validation is...\",\nL360: \nL361:       \"published\": false\nL362: \nL363:     }\nL364: \nL365:     Copy\nL366: \nL367: You should get an HTTP 400 error response along with details in the response body about what validation rule was broken.\nL368: \nL369: [Image 4: HTTP 400 response with descriptive error message]\nL370: \nL371: This diagram explains what the `ValidationPipe` is doing under the hood for invalid inputs to the `/articles` route:\nL372: \nL373: [Image 5: Input validation flow with ValidationPipe]\nL374: \nL375: ### Strip unnecessary properties from client requests \nL376: \nL377: The `CreateArticleDTO` defines the properties that need to be sent to the `POST /articles` endpoint to create a new article. `UpdateArticleDTO` does the same, but for the `PATCH /articles/{id}` endpoint.\nL378: \nL379: Currently, for both of these endpoints it is possible to send additional properties that are not defined in the DTO. This can lead to unforeseen bugs or security issues. For example, you could manually pass invalid `createdAt` and `updatedAt` values to the `POST /articles` endpoint. Since TypeScript type information is not available at run-time, your application will not be able to identify that these fields are not available in the DTO.\nL380: \nL381: To give an example, try sending the following request to the `POST /articles` endpoint:\nL382: \nL383:     {\nL384: \nL385:       \"title\": \"example-title\",\nL386: \nL387:       \"description\": \"example-description\",\nL388: \nL389:       \"body\": \"example-body\",\nL390: \nL391:       \"published\": true,\nL392: \nL393:       \"createdAt\": \"2010-06-08T18:20:29.309Z\",\nL394: \nL395:       \"updatedAt\": \"2021-06-02T18:20:29.310Z\"\nL396: \nL397:     }\nL398: \nL399:     Copy\nL400: \nL401: [Image 6]\nL402: \nL403: In this way, you can inject invalid values. Here you have created an article that has an `updatedAt` value that precedes `createdAt`, which does not make sense.\nL404: \nL405: To prevent this, you will need to filter any unnecessary fields/properties from client requests. Fortunately, NestJS provides an out-of-the-box for this as well. All you need to do is pass the `whitelist: true` option when initializing the `ValidationPipe` inside your application.\nL406: \nL407:     // src/main.ts\nL408: \nL409:     import { NestFactory } from '@nestjs/core';\nL410: \nL411:     import { AppModule } from './app.module';\nL412: \nL413:     import { SwaggerModule, DocumentBuilder } from '@nestjs/swagger';\nL414: \nL415:     import { ValidationPipe } from '@nestjs/common';\nL416: \nL417:     async function bootstrap() {\nL418: \nL419:       const app = await NestFactory.create(AppModule);\nL420: \nL421:     +  app.useGlobalPipes(new ValidationPipe({ whitelist: true }));\nL422: \nL423:       const config = new DocumentBuilder()\nL424: \nL425:         .setTitle('Median')\nL426: \nL427:         .setDescription('The Median API description')\nL428: \nL429:         .setVersion('0.1')\nL430: \nL431:         .build();\nL432: \nL433:       const document = SwaggerModule.createDocument(app, config);\nL434: \nL435:       SwaggerModule.setup('api', app, document);\nL436: \nL437:       await app.listen(3000);\nL438: \nL439:     }\nL440: \nL441:     bootstrap();\nL442: \nL443:     Copy\nL444: \nL445: With this option set to true, `ValidationPipe` will automatically remove all non-whitelisted properties, where “non-whitelisted” means properties without any validation decorators. It’s important to note that this option will filter all properties without validation decorators, even if they are defined in the DTO.\nL446: \nL447: Now, any additional fields/properties that are passed to the request will be stripped automatically by NestJS, preventing the previously shown exploit.\nL448: \nL449: \u003e Note: The NestJS `ValidationPipe` is highly configurable. All configuration options available are documented in the 【43†NestJS docs†docs.nestjs.com】. If necessary, you can also build 【41†custom validation pipes†docs.nestjs.com】 for your application.\nL450: \nL451: ## Transform dynamic URL paths with `ParseIntPipe `\nL452: \nL453: Inside your API, you are currently accepting the id parameter for the `GET /articles/{id}` , `PATCH /articles/{id}` and `DELETE /articles/{id}` endpoints as a part of the path. NestJS parses the `id` parameter as a string from the URL path. Then, the string is cast to a number inside your application code before being passed to the ArticlesService. For example, take a look at the `DELETE /articles/{id}` route handler:\nL454: \nL455:     // src/articles/articles.controller.ts\nL456: \nL457:     @Delete(':id')\nL458: \nL459:     @ApiOkResponse({ type: ArticleEntity })\nL460: \nL461:     remove(@Param('id') id: string) {   // id is parsed as a string\nL462: \nL463:       return this.articlesService.remove(+id); // id is converted to number using the expression '+id'\nL464: \nL465:     }\nL466: \nL467: Since `id` is defined as a string type, the Swagger API also documents this argument as a string in the generated API documentation. This is unintuitive and incorrect.\nL468: \nL469: [Image 7]\nL470: \nL471: Instead of doing this transformation manually inside the route handler, you can use a NestJS pipe to convert `id` to a number automatically. Add the built-in `ParseIntPipe` to the controller route handlers for these three endpoints:\nL472: \nL473:     // src/articles/articles.controller.ts\nL474: \nL475:     import {\nL476: \nL477:       Controller,\nL478: \nL479:       Get,\nL480: \nL481:       Post,\nL482: \nL483:       Body,\nL484: \nL485:       Patch,\nL486: \nL487:       Param,\nL488: \nL489:       Delete,\nL490: \nL491:       NotFoundException,\nL492: \nL493:     +  ParseIntPipe,\nL494: \nL495:     } from '@nestjs/common';\nL496: \nL497:     export class ArticlesController {\nL498: \nL499:       // ...\nL500: \nL501:       @Get(':id')\nL502: \nL503:       @ApiOkResponse({ type: ArticleEntity })\nL504: \nL505:     +  findOne(@Param('id', ParseIntPipe) id: number) {\nL506: \nL507:     +    return this.articlesService.findOne(id);\nL508: \nL509:       }\nL510: \nL511:       @Patch(':id')\nL512: \nL513:       @ApiCreatedResponse({ type: ArticleEntity })\nL514: \nL515:       update(\nL516: \nL517:     +    @Param('id', ParseIntPipe) id: number,\nL518: \nL519:         @Body() updateArticleDto: UpdateArticleDto,\nL520: \nL521:       ) {\nL522: \nL523:     +    return this.articlesService.update(id, updateArticleDto);\nL524: \nL525:       }\nL526: \nL527:       @Delete(':id')\nL528: \nL529:       @ApiOkResponse({ type: ArticleEntity })\nL530: \nL531:     +  remove(@Param('id', ParseIntPipe) id: number) {\nL532: \nL533:     +    return this.articlesService.remove(id);\nL534: \nL535:       }\nL536: \nL537:     }\nL538: \nL539:     Copy\nL540: \nL541: The `ParseIntPipe` will intercept the `id` parameter of string type and automatically parse it to a number before passing it to the appropriate route handler. This also has the advantage of documenting the `id` parameter correctly as a number inside Swagger.\nL542: \nL543: [Image 8]\nL544: \nL545: ## Summary and final remarks \nL546: \nL547: Congratulations! In this tutorial, you took an existing REST API and:\nL548: \nL549:   * Integrated validation using the `ValidationPipe`.\nL550:   * Stripped client request of unnecessary properties.\nL551:   * Integrated `ParseIntPipe` to parse a `string` path variable and convert it to a `number`.\nL552: \nL553: You might have noticed that NestJS heavily relies on decorators. This is a very intentional design choice. NestJS aims to improve code readability and modularity by heavily leveraging decorators for various kinds of 【44†cross-cutting concerns†en.wikipedia.org】. As a result, controllers and service methods do not need to be bloated with boilerplate code for doing things like validation, caching, logging, etc.\nL554: \nL555: You can find the finished code for this tutorial in the 【45†end-validation branch†github.com】 of the 【37†GitHub repository†github.com】. Please feel free to raise an issue in the repository or submit a PR if you notice a problem. You can also reach out to me directly on 【17†Twitter†twitter.com】.\nL556: \nL557: 【46†Education】\nL558: \nL559: ### Don’t miss the next post!\nL560: \nL561: Sign up for the Prisma Newsletter\nL562: \nL563: 【47†Key takeaways from the Discover Data DX virtual event December 13, 2023 Explore the insights from the Discover Data DX virtual event held on December 7th, 2023. The event brought together industry leaders to discuss the significance and principles of the emerging Data DX category. Announcement】\nL564: \nL565: 【50†Prisma Accelerate now in General Availability October 26, 2023 Now in General Availability: Dive into Prisma Accelerate , enhancing global database connections with connection pooling and edge caching for fast data access. Announcement Data Platform】\nL566: \nL567: 【53†Support for Serverless Database Drivers in Prisma ORM Is Now in Preview October 06, 2023 Prisma is releasing Preview support for serverless database drivers from Neon and PlanetScale . This feature allows Prisma users to leverage the existing database drivers for communication with their database without long-lived TCP connections! Prisma ORM Serverless Release】\nL568: \nL569: #### Product\nL570: \nL571: 【0†Client】【1†Migrate】【2†Accelerate】【3†Pulse Early Access】【4†Pricing】\nL572: \nL573: #### Developers\nL574: \nL575: 【5†Docs】【6†Get Started】【8†Prisma Examples†github.com】【12†Data Guide】【9†Prisma in your Stack】【57†Support】【58†Community】【59†Data Platform Status†www.prisma-status.com】【35†VS Code Extension†marketplace.visualstudio.com】\nL576: \nL577: #### Use Cases\nL578: \nL579: 【11†Customer Stories】【60†Enterprise】\nL580: \nL581: #### Company\nL582: \nL583: 【61†About】【14†Blog】【62†Careers 】【63†Events】【64†Causes†pris.ly】【65†Terms \u0026 Privacy†pris.ly】【66†Service Level Agreement†pris.ly】\nL584: \nL585: #### Newsletter\nL586: \nL587: [Image 9: prisma_logo]\nL588: \nL589: © 2023 Prisma Data, Inc.\nL590: \nL591:\nVisible: 0% - 100%","summary":"Learn how to add Input Validation to a REST API with NestJS and Prisma (www.prisma.io)\n","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Learn how to add Input Validation to a REST API with NestJS and Prisma","url":"https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1","text":"L0: \nL1: URL: https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1\nL2: \nL3: \nL4: [Image 0: prisma_logo]\nL5: \nL6: Products \nL7: \nL8: #### Prisma ORM\nL9: \nL10: Client Write Queries the way you thinkMigrate Generate customizable SQL migrations\nL11: \nL12: #### Prisma Data Platform\nL13: \nL14: Accelerate Query up to 1000x fasterPulse Early Access Real-time database events\nL15: \nL16: Pricing\nL17: \nL18: Resources\nL19: \nL20: DocumentationGet startedTutorialsExamplesPrisma in your stackEcosystemCustomer storiesData guide\nL21: \nL22: Playground\nL23: \nL24: Blog\nL25: \nL26: LoginGet started\nL27: \nL28: July 19, 2022 \nL29: \nL30: # Building a REST API with NestJS and Prisma: Input Validation \u0026 Transformation\nL31: \nL32: Series\nL33: \nL34: Tasin Ishmam @ tasinishmam\nL35: \nL36: 8 min read\nL37: \nL38: Welcome to the second tutorial on the series about building a REST API with NestJS, Prisma and PostgreSQL! In this tutorial, you will learn how to perform input validation and transformation in your API.\nL39: \nL40: [Image 1]\nL41: \nL42: Part 1 Building a REST API with NestJS and Prisma\nL43: \nL44: Part 2\nL45: \nL46: (Currently reading)\nL47: \nL48: Building a REST API with NestJS and Prisma: Input Validation \u0026 Transformation\nL49: \nL50: Part 3 Building a REST API with NestJS and Prisma: Error HandlingPart 4 Building a REST API with NestJS and Prisma: Handling Relational DataPart 5 Building a REST API with NestJS and Prisma: Authentication\nL51: \nL52: ## Table Of Contents\nL53: \nL54:   * Introduction\nL55:     * Development environment\nL56:     * Clone the repository\nL57:     * Project structure and files\nL58:   * Perform input validation\nL59:     * Set up ValidationPipe globally\nL60:     * Add validation rules to CreateArticleDto\nL61:     * Strip unnecessary properties from client requests\nL62:   * Use ParseIntPipe to transform dynamic URL paths\nL63:   * Summary and final remarks\nL64: \nL65: ## Introduction \nL66: \nL67: In the first part of this series, you created a new NestJS project and integrated it with Prisma, PostgreSQL and Swagger. Then, you built a rudimentary REST API for the backend of a blog application.\nL68: \nL69: In this part, you will learn how to validate the input, so it conforms to your API specifications. Input validation is performed to ensure only properly formed data from the client passes through your API. It is best practice to validate the correctness of any data sent into a web application. This can help prevent malformed data and abuse of your API.\nL70: \nL71: You will also learn how to perform input transformation. Input transformation is a technique that allows you to intercept and transform data sent from the client before being processed by the route handler for that request. This is useful for converting data to appropriate types, applying default values to missing fields, sanitizing input, etc.\nL72: \nL73: ### Development environment \nL74: \nL75: To follow along with this tutorial, you will be expected to have:\nL76: \nL77:   * Node.js installed.\nL78:   * Docker or PostgreSQL installed.\nL79:   * Installed the Prisma VSCode Extension. (optional)\nL80:   * Access to a Unix shell (like the terminal/shell in Linux and macOS) to run the commands provided in this series. (optional)\nL81: \nL82: \u003e Note:\nL83: \u003e \nL84: \u003e   1. The optional Prisma VS Code extension adds some nice IntelliSense and syntax highlighting for Prisma.\nL85: \u003e \nL86: \u003e   2. If you don't have a Unix shell (for example, you are on a Windows machine), you can still follow along, but the shell commands may need to be modified for your machine.\nL87: \u003e \nL88: \u003e \nL89: \nL90: ### Clone the repository \nL91: \nL92: The starting point for this tutorial is the ending of part one of this series. It contains a rudimentary REST API built with NestJS. I would recommend finishing the first tutorial before starting this one.\nL93: \nL94: The starting point for this tutorial is available in the begin-validation branch of the GitHub repository. To get started, clone the repository and checkout the `begin-validation` branch:\nL95: \nL96:     git clone -b begin-validation git@github.com:prisma/blog-backend-rest-api-nestjs-prisma.git \nL97: \nL98:     Copy\nL99: \nL100: Now, perform the following actions to get started:\nL101: \nL102:   1. Navigate to the cloned directory:\nL103: \nL104:         cd blog-backend-rest-api-nestjs-prisma \nL105: \nL106:     Copy\nL107: \nL108:   2. Install dependencies:\nL109: \nL110:         npm install \nL111: \nL112:     Copy\nL113: \nL114:   3. Start the PostgreSQL database with docker:\nL115: \nL116:         docker-compose up -d \nL117: \nL118:     Copy\nL119: \nL120:   4. Apply database migrations:\nL121: \nL122:         npx prisma migrate dev \nL123: \nL124:     Copy\nL125: \nL126:   5. Start the project:\nL127: \nL128:         npm run start:dev \nL129: \nL130:     Copy\nL131: \nL132: \u003e Note: Step 4 will also generate Prisma Client and seed the database.\nL133: \nL134: Now, you should be able to access the API documentation at http://localhost:3000/api/.\nL135: \nL136: ### Project structure and files \nL137: \nL138: The repository you cloned should have the following structure:\nL139: \nL140:     median\nL141: \nL142:       ├── node_modules\nL143: \nL144:       ├── prisma\nL145: \nL146:       │   ├── migrations\nL147: \nL148:       │   ├── schema.prisma\nL149: \nL150:       │   └── seed.ts\nL151: \nL152:       ├── src\nL153: \nL154:       │   ├── app.controller.spec.ts\nL155: \nL156:       │   ├── app.controller.ts\nL157: \nL158:       │   ├── app.module.ts\nL159: \nL160:       │   ├── app.service.ts\nL161: \nL162:       │   ├── main.ts\nL163: \nL164:       │   ├── articles\nL165: \nL166:       │   └── prisma\nL167: \nL168:       ├── test\nL169: \nL170:       │   ├── app.e2e-spec.ts\nL171: \nL172:       │   └── jest-e2e.json\nL173: \nL174:       ├── README.md\nL175: \nL176:       ├── .env\nL177: \nL178:       ├── docker-compose.yml\nL179: \nL180:       ├── nest-cli.json\nL181: \nL182:       ├── package-lock.json\nL183: \nL184:       ├── package.json\nL185: \nL186:       ├── tsconfig.build.json\nL187: \nL188:       └── tsconfig.json \nL189: \nL190: The notable files and directories in this repository are:\nL191: \nL192:   * The `src` directory contains the source code for the application. There are three modules:\nL193:     * The `app` module is situated in the root of the `src` directory and is the entry point of the application. It is responsible for starting the web server.\nL194:     * The `prisma` module contains the Prisma Client, your database query builder.\nL195:     * The `articles` module defines the endpoints for the `/articles` route and accompanying business logic.\nL196:   * The `prisma` module has the following:\nL197:     * The `schema.prisma` file defines the database schema.\nL198:     * The `migrations` directory contains the database migration history.\nL199:     * The `seed.ts` file contains a script to seed your development database with dummy data.\nL200:   * The `docker-compose.yml` file defines the Docker image for your PostgreSQL database.\nL201:   * The `.env` file contains the database connection string for your PostgreSQL database.\nL202: \nL203: \u003e Note: For more information about these components, go through part one of this tutorial series.\nL204: \nL205: ## Perform input validation \nL206: \nL207: To perform input validation, you will be using NestJS Pipes. Pipes operate on the arguments being processed by a route handler. Nest invokes a pipe before the route handler, and the pipe receives the arguments destined for the route handler. Pipes can do a number of things, like validate the input, add fields to the input, etc. Pipes are similar to middleware, but the scope of pipes is limited to processing input arguments. NestJS provides a few pipes out-of-the-box, but you can also create your own custom pipes.\nL208: \nL209: Pipes have two typical use cases:\nL210: \nL211:   * Validation: Evaluate input data and, if valid, pass it through unchanged; otherwise, throw an exception when the data is incorrect.\nL212:   * Transformation: Transform input data to the desired form (e.g., from string to integer).\nL213: \nL214: A NestJS validation pipe will check the arguments passed to a route. If the arguments are vaid, the pipe will pass the arguments to the route handler without any modification. However, if the arguments violate any of the specified validation rules, the pipe will throw an exception.\nL215: \nL216: The following two diagrams shows how validation pipe works, for an arbitrary `/example` route.\nL217: \nL218: [Image 2] [Image 3]\nL219: \nL220: In this section, you will focus on the validation use case.\nL221: \nL222: ### Set up `ValidationPipe` globally \nL223: \nL224: To perform input validation, you will be using the built-in NestJS `ValidationPipe`. The `ValidationPipe` provides a convenient approach to enforce validation rules for all incoming client payloads, where the validation rules are declared with decorators from the `class-validator` package.\nL225: \nL226: To use this feature, you will need to add two packages to your project:\nL227: \nL228:     npm install class-validator class-transformer \nL229: \nL230:     Copy\nL231: \nL232: The class-validator package provides decorators for validating input data, and the class-transformer package provides decorators to transform input data to the desired form. Both packages are well integrated with NestJS pipes.\nL233: \nL234: Now import the `ValidationPipe` in your `main.ts` file and use the `app.useGlobalPipes` method to make it available globally in your application:\nL235: \nL236:     // src/main.ts\nL237: \nL238:     import { NestFactory } from '@nestjs/core';\nL239: \nL240:     import { AppModule } from './app.module';\nL241: \nL242:     import { SwaggerModule, DocumentBuilder } from '@nestjs/swagger';\nL243: \nL244:     +import { ValidationPipe } from '@nestjs/common';\nL245: \nL246:     async function bootstrap() {\nL247: \nL248:       const app = await NestFactory.create(AppModule);\nL249: \nL250:     +  app.useGlobalPipes(new ValidationPipe());\nL251: \nL252:       const config = new DocumentBuilder()\nL253: \nL254:         .setTitle('Median')\nL255: \nL256:         .setDescription('The Median API description')\nL257: \nL258:         .setVersion('0.1')\nL259: \nL260:         .build();\nL261: \nL262:       const document = SwaggerModule.createDocument(app, config);\nL263: \nL264:       SwaggerModule.setup('api', app, document);\nL265: \nL266:       await app.listen(3000);\nL267: \nL268:     }\nL269: \nL270:     bootstrap();\nL271: \nL272:     Copy\nL273: \nL274: ### Add validation rules to `CreateArticleDto `\nL275: \nL276: You will now use the class-validator package to add validation decorators to `CreateArticleDto`. You will apply the following rules to `CreateArticleDto`:\nL277: \nL278:   1. `title` can't be empty or shorter than 5 characters.\nL279:   2. `description` has to have a maximum length of 300.\nL280:   3. `body` and `description` can't be empty.\nL281:   4. `title`, `description` and `body` must be of type `string` and `published` must be of type `boolean`.\nL282: \nL283: Open the `src/articles/dto/create-article.dto.ts` file and replace its contents with the following:\nL284: \nL285:     // src/articles/dto/create-article.dto.ts\nL286: \nL287:     import { ApiProperty } from '@nestjs/swagger';\nL288: \nL289:     import {\nL290: \nL291:       IsBoolean,\nL292: \nL293:       IsNotEmpty,\nL294: \nL295:       IsOptional,\nL296: \nL297:       IsString,\nL298: \nL299:       MaxLength,\nL300: \nL301:       MinLength,\nL302: \nL303:     } from 'class-validator';\nL304: \nL305:     export class CreateArticleDto {\nL306: \nL307:       @IsString()\nL308: \nL309:       @IsNotEmpty()\nL310: \nL311:       @MinLength(5)\nL312: \nL313:       @ApiProperty()\nL314: \nL315:       title: string;\nL316: \nL317:       @IsString()\nL318: \nL319:       @IsOptional()\nL320: \nL321:       @IsNotEmpty()\nL322: \nL323:       @MaxLength(300)\nL324: \nL325:       @ApiProperty({ required: false })\nL326: \nL327:       description?: string;\nL328: \nL329:       @IsString()\nL330: \nL331:       @IsNotEmpty()\nL332: \nL333:       @ApiProperty()\nL334: \nL335:       body: string;\nL336: \nL337:       @IsBoolean()\nL338: \nL339:       @IsOptional()\nL340: \nL341:       @ApiProperty({ required: false, default: false })\nL342: \nL343:       published?: boolean = false;\nL344: \nL345:     }\nL346: \nL347:     Copy\nL348: \nL349: These rules will be picked up by the `ValidationPipe` and applied automatically to your route handlers. One of the advantages of using decorators for validation is that the `CreateArticleDto` remains the single source of truth for all arguments to the `POST /articles` endpoint. So you don't need to define a separate validation class.\nL350: \nL351: Test out the validation rules you have in place. Try creating an article using the `POST /articles` endpoint with a very short placeholder `title` like this:\nL352: \nL353:     {\nL354: \nL355:       \"title\": \"Temp\",\nL356: \nL357:       \"description\": \"Learn about input validation\",\nL358: \nL359:       \"body\": \"Input validation is...\",\nL360: \nL361:       \"published\": false\nL362: \nL363:     }\nL364: \nL365:     Copy\nL366: \nL367: You should get an HTTP 400 error response along with details in the response body about what validation rule was broken.\nL368: \nL369: [Image 4: HTTP 400 response with descriptive error message]\nL370: \nL371: This diagram explains what the `ValidationPipe` is doing under the hood for invalid inputs to the `/articles` route:\nL372: \nL373: [Image 5: Input validation flow with ValidationPipe]\nL374: \nL375: ### Strip unnecessary properties from client requests \nL376: \nL377: The `CreateArticleDTO` defines the properties that need to be sent to the `POST /articles` endpoint to create a new article. `UpdateArticleDTO` does the same, but for the `PATCH /articles/{id}` endpoint.\nL378: \nL379: Currently, for both of these endpoints it is possible to send additional properties that are not defined in the DTO. This can lead to unforeseen bugs or security issues. For example, you could manually pass invalid `createdAt` and `updatedAt` values to the `POST /articles` endpoint. Since TypeScript type information is not available at run-time, your application will not be able to identify that these fields are not available in the DTO.\nL380: \nL381: To give an example, try sending the following request to the `POST /articles` endpoint:\nL382: \nL383:     {\nL384: \nL385:       \"title\": \"example-title\",\nL386: \nL387:       \"description\": \"example-description\",\nL388: \nL389:       \"body\": \"example-body\",\nL390: \nL391:       \"published\": true,\nL392: \nL393:       \"createdAt\": \"2010-06-08T18:20:29.309Z\",\nL394: \nL395:       \"updatedAt\": \"2021-06-02T18:20:29.310Z\"\nL396: \nL397:     }\nL398: \nL399:     Copy\nL400: \nL401: [Image 6]\nL402: \nL403: In this way, you can inject invalid values. Here you have created an article that has an `updatedAt` value that precedes `createdAt`, which does not make sense.\nL404: \nL405: To prevent this, you will need to filter any unnecessary fields/properties from client requests. Fortunately, NestJS provides an out-of-the-box for this as well. All you need to do is pass the `whitelist: true` option when initializing the `ValidationPipe` inside your application.\nL406: \nL407:     // src/main.ts\nL408: \nL409:     import { NestFactory } from '@nestjs/core';\nL410: \nL411:     import { AppModule } from './app.module';\nL412: \nL413:     import { SwaggerModule, DocumentBuilder } from '@nestjs/swagger';\nL414: \nL415:     import { ValidationPipe } from '@nestjs/common';\nL416: \nL417:     async function bootstrap() {\nL418: \nL419:       const app = await NestFactory.create(AppModule);\nL420: \nL421:     +  app.useGlobalPipes(new ValidationPipe({ whitelist: true }));\nL422: \nL423:       const config = new DocumentBuilder()\nL424: \nL425:         .setTitle('Median')\nL426: \nL427:         .setDescription('The Median API description')\nL428: \nL429:         .setVersion('0.1')\nL430: \nL431:         .build();\nL432: \nL433:       const document = SwaggerModule.createDocument(app, config);\nL434: \nL435:       SwaggerModule.setup('api', app, document);\nL436: \nL437:       await app.listen(3000);\nL438: \nL439:     }\nL440: \nL441:     bootstrap();\nL442: \nL443:     Copy\nL444: \nL445: With this option set to true, `ValidationPipe` will automatically remove all non-whitelisted properties, where “non-whitelisted” means properties without any validation decorators. It’s important to note that this option will filter all properties without validation decorators, even if they are defined in the DTO.\nL446: \nL447: Now, any additional fields/properties that are passed to the request will be stripped automatically by NestJS, preventing the previously shown exploit.\nL448: \nL449: \u003e Note: The NestJS `ValidationPipe` is highly configurable. All configuration options available are documented in the NestJS docs. If necessary, you can also build custom validation pipes for your application.\nL450: \nL451: ## Transform dynamic URL paths with `ParseIntPipe `\nL452: \nL453: Inside your API, you are currently accepting the id parameter for the `GET /articles/{id}` , `PATCH /articles/{id}` and `DELETE /articles/{id}` endpoints as a part of the path. NestJS parses the `id` parameter as a string from the URL path. Then, the string is cast to a number inside your application code before being passed to the ArticlesService. For example, take a look at the `DELETE /articles/{id}` route handler:\nL454: \nL455:     // src/articles/articles.controller.ts\nL456: \nL457:     @Delete(':id')\nL458: \nL459:     @ApiOkResponse({ type: ArticleEntity })\nL460: \nL461:     remove(@Param('id') id: string) {   // id is parsed as a string\nL462: \nL463:       return this.articlesService.remove(+id); // id is converted to number using the expression '+id'\nL464: \nL465:     }\nL466: \nL467: Since `id` is defined as a string type, the Swagger API also documents this argument as a string in the generated API documentation. This is unintuitive and incorrect.\nL468: \nL469: [Image 7]\nL470: \nL471: Instead of doing this transformation manually inside the route handler, you can use a NestJS pipe to convert `id` to a number automatically. Add the built-in `ParseIntPipe` to the controller route handlers for these three endpoints:\nL472: \nL473:     // src/articles/articles.controller.ts\nL474: \nL475:     import {\nL476: \nL477:       Controller,\nL478: \nL479:       Get,\nL480: \nL481:       Post,\nL482: \nL483:       Body,\nL484: \nL485:       Patch,\nL486: \nL487:       Param,\nL488: \nL489:       Delete,\nL490: \nL491:       NotFoundException,\nL492: \nL493:     +  ParseIntPipe,\nL494: \nL495:     } from '@nestjs/common';\nL496: \nL497:     export class ArticlesController {\nL498: \nL499:       // ...\nL500: \nL501:       @Get(':id')\nL502: \nL503:       @ApiOkResponse({ type: ArticleEntity })\nL504: \nL505:     +  findOne(@Param('id', ParseIntPipe) id: number) {\nL506: \nL507:     +    return this.articlesService.findOne(id);\nL508: \nL509:       }\nL510: \nL511:       @Patch(':id')\nL512: \nL513:       @ApiCreatedResponse({ type: ArticleEntity })\nL514: \nL515:       update(\nL516: \nL517:     +    @Param('id', ParseIntPipe) id: number,\nL518: \nL519:         @Body() updateArticleDto: UpdateArticleDto,\nL520: \nL521:       ) {\nL522: \nL523:     +    return this.articlesService.update(id, updateArticleDto);\nL524: \nL525:       }\nL526: \nL527:       @Delete(':id')\nL528: \nL529:       @ApiOkResponse({ type: ArticleEntity })\nL530: \nL531:     +  remove(@Param('id', ParseIntPipe) id: number) {\nL532: \nL533:     +    return this.articlesService.remove(id);\nL534: \nL535:       }\nL536: \nL537:     }\nL538: \nL539:     Copy\nL540: \nL541: The `ParseIntPipe` will intercept the `id` parameter of string type and automatically parse it to a number before passing it to the appropriate route handler. This also has the advantage of documenting the `id` parameter correctly as a number inside Swagger.\nL542: \nL543: [Image 8]\nL544: \nL545: ## Summary and final remarks \nL546: \nL547: Congratulations! In this tutorial, you took an existing REST API and:\nL548: \nL549:   * Integrated validation using the `ValidationPipe`.\nL550:   * Stripped client request of unnecessary properties.\nL551:   * Integrated `ParseIntPipe` to parse a `string` path variable and convert it to a `number`.\nL552: \nL553: You might have noticed that NestJS heavily relies on decorators. This is a very intentional design choice. NestJS aims to improve code readability and modularity by heavily leveraging decorators for various kinds of cross-cutting concerns. As a result, controllers and service methods do not need to be bloated with boilerplate code for doing things like validation, caching, logging, etc.\nL554: \nL555: You can find the finished code for this tutorial in the end-validation branch of the GitHub repository. Please feel free to raise an issue in the repository or submit a PR if you notice a problem. You can also reach out to me directly on Twitter.\nL556: \nL557: Education\nL558: \nL559: ### Don’t miss the next post!\nL560: \nL561: Sign up for the Prisma Newsletter\nL562: \nL563: Key takeaways from the Discover Data DX virtual event December 13, 2023 Explore the insights from the Discover Data DX virtual event held on December 7th, 2023. The event brought together industry leaders to discuss the significance and principles of the emerging Data DX category. Announcement\nL564: \nL565: Prisma Accelerate now in General Availability October 26, 2023 Now in General Availability: Dive into Prisma Accelerate , enhancing global database connections with connection pooling and edge caching for fast data access. Announcement Data Platform\nL566: \nL567: Support for Serverless Database Drivers in Prisma ORM Is Now in Preview October 06, 2023 Prisma is releasing Preview support for serverless database drivers from Neon and PlanetScale . This feature allows Prisma users to leverage the existing database drivers for communication with their database without long-lived TCP connections! Prisma ORM Serverless Release\nL568: \nL569: #### Product\nL570: \nL571: ClientMigrateAcceleratePulse Early AccessPricing\nL572: \nL573: #### Developers\nL574: \nL575: DocsGet StartedPrisma ExamplesData GuidePrisma in your StackSupportCommunityData Platform StatusVS Code Extension\nL576: \nL577: #### Use Cases\nL578: \nL579: Customer StoriesEnterprise\nL580: \nL581: #### Company\nL582: \nL583: AboutBlogCareers EventsCausesTerms \u0026 PrivacyService Level Agreement\nL584: \nL585: #### Newsletter\nL586: \nL587: [Image 9: prisma_logo]\nL588: \nL589: © 2023 Prisma Data, Inc.\nL590: \nL591:\nVisible: 0% - 100%"}]},"command":"click","args":[8],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"94a31171-0a47-4435-b86e-4bfbbc484882","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"94a31171-0a47-4435-b86e-4bfbbc484882","children":["7bc77edd-f6ab-457e-9664-a09a0d5c5b80"]},"94a31171-0a47-4435-b86e-4bfbbc484882":{"id":"94a31171-0a47-4435-b86e-4bfbbc484882","message":{"id":"94a31171-0a47-4435-b86e-4bfbbc484882","author":{"role":"assistant","metadata":{}},"create_time":1703480183.38036,"content":{"content_type":"code","language":"unknown","text":"click(8)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"c88fb854-0ca4-4542-9d2c-7e40febea1ed","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"c88fb854-0ca4-4542-9d2c-7e40febea1ed","children":["7de6f89c-d331-4865-b726-ad1847f2d9b4"]},"c88fb854-0ca4-4542-9d2c-7e40febea1ed":{"id":"c88fb854-0ca4-4542-9d2c-7e40febea1ed","message":{"id":"c88fb854-0ca4-4542-9d2c-7e40febea1ed","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.366223,"content":{"content_type":"tether_browsing_display","result":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Validation | NestJS - A progressive Node.js framework","url":"https://docs.nestjs.com/techniques/validation","text":"\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: "},{"type":"webpage","title":"Custom validation with database in NestJS - DEV Community","url":"https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao","text":"\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: "},{"type":"webpage","title":"Validation - GitHub: Let’s build from here","url":"https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md","text":"\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: "},{"type":"webpage","title":"Injecting request object to a custom validation class in NestJS","url":"https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal","text":"\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: "},{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: "},{"type":"webpage","title":"NestJS and ‘class validator’ cheat sheet - DEV Community","url":"https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao","text":"\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: "},{"type":"webpage","title":"How to implement input validation with NestJS - Sébastien Dubois","url":"https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/","text":"\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: "},{"type":"webpage","title":"How to use class-validator and generate custom error object in nest.js","url":"https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h","text":"\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: "},{"type":"webpage","title":"Building a REST API with NestJS and Prisma: Input Validation ...","url":"https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1","text":"\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: "},{"type":"webpage","title":"NestJS Custom Payload Validation - DEV Community","url":"https://dev.to/shubham_kadam/nestjs-custom-payload-validation-3hh7","text":"\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: "},{"type":"webpage","title":"Mastering Email Validation in NestJS: A Comprehensive Guide","url":"https://emaillistvalidation.com/blog/mastering-email-validation-in-nestjs-a-comprehensive-guide/","text":"\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: "},{"type":"webpage","title":"Custom Card v2 Signature Validation in NestJS - community.hubspot.com","url":"https://community.hubspot.com/t5/APIs-Integrations/Custom-Card-v2-Signature-Validation-in-NestJS/m-p/897350","text":"\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"},{"type":"webpage","title":"Search results for query: 'nestjs class-validator custom validation method documentation'","url":"","text":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"}]},"command":"back","args":[],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"6bf8eb2b-c717-48a3-b498-f30187a2bc6d","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"6bf8eb2b-c717-48a3-b498-f30187a2bc6d","children":["94a31171-0a47-4435-b86e-4bfbbc484882"]},"6bf8eb2b-c717-48a3-b498-f30187a2bc6d":{"id":"6bf8eb2b-c717-48a3-b498-f30187a2bc6d","message":{"id":"6bf8eb2b-c717-48a3-b498-f30187a2bc6d","author":{"role":"assistant","metadata":{}},"create_time":1703480183.350667,"content":{"content_type":"code","language":"unknown","text":"back()"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"330b0eaf-03de-4922-bea8-1a6d942e1dea","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"330b0eaf-03de-4922-bea8-1a6d942e1dea","children":["c88fb854-0ca4-4542-9d2c-7e40febea1ed"]},"330b0eaf-03de-4922-bea8-1a6d942e1dea":{"id":"330b0eaf-03de-4922-bea8-1a6d942e1dea","message":{"id":"330b0eaf-03de-4922-bea8-1a6d942e1dea","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.336923,"content":{"content_type":"tether_browsing_display","result":"L0: \nL1: URL: https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h\nL2:   \nL3: \nL4:   【0†Skip to content】 \nL5: \nL6: Navigation menu 【1† 】 \nL7: \nL8:  Search\nL9: \nL10: 【2† Search 】 \nL11: \nL12:   【3† Log in 】  【4† Create account 】 \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30: 【5† Share to Twitter †twitter.com】 【6† Share to LinkedIn †www.linkedin.com】 【7† Share to Reddit †www.reddit.com】 【8† Share to Hacker News †news.ycombinator.com】 【9† Share to Facebook †www.facebook.com】 【10† Share to Mastodon †toot.kytta.dev】 \nL31: \nL32:  Share Post via...  【11†Report Abuse】 \nL33: \nL34: [Image 6: Nithin K Joy]\nL35: \nL36: 【12†Nithin K Joy】 \nL37: \nL38: Posted on Jun 6\nL39: \nL40: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL41: \nL42: #  How to use class-validator and generate custom error object in nest.js \nL43: \nL44: 【13†# javascript】 【14†# nest】 【15†# classvalidator】 【16†# typescript】 \nL45: \nL46: ##  【17† 】 Objective \nL47: \nL48: The main objective of this article is showing how to generate custom error object when the validation fails, but we will go through the process of using class-validator and later about generating custom error object.\nL49: \nL50: ##  【18† 】 What is class-validator \nL51: \nL52: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms.\nL53: \nL54: ##  【19† 】 How to use it \nL55: \nL56: In order to use class-validator in nest.js we need to install class-validator and class-transformer.  \nL57: `npm i --save class-validator class-transformer`\nL58: \nL59: To configure, in `main.ts` file we need to invoke `ValidationPipe()` constructor function imported form `@nestjs/common` and pass it as a argument for `app.useGlobalPipes` method.  \nL60: \nL61:     import { NestFactory } from '@nestjs/core';\nL62:     import { AppModule } from './app.module';\nL63:     import { ValidationPipe } from '@nestjs/common';\nL64: \nL65:     async function bootstrap() {\nL66:       const app = await NestFactory.create(AppModule);\nL67:       app.useGlobalPipes(new ValidationPipe({ stopAtFirstError: true }));\nL68:       await app.listen(3500);\nL69:     }\nL70: \nL71:     bootstrap();\nL72: \nL73: Enter fullscreen mode Exit fullscreen mode\nL74: \nL75: `{ stopAtFirstError: true }` is just an optional argument to stop after getting the first error and return it. we can always customize it.\nL76: \nL77: [Image 12: main.ts file]\nL78: \nL79: Let us assume we have a `users` resource. We need a create `create-user.dto.ts` file inside a `dto` folder under `users` resource as in image given below.\nL80: \nL81: [Image 13: create-user.to.ts file location]\nL82: \nL83: Inside `create-user.dto.ts` file add the class validation you need to add. Refer class-validator docs for which validation you need to apply. docs: 【20†https://www.npmjs.com/package/class-validator†www.npmjs.com】\nL84: \nL85: This is my `create-user.dto.ts` file  \nL86: \nL87:     import {\nL88:       IsNotEmpty,\nL89:       IsString,\nL90:       MinLength,\nL91:       IsAlpha,\nL92:       Matches,\nL93:       IsEnum,\nL94:     } from 'class-validator';\nL95: \nL96:     export enum UserState {\nL97:       ACTIVE = 'Active',\nL98:       IN_ACTIVE = 'Inactive',\nL99:     }\nL100: \nL101:     export class CreateUserDto {\nL102:       @IsNotEmpty()\nL103:       @IsString()\nL104:       @IsAlpha()\nL105:       @MinLength(1)\nL106:       readonly firstName: string;\nL107: \nL108:       @IsNotEmpty()\nL109:       @IsString()\nL110:       readonly lastName: string;\nL111: \nL112:       @IsNotEmpty()\nL113:       @IsString()\nL114:       @IsNotEmpty()\nL115:       @Matches(/^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,3}$/g)\nL116:       readonly email: string;\nL117: \nL118:       @IsNotEmpty()\nL119:       @IsString()\nL120:       @Matches(/^[6789]\\d{9}$/)\nL121:       readonly phoneNumber: string;\nL122: \nL123:       @IsNotEmpty()\nL124:       @IsString()\nL125:       @MinLength(3)\nL126:       readonly companyName: string;\nL127: \nL128:       @IsEnum(UserState)\nL129:       readonly userState: UserState;\nL130:     }\nL131: \nL132: Enter fullscreen mode Exit fullscreen mode\nL133: \nL134: Next import `CreateUserDto` class and use it inside the user controller.  \nL135: \nL136:     import { Controller, Post, Body } from '@nestjs/common';\nL137:     import { UsersService } from './users.service';\nL138:     import { CreateUserDto } from './dto/create-user.dto';\nL139: \nL140:     @Controller('users')\nL141:     export class UsersController {\nL142:       constructor(private readonly usersService: UsersService) {}\nL143: \nL144:       @Post()\nL145:       create(@Body() user: CreateUserDto) {\nL146:         return this.usersService.create(user);\nL147:       }\nL148:     }\nL149: \nL150: Enter fullscreen mode Exit fullscreen mode\nL151: \nL152: After sending request in postman or any other api testing application this will automatically validate and send error message as shown below  \nL153: Request body  \nL154: \nL155:     {\nL156:       \"firstName\":\"\",\nL157:       \"lastName\":\"K Joy\",\nL158:       \"email\":\"Nn@gail.com\",\nL159:       \"phoneNumber\":\"9160000000\",\nL160:       \"companyName\":\"abcgf\",\nL161:       \"userState\":\"Active\"\nL162:     }\nL163: \nL164: Enter fullscreen mode Exit fullscreen mode\nL165: \nL166: Response  \nL167: \nL168:     {\nL169:       \"statusCode\": 400,\nL170:       \"message\": [\nL171:         \"firstName must be longer than or equal to 1 characters\"\nL172:       ],\nL173:       \"error\": \"Bad Request\"\nL174:     }\nL175: \nL176: Enter fullscreen mode Exit fullscreen mode\nL177: \nL178: [Image 14: image of a non customized class-validator]\nL179: \nL180: ##  【21† 】 How to generate custom error message object \nL181: \nL182: But we need to get which property just gave us this error along with the error message. In order to do that we need to configure the `ValidationPipe()` in `main.ts` file with some configurations.  \nL183: \nL184:     import { NestFactory } from '@nestjs/core';\nL185:     import { AppModule } from './app.module';\nL186:     import { ValidationPipe, BadRequestException } from '@nestjs/common';\nL187: \nL188:     async function bootstrap() {\nL189:       const app = await NestFactory.create(AppModule);\nL190:       app.useGlobalPipes(\nL191:         new ValidationPipe({\nL192:           exceptionFactory: (errors) =\u003e {\nL193:             const result = errors.map((error) =\u003e ({\nL194:               property: error.property,\nL195:               message: error.constraints[Object.keys(error.constraints)[0]],\nL196:             }));\nL197:             return new BadRequestException(result);\nL198:           },\nL199:           stopAtFirstError: true,\nL200:         }),\nL201:       );\nL202:       await app.listen(3500);\nL203:     }\nL204: \nL205:     bootstrap();\nL206: \nL207: Enter fullscreen mode Exit fullscreen mode\nL208: \nL209: Let me break down the above code. The object below is the error object.  \nL210: \nL211:     {\nL212:       property: 'firstName',\nL213:       children: [],\nL214:       constraints: {\nL215:         minLength: 'firstName must be longer than or equal to 1 characters'\nL216:       }\nL217:     }\nL218: \nL219: Enter fullscreen mode Exit fullscreen mode\nL220: \nL221: `property: error.property` usage is straight forward.   \nL222: `message` is basically the value inside the the constraints object. But the key for the constraint object (here `minLength`) is not static. The key will be different for different validation failure.\nL223: \nL224: `Object.keys(error.constraints)[0]` Object.keys just changes all object keys to array and we access the first key by `[0]`. \nL225: \nL226: Request body  \nL227: \nL228:     {\nL229:       \"firstName\":\"\",\nL230:       \"lastName\":\"K Joy\",\nL231:       \"email\":\"Nn@gail.com\",\nL232:       \"phoneNumber\":\"9160000000\",\nL233:       \"companyName\":\"abcgf\",\nL234:       \"userState\":\"Active\"\nL235:     }\nL236: \nL237: Enter fullscreen mode Exit fullscreen mode\nL238: \nL239: Response  \nL240: \nL241:     {\nL242:       \"statusCode\": 400,\nL243:       \"message\": [\nL244:         {\nL245:           \"property\": \"firstName\",\nL246:           \"message\": \"firstName must be longer than or equal to 1 characters\"\nL247:         }\nL248:       ],\nL249:       \"error\": \"Bad Request\"\nL250:     }\nL251: \nL252: Enter fullscreen mode Exit fullscreen mode\nL253: \nL254: If you found this helpful, be sure to leave a on the post. Thank you!\nL255: \nL256: ##  Top comments (5)\nL257: \nL258: Subscribe\nL259: \nL260:     [Image 15: pic] \nL261: \nL262: Personal Trusted User\nL263: \nL264: 【22† Create template 】 \nL265: \nL266: Templates let you quickly answer FAQs or store snippets for re-use.\nL267: \nL268: Submit Preview 【23†Dismiss】 \nL269: \nL270:   Collapse Expand\nL271: \nL272: 【24† 】 \nL273: \nL274: 【24† davistran86 】 \nL275: \nL276:  davistran86 \nL277: \nL278: 【24† davistran86 】 \nL279: \nL280: Follow\nL281: \nL282:   * Joined \nL283: \nL284: Mar 27, 2019\nL285: \nL286: • 【25† Aug 11 】 \nL287: \nL288:  Dropdown menu\nL289: \nL290:   * 【25†Copy link】\nL291:   *   * Hide \nL292:   *   *   * \nL293: \nL294: Thanks alot, custom error message is what I'm looking for :)\nL295: \nL296:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL297: \nL298: Collapse Expand\nL299: \nL300: 【12† 】 \nL301: \nL302: 【12† Nithin K Joy 】 \nL303: \nL304:  Nithin K Joy \nL305: \nL306: 【12† Nithin K Joy 】 \nL307: \nL308: Follow\nL309: \nL310: I am a passionate Node.js, React.js developer who is more focused on developing Scalable FullStack Web Applications. \nL311: \nL312:   * Location \nL313: \nL314: Bangalore \nL315: \nL316:   * Education \nL317: \nL318: NMAM Institute of Technology, Nitte \nL319: \nL320:   * Work \nL321: \nL322: Clover Bay Technologies Pvt Ltd \nL323: \nL324:   * Joined \nL325: \nL326: May 14, 2023\nL327: \nL328: • 【26† Aug 12 】 \nL329: \nL330:  Dropdown menu\nL331: \nL332:   * 【26†Copy link】\nL333:   *   * Hide \nL334:   *   *   * \nL335: \nL336: You're welcome\nL337: \nL338:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL339: \nL340: Collapse Expand\nL341: \nL342: 【27† 】 \nL343: \nL344: 【27† mohamed 】 \nL345: \nL346:  mohamed \nL347: \nL348: 【27† mohamed 】 \nL349: \nL350: Follow\nL351: \nL352:   * Joined \nL353: \nL354: Aug 23, 2023\nL355: \nL356: • 【28† Aug 23 】 \nL357: \nL358:  Dropdown menu\nL359: \nL360:   * 【28†Copy link】\nL361:   *   * Hide \nL362:   *   *   * \nL363: \nL364: i need to custom like this  \nL365: {  \nL366: \"statusCode\": 400,  \nL367: \"message\": \"firstName must be longer than or equal to 1 characters\"  \nL368: }\nL369: \nL370: any idea please\nL371: \nL372:  Like comment:  Like comment:  3 likes Like  Comment button Reply \nL373: \nL374: Collapse Expand\nL375: \nL376: 【29† 】 \nL377: \nL378: 【29† Rafael Rossi 】 \nL379: \nL380:  Rafael Rossi \nL381: \nL382: 【29† Rafael Rossi 】 \nL383: \nL384: Follow\nL385: \nL386:   * Joined \nL387: \nL388: Jun 22, 2023\nL389: \nL390: • 【30† Nov 24 】 \nL391: \nL392:  Dropdown menu\nL393: \nL394:   * 【30†Copy link】\nL395:   *   * Hide \nL396:   *   *   * \nL397: \nL398: Tks sir\nL399: \nL400:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL401: \nL402: Collapse Expand\nL403: \nL404: 【31† 】 \nL405: \nL406: 【31† mundzirmuin 】 \nL407: \nL408:  mundzirmuin \nL409: \nL410: 【31† mundzirmuin 】 \nL411: \nL412: Follow\nL413: \nL414:   * Joined \nL415: \nL416: Aug 10, 2023\nL417: \nL418: • 【32† Aug 19 】 \nL419: \nL420:  Dropdown menu\nL421: \nL422:   * 【32†Copy link】\nL423:   *   * Hide \nL424:   *   *   * \nL425: \nL426: This really saves me, thanks!\nL427: \nL428:  Like comment:  Like comment:  Like  Comment button Reply \nL429: \nL430: 【33†Code of Conduct】 • 【11†Report abuse】 \nL431: \nL432: Are you sure you want to hide this comment? It will become hidden in your post, but will still be visible via the comment's permalink. \nL433: \nL434: Hide child comments as well\nL435: \nL436: Confirm \nL437: \nL438: For further actions, you may consider blocking this person and/or 【11†reporting abuse】\nL439: \nL440: ## Read next\nL441: \nL442: 【34† Tech Talk: React in the Terminal? Hold my Beer Manuel Artero Anguita - Dec 20 】 【35† Download Best 800+ VST Plugins Collection for Music Production Extraplugins extraplugins - Nov 22 】 【36† 14 tips to write better Javascript Melvinvmegen - Dec 12 】 【37† The One Thing Every Developer Should Know Brock Chestwall - Dec 18 】 \nL443: \nL444: 【12† Nithin K Joy 】 \nL445: \nL446: Follow\nL447: \nL448: I am a passionate Node.js, React.js developer who is more focused on developing Scalable FullStack Web Applications. \nL449: \nL450:   * Location \nL451: \nL452: Bangalore \nL453: \nL454:   * Education \nL455: \nL456: NMAM Institute of Technology, Nitte \nL457: \nL458:   * Work \nL459: \nL460: Clover Bay Technologies Pvt Ltd \nL461: \nL462:   * Joined \nL463: \nL464: May 14, 2023\nL465: \nL466: ###  More from 【12†Nithin K Joy】 \nL467: \nL468: 【38† How to call React Query hooks conditionally! # react # javascript # hooks # reactquery 】 \nL469: \nL470: Once suspended, nithinkjoy will not be able to comment or publish posts until their suspension is removed. \nL471: \nL472: Note:  \nL473: \nL474:  Submit \u0026 Suspend \nL475: \nL476: Once unsuspended, nithinkjoy will be able to comment and publish posts again. \nL477: \nL478: Note:  \nL479: \nL480:  Submit \u0026 Unsuspend \nL481: \nL482: Once unpublished, all posts by nithinkjoy will become hidden and only accessible to themselves. \nL483: \nL484: If nithinkjoy is not suspended, they can still re-publish their posts from their dashboard. \nL485: \nL486: Note: \nL487: \nL488:  Unpublish all posts \nL489: \nL490: Once unpublished, this post will become invisible to the public and only accessible to Nithin K Joy. \nL491: \nL492: They can still re-publish the post if they are not suspended.\nL493: \nL494:  Unpublish Post \nL495: \nL496: Thanks for keeping DEV Community safe. Here is what you can do to flag nithinkjoy: \nL497: \nL498:  Make all posts by nithinkjoy less visible \nL499: \nL500: nithinkjoy consistently posts content that violates DEV Community's code of conduct because it is harassing, offensive or spammy. \nL501: \nL502: 【39† Report other inappropriate conduct †javascript:void(0);】 \nL503: \nL504:  Confirm Flag \nL505: \nL506: Unflagging nithinkjoy will restore default visibility to their posts. \nL507: \nL508:  Confirm Unflag \nL509: \nL510: 【1†DEV Community】 — A constructive and inclusive social network for software developers. With you every step of your journey. \nL511: \nL512: * 【1† Home 】 \nL513: * 【40† Podcasts 】 \nL514: * 【41† Videos 】 \nL515: * 【42† Tags 】 \nL516: * 【43† FAQ 】 \nL517: * 【44† Forem Shop †shop.forem.com】 \nL518: * 【45† Advertise on DEV 】 \nL519: * 【46† About 】 \nL520: * 【47† Contact 】 \nL521: * 【48† Guides 】 \nL522: * 【49† Software comparisons 】 \nL523: \nL524: * 【33† Code of Conduct 】 \nL525: * 【50† Privacy Policy 】 \nL526: * 【51† Terms of use 】 \nL527: \nL528: Built on 【52†Forem†www.forem.com】 — the 【53†open source】 software that powers 【54†DEV】 and other inclusive communities.\nL529: \nL530: Made with love and 【55†Ruby on Rails】. DEV Community © 2016 - 2023.\nL531: \nL532: [Image 16: DEV Community] \nL533: \nL534: We're a place where coders share, stay up-to-date and grow their careers. \nL535: \nL536: 【3† Log in 】 【4† Create account 】 \nL537: \nL538:  [Image 17] [Image 18] [Image 19] [Image 20] [Image 21]\nVisible: 0% - 100%","summary":"How to use class-validator and generate custom error object in nest.js - DEV Community (dev.to)\n","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"How to use class-validator and generate custom error object in nest.js - DEV Community","url":"https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h","text":"L0: \nL1: URL: https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h\nL2:   \nL3: \nL4:   Skip to content \nL5: \nL6: Navigation menu   \nL7: \nL8:  Search\nL9: \nL10:  Search  \nL11: \nL12:    Log in    Create account  \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30:  Share to Twitter   Share to LinkedIn   Share to Reddit   Share to Hacker News   Share to Facebook   Share to Mastodon  \nL31: \nL32:  Share Post via...  Report Abuse \nL33: \nL34: [Image 6: Nithin K Joy]\nL35: \nL36: Nithin K Joy \nL37: \nL38: Posted on Jun 6\nL39: \nL40: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL41: \nL42: #  How to use class-validator and generate custom error object in nest.js \nL43: \nL44: # javascript # nest # classvalidator # typescript \nL45: \nL46: ##    Objective \nL47: \nL48: The main objective of this article is showing how to generate custom error object when the validation fails, but we will go through the process of using class-validator and later about generating custom error object.\nL49: \nL50: ##    What is class-validator \nL51: \nL52: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms.\nL53: \nL54: ##    How to use it \nL55: \nL56: In order to use class-validator in nest.js we need to install class-validator and class-transformer.  \nL57: `npm i --save class-validator class-transformer`\nL58: \nL59: To configure, in `main.ts` file we need to invoke `ValidationPipe()` constructor function imported form `@nestjs/common` and pass it as a argument for `app.useGlobalPipes` method.  \nL60: \nL61:     import { NestFactory } from '@nestjs/core';\nL62:     import { AppModule } from './app.module';\nL63:     import { ValidationPipe } from '@nestjs/common';\nL64: \nL65:     async function bootstrap() {\nL66:       const app = await NestFactory.create(AppModule);\nL67:       app.useGlobalPipes(new ValidationPipe({ stopAtFirstError: true }));\nL68:       await app.listen(3500);\nL69:     }\nL70: \nL71:     bootstrap();\nL72: \nL73: Enter fullscreen mode Exit fullscreen mode\nL74: \nL75: `{ stopAtFirstError: true }` is just an optional argument to stop after getting the first error and return it. we can always customize it.\nL76: \nL77: [Image 12: main.ts file]\nL78: \nL79: Let us assume we have a `users` resource. We need a create `create-user.dto.ts` file inside a `dto` folder under `users` resource as in image given below.\nL80: \nL81: [Image 13: create-user.to.ts file location]\nL82: \nL83: Inside `create-user.dto.ts` file add the class validation you need to add. Refer class-validator docs for which validation you need to apply. docs: https://www.npmjs.com/package/class-validator\nL84: \nL85: This is my `create-user.dto.ts` file  \nL86: \nL87:     import {\nL88:       IsNotEmpty,\nL89:       IsString,\nL90:       MinLength,\nL91:       IsAlpha,\nL92:       Matches,\nL93:       IsEnum,\nL94:     } from 'class-validator';\nL95: \nL96:     export enum UserState {\nL97:       ACTIVE = 'Active',\nL98:       IN_ACTIVE = 'Inactive',\nL99:     }\nL100: \nL101:     export class CreateUserDto {\nL102:       @IsNotEmpty()\nL103:       @IsString()\nL104:       @IsAlpha()\nL105:       @MinLength(1)\nL106:       readonly firstName: string;\nL107: \nL108:       @IsNotEmpty()\nL109:       @IsString()\nL110:       readonly lastName: string;\nL111: \nL112:       @IsNotEmpty()\nL113:       @IsString()\nL114:       @IsNotEmpty()\nL115:       @Matches(/^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,3}$/g)\nL116:       readonly email: string;\nL117: \nL118:       @IsNotEmpty()\nL119:       @IsString()\nL120:       @Matches(/^[6789]\\d{9}$/)\nL121:       readonly phoneNumber: string;\nL122: \nL123:       @IsNotEmpty()\nL124:       @IsString()\nL125:       @MinLength(3)\nL126:       readonly companyName: string;\nL127: \nL128:       @IsEnum(UserState)\nL129:       readonly userState: UserState;\nL130:     }\nL131: \nL132: Enter fullscreen mode Exit fullscreen mode\nL133: \nL134: Next import `CreateUserDto` class and use it inside the user controller.  \nL135: \nL136:     import { Controller, Post, Body } from '@nestjs/common';\nL137:     import { UsersService } from './users.service';\nL138:     import { CreateUserDto } from './dto/create-user.dto';\nL139: \nL140:     @Controller('users')\nL141:     export class UsersController {\nL142:       constructor(private readonly usersService: UsersService) {}\nL143: \nL144:       @Post()\nL145:       create(@Body() user: CreateUserDto) {\nL146:         return this.usersService.create(user);\nL147:       }\nL148:     }\nL149: \nL150: Enter fullscreen mode Exit fullscreen mode\nL151: \nL152: After sending request in postman or any other api testing application this will automatically validate and send error message as shown below  \nL153: Request body  \nL154: \nL155:     {\nL156:       \"firstName\":\"\",\nL157:       \"lastName\":\"K Joy\",\nL158:       \"email\":\"Nn@gail.com\",\nL159:       \"phoneNumber\":\"9160000000\",\nL160:       \"companyName\":\"abcgf\",\nL161:       \"userState\":\"Active\"\nL162:     }\nL163: \nL164: Enter fullscreen mode Exit fullscreen mode\nL165: \nL166: Response  \nL167: \nL168:     {\nL169:       \"statusCode\": 400,\nL170:       \"message\": [\nL171:         \"firstName must be longer than or equal to 1 characters\"\nL172:       ],\nL173:       \"error\": \"Bad Request\"\nL174:     }\nL175: \nL176: Enter fullscreen mode Exit fullscreen mode\nL177: \nL178: [Image 14: image of a non customized class-validator]\nL179: \nL180: ##    How to generate custom error message object \nL181: \nL182: But we need to get which property just gave us this error along with the error message. In order to do that we need to configure the `ValidationPipe()` in `main.ts` file with some configurations.  \nL183: \nL184:     import { NestFactory } from '@nestjs/core';\nL185:     import { AppModule } from './app.module';\nL186:     import { ValidationPipe, BadRequestException } from '@nestjs/common';\nL187: \nL188:     async function bootstrap() {\nL189:       const app = await NestFactory.create(AppModule);\nL190:       app.useGlobalPipes(\nL191:         new ValidationPipe({\nL192:           exceptionFactory: (errors) =\u003e {\nL193:             const result = errors.map((error) =\u003e ({\nL194:               property: error.property,\nL195:               message: error.constraints[Object.keys(error.constraints)[0]],\nL196:             }));\nL197:             return new BadRequestException(result);\nL198:           },\nL199:           stopAtFirstError: true,\nL200:         }),\nL201:       );\nL202:       await app.listen(3500);\nL203:     }\nL204: \nL205:     bootstrap();\nL206: \nL207: Enter fullscreen mode Exit fullscreen mode\nL208: \nL209: Let me break down the above code. The object below is the error object.  \nL210: \nL211:     {\nL212:       property: 'firstName',\nL213:       children: [],\nL214:       constraints: {\nL215:         minLength: 'firstName must be longer than or equal to 1 characters'\nL216:       }\nL217:     }\nL218: \nL219: Enter fullscreen mode Exit fullscreen mode\nL220: \nL221: `property: error.property` usage is straight forward.   \nL222: `message` is basically the value inside the the constraints object. But the key for the constraint object (here `minLength`) is not static. The key will be different for different validation failure.\nL223: \nL224: `Object.keys(error.constraints)[0]` Object.keys just changes all object keys to array and we access the first key by `[0]`. \nL225: \nL226: Request body  \nL227: \nL228:     {\nL229:       \"firstName\":\"\",\nL230:       \"lastName\":\"K Joy\",\nL231:       \"email\":\"Nn@gail.com\",\nL232:       \"phoneNumber\":\"9160000000\",\nL233:       \"companyName\":\"abcgf\",\nL234:       \"userState\":\"Active\"\nL235:     }\nL236: \nL237: Enter fullscreen mode Exit fullscreen mode\nL238: \nL239: Response  \nL240: \nL241:     {\nL242:       \"statusCode\": 400,\nL243:       \"message\": [\nL244:         {\nL245:           \"property\": \"firstName\",\nL246:           \"message\": \"firstName must be longer than or equal to 1 characters\"\nL247:         }\nL248:       ],\nL249:       \"error\": \"Bad Request\"\nL250:     }\nL251: \nL252: Enter fullscreen mode Exit fullscreen mode\nL253: \nL254: If you found this helpful, be sure to leave a on the post. Thank you!\nL255: \nL256: ##  Top comments (5)\nL257: \nL258: Subscribe\nL259: \nL260:     [Image 15: pic] \nL261: \nL262: Personal Trusted User\nL263: \nL264:  Create template  \nL265: \nL266: Templates let you quickly answer FAQs or store snippets for re-use.\nL267: \nL268: Submit Preview Dismiss \nL269: \nL270:   Collapse Expand\nL271: \nL272:   \nL273: \nL274:  davistran86  \nL275: \nL276:  davistran86 \nL277: \nL278:  davistran86  \nL279: \nL280: Follow\nL281: \nL282:   * Joined \nL283: \nL284: Mar 27, 2019\nL285: \nL286: •  Aug 11  \nL287: \nL288:  Dropdown menu\nL289: \nL290:   * Copy link\nL291:   *   * Hide \nL292:   *   *   * \nL293: \nL294: Thanks alot, custom error message is what I'm looking for :)\nL295: \nL296:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL297: \nL298: Collapse Expand\nL299: \nL300:   \nL301: \nL302:  Nithin K Joy  \nL303: \nL304:  Nithin K Joy \nL305: \nL306:  Nithin K Joy  \nL307: \nL308: Follow\nL309: \nL310: I am a passionate Node.js, React.js developer who is more focused on developing Scalable FullStack Web Applications. \nL311: \nL312:   * Location \nL313: \nL314: Bangalore \nL315: \nL316:   * Education \nL317: \nL318: NMAM Institute of Technology, Nitte \nL319: \nL320:   * Work \nL321: \nL322: Clover Bay Technologies Pvt Ltd \nL323: \nL324:   * Joined \nL325: \nL326: May 14, 2023\nL327: \nL328: •  Aug 12  \nL329: \nL330:  Dropdown menu\nL331: \nL332:   * Copy link\nL333:   *   * Hide \nL334:   *   *   * \nL335: \nL336: You're welcome\nL337: \nL338:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL339: \nL340: Collapse Expand\nL341: \nL342:   \nL343: \nL344:  mohamed  \nL345: \nL346:  mohamed \nL347: \nL348:  mohamed  \nL349: \nL350: Follow\nL351: \nL352:   * Joined \nL353: \nL354: Aug 23, 2023\nL355: \nL356: •  Aug 23  \nL357: \nL358:  Dropdown menu\nL359: \nL360:   * Copy link\nL361:   *   * Hide \nL362:   *   *   * \nL363: \nL364: i need to custom like this  \nL365: {  \nL366: \"statusCode\": 400,  \nL367: \"message\": \"firstName must be longer than or equal to 1 characters\"  \nL368: }\nL369: \nL370: any idea please\nL371: \nL372:  Like comment:  Like comment:  3 likes Like  Comment button Reply \nL373: \nL374: Collapse Expand\nL375: \nL376:   \nL377: \nL378:  Rafael Rossi  \nL379: \nL380:  Rafael Rossi \nL381: \nL382:  Rafael Rossi  \nL383: \nL384: Follow\nL385: \nL386:   * Joined \nL387: \nL388: Jun 22, 2023\nL389: \nL390: •  Nov 24  \nL391: \nL392:  Dropdown menu\nL393: \nL394:   * Copy link\nL395:   *   * Hide \nL396:   *   *   * \nL397: \nL398: Tks sir\nL399: \nL400:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL401: \nL402: Collapse Expand\nL403: \nL404:   \nL405: \nL406:  mundzirmuin  \nL407: \nL408:  mundzirmuin \nL409: \nL410:  mundzirmuin  \nL411: \nL412: Follow\nL413: \nL414:   * Joined \nL415: \nL416: Aug 10, 2023\nL417: \nL418: •  Aug 19  \nL419: \nL420:  Dropdown menu\nL421: \nL422:   * Copy link\nL423:   *   * Hide \nL424:   *   *   * \nL425: \nL426: This really saves me, thanks!\nL427: \nL428:  Like comment:  Like comment:  Like  Comment button Reply \nL429: \nL430: Code of Conduct • Report abuse \nL431: \nL432: Are you sure you want to hide this comment? It will become hidden in your post, but will still be visible via the comment's permalink. \nL433: \nL434: Hide child comments as well\nL435: \nL436: Confirm \nL437: \nL438: For further actions, you may consider blocking this person and/or reporting abuse\nL439: \nL440: ## Read next\nL441: \nL442:  Tech Talk: React in the Terminal? Hold my Beer Manuel Artero Anguita - Dec 20   Download Best 800+ VST Plugins Collection for Music Production Extraplugins extraplugins - Nov 22   14 tips to write better Javascript Melvinvmegen - Dec 12   The One Thing Every Developer Should Know Brock Chestwall - Dec 18  \nL443: \nL444:  Nithin K Joy  \nL445: \nL446: Follow\nL447: \nL448: I am a passionate Node.js, React.js developer who is more focused on developing Scalable FullStack Web Applications. \nL449: \nL450:   * Location \nL451: \nL452: Bangalore \nL453: \nL454:   * Education \nL455: \nL456: NMAM Institute of Technology, Nitte \nL457: \nL458:   * Work \nL459: \nL460: Clover Bay Technologies Pvt Ltd \nL461: \nL462:   * Joined \nL463: \nL464: May 14, 2023\nL465: \nL466: ###  More from Nithin K Joy \nL467: \nL468:  How to call React Query hooks conditionally! # react # javascript # hooks # reactquery  \nL469: \nL470: Once suspended, nithinkjoy will not be able to comment or publish posts until their suspension is removed. \nL471: \nL472: Note:  \nL473: \nL474:  Submit \u0026 Suspend \nL475: \nL476: Once unsuspended, nithinkjoy will be able to comment and publish posts again. \nL477: \nL478: Note:  \nL479: \nL480:  Submit \u0026 Unsuspend \nL481: \nL482: Once unpublished, all posts by nithinkjoy will become hidden and only accessible to themselves. \nL483: \nL484: If nithinkjoy is not suspended, they can still re-publish their posts from their dashboard. \nL485: \nL486: Note: \nL487: \nL488:  Unpublish all posts \nL489: \nL490: Once unpublished, this post will become invisible to the public and only accessible to Nithin K Joy. \nL491: \nL492: They can still re-publish the post if they are not suspended.\nL493: \nL494:  Unpublish Post \nL495: \nL496: Thanks for keeping DEV Community safe. Here is what you can do to flag nithinkjoy: \nL497: \nL498:  Make all posts by nithinkjoy less visible \nL499: \nL500: nithinkjoy consistently posts content that violates DEV Community's code of conduct because it is harassing, offensive or spammy. \nL501: \nL502:  Report other inappropriate conduct  \nL503: \nL504:  Confirm Flag \nL505: \nL506: Unflagging nithinkjoy will restore default visibility to their posts. \nL507: \nL508:  Confirm Unflag \nL509: \nL510: DEV Community — A constructive and inclusive social network for software developers. With you every step of your journey. \nL511: \nL512: *  Home  \nL513: *  Podcasts  \nL514: *  Videos  \nL515: *  Tags  \nL516: *  FAQ  \nL517: *  Forem Shop  \nL518: *  Advertise on DEV  \nL519: *  About  \nL520: *  Contact  \nL521: *  Guides  \nL522: *  Software comparisons  \nL523: \nL524: *  Code of Conduct  \nL525: *  Privacy Policy  \nL526: *  Terms of use  \nL527: \nL528: Built on Forem — the open source software that powers DEV and other inclusive communities.\nL529: \nL530: Made with love and Ruby on Rails. DEV Community © 2016 - 2023.\nL531: \nL532: [Image 16: DEV Community] \nL533: \nL534: We're a place where coders share, stay up-to-date and grow their careers. \nL535: \nL536:  Log in   Create account  \nL537: \nL538:  [Image 17] [Image 18] [Image 19] [Image 20] [Image 21]\nVisible: 0% - 100%"}]},"command":"click","args":[7],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"fd73d626-e230-4190-8443-f44e4f74398d","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"fd73d626-e230-4190-8443-f44e4f74398d","children":["6bf8eb2b-c717-48a3-b498-f30187a2bc6d"]},"fd73d626-e230-4190-8443-f44e4f74398d":{"id":"fd73d626-e230-4190-8443-f44e4f74398d","message":{"id":"fd73d626-e230-4190-8443-f44e4f74398d","author":{"role":"assistant","metadata":{}},"create_time":1703480183.322245,"content":{"content_type":"code","language":"unknown","text":"click(7)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"83061f03-06af-456f-a695-1731d6f213fc","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"83061f03-06af-456f-a695-1731d6f213fc","children":["330b0eaf-03de-4922-bea8-1a6d942e1dea"]},"83061f03-06af-456f-a695-1731d6f213fc":{"id":"83061f03-06af-456f-a695-1731d6f213fc","message":{"id":"83061f03-06af-456f-a695-1731d6f213fc","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.309356,"content":{"content_type":"tether_browsing_display","result":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Validation | NestJS - A progressive Node.js framework","url":"https://docs.nestjs.com/techniques/validation","text":"\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: "},{"type":"webpage","title":"Custom validation with database in NestJS - DEV Community","url":"https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao","text":"\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: "},{"type":"webpage","title":"Validation - GitHub: Let’s build from here","url":"https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md","text":"\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: "},{"type":"webpage","title":"Injecting request object to a custom validation class in NestJS","url":"https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal","text":"\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: "},{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: "},{"type":"webpage","title":"NestJS and ‘class validator’ cheat sheet - DEV Community","url":"https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao","text":"\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: "},{"type":"webpage","title":"How to implement input validation with NestJS - Sébastien Dubois","url":"https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/","text":"\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: "},{"type":"webpage","title":"How to use class-validator and generate custom error object in nest.js","url":"https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h","text":"\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: "},{"type":"webpage","title":"Building a REST API with NestJS and Prisma: Input Validation ...","url":"https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1","text":"\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: "},{"type":"webpage","title":"NestJS Custom Payload Validation - DEV Community","url":"https://dev.to/shubham_kadam/nestjs-custom-payload-validation-3hh7","text":"\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: "},{"type":"webpage","title":"Mastering Email Validation in NestJS: A Comprehensive Guide","url":"https://emaillistvalidation.com/blog/mastering-email-validation-in-nestjs-a-comprehensive-guide/","text":"\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: "},{"type":"webpage","title":"Custom Card v2 Signature Validation in NestJS - community.hubspot.com","url":"https://community.hubspot.com/t5/APIs-Integrations/Custom-Card-v2-Signature-Validation-in-NestJS/m-p/897350","text":"\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"},{"type":"webpage","title":"Search results for query: 'nestjs class-validator custom validation method documentation'","url":"","text":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"}]},"command":"back","args":[],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"ec87bf06-4149-4177-936a-ac8348a92088","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"ec87bf06-4149-4177-936a-ac8348a92088","children":["fd73d626-e230-4190-8443-f44e4f74398d"]},"ec87bf06-4149-4177-936a-ac8348a92088":{"id":"ec87bf06-4149-4177-936a-ac8348a92088","message":{"id":"ec87bf06-4149-4177-936a-ac8348a92088","author":{"role":"assistant","metadata":{}},"create_time":1703480183.295242,"content":{"content_type":"code","language":"unknown","text":"back()"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"1c5e95d3-96f4-43cb-9ad6-f659d9f36f64","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"1c5e95d3-96f4-43cb-9ad6-f659d9f36f64","children":["83061f03-06af-456f-a695-1731d6f213fc"]},"1c5e95d3-96f4-43cb-9ad6-f659d9f36f64":{"id":"1c5e95d3-96f4-43cb-9ad6-f659d9f36f64","message":{"id":"1c5e95d3-96f4-43cb-9ad6-f659d9f36f64","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.281676,"content":{"content_type":"tether_browsing_display","result":"L0: \nL1: URL: https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m\nL2:   \nL3: \nL4:   【0†Skip to content】 \nL5: \nL6: Navigation menu 【1† 】 \nL7: \nL8:  Search\nL9: \nL10: 【2† Search 】 \nL11: \nL12:   【3† Log in 】  【4† Create account 】 \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30: 【5† Share to Twitter †twitter.com】 【6† Share to LinkedIn †www.linkedin.com】 【7† Share to Reddit †www.reddit.com】 【8† Share to Hacker News †news.ycombinator.com】 【9† Share to Facebook †www.facebook.com】 【10† Share to Mastodon †toot.kytta.dev】 \nL31: \nL32:  Share Post via...  【11†Report Abuse】 \nL33: \nL34: [Image 6: Vishnu C Prasad]\nL35: \nL36: 【12†Vishnu C Prasad】 \nL37: \nL38: Posted on Aug 15 • Originally published at 【13†vishnucprasad.Medium†vishnucprasad.medium.com】 \nL39: \nL40: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL41: \nL42: #  Simple Data Validation in NestJS: A Practical Guide \nL43: \nL44: 【14†# nestjs】 【15†# passportjs】 【16†# node】 【17†# typescript】 \nL45: \nL46: [Image 12: NestJS Data Validation]\nL47: \nL48: In modern web applications, data validation plays a crucial role in ensuring the integrity and security of the information being processed. NestJS, a popular Node.js framework, provides a robust and easy-to-use mechanism for data validation, making it easier for developers to handle incoming data and prevent common vulnerabilities like injection attacks or invalid inputs. In this article, we will explore the basics of data validation in NestJS, complete with code examples to illustrate the concepts.\nL49: \nL50: ###  【18† 】 Why Data Validation Matters \nL51: \nL52: Data validation involves checking whether input data conforms to predefined rules or patterns before processing it further. This step helps prevent incorrect or malicious data from compromising the application’s functionality or security. In the context of a NestJS application, proper data validation can help mitigate risks such as:\nL53: \nL54:   1. Injection Attacks: By validating and sanitizing input data, you can prevent SQL injection, NoSQL injection, and other types of code injection attacks.\nL55: \nL56:   2. Invalid Inputs: Avoid errors and exceptions resulting from unexpected data types or formats.\nL57: \nL58:   3. Data Integrity: Ensure that the data being processed adheres to the expected structure and rules, preventing inconsistencies.\nL59: \nL60: ###  【19† 】 Using class-validator with NestJS \nL61: \nL62: NestJS seamlessly integrates with the class-validator library, which provides decorators and utilities for validating data using class-based validation rules. To get started, let's assume we're building an API endpoint to create users. We want to validate the incoming data, such as the user's name and email, before saving it to the database.\nL63: \nL64: ####  【20† 】 Step 1: Install Dependencies \nL65: \nL66: First, create a new NestJS application or navigate to your existing project directory and install the required packages:  \nL67: \nL68:     npm install --save class-validator\nL69: \nL70: Enter fullscreen mode Exit fullscreen mode\nL71: \nL72: ####  【21† 】 Step 2: Create a DTO (Data Transfer Object) \nL73: \nL74: In NestJS, DTOs are used to define the shape of the incoming data and its validation rules. Let’s create a CreateUserDto class to represent the data expected when creating a new user:  \nL75: \nL76:     // src/users/dto/create-user.dto.ts\nL77: \nL78:     import { IsNotEmpty, IsEmail } from 'class-validator';\nL79: \nL80:     export class CreateUserDto {\nL81:       @IsNotEmpty()\nL82:       name: string;\nL83: \nL84:       @IsNotEmpty()\nL85:       @IsEmail()\nL86:       email: string;\nL87:     }\nL88: \nL89: Enter fullscreen mode Exit fullscreen mode\nL90: \nL91: In the CreateUserDto class, we've used the @IsNotEmpty() and @IsEmail() decorators from the class-validator library to specify that the name and email fields should not be empty and the email should be a valid email address.\nL92: \nL93: ####  【22† 】 Step 3: Create the Controller \nL94: \nL95: Now, let’s create a controller to handle the incoming requests and validate the data using the CreateUserDto class:  \nL96: \nL97:     // src/users/users.controller.ts\nL98: \nL99:     import { Controller, Post, Body } from '@nestjs/common';\nL100:     import { CreateUserDto } from './dto/create-user.dto';\nL101: \nL102:     @Controller('users')\nL103:     export class UsersController {\nL104:       @Post()\nL105:       async createUser(@Body() dto: CreateUserDto) {\nL106:         // At this point, \"dto\" has already been validated\nL107:         // You can now proceed with processing and saving the user data\nL108:         return 'User created successfully';\nL109:       }\nL110:     }\nL111: \nL112: Enter fullscreen mode Exit fullscreen mode\nL113: \nL114: In the createUser method of the UsersController, the @Body() decorator automatically maps the incoming request body to the createUserDto object and validates it according to the rules defined in the DTO.\nL115: \nL116: ####  【23† 】 Step 4: Enable Validation Globally \nL117: \nL118: By default, NestJS won’t perform automatic validation for DTOs unless you enable it. You can enable global validation by modifying your main.ts file:  \nL119: \nL120:     // src/main.ts\nL121: \nL122:     import { ValidationPipe } from '@nestjs/common';\nL123:     import { NestFactory } from '@nestjs/core';\nL124:     import { AppModule } from './app.module';\nL125: \nL126:     async function bootstrap() {\nL127:       const app = await NestFactory.create(AppModule);\nL128: \nL129:       // Enable global validation pipe\nL130:       app.useGlobalPipes(new ValidationPipe());\nL131: \nL132:       await app.listen(3000);\nL133:     }\nL134:     bootstrap();\nL135: \nL136: Enter fullscreen mode Exit fullscreen mode\nL137: \nL138: With this setup, the ValidationPipe will automatically validate incoming data using the DTO's validation rules for all routes.\nL139: \nL140: ###  【24† 】 Conclusion \nL141: \nL142: Data validation is a crucial aspect of building secure and reliable applications. NestJS, combined with the class-validator library, provides an elegant way to validate incoming data using decorators and class-based validation rules. By creating DTOs and enabling global validation, you can ensure that your NestJS application processes only valid and safe data, reducing the risk of vulnerabilities and errors.\nL143: \nL144: Remember that while this article covers the basics of data validation, more advanced scenarios might require additional validation techniques and error handling. Always tailor your validation strategies to your specific application’s needs and security requirements.\nL145: \nL146: ##  Top comments (0)\nL147: \nL148: Subscribe\nL149: \nL150:     [Image 13: pic] \nL151: \nL152: Personal Trusted User\nL153: \nL154: 【25† Create template 】 \nL155: \nL156: Templates let you quickly answer FAQs or store snippets for re-use.\nL157: \nL158: Submit Preview 【26†Dismiss】 \nL159: \nL160: 【27†Code of Conduct】 • 【11†Report abuse】 \nL161: \nL162: Are you sure you want to hide this comment? It will become hidden in your post, but will still be visible via the comment's permalink. \nL163: \nL164: Hide child comments as well\nL165: \nL166: Confirm \nL167: \nL168: For further actions, you may consider blocking this person and/or 【11†reporting abuse】\nL169: \nL170: ## Read next\nL171: \nL172: 【28† Build a full stack app with Rust, Next.js and Docker Francesco Ciulla - Dec 19 】 【29† Angular Addicts #20: unit testing the new defer blocks, NGRX Signal store extensions, app architectures \u0026 more Gergely Szerovay - Dec 12 】 【30† Tech Talk: React in the Terminal? Hold my Beer Manuel Artero Anguita - Dec 20 】 【31† How to know node vs react versions compatibility? suresh - Nov 17 】 \nL173: \nL174: 【12† Vishnu C Prasad 】 \nL175: \nL176: Follow\nL177: \nL178: Pragmatic and Ambitious developer with extensive expertise in app development and web development. \nL179: \nL180:   * Work \nL181: \nL182: Flutter \u0026 Nest JS Developer \nL183: \nL184:   * Joined \nL185: \nL186: Jan 3, 2023\nL187: \nL188: ###  More from 【12†Vishnu C Prasad】 \nL189: \nL190: 【32† Implementing the CQRS Pattern in NestJS with a Note API Example # nestjs # cqrs # node # typescript 】 【33† Establishing PostgreSQL Connection with TypeORM in NestJS # nestjs # typeorm # postgres # node 】 【34† Passport JWT Authentication in NestJS # nestjs # passportjs # jwt # node 】 \nL191: \nL192: Once suspended, vishnucprasad will not be able to comment or publish posts until their suspension is removed. \nL193: \nL194: Note:  \nL195: \nL196:  Submit \u0026 Suspend \nL197: \nL198: Once unsuspended, vishnucprasad will be able to comment and publish posts again. \nL199: \nL200: Note:  \nL201: \nL202:  Submit \u0026 Unsuspend \nL203: \nL204: Once unpublished, all posts by vishnucprasad will become hidden and only accessible to themselves. \nL205: \nL206: If vishnucprasad is not suspended, they can still re-publish their posts from their dashboard. \nL207: \nL208: Note: \nL209: \nL210:  Unpublish all posts \nL211: \nL212: Once unpublished, this post will become invisible to the public and only accessible to Vishnu C Prasad. \nL213: \nL214: They can still re-publish the post if they are not suspended.\nL215: \nL216:  Unpublish Post \nL217: \nL218: Thanks for keeping DEV Community safe. Here is what you can do to flag vishnucprasad: \nL219: \nL220:  Make all posts by vishnucprasad less visible \nL221: \nL222: vishnucprasad consistently posts content that violates DEV Community's code of conduct because it is harassing, offensive or spammy. \nL223: \nL224: 【35† Report other inappropriate conduct †javascript:void(0);】 \nL225: \nL226:  Confirm Flag \nL227: \nL228: Unflagging vishnucprasad will restore default visibility to their posts. \nL229: \nL230:  Confirm Unflag \nL231: \nL232: 【1†DEV Community】 — A constructive and inclusive social network for software developers. With you every step of your journey. \nL233: \nL234: * 【1† Home 】 \nL235: * 【36† Podcasts 】 \nL236: * 【37† Videos 】 \nL237: * 【38† Tags 】 \nL238: * 【39† FAQ 】 \nL239: * 【40† Forem Shop †shop.forem.com】 \nL240: * 【41† Advertise on DEV 】 \nL241: * 【42† About 】 \nL242: * 【43† Contact 】 \nL243: * 【44† Guides 】 \nL244: * 【45† Software comparisons 】 \nL245: \nL246: * 【27† Code of Conduct 】 \nL247: * 【46† Privacy Policy 】 \nL248: * 【47† Terms of use 】 \nL249: \nL250: Built on 【48†Forem†www.forem.com】 — the 【49†open source】 software that powers 【50†DEV】 and other inclusive communities.\nL251: \nL252: Made with love and 【51†Ruby on Rails】. DEV Community © 2016 - 2023.\nL253: \nL254: [Image 14: DEV Community] \nL255: \nL256: We're a place where coders share, stay up-to-date and grow their careers. \nL257: \nL258: 【3† Log in 】 【4† Create account 】 \nL259: \nL260:  [Image 15] [Image 16] [Image 17] [Image 18] [Image 19]\nVisible: 0% - 100%","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide - DEV Community","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"L0: \nL1: URL: https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m\nL2:   \nL3: \nL4:   Skip to content \nL5: \nL6: Navigation menu   \nL7: \nL8:  Search\nL9: \nL10:  Search  \nL11: \nL12:    Log in    Create account  \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30:  Share to Twitter   Share to LinkedIn   Share to Reddit   Share to Hacker News   Share to Facebook   Share to Mastodon  \nL31: \nL32:  Share Post via...  Report Abuse \nL33: \nL34: [Image 6: Vishnu C Prasad]\nL35: \nL36: Vishnu C Prasad \nL37: \nL38: Posted on Aug 15 • Originally published at vishnucprasad.Medium \nL39: \nL40: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL41: \nL42: #  Simple Data Validation in NestJS: A Practical Guide \nL43: \nL44: # nestjs # passportjs # node # typescript \nL45: \nL46: [Image 12: NestJS Data Validation]\nL47: \nL48: In modern web applications, data validation plays a crucial role in ensuring the integrity and security of the information being processed. NestJS, a popular Node.js framework, provides a robust and easy-to-use mechanism for data validation, making it easier for developers to handle incoming data and prevent common vulnerabilities like injection attacks or invalid inputs. In this article, we will explore the basics of data validation in NestJS, complete with code examples to illustrate the concepts.\nL49: \nL50: ###    Why Data Validation Matters \nL51: \nL52: Data validation involves checking whether input data conforms to predefined rules or patterns before processing it further. This step helps prevent incorrect or malicious data from compromising the application’s functionality or security. In the context of a NestJS application, proper data validation can help mitigate risks such as:\nL53: \nL54:   1. Injection Attacks: By validating and sanitizing input data, you can prevent SQL injection, NoSQL injection, and other types of code injection attacks.\nL55: \nL56:   2. Invalid Inputs: Avoid errors and exceptions resulting from unexpected data types or formats.\nL57: \nL58:   3. Data Integrity: Ensure that the data being processed adheres to the expected structure and rules, preventing inconsistencies.\nL59: \nL60: ###    Using class-validator with NestJS \nL61: \nL62: NestJS seamlessly integrates with the class-validator library, which provides decorators and utilities for validating data using class-based validation rules. To get started, let's assume we're building an API endpoint to create users. We want to validate the incoming data, such as the user's name and email, before saving it to the database.\nL63: \nL64: ####    Step 1: Install Dependencies \nL65: \nL66: First, create a new NestJS application or navigate to your existing project directory and install the required packages:  \nL67: \nL68:     npm install --save class-validator\nL69: \nL70: Enter fullscreen mode Exit fullscreen mode\nL71: \nL72: ####    Step 2: Create a DTO (Data Transfer Object) \nL73: \nL74: In NestJS, DTOs are used to define the shape of the incoming data and its validation rules. Let’s create a CreateUserDto class to represent the data expected when creating a new user:  \nL75: \nL76:     // src/users/dto/create-user.dto.ts\nL77: \nL78:     import { IsNotEmpty, IsEmail } from 'class-validator';\nL79: \nL80:     export class CreateUserDto {\nL81:       @IsNotEmpty()\nL82:       name: string;\nL83: \nL84:       @IsNotEmpty()\nL85:       @IsEmail()\nL86:       email: string;\nL87:     }\nL88: \nL89: Enter fullscreen mode Exit fullscreen mode\nL90: \nL91: In the CreateUserDto class, we've used the @IsNotEmpty() and @IsEmail() decorators from the class-validator library to specify that the name and email fields should not be empty and the email should be a valid email address.\nL92: \nL93: ####    Step 3: Create the Controller \nL94: \nL95: Now, let’s create a controller to handle the incoming requests and validate the data using the CreateUserDto class:  \nL96: \nL97:     // src/users/users.controller.ts\nL98: \nL99:     import { Controller, Post, Body } from '@nestjs/common';\nL100:     import { CreateUserDto } from './dto/create-user.dto';\nL101: \nL102:     @Controller('users')\nL103:     export class UsersController {\nL104:       @Post()\nL105:       async createUser(@Body() dto: CreateUserDto) {\nL106:         // At this point, \"dto\" has already been validated\nL107:         // You can now proceed with processing and saving the user data\nL108:         return 'User created successfully';\nL109:       }\nL110:     }\nL111: \nL112: Enter fullscreen mode Exit fullscreen mode\nL113: \nL114: In the createUser method of the UsersController, the @Body() decorator automatically maps the incoming request body to the createUserDto object and validates it according to the rules defined in the DTO.\nL115: \nL116: ####    Step 4: Enable Validation Globally \nL117: \nL118: By default, NestJS won’t perform automatic validation for DTOs unless you enable it. You can enable global validation by modifying your main.ts file:  \nL119: \nL120:     // src/main.ts\nL121: \nL122:     import { ValidationPipe } from '@nestjs/common';\nL123:     import { NestFactory } from '@nestjs/core';\nL124:     import { AppModule } from './app.module';\nL125: \nL126:     async function bootstrap() {\nL127:       const app = await NestFactory.create(AppModule);\nL128: \nL129:       // Enable global validation pipe\nL130:       app.useGlobalPipes(new ValidationPipe());\nL131: \nL132:       await app.listen(3000);\nL133:     }\nL134:     bootstrap();\nL135: \nL136: Enter fullscreen mode Exit fullscreen mode\nL137: \nL138: With this setup, the ValidationPipe will automatically validate incoming data using the DTO's validation rules for all routes.\nL139: \nL140: ###    Conclusion \nL141: \nL142: Data validation is a crucial aspect of building secure and reliable applications. NestJS, combined with the class-validator library, provides an elegant way to validate incoming data using decorators and class-based validation rules. By creating DTOs and enabling global validation, you can ensure that your NestJS application processes only valid and safe data, reducing the risk of vulnerabilities and errors.\nL143: \nL144: Remember that while this article covers the basics of data validation, more advanced scenarios might require additional validation techniques and error handling. Always tailor your validation strategies to your specific application’s needs and security requirements.\nL145: \nL146: ##  Top comments (0)\nL147: \nL148: Subscribe\nL149: \nL150:     [Image 13: pic] \nL151: \nL152: Personal Trusted User\nL153: \nL154:  Create template  \nL155: \nL156: Templates let you quickly answer FAQs or store snippets for re-use.\nL157: \nL158: Submit Preview Dismiss \nL159: \nL160: Code of Conduct • Report abuse \nL161: \nL162: Are you sure you want to hide this comment? It will become hidden in your post, but will still be visible via the comment's permalink. \nL163: \nL164: Hide child comments as well\nL165: \nL166: Confirm \nL167: \nL168: For further actions, you may consider blocking this person and/or reporting abuse\nL169: \nL170: ## Read next\nL171: \nL172:  Build a full stack app with Rust, Next.js and Docker Francesco Ciulla - Dec 19   Angular Addicts #20: unit testing the new defer blocks, NGRX Signal store extensions, app architectures \u0026 more Gergely Szerovay - Dec 12   Tech Talk: React in the Terminal? Hold my Beer Manuel Artero Anguita - Dec 20   How to know node vs react versions compatibility? suresh - Nov 17  \nL173: \nL174:  Vishnu C Prasad  \nL175: \nL176: Follow\nL177: \nL178: Pragmatic and Ambitious developer with extensive expertise in app development and web development. \nL179: \nL180:   * Work \nL181: \nL182: Flutter \u0026 Nest JS Developer \nL183: \nL184:   * Joined \nL185: \nL186: Jan 3, 2023\nL187: \nL188: ###  More from Vishnu C Prasad \nL189: \nL190:  Implementing the CQRS Pattern in NestJS with a Note API Example # nestjs # cqrs # node # typescript   Establishing PostgreSQL Connection with TypeORM in NestJS # nestjs # typeorm # postgres # node   Passport JWT Authentication in NestJS # nestjs # passportjs # jwt # node  \nL191: \nL192: Once suspended, vishnucprasad will not be able to comment or publish posts until their suspension is removed. \nL193: \nL194: Note:  \nL195: \nL196:  Submit \u0026 Suspend \nL197: \nL198: Once unsuspended, vishnucprasad will be able to comment and publish posts again. \nL199: \nL200: Note:  \nL201: \nL202:  Submit \u0026 Unsuspend \nL203: \nL204: Once unpublished, all posts by vishnucprasad will become hidden and only accessible to themselves. \nL205: \nL206: If vishnucprasad is not suspended, they can still re-publish their posts from their dashboard. \nL207: \nL208: Note: \nL209: \nL210:  Unpublish all posts \nL211: \nL212: Once unpublished, this post will become invisible to the public and only accessible to Vishnu C Prasad. \nL213: \nL214: They can still re-publish the post if they are not suspended.\nL215: \nL216:  Unpublish Post \nL217: \nL218: Thanks for keeping DEV Community safe. Here is what you can do to flag vishnucprasad: \nL219: \nL220:  Make all posts by vishnucprasad less visible \nL221: \nL222: vishnucprasad consistently posts content that violates DEV Community's code of conduct because it is harassing, offensive or spammy. \nL223: \nL224:  Report other inappropriate conduct  \nL225: \nL226:  Confirm Flag \nL227: \nL228: Unflagging vishnucprasad will restore default visibility to their posts. \nL229: \nL230:  Confirm Unflag \nL231: \nL232: DEV Community — A constructive and inclusive social network for software developers. With you every step of your journey. \nL233: \nL234: *  Home  \nL235: *  Podcasts  \nL236: *  Videos  \nL237: *  Tags  \nL238: *  FAQ  \nL239: *  Forem Shop  \nL240: *  Advertise on DEV  \nL241: *  About  \nL242: *  Contact  \nL243: *  Guides  \nL244: *  Software comparisons  \nL245: \nL246: *  Code of Conduct  \nL247: *  Privacy Policy  \nL248: *  Terms of use  \nL249: \nL250: Built on Forem — the open source software that powers DEV and other inclusive communities.\nL251: \nL252: Made with love and Ruby on Rails. DEV Community © 2016 - 2023.\nL253: \nL254: [Image 14: DEV Community] \nL255: \nL256: We're a place where coders share, stay up-to-date and grow their careers. \nL257: \nL258:  Log in   Create account  \nL259: \nL260:  [Image 15] [Image 16] [Image 17] [Image 18] [Image 19]\nVisible: 0% - 100%"}]},"command":"scroll","args":[3],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"fddb10a2-d22b-4598-baf5-5f1109b22ccf","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"fddb10a2-d22b-4598-baf5-5f1109b22ccf","children":["ec87bf06-4149-4177-936a-ac8348a92088"]},"fddb10a2-d22b-4598-baf5-5f1109b22ccf":{"id":"fddb10a2-d22b-4598-baf5-5f1109b22ccf","message":{"id":"fddb10a2-d22b-4598-baf5-5f1109b22ccf","author":{"role":"assistant","metadata":{}},"create_time":1703480183.267101,"content":{"content_type":"code","language":"unknown","text":"scroll(3)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"a4f0184b-a826-484a-a54a-78465cdb0067","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"a4f0184b-a826-484a-a54a-78465cdb0067","children":["1c5e95d3-96f4-43cb-9ad6-f659d9f36f64"]},"a4f0184b-a826-484a-a54a-78465cdb0067":{"id":"a4f0184b-a826-484a-a54a-78465cdb0067","message":{"id":"a4f0184b-a826-484a-a54a-78465cdb0067","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.254792,"content":{"content_type":"tether_browsing_display","result":"L0: \nL1: URL: https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m\nL2:   \nL3: \nL4:   【0†Skip to content】 \nL5: \nL6: Navigation menu 【1† 】 \nL7: \nL8:  Search\nL9: \nL10: 【2† Search 】 \nL11: \nL12:   【3† Log in 】  【4† Create account 】 \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30: 【5† Share to Twitter †twitter.com】 【6† Share to LinkedIn †www.linkedin.com】 【7† Share to Reddit †www.reddit.com】 【8† Share to Hacker News †news.ycombinator.com】 【9† Share to Facebook †www.facebook.com】 【10† Share to Mastodon †toot.kytta.dev】 \nL31: \nL32:  Share Post via...  【11†Report Abuse】 \nL33: \nL34: [Image 6: Vishnu C Prasad]\nL35: \nL36: 【12†Vishnu C Prasad】 \nL37: \nL38: Posted on Aug 15 • Originally published at 【13†vishnucprasad.Medium†vishnucprasad.medium.com】 \nL39: \nL40: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL41: \nL42: #  Simple Data Validation in NestJS: A Practical Guide \nL43: \nL44: 【14†# nestjs】 【15†# passportjs】 【16†# node】 【17†# typescript】 \nL45: \nL46: [Image 12: NestJS Data Validation]\nL47: \nL48: In modern web applications, data validation plays a crucial role in ensuring the integrity and security of the information being processed. NestJS, a popular Node.js framework, provides a robust and easy-to-use mechanism for data validation, making it easier for developers to handle incoming data and prevent common vulnerabilities like injection attacks or invalid inputs. In this article, we will explore the basics of data validation in NestJS, complete with code examples to illustrate the concepts.\nL49: \nL50: ###  【18† 】 Why Data Validation Matters \nL51: \nL52: Data validation involves checking whether input data conforms to predefined rules or patterns before processing it further. This step helps prevent incorrect or malicious data from compromising the application’s functionality or security. In the context of a NestJS application, proper data validation can help mitigate risks such as:\nL53: \nL54:   1. Injection Attacks: By validating and sanitizing input data, you can prevent SQL injection, NoSQL injection, and other types of code injection attacks.\nL55: \nL56:   2. Invalid Inputs: Avoid errors and exceptions resulting from unexpected data types or formats.\nL57: \nL58:   3. Data Integrity: Ensure that the data being processed adheres to the expected structure and rules, preventing inconsistencies.\nL59: \nL60: ###  【19† 】 Using class-validator with NestJS \nL61: \nL62: NestJS seamlessly integrates with the class-validator library, which provides decorators and utilities for validating data using class-based validation rules. To get started, let's assume we're building an API endpoint to create users. We want to validate the incoming data, such as the user's name and email, before saving it to the database.\nL63: \nL64: ####  【20† 】 Step 1: Install Dependencies \nL65: \nL66: First, create a new NestJS application or navigate to your existing project directory and install the required packages:  \nL67: \nL68:     npm install --save class-validator\nL69: \nL70: Enter fullscreen mode Exit fullscreen mode\nL71: \nL72: ####  【21† 】 Step 2: Create a DTO (Data Transfer Object) \nL73: \nL74: In NestJS, DTOs are used to define the shape of the incoming data and its validation rules. Let’s create a CreateUserDto class to represent the data expected when creating a new user:  \nL75: \nL76:     // src/users/dto/create-user.dto.ts\nL77: \nL78:     import { IsNotEmpty, IsEmail } from 'class-validator';\nL79: \nL80:     export class CreateUserDto {\nL81:       @IsNotEmpty()\nL82:       name: string;\nL83: \nL84:       @IsNotEmpty()\nL85:       @IsEmail()\nL86:       email: string;\nL87:     }\nL88: \nL89: Enter fullscreen mode Exit fullscreen mode\nL90: \nL91: In the CreateUserDto class, we've used the @IsNotEmpty() and @IsEmail() decorators from the class-validator library to specify that the name and email fields should not be empty and the email should be a valid email address.\nL92: \nL93: ####  【22† 】 Step 3: Create the Controller \nL94: \nL95: Now, let’s create a controller to handle the incoming requests and validate the data using the CreateUserDto class:  \nL96: \nL97:     // src/users/users.controller.ts\nL98: \nL99:     import { Controller, Post, Body } from '@nestjs/common';\nL100:     import { CreateUserDto } from './dto/create-user.dto';\nL101: \nL102:     @Controller('users')\nL103:     export class UsersController {\nL104:       @Post()\nL105:       async createUser(@Body() dto: CreateUserDto) {\nL106:         // At this point, \"dto\" has already been validated\nL107:         // You can now proceed with processing and saving the user data\nL108:         return 'User created successfully';\nL109:       }\nL110:     }\nL111: \nL112: Enter fullscreen mode Exit fullscreen mode\nL113: \nL114: In the createUser method of the UsersController, the @Body() decorator automatically maps the incoming request body to the createUserDto object and validates it according to the rules defined in the DTO.\nL115: \nL116: ####  【23† 】 Step 4: Enable Validation Globally \nL117: \nL118: By default, NestJS won’t perform automatic validation for DTOs unless you enable it. You can enable global validation by modifying your main.ts file:  \nL119: \nL120:     // src/main.ts\nL121: \nL122:     import { ValidationPipe } from '@nestjs/common';\nL123:     import { NestFactory } from '@nestjs/core';\nL124:     import { AppModule } from './app.module';\nL125: \nL126:     async function bootstrap() {\nL127:       const app = await NestFactory.create(AppModule);\nL128: \nL129:       // Enable global validation pipe\nL130:       app.useGlobalPipes(new ValidationPipe());\nL131: \nL132:       await app.listen(3000);\nL133:     }\nL134:     bootstrap();\nL135: \nL136: Enter fullscreen mode Exit fullscreen mode\nL137: \nL138: With this setup, the ValidationPipe will automatically validate incoming data using the DTO's validation rules for all routes.\nL139: \nL140: ###  【24† 】 Conclusion \nL141: \nL142: Data validation is a crucial aspect of building secure and reliable applications. NestJS, combined with the class-validator library, provides an elegant way to validate incoming data using decorators and class-based validation rules. By creating DTOs and enabling global validation, you can ensure that your NestJS application processes only valid and safe data, reducing the risk of vulnerabilities and errors.\nL143: \nL144: Remember that while this article covers the basics of data validation, more advanced scenarios might require additional validation techniques and error handling. Always tailor your validation strategies to your specific application’s needs and security requirements.\nL145: \nL146: ##  Top comments (0)\nL147: \nL148: Subscribe\nL149: \nL150:     [Image 13: pic] \nL151: \nL152: Personal Trusted User\nL153: \nL154: 【25† Create template 】 \nL155: \nL156: Templates let you quickly answer FAQs or store snippets for re-use.\nL157: \nL158: Submit Preview 【26†Dismiss】 \nL159: \nL160: 【27†Code of Conduct】 • 【11†Report abuse】 \nL161: \nL162: Are you sure you want to hide this comment? It will become hidden in your post, but will still be visible via the comment's permalink. \nL163: \nL164: Hide child comments as well\nL165: \nL166: Confirm \nL167: \nL168: For further actions, you may consider blocking this person and/or 【11†reporting abuse】\nL169: \nL170: ## Read next\nL171: \nL172: 【28† Build a full stack app with Rust, Next.js and Docker Francesco Ciulla - Dec 19 】 【29† Angular Addicts #20: unit testing the new defer blocks, NGRX Signal store extensions, app architectures \u0026 more Gergely Szerovay - Dec 12 】 【30† Tech Talk: React in the Terminal? Hold my Beer Manuel Artero Anguita - Dec 20 】 【31† How to know node vs react versions compatibility? suresh - Nov 17 】 \nL173: \nL174: 【12† Vishnu C Prasad 】 \nL175: \nL176: Follow\nL177: \nL178: Pragmatic and Ambitious developer with extensive expertise in app development and web development. \nL179: \nL180:   * Work \nL181: \nL182: Flutter \u0026 Nest JS Developer \nL183: \nL184:   * Joined \nL185: \nL186: Jan 3, 2023\nL187: \nL188: ###  More from 【12†Vishnu C Prasad】 \nL189: \nL190: 【32† Implementing the CQRS Pattern in NestJS with a Note API Example # nestjs # cqrs # node # typescript 】 【33† Establishing PostgreSQL Connection with TypeORM in NestJS # nestjs # typeorm # postgres # node 】 【34† Passport JWT Authentication in NestJS # nestjs # passportjs # jwt # node 】 \nL191: \nL192: Once suspended, vishnucprasad will not be able to comment or publish posts until their suspension is removed. \nL193: \nL194: Note:  \nL195: \nL196:  Submit \u0026 Suspend \nL197: \nL198: Once unsuspended, vishnucprasad will be able to comment and publish posts again. \nL199: \nL200: Note:  \nL201: \nL202:  Submit \u0026 Unsuspend \nL203: \nL204: Once unpublished, all posts by vishnucprasad will become hidden and only accessible to themselves. \nL205: \nL206: If vishnucprasad is not suspended, they can still re-publish their posts from their dashboard. \nL207: \nL208: Note: \nL209: \nL210:  Unpublish all posts \nL211: \nL212: Once unpublished, this post will become invisible to the public and only accessible to Vishnu C Prasad. \nL213: \nL214: They can still re-publish the post if they are not suspended.\nL215: \nL216:  Unpublish Post \nL217: \nL218: Thanks for keeping DEV Community safe. Here is what you can do to flag vishnucprasad: \nL219: \nL220:  Make all posts by vishnucprasad less visible \nL221: \nL222: vishnucprasad consistently posts content that violates DEV Community's code of conduct because it is harassing, offensive or spammy. \nL223: \nL224: 【35† Report other inappropriate conduct †javascript:void(0);】 \nL225: \nL226:  Confirm Flag \nL227: \nL228: Unflagging vishnucprasad will restore default visibility to their posts. \nL229: \nL230:  Confirm Unflag \nL231: \nL232: 【1†DEV Community】 — A constructive and inclusive social network for software developers. With you every step of your journey. \nL233: \nL234: * 【1† Home 】 \nL235: * 【36† Podcasts 】 \nL236: * 【37† Videos 】 \nL237: * 【38† Tags 】 \nL238: * 【39† FAQ 】 \nL239: * 【40† Forem Shop †shop.forem.com】 \nL240: * 【41† Advertise on DEV 】 \nL241: * 【42† About 】 \nL242: * 【43† Contact 】 \nL243: * 【44† Guides 】 \nL244: * 【45† Software comparisons 】 \nL245: \nL246: * 【27† Code of Conduct 】 \nL247: * 【46† Privacy Policy 】 \nL248: * 【47† Terms of use 】 \nL249: \nL250: Built on 【48†Forem†www.forem.com】 — the 【49†open source】 software that powers 【50†DEV】 and other inclusive communities.\nL251: \nL252: Made with love and 【51†Ruby on Rails】. DEV Community © 2016 - 2023.\nL253: \nL254: [Image 14: DEV Community] \nL255: \nL256: We're a place where coders share, stay up-to-date and grow their careers. \nL257: \nL258: 【3† Log in 】 【4† Create account 】 \nL259: \nL260:  [Image 15] [Image 16] [Image 17] [Image 18] [Image 19]\nVisible: 0% - 100%","summary":"Simple Data Validation in NestJS: A Practical Guide - DEV Community (dev.to)\n","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide - DEV Community","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"L0: \nL1: URL: https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m\nL2:   \nL3: \nL4:   Skip to content \nL5: \nL6: Navigation menu   \nL7: \nL8:  Search\nL9: \nL10:  Search  \nL11: \nL12:    Log in    Create account  \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30:  Share to Twitter   Share to LinkedIn   Share to Reddit   Share to Hacker News   Share to Facebook   Share to Mastodon  \nL31: \nL32:  Share Post via...  Report Abuse \nL33: \nL34: [Image 6: Vishnu C Prasad]\nL35: \nL36: Vishnu C Prasad \nL37: \nL38: Posted on Aug 15 • Originally published at vishnucprasad.Medium \nL39: \nL40: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL41: \nL42: #  Simple Data Validation in NestJS: A Practical Guide \nL43: \nL44: # nestjs # passportjs # node # typescript \nL45: \nL46: [Image 12: NestJS Data Validation]\nL47: \nL48: In modern web applications, data validation plays a crucial role in ensuring the integrity and security of the information being processed. NestJS, a popular Node.js framework, provides a robust and easy-to-use mechanism for data validation, making it easier for developers to handle incoming data and prevent common vulnerabilities like injection attacks or invalid inputs. In this article, we will explore the basics of data validation in NestJS, complete with code examples to illustrate the concepts.\nL49: \nL50: ###    Why Data Validation Matters \nL51: \nL52: Data validation involves checking whether input data conforms to predefined rules or patterns before processing it further. This step helps prevent incorrect or malicious data from compromising the application’s functionality or security. In the context of a NestJS application, proper data validation can help mitigate risks such as:\nL53: \nL54:   1. Injection Attacks: By validating and sanitizing input data, you can prevent SQL injection, NoSQL injection, and other types of code injection attacks.\nL55: \nL56:   2. Invalid Inputs: Avoid errors and exceptions resulting from unexpected data types or formats.\nL57: \nL58:   3. Data Integrity: Ensure that the data being processed adheres to the expected structure and rules, preventing inconsistencies.\nL59: \nL60: ###    Using class-validator with NestJS \nL61: \nL62: NestJS seamlessly integrates with the class-validator library, which provides decorators and utilities for validating data using class-based validation rules. To get started, let's assume we're building an API endpoint to create users. We want to validate the incoming data, such as the user's name and email, before saving it to the database.\nL63: \nL64: ####    Step 1: Install Dependencies \nL65: \nL66: First, create a new NestJS application or navigate to your existing project directory and install the required packages:  \nL67: \nL68:     npm install --save class-validator\nL69: \nL70: Enter fullscreen mode Exit fullscreen mode\nL71: \nL72: ####    Step 2: Create a DTO (Data Transfer Object) \nL73: \nL74: In NestJS, DTOs are used to define the shape of the incoming data and its validation rules. Let’s create a CreateUserDto class to represent the data expected when creating a new user:  \nL75: \nL76:     // src/users/dto/create-user.dto.ts\nL77: \nL78:     import { IsNotEmpty, IsEmail } from 'class-validator';\nL79: \nL80:     export class CreateUserDto {\nL81:       @IsNotEmpty()\nL82:       name: string;\nL83: \nL84:       @IsNotEmpty()\nL85:       @IsEmail()\nL86:       email: string;\nL87:     }\nL88: \nL89: Enter fullscreen mode Exit fullscreen mode\nL90: \nL91: In the CreateUserDto class, we've used the @IsNotEmpty() and @IsEmail() decorators from the class-validator library to specify that the name and email fields should not be empty and the email should be a valid email address.\nL92: \nL93: ####    Step 3: Create the Controller \nL94: \nL95: Now, let’s create a controller to handle the incoming requests and validate the data using the CreateUserDto class:  \nL96: \nL97:     // src/users/users.controller.ts\nL98: \nL99:     import { Controller, Post, Body } from '@nestjs/common';\nL100:     import { CreateUserDto } from './dto/create-user.dto';\nL101: \nL102:     @Controller('users')\nL103:     export class UsersController {\nL104:       @Post()\nL105:       async createUser(@Body() dto: CreateUserDto) {\nL106:         // At this point, \"dto\" has already been validated\nL107:         // You can now proceed with processing and saving the user data\nL108:         return 'User created successfully';\nL109:       }\nL110:     }\nL111: \nL112: Enter fullscreen mode Exit fullscreen mode\nL113: \nL114: In the createUser method of the UsersController, the @Body() decorator automatically maps the incoming request body to the createUserDto object and validates it according to the rules defined in the DTO.\nL115: \nL116: ####    Step 4: Enable Validation Globally \nL117: \nL118: By default, NestJS won’t perform automatic validation for DTOs unless you enable it. You can enable global validation by modifying your main.ts file:  \nL119: \nL120:     // src/main.ts\nL121: \nL122:     import { ValidationPipe } from '@nestjs/common';\nL123:     import { NestFactory } from '@nestjs/core';\nL124:     import { AppModule } from './app.module';\nL125: \nL126:     async function bootstrap() {\nL127:       const app = await NestFactory.create(AppModule);\nL128: \nL129:       // Enable global validation pipe\nL130:       app.useGlobalPipes(new ValidationPipe());\nL131: \nL132:       await app.listen(3000);\nL133:     }\nL134:     bootstrap();\nL135: \nL136: Enter fullscreen mode Exit fullscreen mode\nL137: \nL138: With this setup, the ValidationPipe will automatically validate incoming data using the DTO's validation rules for all routes.\nL139: \nL140: ###    Conclusion \nL141: \nL142: Data validation is a crucial aspect of building secure and reliable applications. NestJS, combined with the class-validator library, provides an elegant way to validate incoming data using decorators and class-based validation rules. By creating DTOs and enabling global validation, you can ensure that your NestJS application processes only valid and safe data, reducing the risk of vulnerabilities and errors.\nL143: \nL144: Remember that while this article covers the basics of data validation, more advanced scenarios might require additional validation techniques and error handling. Always tailor your validation strategies to your specific application’s needs and security requirements.\nL145: \nL146: ##  Top comments (0)\nL147: \nL148: Subscribe\nL149: \nL150:     [Image 13: pic] \nL151: \nL152: Personal Trusted User\nL153: \nL154:  Create template  \nL155: \nL156: Templates let you quickly answer FAQs or store snippets for re-use.\nL157: \nL158: Submit Preview Dismiss \nL159: \nL160: Code of Conduct • Report abuse \nL161: \nL162: Are you sure you want to hide this comment? It will become hidden in your post, but will still be visible via the comment's permalink. \nL163: \nL164: Hide child comments as well\nL165: \nL166: Confirm \nL167: \nL168: For further actions, you may consider blocking this person and/or reporting abuse\nL169: \nL170: ## Read next\nL171: \nL172:  Build a full stack app with Rust, Next.js and Docker Francesco Ciulla - Dec 19   Angular Addicts #20: unit testing the new defer blocks, NGRX Signal store extensions, app architectures \u0026 more Gergely Szerovay - Dec 12   Tech Talk: React in the Terminal? Hold my Beer Manuel Artero Anguita - Dec 20   How to know node vs react versions compatibility? suresh - Nov 17  \nL173: \nL174:  Vishnu C Prasad  \nL175: \nL176: Follow\nL177: \nL178: Pragmatic and Ambitious developer with extensive expertise in app development and web development. \nL179: \nL180:   * Work \nL181: \nL182: Flutter \u0026 Nest JS Developer \nL183: \nL184:   * Joined \nL185: \nL186: Jan 3, 2023\nL187: \nL188: ###  More from Vishnu C Prasad \nL189: \nL190:  Implementing the CQRS Pattern in NestJS with a Note API Example # nestjs # cqrs # node # typescript   Establishing PostgreSQL Connection with TypeORM in NestJS # nestjs # typeorm # postgres # node   Passport JWT Authentication in NestJS # nestjs # passportjs # jwt # node  \nL191: \nL192: Once suspended, vishnucprasad will not be able to comment or publish posts until their suspension is removed. \nL193: \nL194: Note:  \nL195: \nL196:  Submit \u0026 Suspend \nL197: \nL198: Once unsuspended, vishnucprasad will be able to comment and publish posts again. \nL199: \nL200: Note:  \nL201: \nL202:  Submit \u0026 Unsuspend \nL203: \nL204: Once unpublished, all posts by vishnucprasad will become hidden and only accessible to themselves. \nL205: \nL206: If vishnucprasad is not suspended, they can still re-publish their posts from their dashboard. \nL207: \nL208: Note: \nL209: \nL210:  Unpublish all posts \nL211: \nL212: Once unpublished, this post will become invisible to the public and only accessible to Vishnu C Prasad. \nL213: \nL214: They can still re-publish the post if they are not suspended.\nL215: \nL216:  Unpublish Post \nL217: \nL218: Thanks for keeping DEV Community safe. Here is what you can do to flag vishnucprasad: \nL219: \nL220:  Make all posts by vishnucprasad less visible \nL221: \nL222: vishnucprasad consistently posts content that violates DEV Community's code of conduct because it is harassing, offensive or spammy. \nL223: \nL224:  Report other inappropriate conduct  \nL225: \nL226:  Confirm Flag \nL227: \nL228: Unflagging vishnucprasad will restore default visibility to their posts. \nL229: \nL230:  Confirm Unflag \nL231: \nL232: DEV Community — A constructive and inclusive social network for software developers. With you every step of your journey. \nL233: \nL234: *  Home  \nL235: *  Podcasts  \nL236: *  Videos  \nL237: *  Tags  \nL238: *  FAQ  \nL239: *  Forem Shop  \nL240: *  Advertise on DEV  \nL241: *  About  \nL242: *  Contact  \nL243: *  Guides  \nL244: *  Software comparisons  \nL245: \nL246: *  Code of Conduct  \nL247: *  Privacy Policy  \nL248: *  Terms of use  \nL249: \nL250: Built on Forem — the open source software that powers DEV and other inclusive communities.\nL251: \nL252: Made with love and Ruby on Rails. DEV Community © 2016 - 2023.\nL253: \nL254: [Image 14: DEV Community] \nL255: \nL256: We're a place where coders share, stay up-to-date and grow their careers. \nL257: \nL258:  Log in   Create account  \nL259: \nL260:  [Image 15] [Image 16] [Image 17] [Image 18] [Image 19]\nVisible: 0% - 100%"}]},"command":"click","args":[4],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"4aff2089-c41b-4702-8a1c-e4c9f79722fc","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"4aff2089-c41b-4702-8a1c-e4c9f79722fc","children":["fddb10a2-d22b-4598-baf5-5f1109b22ccf"]},"4aff2089-c41b-4702-8a1c-e4c9f79722fc":{"id":"4aff2089-c41b-4702-8a1c-e4c9f79722fc","message":{"id":"4aff2089-c41b-4702-8a1c-e4c9f79722fc","author":{"role":"assistant","metadata":{}},"create_time":1703480183.241577,"content":{"content_type":"code","language":"unknown","text":"click(4)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"1e500484-a305-41d0-a815-90cdf6144f18","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"1e500484-a305-41d0-a815-90cdf6144f18","children":["a4f0184b-a826-484a-a54a-78465cdb0067"]},"1e500484-a305-41d0-a815-90cdf6144f18":{"id":"1e500484-a305-41d0-a815-90cdf6144f18","message":{"id":"1e500484-a305-41d0-a815-90cdf6144f18","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.229744,"content":{"content_type":"tether_browsing_display","result":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Validation | NestJS - A progressive Node.js framework","url":"https://docs.nestjs.com/techniques/validation","text":"\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: "},{"type":"webpage","title":"Custom validation with database in NestJS - DEV Community","url":"https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao","text":"\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: "},{"type":"webpage","title":"Validation - GitHub: Let’s build from here","url":"https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md","text":"\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: "},{"type":"webpage","title":"Injecting request object to a custom validation class in NestJS","url":"https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal","text":"\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: "},{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: "},{"type":"webpage","title":"NestJS and ‘class validator’ cheat sheet - DEV Community","url":"https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao","text":"\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: "},{"type":"webpage","title":"How to implement input validation with NestJS - Sébastien Dubois","url":"https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/","text":"\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: "},{"type":"webpage","title":"How to use class-validator and generate custom error object in nest.js","url":"https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h","text":"\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: "},{"type":"webpage","title":"Building a REST API with NestJS and Prisma: Input Validation ...","url":"https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1","text":"\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: "},{"type":"webpage","title":"NestJS Custom Payload Validation - DEV Community","url":"https://dev.to/shubham_kadam/nestjs-custom-payload-validation-3hh7","text":"\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: "},{"type":"webpage","title":"Mastering Email Validation in NestJS: A Comprehensive Guide","url":"https://emaillistvalidation.com/blog/mastering-email-validation-in-nestjs-a-comprehensive-guide/","text":"\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: "},{"type":"webpage","title":"Custom Card v2 Signature Validation in NestJS - community.hubspot.com","url":"https://community.hubspot.com/t5/APIs-Integrations/Custom-Card-v2-Signature-Validation-in-NestJS/m-p/897350","text":"\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"},{"type":"webpage","title":"Search results for query: 'nestjs class-validator custom validation method documentation'","url":"","text":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"}]},"command":"back","args":[],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"9517698f-527f-4109-8348-b9a68f4532e0","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"9517698f-527f-4109-8348-b9a68f4532e0","children":["4aff2089-c41b-4702-8a1c-e4c9f79722fc"]},"9517698f-527f-4109-8348-b9a68f4532e0":{"id":"9517698f-527f-4109-8348-b9a68f4532e0","message":{"id":"9517698f-527f-4109-8348-b9a68f4532e0","author":{"role":"assistant","metadata":{}},"create_time":1703480183.216529,"content":{"content_type":"code","language":"unknown","text":"back()"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"ef34b855-867c-4ae6-ab80-9b79a353eebe","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"ef34b855-867c-4ae6-ab80-9b79a353eebe","children":["1e500484-a305-41d0-a815-90cdf6144f18"]},"ef34b855-867c-4ae6-ab80-9b79a353eebe":{"id":"ef34b855-867c-4ae6-ab80-9b79a353eebe","message":{"id":"ef34b855-867c-4ae6-ab80-9b79a353eebe","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.205306,"content":{"content_type":"tether_browsing_display","result":"L0: \nL1: URL: https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal\nL2:   \nL3: \nL4:   【0†Skip to content】 \nL5: \nL6: Navigation menu 【1† 】 \nL7: \nL8:  Search\nL9: \nL10: 【2† Search 】 \nL11: \nL12:   【3† Log in 】  【4† Create account 】 \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30: 【5† Share to Twitter †twitter.com】 【6† Share to LinkedIn †www.linkedin.com】 【7† Share to Reddit †www.reddit.com】 【8† Share to Hacker News †news.ycombinator.com】 【9† Share to Facebook †www.facebook.com】 【10† Share to Mastodon †toot.kytta.dev】 \nL31: \nL32:  Share Post via...  【11†Report Abuse】 \nL33: \nL34:   【12† †res.cloudinary.com】 \nL35: \nL36: [Image 6: Krzysztof Szala]\nL37: \nL38: 【13†Krzysztof Szala】 \nL39: \nL40: Posted on May 12, 2021 • Updated on Mar 29, 2022\nL41: \nL42: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL43: \nL44: #  Injecting request object to a custom validation class in NestJS \nL45: \nL46: 【14†# nestjs】 【15†# typescript】 【16†# javascript】 【17†# node】 \nL47: \nL48: ##  【18†Validation tricks in NestJS (4 Part Series)】 \nL49: \nL50: 【19† 1 Custom validation with database in NestJS 】 【20† 2 Validating nested objects with class-validator in NestJS 】 【21† 3 Validating numeric query parameters in NestJS 】 【22† 4 Injecting request object to a custom validation class in NestJS 】 \nL51: \nL52: I'm a big fan of how NestJS handle validation using class-validator library. There are many advantages of using an external library for validation. For most of the typical cases default integration via `ValidationPipe` is good enough. But as you know, daily work likes to verify and challenge us.\nL53: \nL54: A few days ago I had a specific need – I needed to validate something with ValidatorPipe and class-validator library, but one of the validation factors, was user ID. In this project, user ID is pulled out from JWT token, during the authorization process, and added to the request object.\nL55: \nL56: My first thought was – just use the Injection Request Scope, like we can do it in NestJS services:  \nL57: \nL58:     constructor(@Inject(REQUEST) private request: Request) {}\nL59: \nL60: Enter fullscreen mode Exit fullscreen mode\nL61: \nL62: Obviously – it doesn't work, otherwise this article wouldn't be here. 【23†Here is a short explanation†github.com】 made by NestJS creator, Kamil Myśliwiec: \nL63: \nL64: [Image 12: image]\nL65: \nL66: Ok. So, there is basically no simple way to get request object data in custom validation constraint. But there is a way around! Not perfect, but it works. And if it can't be pretty, at least it should do its job. What steps we need to take, to achieve it?\nL67: \nL68:   1. Create Interceptor, which will add the User Object to the request type you need (Query, Body or Param)\nL69:   2. Write your Validator Constraint, Extended Validation Arguments interface, use the User data you need.\nL70:   3. Create Pipe, which will strip the request type object from User data context.\nL71:   4. Create the appropriate decorators, one for each type of request.\nL72:   5. Use newly created decorators in Controllers, when you need to \"inject\" User data to your validation class.\nL73: \nL74: Not great, not terrible. Right?  \nL75: [Image 13: image]\nL76: \nL77: ##  【24† 】 Interceptor \nL78: \nL79: Create Interceptor, which will add User Object to request type you need (Query, Body or Param). For the demonstration purposes, I assume you store your User Object in `request.user` attribute.  \nL80: \nL81:     export const REQUEST_CONTEXT = '_requestContext';\nL82: \nL83:     @Injectable()\nL84:     export class InjectUserInterceptor implements NestInterceptor {\nL85:       constructor(private type?: Nullable\u003c'query' | 'body' | 'param'\u003e) {}\nL86: \nL87:       intercept(context: ExecutionContext, next: CallHandler): Observable\u003cany\u003e {\nL88:         const request = context.switchToHttp().getRequest();\nL89: \nL90:         if (this.type \u0026\u0026 request[this.type]) {\nL91:           request[this.type][REQUEST_CONTEXT] = {\nL92:             user: request.user,\nL93:           };\nL94:         }\nL95: \nL96:         return next.handle();\nL97:       }\nL98:     }\nL99: \nL100: Enter fullscreen mode Exit fullscreen mode\nL101: \nL102: ##  【25† 】 Custom validation decorator \nL103: \nL104: Write your Validator Constraint and custom decorator, Extended Validation Arguments interface, use the User data you need.  \nL105: \nL106:     @ValidatorConstraint({ async: true })\nL107:     @Injectable()\nL108:     export class IsUserCommentValidatorConstraint implements ValidatorConstraintInterface {\nL109:       constructor(private commentsRepository: CommentsRepository) {}\nL110: \nL111:       async validate(commentId: number, args?: ExtendedValidationArguments) {\nL112:         const userId = args?.object[REQUEST_CONTEXT].user.id;\nL113: \nL114:         if (userId \u0026\u0026 Number.isInteger(commentId)) {\nL115:           const comment = await this.commentsRepository.findByUserId(userId, commentId); // Checking if comment belongs to selected user\nL116: \nL117:           if (!comment) {\nL118:             return false;\nL119:           }\nL120:         }\nL121: \nL122:         return true;\nL123:       }\nL124: \nL125:       defaultMessage(): string {\nL126:         return 'The comment does not belong to the user';\nL127:       }\nL128:     }\nL129: \nL130:     export function IsUserComment(validationOptions?: ValidationOptions) {\nL131:       return function (object: any, propertyName: string) {\nL132:         registerDecorator({\nL133:           name: 'IsUserComment',\nL134:           target: object.constructor,\nL135:           propertyName: propertyName,\nL136:           options: validationOptions,\nL137:           validator: IsUserCommentValidatorConstraint,\nL138:         });\nL139:       };\nL140:     }\nL141: \nL142: Enter fullscreen mode Exit fullscreen mode\nL143: \nL144: If you don't know how to inject dependencies into a custom validator in class-validator library, 【19†this article】 can help you.\nL145: \nL146: My `ExtendedValidationArguments` interface looks like this:  \nL147: \nL148:     export interface ExtendedValidationArguments extends ValidationArguments {\nL149:       object: {\nL150:         [REQUEST_CONTEXT]: {\nL151:           user: IUser; // IUser is my interface for User class\nL152:         };\nL153:       };\nL154:     }\nL155: \nL156: Enter fullscreen mode Exit fullscreen mode\nL157: \nL158: It allows me to use valid typing in `ValidatorConstraint`. Without it, TypeScript will print out an error, that the `_requestContext` property doesn't exist.\nL159: \nL160: ##  【26† 】 Stripping Pipe \nL161: \nL162: Create Pipe, which will strip the request type object from User data context. If we don't do that, our DTO object will contain attached previously request data. We don't want that to happen. I'm using here one of the `lodash` function – 【27†omit()†lodash.com】. It allows removing chosen properties from an object.  \nL163: \nL164:     @Injectable()\nL165:     export class StripRequestContextPipe implements PipeTransform {\nL166:       transform(value: any) {\nL167:         return omit(value, REQUEST_CONTEXT);\nL168:       }\nL169:     }\nL170: \nL171: Enter fullscreen mode Exit fullscreen mode\nL172: \nL173: ##  【28† 】 New decorators \nL174: \nL175: Creating new decorators is not necessary, but it's definitely a more clean and DRY approach than manually adding Interceptors and Pipes to the methods. We're going to use NestJS built-in function – `applyDecorators`, which 【29†allows merging multiple different decorators into a new one†docs.nestjs.com】.  \nL176: \nL177:     export function InjectUserToQuery() {\nL178:       return applyDecorators(InjectUserTo('query'));\nL179:     }\nL180: \nL181:     export function InjectUserToBody() {\nL182:       return applyDecorators(InjectUserTo('body'));\nL183:     }\nL184: \nL185:     export function InjectUserToParam() {\nL186:       return applyDecorators(InjectUserTo('params'));\nL187:     }\nL188: \nL189:     export function InjectUserTo(context: 'query' | 'body' | 'params') {\nL190:       return applyDecorators(UseInterceptors(new InjectUserInterceptor(context)), UsePipes(StripRequestContextPipe));\nL191:     }\nL192: \nL193: Enter fullscreen mode Exit fullscreen mode\nL194: \nL195: To add your user data, just decorate your controller's method with one of the above decorators.  \nL196: \nL197:       @InjectUserToParam()\nL198:       async edit(@Param() params: EditParams){}\nL199: \nL200: Enter fullscreen mode Exit fullscreen mode\nL201: \nL202: Now, if you wanted to use your `IsUserComment` decorator in `EditParams`, you will be able to access injected user data.  \nL203: \nL204:     export class EditParams {\nL205:       @IsUserComment()\nL206:       commentId: number;\nL207:     }\nL208: \nL209: Enter fullscreen mode Exit fullscreen mode\nL210: \nL211: And that's all! You can use this method, to add any data from the request object to your custom validation class. Hope you find it helpful!\nL212: \nL213: You can find an 【30†example repository on my GitHub†github.com】.\nL214: \nL215: In case you use in your `ValidationPipe` `whitelist: true` parameter, and above example doesn't work for you – 【31†check this issue†github.com】.\nL216: \nL217: This article is highly inspired by the idea I've found in 【32†this comment†github.com】 on GitHub.\nL218: \nL219: PS. It's just proof of concept, and this comment ownership validation is a simple example of usage.\nL220: \nL221: ##  【18†Validation tricks in NestJS (4 Part Series)】 \nL222: \nL223: 【19† 1 Custom validation with database in NestJS 】 【20† 2 Validating nested objects with class-validator in NestJS 】 【21† 3 Validating numeric query parameters in NestJS 】 【22† 4 Injecting request object to a custom validation class in NestJS 】 \nL224: \nL225: ##  Top comments (20)\nL226: \nL227: Subscribe\nL228: \nL229:     [Image 14: pic] \nL230: \nL231: Personal Trusted User\nL232: \nL233: 【33† Create template 】 \nL234: \nL235: Templates let you quickly answer FAQs or store snippets for re-use.\nL236: \nL237: Submit Preview 【34†Dismiss】 \nL238: \nL239:   Collapse Expand\nL240: \nL241: 【35† 】 \nL242: \nL243: 【35† Walid-Gerges 】 \nL244: \nL245:  Walid-Gerges \nL246: \nL247: 【35† Walid-Gerges 】 \nL248: \nL249: Follow\nL250: \nL251:   * Joined \nL252: \nL253: Jul 26, 2021\nL254: \nL255: • 【36† May 26 '22 】 \nL256: \nL257:  Dropdown menu\nL258: \nL259:   * 【36†Copy link】\nL260:   *   * Hide \nL261:   *   *   * \nL262: \nL263: You can go a step forward and use request context.\nL264: \nL265: 【37†npmjs.com/package/@medibloc/nestjs...†www.npmjs.com】\nL266: \nL267: Thanks for your tips, it helped me.\nL268: \nL269:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL270: \nL271: Collapse Expand\nL272: \nL273: 【38† 】 \nL274: \nL275: 【38† Monirul Islam 】 \nL276: \nL277:  Monirul Islam \nL278: \nL279: 【38† Monirul Islam 】 \nL280: \nL281: Follow\nL282: \nL283: Full Stack Developer. Making the web awesome since 2018. \nL284: \nL285:   * Location \nL286: \nL287: Dhaka,Bangladesh \nL288: \nL289:   * Education \nL290: \nL291: Jahangirnagar University \nL292: \nL293:   * Work \nL294: \nL295: Sr. Software Engineer L-I at Vivasoft Ltd. \nL296: \nL297:   * Joined \nL298: \nL299: Sep 6, 2021\nL300: \nL301: • 【39† Sep 19 '21 】 \nL302: \nL303:  Dropdown menu\nL304: \nL305:   * 【39†Copy link】\nL306:   *   * Hide \nL307:   *   *   * \nL308: \nL309: this is not working ValidationArguments does not hold REQUEST_CONTEXT\nL310: \nL311:  Like comment:  Like comment:  Like  Comment button Reply \nL312: \nL313: Collapse Expand\nL314: \nL315: 【13† 】 \nL316: \nL317: 【13† Krzysztof Szala 】 \nL318: \nL319:  Krzysztof Szala \nL320: \nL321: 【13† Krzysztof Szala 】 \nL322: \nL323: Follow\nL324: \nL325: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL326: \nL327:   * Location \nL328: \nL329: Silesia \nL330: \nL331:   * Joined \nL332: \nL333: May 30, 2020\nL334: \nL335: • 【40† Sep 20 '21 】 \nL336: \nL337:  Dropdown menu\nL338: \nL339:   * 【40†Copy link】\nL340:   *   * Hide \nL341:   *   *   * \nL342: \nL343: There was obviously typo in decorator composition class. Instead of `AddUseTo`, there should be `InjectUserTo`. Please try if it works for you now.\nL344: \nL345:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL346: \nL347: Collapse Expand\nL348: \nL349: 【13† 】 \nL350: \nL351: 【13† Krzysztof Szala 】 \nL352: \nL353:  Krzysztof Szala \nL354: \nL355: 【13† Krzysztof Szala 】 \nL356: \nL357: Follow\nL358: \nL359: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL360: \nL361:   * Location \nL362: \nL363: Silesia \nL364: \nL365:   * Joined \nL366: \nL367: May 30, 2020\nL368: \nL369: • 【41† Sep 20 '21 • Edited on Sep 20 • Edited 】 \nL370: \nL371:  Dropdown menu\nL372: \nL373:   * 【41†Copy link】\nL374:   *   * Hide \nL375:   *   *   * \nL376: \nL377: Are you sure you created interceptor, which injects the REQUEST_CONTEXT? I'm using similar code in my production-ready app and it works for me.\nL378: \nL379:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL380: \nL381: Collapse Expand\nL382: \nL383: 【38† 】 \nL384: \nL385: 【38† Monirul Islam 】 \nL386: \nL387:  Monirul Islam \nL388: \nL389: 【38† Monirul Islam 】 \nL390: \nL391: Follow\nL392: \nL393: Full Stack Developer. Making the web awesome since 2018. \nL394: \nL395:   * Location \nL396: \nL397: Dhaka,Bangladesh \nL398: \nL399:   * Education \nL400: \nL401: Jahangirnagar University \nL402: \nL403:   * Work \nL404: \nL405: Sr. Software Engineer L-I at Vivasoft Ltd. \nL406: \nL407:   * Joined \nL408: \nL409: Sep 6, 2021\nL410: \nL411: • 【42† Sep 20 '21 】 \nL412: \nL413:  Dropdown menu\nL414: \nL415:   * 【42†Copy link】\nL416:   *   * Hide \nL417:   *   *   * \nL418: \nL419: yes i am using but its not working btw.I did exactly the way you said\nL420: \nL421:  Like comment:  Like comment:  Like  Thread Thread \nL422: \nL423: 【38† 】 \nL424: \nL425: 【38† Monirul Islam 】 \nL426: \nL427:  Monirul Islam \nL428: \nL429: 【38† Monirul Islam 】 \nL430: \nL431: Follow\nL432: \nL433: Full Stack Developer. Making the web awesome since 2018. \nL434: \nL435:   * Location \nL436: \nL437: Dhaka,Bangladesh \nL438: \nL439:   * Education \nL440: \nL441: Jahangirnagar University \nL442: \nL443:   * Work \nL444: \nL445: Sr. Software Engineer L-I at Vivasoft Ltd. \nL446: \nL447:   * Joined \nL448: \nL449: Sep 6, 2021\nL450: \nL451: • 【43† Sep 20 '21 】 \nL452: \nL453:  Dropdown menu\nL454: \nL455:   * 【43†Copy link】\nL456:   *   * Hide \nL457:   *   *   * \nL458: \nL459: even console logged the args but REQUEST_CONTEXT returns undefined\nL460: \nL461:  Like comment:  Like comment:  1 like Like  Thread Thread \nL462: \nL463: 【44† 】 \nL464: \nL465: 【44† Siavash Habil 】 \nL466: \nL467:  Siavash Habil \nL468: \nL469: 【44† Siavash Habil 】 \nL470: \nL471: Follow\nL472: \nL473:   * Joined \nL474: \nL475: Mar 29, 2022\nL476: \nL477: • 【45† Mar 29 '22 】 \nL478: \nL479:  Dropdown menu\nL480: \nL481:   * 【45†Copy link】\nL482:   *   * Hide \nL483:   *   *   * \nL484: \nL485: 【38†@monirul017】 【13†@avantar】   \nL486: I had exactly same problem and after investigating it is happening because of `{whitelist: true}` of ValidationPipe and when you set it to false it will working properly but I didn't continue in this way because I want to whitelist the properties so temporary I added `_requestContext` to the related DTO file that I used in my controller and added it as an @IsOptional() decorator  \nL487: \nL488:     import { REQUEST_CONTEXT } from '../../../interceptors/inject-request-param.interceptor';\nL489: \nL490:       @IsOptional()\nL491:       \\[REQUEST_CONTEXT\\]: any;\nL492: \nL493: Enter fullscreen mode Exit fullscreen mode\nL494: \nL495: Ignore \"\\\" from the above code.\nL496: \nL497: For others trying to use this article as a solution continue using from attached repository.\nL498: \nL499: At the end thank you 【13†@avantar】 for your solution.\nL500: \nL501:  Like comment:  Like comment:  3 likes Like  Thread Thread \nL502: \nL503: 【13† 】 \nL504: \nL505: 【13† Krzysztof Szala 】 \nL506: \nL507:  Krzysztof Szala \nL508: \nL509: 【13† Krzysztof Szala 】 \nL510: \nL511: Follow\nL512: \nL513: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL514: \nL515:   * Location \nL516: \nL517: Silesia \nL518: \nL519:   * Joined \nL520: \nL521: May 30, 2020\nL522: \nL523: • 【46† Mar 29 '22 】 \nL524: \nL525:  Dropdown menu\nL526: \nL527:   * 【46†Copy link】\nL528:   *   * Hide \nL529:   *   *   * \nL530: \nL531: Thank you, 【44†@siavash_habil】! This can be helpful as well.\nL532: \nL533: 【31†github.com/AvantaR/nestjs-validati...†github.com】\nL534: \nL535:  Like comment:  Like comment:  2 likes Like  Thread Thread \nL536: \nL537: 【44† 】 \nL538: \nL539: 【44† Siavash Habil 】 \nL540: \nL541:  Siavash Habil \nL542: \nL543: 【44† Siavash Habil 】 \nL544: \nL545: Follow\nL546: \nL547:   * Joined \nL548: \nL549: Mar 29, 2022\nL550: \nL551: • 【47† Mar 29 '22 】 \nL552: \nL553:  Dropdown menu\nL554: \nL555:   * 【47†Copy link】\nL556:   *   * Hide \nL557:   *   *   * \nL558: \nL559: 【13†@avantar】 This is almost happened at the same time for both of us because I solved it about 20 hours ago. :)  \nL560: Thank you for sharing.\nL561: \nL562:  Like comment:  Like comment:  1 like Like  Thread Thread \nL563: \nL564: 【13† 】 \nL565: \nL566: 【13† Krzysztof Szala 】 \nL567: \nL568:  Krzysztof Szala \nL569: \nL570: 【13† Krzysztof Szala 】 \nL571: \nL572: Follow\nL573: \nL574: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL575: \nL576:   * Location \nL577: \nL578: Silesia \nL579: \nL580:   * Joined \nL581: \nL582: May 30, 2020\nL583: \nL584: • 【48† Mar 29 '22 】 \nL585: \nL586:  Dropdown menu\nL587: \nL588:   * 【48†Copy link】\nL589:   *   * Hide \nL590:   *   *   * \nL591: \nL592: What a coincidence! Magic \nL593: \nL594:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL595: \nL596: Collapse Expand\nL597: \nL598: 【49† 】 \nL599: \nL600: 【49† tkssharma 】 \nL601: \nL602:  tkssharma \nL603: \nL604: 【49† tkssharma 】 \nL605: \nL606: Follow\nL607: \nL608: Hi, I’m Tarun. I help people to make a better world by building apps. I am Publisher, Trainer Developer, working on Enterprise and open source Technologies JavaScript frameworks (React Angular) \nL609: \nL610:   * Email \nL611: \nL612: 【50†tarun.softengg@gmail.com†mailto:tarun.softengg@gmail.com】 \nL613: \nL614:   * Location \nL615: \nL616: Delhi, India \nL617: \nL618:   * Work \nL619: \nL620: Lead Engineer \nL621: \nL622:   * Joined \nL623: \nL624: Nov 5, 2018\nL625: \nL626: • 【51† Sep 10 '21 】 \nL627: \nL628:  Dropdown menu\nL629: \nL630:   * 【51†Copy link】\nL631:   *   * Hide \nL632:   *   *   * \nL633: \nL634: this is awesome but not sure if i want to use this !! not a clean solution \nL635: \nL636:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL637: \nL638: Collapse Expand\nL639: \nL640: 【13† 】 \nL641: \nL642: 【13† Krzysztof Szala 】 \nL643: \nL644:  Krzysztof Szala \nL645: \nL646: 【13† Krzysztof Szala 】 \nL647: \nL648: Follow\nL649: \nL650: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL651: \nL652:   * Location \nL653: \nL654: Silesia \nL655: \nL656:   * Joined \nL657: \nL658: May 30, 2020\nL659: \nL660: • 【52† Sep 10 '21 】 \nL661: \nL662:  Dropdown menu\nL663: \nL664:   * 【52†Copy link】\nL665:   *   * Hide \nL666:   *   *   * \nL667: \nL668: Totally agree, but sometimes we need to do something dirty way ‍♂️ Thanks for your feedback! \nL669: \nL670:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL671: \nL672: Collapse Expand\nL673: \nL674: 【53† 】 \nL675: \nL676: 【53† Dolphine Dev 】 \nL677: \nL678:  Dolphine Dev \nL679: \nL680: 【53† Dolphine Dev 】 \nL681: \nL682: Follow\nL683: \nL684:   * Joined \nL685: \nL686: Aug 4, 2023\nL687: \nL688: • 【54† Aug 4 • Edited on Aug 4 • Edited 】 \nL689: \nL690:  Dropdown menu\nL691: \nL692:   * 【54†Copy link】\nL693:   *   * Hide \nL694:   *   *   * \nL695: \nL696: When using @ValidateNested(), the `args?.object[REQUEST_CONTEXT]` is undefined because the context passed to the nested validation is not the same as the one at the top level.\nL697: \nL698:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL699: \nL700: Collapse Expand\nL701: \nL702: 【55† 】 \nL703: \nL704: 【55† Wahyu Baskara 】 \nL705: \nL706:  Wahyu Baskara \nL707: \nL708: 【55† Wahyu Baskara 】 \nL709: \nL710: Follow\nL711: \nL712:   * Joined \nL713: \nL714: Apr 25, 2022\nL715: \nL716: • 【56† Aug 4 】 \nL717: \nL718:  Dropdown menu\nL719: \nL720:   * 【56†Copy link】\nL721:   *   * Hide \nL722:   *   *   * \nL723: \nL724: ValidationArguments does not hold REQUEST_CONTEXT when using nested validation object\nL725: \nL726:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL727: \nL728: Collapse Expand\nL729: \nL730: 【57† 】 \nL731: \nL732: 【57† Xjsny 】 \nL733: \nL734:  Xjsny \nL735: \nL736: 【57† Xjsny 】 \nL737: \nL738: Follow\nL739: \nL740:   * Joined \nL741: \nL742: Jun 15, 2022\nL743: \nL744: • 【58† Jun 15 '22 】 \nL745: \nL746:  Dropdown menu\nL747: \nL748:   * 【58†Copy link】\nL749:   *   * Hide \nL750:   *   *   * \nL751: \nL752: It didn’t work if I request data with multipart/form-data. Is there any solution for form data request.\nL753: \nL754:  Like comment:  Like comment:  Like  Comment button Reply \nL755: \nL756: Collapse Expand\nL757: \nL758: 【59† 】 \nL759: \nL760: 【59† htdai 】 \nL761: \nL762:  htdai \nL763: \nL764: 【59† htdai 】 \nL765: \nL766: Follow\nL767: \nL768: Full-stack Overflow Copyist \nL769: \nL770:   * Joined \nL771: \nL772: Mar 28, 2023\nL773: \nL774: • 【60† Mar 28 】 \nL775: \nL776:  Dropdown menu\nL777: \nL778:   * 【60†Copy link】\nL779:   *   * Hide \nL780:   *   *   * \nL781: \nL782: 【61†stackoverflow.com/a/75139788†stackoverflow.com】\nL783: \nL784: Maybe it's late but I found the solution for inject current user into body when using form-data  \nL785: I have tested and it works perfectly for me\nL786: \nL787:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL788: \nL789: Collapse Expand\nL790: \nL791: 【62† 】 \nL792: \nL793: 【62† Szymon Sukiennik 】 \nL794: \nL795:  Szymon Sukiennik \nL796: \nL797: 【62† Szymon Sukiennik 】 \nL798: \nL799: Follow\nL800: \nL801:   * Joined \nL802: \nL803: Nov 29, 2021\nL804: \nL805: • 【63† Nov 29 '21 】 \nL806: \nL807:  Dropdown menu\nL808: \nL809:   * 【63†Copy link】\nL810:   *   * Hide \nL811:   *   *   * \nL812: \nL813: Did you ever managed to port a similar approach to graphql in Nest? Namely, to have access to part or even whole gql context inside validator or validation rule?\nL814: \nL815:  Like comment:  Like comment:  Like  Comment button Reply \nL816: \nL817: Collapse Expand\nL818: \nL819: 【13† 】 \nL820: \nL821: 【13† Krzysztof Szala 】 \nL822: \nL823:  Krzysztof Szala \nL824: \nL825: 【13† Krzysztof Szala 】 \nL826: \nL827: Follow\nL828: \nL829: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL830: \nL831:   * Location \nL832: \nL833: Silesia \nL834: \nL835:   * Joined \nL836: \nL837: May 30, 2020\nL838: \nL839: • 【64† Mar 28 '22 】 \nL840: \nL841:  Dropdown menu\nL842: \nL843:   * 【64†Copy link】\nL844:   *   * Hide \nL845:   *   *   * \nL846: \nL847: Hi!\nL848: \nL849: No, I haven't tried to use it with GraphQL, sorry.\nL850: \nL851:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL852: \nL853: Collapse Expand\nL854: \nL855: 【65† 】 \nL856: \nL857: 【65† davidN96 】 \nL858: \nL859:  davidN96 \nL860: \nL861: 【65† davidN96 】 \nL862: \nL863: Follow\nL864: \nL865:   * Joined \nL866: \nL867: Apr 25, 2021\nL868: \nL869: • 【66† Jun 23 '21 】 \nL870: \nL871:  Dropdown menu\nL872: \nL873:   * 【66†Copy link】\nL874:   *   * Hide \nL875:   *   *   * \nL876: \nL877: Hey! Thank you for a great article!\nL878: \nL879:  Like comment:  Like comment\nVisible: 0% - 84%","summary":"Injecting request object to a custom validation class in NestJS - DEV Community (dev.to)\n","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Injecting request object to a custom validation class in NestJS - DEV Community","url":"https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal","text":"L0: \nL1: URL: https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal\nL2:   \nL3: \nL4:   Skip to content \nL5: \nL6: Navigation menu   \nL7: \nL8:  Search\nL9: \nL10:  Search  \nL11: \nL12:    Log in    Create account  \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30:  Share to Twitter   Share to LinkedIn   Share to Reddit   Share to Hacker News   Share to Facebook   Share to Mastodon  \nL31: \nL32:  Share Post via...  Report Abuse \nL33: \nL34:     \nL35: \nL36: [Image 6: Krzysztof Szala]\nL37: \nL38: Krzysztof Szala \nL39: \nL40: Posted on May 12, 2021 • Updated on Mar 29, 2022\nL41: \nL42: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL43: \nL44: #  Injecting request object to a custom validation class in NestJS \nL45: \nL46: # nestjs # typescript # javascript # node \nL47: \nL48: ##  Validation tricks in NestJS (4 Part Series) \nL49: \nL50:  1 Custom validation with database in NestJS   2 Validating nested objects with class-validator in NestJS   3 Validating numeric query parameters in NestJS   4 Injecting request object to a custom validation class in NestJS  \nL51: \nL52: I'm a big fan of how NestJS handle validation using class-validator library. There are many advantages of using an external library for validation. For most of the typical cases default integration via `ValidationPipe` is good enough. But as you know, daily work likes to verify and challenge us.\nL53: \nL54: A few days ago I had a specific need – I needed to validate something with ValidatorPipe and class-validator library, but one of the validation factors, was user ID. In this project, user ID is pulled out from JWT token, during the authorization process, and added to the request object.\nL55: \nL56: My first thought was – just use the Injection Request Scope, like we can do it in NestJS services:  \nL57: \nL58:     constructor(@Inject(REQUEST) private request: Request) {}\nL59: \nL60: Enter fullscreen mode Exit fullscreen mode\nL61: \nL62: Obviously – it doesn't work, otherwise this article wouldn't be here. Here is a short explanation made by NestJS creator, Kamil Myśliwiec: \nL63: \nL64: [Image 12: image]\nL65: \nL66: Ok. So, there is basically no simple way to get request object data in custom validation constraint. But there is a way around! Not perfect, but it works. And if it can't be pretty, at least it should do its job. What steps we need to take, to achieve it?\nL67: \nL68:   1. Create Interceptor, which will add the User Object to the request type you need (Query, Body or Param)\nL69:   2. Write your Validator Constraint, Extended Validation Arguments interface, use the User data you need.\nL70:   3. Create Pipe, which will strip the request type object from User data context.\nL71:   4. Create the appropriate decorators, one for each type of request.\nL72:   5. Use newly created decorators in Controllers, when you need to \"inject\" User data to your validation class.\nL73: \nL74: Not great, not terrible. Right?  \nL75: [Image 13: image]\nL76: \nL77: ##    Interceptor \nL78: \nL79: Create Interceptor, which will add User Object to request type you need (Query, Body or Param). For the demonstration purposes, I assume you store your User Object in `request.user` attribute.  \nL80: \nL81:     export const REQUEST_CONTEXT = '_requestContext';\nL82: \nL83:     @Injectable()\nL84:     export class InjectUserInterceptor implements NestInterceptor {\nL85:       constructor(private type?: Nullable\u003c'query' | 'body' | 'param'\u003e) {}\nL86: \nL87:       intercept(context: ExecutionContext, next: CallHandler): Observable\u003cany\u003e {\nL88:         const request = context.switchToHttp().getRequest();\nL89: \nL90:         if (this.type \u0026\u0026 request[this.type]) {\nL91:           request[this.type][REQUEST_CONTEXT] = {\nL92:             user: request.user,\nL93:           };\nL94:         }\nL95: \nL96:         return next.handle();\nL97:       }\nL98:     }\nL99: \nL100: Enter fullscreen mode Exit fullscreen mode\nL101: \nL102: ##    Custom validation decorator \nL103: \nL104: Write your Validator Constraint and custom decorator, Extended Validation Arguments interface, use the User data you need.  \nL105: \nL106:     @ValidatorConstraint({ async: true })\nL107:     @Injectable()\nL108:     export class IsUserCommentValidatorConstraint implements ValidatorConstraintInterface {\nL109:       constructor(private commentsRepository: CommentsRepository) {}\nL110: \nL111:       async validate(commentId: number, args?: ExtendedValidationArguments) {\nL112:         const userId = args?.object[REQUEST_CONTEXT].user.id;\nL113: \nL114:         if (userId \u0026\u0026 Number.isInteger(commentId)) {\nL115:           const comment = await this.commentsRepository.findByUserId(userId, commentId); // Checking if comment belongs to selected user\nL116: \nL117:           if (!comment) {\nL118:             return false;\nL119:           }\nL120:         }\nL121: \nL122:         return true;\nL123:       }\nL124: \nL125:       defaultMessage(): string {\nL126:         return 'The comment does not belong to the user';\nL127:       }\nL128:     }\nL129: \nL130:     export function IsUserComment(validationOptions?: ValidationOptions) {\nL131:       return function (object: any, propertyName: string) {\nL132:         registerDecorator({\nL133:           name: 'IsUserComment',\nL134:           target: object.constructor,\nL135:           propertyName: propertyName,\nL136:           options: validationOptions,\nL137:           validator: IsUserCommentValidatorConstraint,\nL138:         });\nL139:       };\nL140:     }\nL141: \nL142: Enter fullscreen mode Exit fullscreen mode\nL143: \nL144: If you don't know how to inject dependencies into a custom validator in class-validator library, this article can help you.\nL145: \nL146: My `ExtendedValidationArguments` interface looks like this:  \nL147: \nL148:     export interface ExtendedValidationArguments extends ValidationArguments {\nL149:       object: {\nL150:         [REQUEST_CONTEXT]: {\nL151:           user: IUser; // IUser is my interface for User class\nL152:         };\nL153:       };\nL154:     }\nL155: \nL156: Enter fullscreen mode Exit fullscreen mode\nL157: \nL158: It allows me to use valid typing in `ValidatorConstraint`. Without it, TypeScript will print out an error, that the `_requestContext` property doesn't exist.\nL159: \nL160: ##    Stripping Pipe \nL161: \nL162: Create Pipe, which will strip the request type object from User data context. If we don't do that, our DTO object will contain attached previously request data. We don't want that to happen. I'm using here one of the `lodash` function – omit(). It allows removing chosen properties from an object.  \nL163: \nL164:     @Injectable()\nL165:     export class StripRequestContextPipe implements PipeTransform {\nL166:       transform(value: any) {\nL167:         return omit(value, REQUEST_CONTEXT);\nL168:       }\nL169:     }\nL170: \nL171: Enter fullscreen mode Exit fullscreen mode\nL172: \nL173: ##    New decorators \nL174: \nL175: Creating new decorators is not necessary, but it's definitely a more clean and DRY approach than manually adding Interceptors and Pipes to the methods. We're going to use NestJS built-in function – `applyDecorators`, which allows merging multiple different decorators into a new one.  \nL176: \nL177:     export function InjectUserToQuery() {\nL178:       return applyDecorators(InjectUserTo('query'));\nL179:     }\nL180: \nL181:     export function InjectUserToBody() {\nL182:       return applyDecorators(InjectUserTo('body'));\nL183:     }\nL184: \nL185:     export function InjectUserToParam() {\nL186:       return applyDecorators(InjectUserTo('params'));\nL187:     }\nL188: \nL189:     export function InjectUserTo(context: 'query' | 'body' | 'params') {\nL190:       return applyDecorators(UseInterceptors(new InjectUserInterceptor(context)), UsePipes(StripRequestContextPipe));\nL191:     }\nL192: \nL193: Enter fullscreen mode Exit fullscreen mode\nL194: \nL195: To add your user data, just decorate your controller's method with one of the above decorators.  \nL196: \nL197:       @InjectUserToParam()\nL198:       async edit(@Param() params: EditParams){}\nL199: \nL200: Enter fullscreen mode Exit fullscreen mode\nL201: \nL202: Now, if you wanted to use your `IsUserComment` decorator in `EditParams`, you will be able to access injected user data.  \nL203: \nL204:     export class EditParams {\nL205:       @IsUserComment()\nL206:       commentId: number;\nL207:     }\nL208: \nL209: Enter fullscreen mode Exit fullscreen mode\nL210: \nL211: And that's all! You can use this method, to add any data from the request object to your custom validation class. Hope you find it helpful!\nL212: \nL213: You can find an example repository on my GitHub.\nL214: \nL215: In case you use in your `ValidationPipe` `whitelist: true` parameter, and above example doesn't work for you – check this issue.\nL216: \nL217: This article is highly inspired by the idea I've found in this comment on GitHub.\nL218: \nL219: PS. It's just proof of concept, and this comment ownership validation is a simple example of usage.\nL220: \nL221: ##  Validation tricks in NestJS (4 Part Series) \nL222: \nL223:  1 Custom validation with database in NestJS   2 Validating nested objects with class-validator in NestJS   3 Validating numeric query parameters in NestJS   4 Injecting request object to a custom validation class in NestJS  \nL224: \nL225: ##  Top comments (20)\nL226: \nL227: Subscribe\nL228: \nL229:     [Image 14: pic] \nL230: \nL231: Personal Trusted User\nL232: \nL233:  Create template  \nL234: \nL235: Templates let you quickly answer FAQs or store snippets for re-use.\nL236: \nL237: Submit Preview Dismiss \nL238: \nL239:   Collapse Expand\nL240: \nL241:   \nL242: \nL243:  Walid-Gerges  \nL244: \nL245:  Walid-Gerges \nL246: \nL247:  Walid-Gerges  \nL248: \nL249: Follow\nL250: \nL251:   * Joined \nL252: \nL253: Jul 26, 2021\nL254: \nL255: •  May 26 '22  \nL256: \nL257:  Dropdown menu\nL258: \nL259:   * Copy link\nL260:   *   * Hide \nL261:   *   *   * \nL262: \nL263: You can go a step forward and use request context.\nL264: \nL265: npmjs.com/package/@medibloc/nestjs...\nL266: \nL267: Thanks for your tips, it helped me.\nL268: \nL269:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL270: \nL271: Collapse Expand\nL272: \nL273:   \nL274: \nL275:  Monirul Islam  \nL276: \nL277:  Monirul Islam \nL278: \nL279:  Monirul Islam  \nL280: \nL281: Follow\nL282: \nL283: Full Stack Developer. Making the web awesome since 2018. \nL284: \nL285:   * Location \nL286: \nL287: Dhaka,Bangladesh \nL288: \nL289:   * Education \nL290: \nL291: Jahangirnagar University \nL292: \nL293:   * Work \nL294: \nL295: Sr. Software Engineer L-I at Vivasoft Ltd. \nL296: \nL297:   * Joined \nL298: \nL299: Sep 6, 2021\nL300: \nL301: •  Sep 19 '21  \nL302: \nL303:  Dropdown menu\nL304: \nL305:   * Copy link\nL306:   *   * Hide \nL307:   *   *   * \nL308: \nL309: this is not working ValidationArguments does not hold REQUEST_CONTEXT\nL310: \nL311:  Like comment:  Like comment:  Like  Comment button Reply \nL312: \nL313: Collapse Expand\nL314: \nL315:   \nL316: \nL317:  Krzysztof Szala  \nL318: \nL319:  Krzysztof Szala \nL320: \nL321:  Krzysztof Szala  \nL322: \nL323: Follow\nL324: \nL325: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL326: \nL327:   * Location \nL328: \nL329: Silesia \nL330: \nL331:   * Joined \nL332: \nL333: May 30, 2020\nL334: \nL335: •  Sep 20 '21  \nL336: \nL337:  Dropdown menu\nL338: \nL339:   * Copy link\nL340:   *   * Hide \nL341:   *   *   * \nL342: \nL343: There was obviously typo in decorator composition class. Instead of `AddUseTo`, there should be `InjectUserTo`. Please try if it works for you now.\nL344: \nL345:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL346: \nL347: Collapse Expand\nL348: \nL349:   \nL350: \nL351:  Krzysztof Szala  \nL352: \nL353:  Krzysztof Szala \nL354: \nL355:  Krzysztof Szala  \nL356: \nL357: Follow\nL358: \nL359: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL360: \nL361:   * Location \nL362: \nL363: Silesia \nL364: \nL365:   * Joined \nL366: \nL367: May 30, 2020\nL368: \nL369: •  Sep 20 '21 • Edited on Sep 20 • Edited  \nL370: \nL371:  Dropdown menu\nL372: \nL373:   * Copy link\nL374:   *   * Hide \nL375:   *   *   * \nL376: \nL377: Are you sure you created interceptor, which injects the REQUEST_CONTEXT? I'm using similar code in my production-ready app and it works for me.\nL378: \nL379:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL380: \nL381: Collapse Expand\nL382: \nL383:   \nL384: \nL385:  Monirul Islam  \nL386: \nL387:  Monirul Islam \nL388: \nL389:  Monirul Islam  \nL390: \nL391: Follow\nL392: \nL393: Full Stack Developer. Making the web awesome since 2018. \nL394: \nL395:   * Location \nL396: \nL397: Dhaka,Bangladesh \nL398: \nL399:   * Education \nL400: \nL401: Jahangirnagar University \nL402: \nL403:   * Work \nL404: \nL405: Sr. Software Engineer L-I at Vivasoft Ltd. \nL406: \nL407:   * Joined \nL408: \nL409: Sep 6, 2021\nL410: \nL411: •  Sep 20 '21  \nL412: \nL413:  Dropdown menu\nL414: \nL415:   * Copy link\nL416:   *   * Hide \nL417:   *   *   * \nL418: \nL419: yes i am using but its not working btw.I did exactly the way you said\nL420: \nL421:  Like comment:  Like comment:  Like  Thread Thread \nL422: \nL423:   \nL424: \nL425:  Monirul Islam  \nL426: \nL427:  Monirul Islam \nL428: \nL429:  Monirul Islam  \nL430: \nL431: Follow\nL432: \nL433: Full Stack Developer. Making the web awesome since 2018. \nL434: \nL435:   * Location \nL436: \nL437: Dhaka,Bangladesh \nL438: \nL439:   * Education \nL440: \nL441: Jahangirnagar University \nL442: \nL443:   * Work \nL444: \nL445: Sr. Software Engineer L-I at Vivasoft Ltd. \nL446: \nL447:   * Joined \nL448: \nL449: Sep 6, 2021\nL450: \nL451: •  Sep 20 '21  \nL452: \nL453:  Dropdown menu\nL454: \nL455:   * Copy link\nL456:   *   * Hide \nL457:   *   *   * \nL458: \nL459: even console logged the args but REQUEST_CONTEXT returns undefined\nL460: \nL461:  Like comment:  Like comment:  1 like Like  Thread Thread \nL462: \nL463:   \nL464: \nL465:  Siavash Habil  \nL466: \nL467:  Siavash Habil \nL468: \nL469:  Siavash Habil  \nL470: \nL471: Follow\nL472: \nL473:   * Joined \nL474: \nL475: Mar 29, 2022\nL476: \nL477: •  Mar 29 '22  \nL478: \nL479:  Dropdown menu\nL480: \nL481:   * Copy link\nL482:   *   * Hide \nL483:   *   *   * \nL484: \nL485: @monirul017 @avantar   \nL486: I had exactly same problem and after investigating it is happening because of `{whitelist: true}` of ValidationPipe and when you set it to false it will working properly but I didn't continue in this way because I want to whitelist the properties so temporary I added `_requestContext` to the related DTO file that I used in my controller and added it as an @IsOptional() decorator  \nL487: \nL488:     import { REQUEST_CONTEXT } from '../../../interceptors/inject-request-param.interceptor';\nL489: \nL490:       @IsOptional()\nL491:       \\[REQUEST_CONTEXT\\]: any;\nL492: \nL493: Enter fullscreen mode Exit fullscreen mode\nL494: \nL495: Ignore \"\\\" from the above code.\nL496: \nL497: For others trying to use this article as a solution continue using from attached repository.\nL498: \nL499: At the end thank you @avantar for your solution.\nL500: \nL501:  Like comment:  Like comment:  3 likes Like  Thread Thread \nL502: \nL503:   \nL504: \nL505:  Krzysztof Szala  \nL506: \nL507:  Krzysztof Szala \nL508: \nL509:  Krzysztof Szala  \nL510: \nL511: Follow\nL512: \nL513: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL514: \nL515:   * Location \nL516: \nL517: Silesia \nL518: \nL519:   * Joined \nL520: \nL521: May 30, 2020\nL522: \nL523: •  Mar 29 '22  \nL524: \nL525:  Dropdown menu\nL526: \nL527:   * Copy link\nL528:   *   * Hide \nL529:   *   *   * \nL530: \nL531: Thank you, @siavash_habil! This can be helpful as well.\nL532: \nL533: github.com/AvantaR/nestjs-validati...\nL534: \nL535:  Like comment:  Like comment:  2 likes Like  Thread Thread \nL536: \nL537:   \nL538: \nL539:  Siavash Habil  \nL540: \nL541:  Siavash Habil \nL542: \nL543:  Siavash Habil  \nL544: \nL545: Follow\nL546: \nL547:   * Joined \nL548: \nL549: Mar 29, 2022\nL550: \nL551: •  Mar 29 '22  \nL552: \nL553:  Dropdown menu\nL554: \nL555:   * Copy link\nL556:   *   * Hide \nL557:   *   *   * \nL558: \nL559: @avantar This is almost happened at the same time for both of us because I solved it about 20 hours ago. :)  \nL560: Thank you for sharing.\nL561: \nL562:  Like comment:  Like comment:  1 like Like  Thread Thread \nL563: \nL564:   \nL565: \nL566:  Krzysztof Szala  \nL567: \nL568:  Krzysztof Szala \nL569: \nL570:  Krzysztof Szala  \nL571: \nL572: Follow\nL573: \nL574: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL575: \nL576:   * Location \nL577: \nL578: Silesia \nL579: \nL580:   * Joined \nL581: \nL582: May 30, 2020\nL583: \nL584: •  Mar 29 '22  \nL585: \nL586:  Dropdown menu\nL587: \nL588:   * Copy link\nL589:   *   * Hide \nL590:   *   *   * \nL591: \nL592: What a coincidence! Magic \nL593: \nL594:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL595: \nL596: Collapse Expand\nL597: \nL598:   \nL599: \nL600:  tkssharma  \nL601: \nL602:  tkssharma \nL603: \nL604:  tkssharma  \nL605: \nL606: Follow\nL607: \nL608: Hi, I’m Tarun. I help people to make a better world by building apps. I am Publisher, Trainer Developer, working on Enterprise and open source Technologies JavaScript frameworks (React Angular) \nL609: \nL610:   * Email \nL611: \nL612: tarun.softengg@gmail.com \nL613: \nL614:   * Location \nL615: \nL616: Delhi, India \nL617: \nL618:   * Work \nL619: \nL620: Lead Engineer \nL621: \nL622:   * Joined \nL623: \nL624: Nov 5, 2018\nL625: \nL626: •  Sep 10 '21  \nL627: \nL628:  Dropdown menu\nL629: \nL630:   * Copy link\nL631:   *   * Hide \nL632:   *   *   * \nL633: \nL634: this is awesome but not sure if i want to use this !! not a clean solution \nL635: \nL636:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL637: \nL638: Collapse Expand\nL639: \nL640:   \nL641: \nL642:  Krzysztof Szala  \nL643: \nL644:  Krzysztof Szala \nL645: \nL646:  Krzysztof Szala  \nL647: \nL648: Follow\nL649: \nL650: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL651: \nL652:   * Location \nL653: \nL654: Silesia \nL655: \nL656:   * Joined \nL657: \nL658: May 30, 2020\nL659: \nL660: •  Sep 10 '21  \nL661: \nL662:  Dropdown menu\nL663: \nL664:   * Copy link\nL665:   *   * Hide \nL666:   *   *   * \nL667: \nL668: Totally agree, but sometimes we need to do something dirty way ‍♂️ Thanks for your feedback! \nL669: \nL670:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL671: \nL672: Collapse Expand\nL673: \nL674:   \nL675: \nL676:  Dolphine Dev  \nL677: \nL678:  Dolphine Dev \nL679: \nL680:  Dolphine Dev  \nL681: \nL682: Follow\nL683: \nL684:   * Joined \nL685: \nL686: Aug 4, 2023\nL687: \nL688: •  Aug 4 • Edited on Aug 4 • Edited  \nL689: \nL690:  Dropdown menu\nL691: \nL692:   * Copy link\nL693:   *   * Hide \nL694:   *   *   * \nL695: \nL696: When using @ValidateNested(), the `args?.object[REQUEST_CONTEXT]` is undefined because the context passed to the nested validation is not the same as the one at the top level.\nL697: \nL698:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL699: \nL700: Collapse Expand\nL701: \nL702:   \nL703: \nL704:  Wahyu Baskara  \nL705: \nL706:  Wahyu Baskara \nL707: \nL708:  Wahyu Baskara  \nL709: \nL710: Follow\nL711: \nL712:   * Joined \nL713: \nL714: Apr 25, 2022\nL715: \nL716: •  Aug 4  \nL717: \nL718:  Dropdown menu\nL719: \nL720:   * Copy link\nL721:   *   * Hide \nL722:   *   *   * \nL723: \nL724: ValidationArguments does not hold REQUEST_CONTEXT when using nested validation object\nL725: \nL726:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL727: \nL728: Collapse Expand\nL729: \nL730:   \nL731: \nL732:  Xjsny  \nL733: \nL734:  Xjsny \nL735: \nL736:  Xjsny  \nL737: \nL738: Follow\nL739: \nL740:   * Joined \nL741: \nL742: Jun 15, 2022\nL743: \nL744: •  Jun 15 '22  \nL745: \nL746:  Dropdown menu\nL747: \nL748:   * Copy link\nL749:   *   * Hide \nL750:   *   *   * \nL751: \nL752: It didn’t work if I request data with multipart/form-data. Is there any solution for form data request.\nL753: \nL754:  Like comment:  Like comment:  Like  Comment button Reply \nL755: \nL756: Collapse Expand\nL757: \nL758:   \nL759: \nL760:  htdai  \nL761: \nL762:  htdai \nL763: \nL764:  htdai  \nL765: \nL766: Follow\nL767: \nL768: Full-stack Overflow Copyist \nL769: \nL770:   * Joined \nL771: \nL772: Mar 28, 2023\nL773: \nL774: •  Mar 28  \nL775: \nL776:  Dropdown menu\nL777: \nL778:   * Copy link\nL779:   *   * Hide \nL780:   *   *   * \nL781: \nL782: stackoverflow.com/a/75139788\nL783: \nL784: Maybe it's late but I found the solution for inject current user into body when using form-data  \nL785: I have tested and it works perfectly for me\nL786: \nL787:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL788: \nL789: Collapse Expand\nL790: \nL791:   \nL792: \nL793:  Szymon Sukiennik  \nL794: \nL795:  Szymon Sukiennik \nL796: \nL797:  Szymon Sukiennik  \nL798: \nL799: Follow\nL800: \nL801:   * Joined \nL802: \nL803: Nov 29, 2021\nL804: \nL805: •  Nov 29 '21  \nL806: \nL807:  Dropdown menu\nL808: \nL809:   * Copy link\nL810:   *   * Hide \nL811:   *   *   * \nL812: \nL813: Did you ever managed to port a similar approach to graphql in Nest? Namely, to have access to part or even whole gql context inside validator or validation rule?\nL814: \nL815:  Like comment:  Like comment:  Like  Comment button Reply \nL816: \nL817: Collapse Expand\nL818: \nL819:   \nL820: \nL821:  Krzysztof Szala  \nL822: \nL823:  Krzysztof Szala \nL824: \nL825:  Krzysztof Szala  \nL826: \nL827: Follow\nL828: \nL829: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL830: \nL831:   * Location \nL832: \nL833: Silesia \nL834: \nL835:   * Joined \nL836: \nL837: May 30, 2020\nL838: \nL839: •  Mar 28 '22  \nL840: \nL841:  Dropdown menu\nL842: \nL843:   * Copy link\nL844:   *   * Hide \nL845:   *   *   * \nL846: \nL847: Hi!\nL848: \nL849: No, I haven't tried to use it with GraphQL, sorry.\nL850: \nL851:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL852: \nL853: Collapse Expand\nL854: \nL855:   \nL856: \nL857:  davidN96  \nL858: \nL859:  davidN96 \nL860: \nL861:  davidN96  \nL862: \nL863: Follow\nL864: \nL865:   * Joined \nL866: \nL867: Apr 25, 2021\nL868: \nL869: •  Jun 23 '21  \nL870: \nL871:  Dropdown menu\nL872: \nL873:   * Copy link\nL874:   *   * Hide \nL875:   *   *   * \nL876: \nL877: Hey! Thank you for a great article!\nL878: \nL879:  Like comment:  Like comment\nVisible: 0% - 84%"}]},"command":"click","args":[3],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"4da87626-aaca-4d09-80fd-db3c79a3aee3","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"4da87626-aaca-4d09-80fd-db3c79a3aee3","children":["9517698f-527f-4109-8348-b9a68f4532e0"]},"4da87626-aaca-4d09-80fd-db3c79a3aee3":{"id":"4da87626-aaca-4d09-80fd-db3c79a3aee3","message":{"id":"4da87626-aaca-4d09-80fd-db3c79a3aee3","author":{"role":"assistant","metadata":{}},"create_time":1703480183.194955,"content":{"content_type":"code","language":"unknown","text":"click(3)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"092f5747-d2b7-4ed8-999d-e0b6b76d8882","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"092f5747-d2b7-4ed8-999d-e0b6b76d8882","children":["ef34b855-867c-4ae6-ab80-9b79a353eebe"]},"092f5747-d2b7-4ed8-999d-e0b6b76d8882":{"id":"092f5747-d2b7-4ed8-999d-e0b6b76d8882","message":{"id":"092f5747-d2b7-4ed8-999d-e0b6b76d8882","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.186066,"content":{"content_type":"tether_browsing_display","result":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Validation | NestJS - A progressive Node.js framework","url":"https://docs.nestjs.com/techniques/validation","text":"\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: "},{"type":"webpage","title":"Custom validation with database in NestJS - DEV Community","url":"https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao","text":"\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: "},{"type":"webpage","title":"Validation - GitHub: Let’s build from here","url":"https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md","text":"\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: "},{"type":"webpage","title":"Injecting request object to a custom validation class in NestJS","url":"https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal","text":"\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: "},{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: "},{"type":"webpage","title":"NestJS and ‘class validator’ cheat sheet - DEV Community","url":"https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao","text":"\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: "},{"type":"webpage","title":"How to implement input validation with NestJS - Sébastien Dubois","url":"https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/","text":"\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: "},{"type":"webpage","title":"How to use class-validator and generate custom error object in nest.js","url":"https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h","text":"\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: "},{"type":"webpage","title":"Building a REST API with NestJS and Prisma: Input Validation ...","url":"https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1","text":"\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: "},{"type":"webpage","title":"NestJS Custom Payload Validation - DEV Community","url":"https://dev.to/shubham_kadam/nestjs-custom-payload-validation-3hh7","text":"\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: "},{"type":"webpage","title":"Mastering Email Validation in NestJS: A Comprehensive Guide","url":"https://emaillistvalidation.com/blog/mastering-email-validation-in-nestjs-a-comprehensive-guide/","text":"\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: "},{"type":"webpage","title":"Custom Card v2 Signature Validation in NestJS - community.hubspot.com","url":"https://community.hubspot.com/t5/APIs-Integrations/Custom-Card-v2-Signature-Validation-in-NestJS/m-p/897350","text":"\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"},{"type":"webpage","title":"Search results for query: 'nestjs class-validator custom validation method documentation'","url":"","text":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"}]},"command":"back","args":[],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"90910b26-0ce6-4c9a-ac77-6b82c92d4498","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"90910b26-0ce6-4c9a-ac77-6b82c92d4498","children":["4da87626-aaca-4d09-80fd-db3c79a3aee3"]},"90910b26-0ce6-4c9a-ac77-6b82c92d4498":{"id":"90910b26-0ce6-4c9a-ac77-6b82c92d4498","message":{"id":"90910b26-0ce6-4c9a-ac77-6b82c92d4498","author":{"role":"assistant","metadata":{}},"create_time":1703480183.175513,"content":{"content_type":"code","language":"unknown","text":"back()"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"e1ab7557-ed13-451e-b7a2-8de9aca7f653","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"e1ab7557-ed13-451e-b7a2-8de9aca7f653","children":["092f5747-d2b7-4ed8-999d-e0b6b76d8882"]},"e1ab7557-ed13-451e-b7a2-8de9aca7f653":{"id":"e1ab7557-ed13-451e-b7a2-8de9aca7f653","message":{"id":"e1ab7557-ed13-451e-b7a2-8de9aca7f653","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.166702,"content":{"content_type":"tether_browsing_display","result":"L0: \nL1: URL: https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/\nL2: \nL3: 【0† Sébastien Dubois 】 \nL4: \nL5:   * 【1†Home】\nL6:   * 【2†Newsletter】\nL7:   * 【3†Courses】\nL8:   * 【4†Obsidian Starter Kit†obsidianstarterkit.com】\nL9:   * 【5†PKM Coaching†developassion.gumroad.com】\nL10:   * 【6†PKM Library†developassion.gumroad.com】\nL11:   * 【7†YouTube†youtube.com】\nL12:   * 【8†Projects】\nL13:   * 【9†Books】\nL14:   * 【10†About】\nL15:   * 【11†Now】\nL16:   * 【12†Uses】\nL17:   * 【13†Links】\nL18: \nL19: Subscribe \nL20: \nL21: 【14†blog】 \nL22: \nL23: # How to implement input validation with NestJS\nL24: \nL25: 【15† 】 \nL26: \nL27: ####  【15†Sebastien Dubois】 \nL28: \nL29: Jul 23, 2020 12 min\nL30: \nL31: Learn how to validate incoming data with NestJS\nL32: \nL33: [Image 0: How to implement input validation with NestJS] \nL34: \nL35: Validating incoming data is of the utmost importance for security. Let’s explore why and how to handle this concern with 【16†NestJS†nestjs.com】.\nL36: \nL37: 【16†NestJS†nestjs.com】 is one of the most popular Node-based back-end frameworks around. It is currently at 【17†rank #198 of the most popular Github repositories†gitstar-ranking.com】 (based on stars); quite an achievement. And it is deserved; this framework does a great job at structuring larger back-end systems; just like Spring does in the Java ecosystem.\nL38: \nL39: In this article, we’ll explore how to handle input validation with 【16†NestJS†nestjs.com】. I will cover the most frequent use case: RESTful APIs, but most of what I’ll explain also applies to GraphQL APIs and WebSockets.\nL40: \nL41: Let’s dive right in!\nL42: \nL43: ## Validation? Why?\nL44: \nL45: Injection attacks are still part of the 【18†OWASP Top 10†owasp.org】; a list of the most critical security threats to Web applications.\nL46: \nL47: As 【19†the 2019 report mentions†github.com】, injection flaws are very prevalent and can result in data loss, corruption or disclosure of data to unauthorized parties or even complete host takeover (aka oopsie doopsie).\nL48: \nL49: If the data that your application handles is not important, then you probably don’t care, but most often this is only true of toy projects. For most real world applications, data is critical and must be protected adequately. Failing to do so can lead to devastating business impacts.\nL50: \nL51: But what does this have to do with validation? Well validation is one of the main ways to circumvent injection attacks. All client/user-supplied data MUST be validated, filtered and properly sanitized by the applications.\nL52: \nL53: By validating incoming data, you can ensure that:\nL54: \nL55:   * The data has the expected shape \nL56:   * The data has the expected types/formats \nL57:   * The data is valid from a business point of view \nL58:   * The data is valid for the intended purpose \nL59: \nL60: That way, if an attacker tries to manipulate inputs so as to pollute your data or break into your systems, then you’ll at least try to fight against it.\nL61: \nL62: Validation alone is unfortunately not sufficient, but we’ll focus solely on it in this article. I strongly encourage you to read the 【19†full report here†github.com】 to learn more about how to protect yourself against the most prevalent threats to application security (even if there are many more those those critical ones).\nL63: \nL64: By the way, the OWASP also maintains a 【20†nice cheatsheet about input validation†cheatsheetseries.owasp.org】 which you should take a look at.\nL65: \nL66: In the next sections, I’ll explain what NestJS has to offer regarding validation and we’ll dive in an example together, demonstrating how to configure validation support and how to enforce validations.\nL67: \nL68: ## NestJS support for validation \nL69: \nL70: Being a framework, NestJS does a great job at providing us with many tools, bells and whistles out of the box. Two of those tools are the support for 【21†Pipes†docs.nestjs.com】 and 【22†Validation†docs.nestjs.com】.\nL71: \nL72: As you probably know, NestJS is heavily inspired by Angular, so it’s no wonder that it has support for pipes like Angular does.\nL73: \nL74: NestJS pipes have two main use cases:\nL75: \nL76:   * transformation of input data \nL77:   * validation of input data \nL78: \nL79: When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL80: \nL81: Out of the box, NestJS includes a number of pipes; some of which are dedicated to validation:\nL82: \nL83:   * ValidationPipe (which we’ll explore in this article)\nL84:   * ParseIntPipe \nL85:   * ParseBoolPipe \nL86:   * ParseArrayPipe \nL87:   * ParseUUIDPipe \nL88: \nL89: There are multiple ways to bind pipes to route handler methods (again, we’re focusing on RESTful APIs here, but I’ll mention other types of APIs later on).\nL90: \nL91: Here’s a first one, taken from the official documentation:\nL92: \nL93:     @Get(':id')\nL94:     async findOne(@Param('id', ParseIntPipe) id: number) {\nL95:       return this.catsService.findOne(id);\nL96:     }\nL97: \nL98: In the example above, the built-in `ParseIntPipe` is associated with the `findOne` route handler method. Before the method is called, the pipe will be invoked to validate that the `id` parameter is indeed an integer. Easy as pie, right?\nL99: \nL100: The nice thing about NestJS validation pipes is that when the method is invoked, then you can consider that the data you have received is structurally valid (shape and form); otherwise an exception would’ve been thrown (and automagically converted into an HTTP 4xx error for the client). That is of course not enough for input validation, but it goes a long way already.\nL101: \nL102: If inputs fail to pass validation checks, then the client will receive an error such as this one:\nL103: \nL104:     {\nL105:       \"statusCode\": 400,\nL106:       \"message\": \"Validation failed (numeric string is expected)\",\nL107:       \"error\": \"Bad Request\"\nL108:     }\nL109: \nL110: To me, it is a good enough default for client errors, even if I prefer the structure proposed by 【23†RFC 7807 (problem details for HTTP APIs)†github.com】, but that’s another subject.\nL111: \nL112: This means that your RESTful route handler methods can respect the 【24†Single Responsibility Principle (SRP)†en.wikipedia.org】 and concentrate on forwarding the requests to some other places in the system, where they can be further validated/processed/handled.\nL113: \nL114: Note that it is also possible to create and use a specific instance of a NestJS pipe:\nL115: \nL116:     @Get(':id')\nL117:     async findOne(\nL118:       @Param('id', new ParseIntPipe({ errorHttpStatusCode: HttpStatus.NOT_ACCEPTABLE }))\nL119:       id: number,\nL120:     ) {\nL121:       return this.catsService.findOne(id);\nL122:     }\nL123: \nL124: Here, a custom instance of the `ParseIntPipe` with a specific configuration was associated with the injected `id` param. This is interesting because it means that you can rely on the default behavior, but also customize it when you need to.\nL125: \nL126: You can of course create your own pipes, to perform any validation you’d like; we’ll look at that a bit later in this article.\nL127: \nL128: Another way to define pipes is to add the `UsePipes()` decorator:\nL129: \nL130:     @Post()\nL131:     @UsePipes(new JoiValidationPipe(createCatSchema))\nL132:     async create(@Body() createCatDto: CreateCatDto) {\nL133:       this.catsService.create(createCatDto);\nL134:     }\nL135: \nL136: With the above, the `JoiValidationPipe` (which is not a built-in pipe) will validate the input data against the provided Joi schema (more on this in the next section).\nL137: \nL138: ## Supported validation types \nL139: \nL140: NestJS supports different means of 【22†validating data†docs.nestjs.com】. In this article, I’ll only discuss the solution using 【25†class-validator,†github.com】 as it covers my needs perfectly, but I’ll still mention the other ones for the sake of completeness.\nL141: \nL142: ### Schema-based validation with Joi \nL143: \nL144: The first approach discussed in the 【21†Pipes documentation†docs.nestjs.com】 is using schema-based validation, for instance using the 【26†Joi†github.com】 library:\nL145: \nL146: The above is a custom NestJS pipe. As you can see, it is quite simple to create one: it’s just a class implementing `PipeTransform` and its `transform` method, which receives the raw value sent to the server, as well as metadata.\nL147: \nL148: In this case, the custom pipe makes use of Joi to validate that the input data respects the configured Joi schema. Each instance of this pipe expects a schema to be passed into the constructor.\nL149: \nL150: This is how the schema is passed in by the route handler methods:\nL151: \nL152:     @UsePipes(new JoiValidationPipe(createCatSchema))\nL153: \nL154: In my current project, I chose not to use this approach because, unfortunately, I couldn’t find an easy/maintainable way to keep my validation schemas strongly aligned with my TypeScript interfaces. I did find libraries that could’ve helped: 【27†typesafe-joi†github.com】 and 【28†joi-extract-type†github.com】, but both of those were either unmaintained/abandoned or only compatible with legacy versions of Joi, so it felt like a risky bet to make.\nL155: \nL156: ### Schema based validation with JSON schema \nL157: \nL158: Another approach for schema-based validation is to use 【29†JSON schemas†json-schema.org】 and validate data against those using libraries such as the 【30†ajv†ajv.js.org】 JSON schema validator.\nL159: \nL160: This also requires the creation of custom validation pipes for NestJS as there is no built-in support.\nL161: \nL162: I’ve rejected this option for my project because of the complexity/overhead; again related to keeping the data model and the validation schemas in sync.\nL163: \nL164: I did find the following library to generate JSON schemas from TypeScript code, but didn’t look into it in detail: 【31†https://github.com/YousefED/typescript-json-schema†github.com】\nL165: \nL166: If you’re interested in that approach, then take a look at the following articles:\nL167: \nL168:   * 【32†https://medium.com/javascript-in-plain-english/how-to-test-json-schema-with-ajv-in-typescript-bd0361e0c03e†medium.com】\nL169:   * 【33†https://levelup.gitconnected.com/typescript-validation-with-ajv-1b70a76dd678†levelup.gitconnected.com】\nL170: \nL171: ### class-validator \nL172: \nL173: The last approach, which is also the one that’s (IMO) currently best supported by NestJS, uses 【25†class-validator†github.com】.\nL174: \nL175: class-validator is a very popular TypeScript validation library that provides 【34†many validation decorators†github.com】.\nL176: \nL177: In order to co configure validation with class-validator, you simply have to add decorators on fields that need validation. Here’s an example taken from the official docs:\nL178: \nL179: As you can see, expressing the validation rules is pretty straightforward.\nL180: \nL181: Note that while class-validator expect you to be using classes. It 【35†does actually support schema-based validation†github.com】 as well, but I wasn’t convinced by the maturity of that approach. The `ValidationSchema` type provided out of the box is 【36†weakly typed†github.com】 (goodbye refactoring!) and there are 【37†unfixed bugs†github.com】 around it, so I wouldn’t recommend it.\nL182: \nL183: In my project, it was a bit frustrating because I could manage without classes so far (and felt pretty happy about it!), but validation kind of forced me to create classes after all. Still, it felt like the safest bet at this point, given the low maturity of JS/TS validation (just my opinion of course!), compared to other languages/platforms (I sometimes miss bean validation :p).\nL184: \nL185: Also, this approach has great support out of the box by NestJS, through its `ValidationPipe`, which we’ll explore next.\nL186: \nL187: ### Other options \nL188: \nL189: In this section, I’ve covered the different solutions mentioned in NestJS’s documentation, but it’s far from all that you can do.\nL190: \nL191: There are a myriad of options for runtime type checking/validation, such as 【38†io-ts†github.com】, which I wrote about in 【39†my TS book†www.amazon.com】, 【40†zod†github.com】, 【41†runtypes†github.com】, 【42†vest†github.com】, and many more. You can find a 【43†nice article about this subject here†2ality.com】.\nL192: \nL193: As a side note, a NestJS maintainer also recommended 【44†Marshall†github.com】 to me as an alternative to class-validator, as it is apparently much more performant and provides a custom NestJS pipe for ease of use. Still, I chose class-validator for now as it is supported right out of the box and battle tested. If NestJS switches over, then I’ll probably follow along. Anyhow, to me, maintainability and support trump performance… until performance really becomes a bottleneck ;-)\nL194: \nL195: ## ValidationPipe \nL196: \nL197: As I’ve mentioned, NestJS provides a built-in `ValidationPipe`. That pipe actually uses 【25†class-validator†github.com】 and 【45†class-transformer†github.com】 (two libraries that go hand in hand) underneath the cover.\nL198: \nL199: The interesting thing about this built-in pipe is that it handles validation as well as transformation of input data into class instances. Thus, if you use it, then your request handlers will receive class instances with properly validated data.\nL200: \nL201: For the validation pipe to kick in, you need to refer to classes in your route handler arguments. If you use “any” or an interface, then the validation pipe won’t be able to help! In my project, it was annoying because it forced me to introduce classes just for the sake of validation, but I known that I’ll ultimately benefit from those for other purposes with NestJS.\nL202: \nL203: The `ValidationPipe` of NestJS can be tweaked according to your needs; you can make it more or less strict, you can disable or enable data transformation, etc.\nL204: \nL205: To use this pipe, you have multiple options. Just like I showed earlier, you can declare it locally on a route handler (e.g., through `@UsePipes`), but you can also enable it globally for your application. The advantage of declaring it as a global pipe is that it’ll always be there (at least for HTTP route handlers); no need to think about it, so it’s a safer route (pun intended). Less to think about = less potential mistakes.\nL206: \nL207: To configure this pipe globally, open your “main.ts” file and add the following:\nL208: \nL209:     app.useGlobalPipes(new ValidationPipe({ ... }));\nL210: \nL211: Here’s how I’ve configured this pipe for my current project:\nL212: \nL213: As you can see, I’ve tweaked the configuration a bit; let me explain:\nL214: \nL215:   * `whitelist: true` tells NestJS to strip the validated (i.e., returned) object of any properties that do not use any validation decorators. This of course means that all fields in your class should be annotated with class-validator decorators; otherwise the fields will be removed. The good news is that it ensures that you will never receive unexpected fields. This is especially important to avoid injecting data silently \nL216:   * `forbidNonWhitelisted: true` instructs NestJS to throw an exception if there are unexpected fields. This is stricter, but even clearer. At least the client will know if/when it provides invalid/unexpected data \nL217:   * `forbitUnknownValues` unknown objects are immediately rejected \nL218:   * `validationError: { value: false }` tells NestJS not to reflect the value at fault in the error responses. This lightens the responses and might limit sensitive data exposure in some cases \nL219:   * `transform: true` tells NestJS to return the validated class instance \nL220: \nL221: With this global configuration in place, all the route handlers that depend on classes will have validation in place; assuming that those classes are all properly annotated with class-validator decorators. Neat!\nL222: \nL223: ## ValidationPipe example \nL224: \nL225: Here’s a concrete example using the `ValidationPipe` of NestJS.\nL226: \nL227: This is the controller that should receive validated data. Here, let’s first concentrate on the `@Body()`. As you can see, we inject the body of the POST request, and expect it to be an instance of the `MeetingPartialUpdate` class.\nL228: \nL229: If the `ValidationPipe` is enabled/configured globally (cfr. last section), and if `MeetingPartialUpdate` is a class annotated with class-validator decorators, then the `ValidationPipe` will handle validations for us. The same is true for the injected parameters (I’ll come back to this later).\nL230: \nL231: Here’s what the body class looks like:\nL232: \nL233: This is standard class-validator usage, so nothing special to mention here if you’re already familiar with class-validator. If you’re not, then notice that we use quite a few validators here, some of which are marked as optional. We’re also leveraging nested validation support, Regex matching, etc.\nL234: \nL235: There are many more validators included in the library, so it’s quite powerful. You can also easily create 【46†custom validators†github.com】 (【46†classes†github.com】 and 【47†decorators†github.com】) if needed.\nL236: \nL237: With the above, the `ValidationPipe` will ensure that the received data matches our expectations (shape and content).\nL238: \nL239: This is a strong first step forward good input validation. But we can do better!\nL240: \nL241: ## Validating resource handler parameters \nL242: \nL243: In the previous section, I’ve focused on the validation of the body. But, as I’ve mentioned, the other input parameter that is injected is also validated.\nL244: \nL245: I think that it’s important to mention that the `ValidationPipe` validates everything that is class-based (and correctly annotated). Based on this, I really recommend you to create classes for all of the inputs (body, query parameters, URL parameters, etc) and use those so that you get strict input validation for everything. And I mean this also for single string parameters; even if it means introducing a class with a single field. It’s clearly worth it.\nL246: \nL247: In the previous example, the `MeetingsControllerInputParams` class only contains two fields, corresponding to the two URL parameters:\nL248: \nL249: That way, the URL parameters are also validated. Quite cool if you ask me!\nL250: \nL251: ## One step further \nL252: \nL253: As I’ve said, validation is more complex than that. Fields must be valid (structure/shape), but they also need to match. For instance, when updating a resource, the resource identifier is mentioned once in the URL, but it is also present in the body of the request. Both values must be the same for the update request to be considered valid and class-validator can’t help with such scenarios as the data is decoupled.\nL254: \nL255: The same goes for other things, but it’s a point to keep in mind: don’t consider that simple/basic input validation will cut it, security wise. Then there’s also of course optimistic concurrency handling, authentication, authorization and quite a lot of additional things to take care of.. ;-)\nL256: \nL257: To go further with input validation in my project, I’ve used a guard because it matched my requirements but, depending on which validations you need to perform, a pipe might be more adequate. Through this generic guard, I could implement checks such as:\nL258: \nL259:   * matching between URL parameters and body values \nL260:   * presence of the If-Match header and matching with the body values \nL261:   * etc \nL262: \nL263: Note that business services that sit behind REST controllers, lower in the architecture, perform additional validations (business-wise!) and authorization. I’ll write about that another day.\nL264: \nL265: ## GraphQL \u0026 WebSockets \nL266: \nL267: As with RESTful APIs, GraphQL APIs and WebSocket “tunnels” also need proper validation.\nL268: \nL269: For GraphQL, the good news is that it is apparently possible to declare the validation pipe along with the `@Args` decorator, as shared here by John Niomair: 【48†https://github.com/nestjs/nest/issues/819#issuecomment-480247274†github.com】\nL270: \nL271: Finally, the built-in validation pipe is supposed to work all the same for WebSocket gateways, so you should be able to add the `UsePipes` decorator on the gateway methods and go from there (I don’t think it works with the global pipes). Although I didn’t test this myself so far…\nL272: \nL273: ## Conclusion \nL274: \nL275: In this article, I’ve explained why input validation matters so much for security. Then, I’ve described the built-in validation support of NestJS.\nL276: \nL277: Finally, I’ve walked you through an example and shared some thoughts about how to properly validate your inputs.\nL278: \nL279: Thanks to the whole setup, the route handlers of our NestJS controllers can focus solely on passing commands/queries around and don’t have to worry about input validation, which is great for separation of concerns.\nL280: \nL281: Once again, this is just the tip of the iceberg. Validation is required across many layers, in different shapes and forms. In addition, validation is only a small part of the overall picture; many other aspects must be taken care of to ensure a good security posture (e.g., authentication, authorization, business validations, error handling, audit logging, monitoring, etc).\nL282: \nL283: That's it for today! ✨\nL284: \nL285: 【49†Subscribe to the newsletter】\nL286: \nL287: ## About Sébastien \nL288: \nL289: Hello everyone! I'm Sébastien Dubois. I'm an author, founder, and CTO. I write books and articles about software development \u0026 IT, personal knowledge management, personal organization, and productivity. I also craft lovely digital products   \nL290: \nL291: If you've enjoyed this article and want to read more like this, then 【50†become a subscriber】, check out my 【51†Obsidian Starter Kit†developassion.gumroad.com】, the 【6†PKM Library†developassion.gumroad.com】 and my 【52†collection of books about software development†dev-concepts.dev】 .  \nL292: \nL293: You can 【53†follow me on Twitter†twitter.com】   \nL294: \nL295: If you want to discuss, then don't hesitate to join the 【54†Personal Knowledge Management community†dsebastien.net】 or the 【55†Software Crafters community†dsebastien.net】.\nL296: \nL297: #### Read next\nL298: \nL299: 【56† TypeScript 3 Projects: What's next? An appendix to my TypeScript book Sebastien Dubois Nov 12, 2019 】  【57† Configuring and using the Apollo client in a Next.js TypeScript application Learn how to integrate the Apollo GraphQL client in a Next.js TypeScript application Sebastien Dubois Feb 24, 2021 】  【58† On the importance of non-goals Goals are key to progress, but non-goals are complementary, and help go in the right direction. Here's why. Sebastien Dubois Aug 4, 2023 】 \nL300: \nL301: #### Comments () \nL302: \nL303: ### Subscribe to Sébastien Dubois\nL304: \nL305: Don't miss out on the latest Knowledge Management news. Sign up now to get access to the library of members-only articles.\nL306: \nL307: Subscribe now\nL308: \nL309:   * Sign up\nL310: \nL311: Passion makes all the difference.\nVisible: 0% - 100%","summary":"How to implement input validation with NestJS (www.dsebastien.net)\n","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"How to implement input validation with NestJS","url":"https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/","text":"L0: \nL1: URL: https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/\nL2: \nL3:  Sébastien Dubois  \nL4: \nL5:   * Home\nL6:   * Newsletter\nL7:   * Courses\nL8:   * Obsidian Starter Kit\nL9:   * PKM Coaching\nL10:   * PKM Library\nL11:   * YouTube\nL12:   * Projects\nL13:   * Books\nL14:   * About\nL15:   * Now\nL16:   * Uses\nL17:   * Links\nL18: \nL19: Subscribe \nL20: \nL21: blog \nL22: \nL23: # How to implement input validation with NestJS\nL24: \nL25:   \nL26: \nL27: ####  Sebastien Dubois \nL28: \nL29: Jul 23, 2020 12 min\nL30: \nL31: Learn how to validate incoming data with NestJS\nL32: \nL33: [Image 0: How to implement input validation with NestJS] \nL34: \nL35: Validating incoming data is of the utmost importance for security. Let’s explore why and how to handle this concern with NestJS.\nL36: \nL37: NestJS is one of the most popular Node-based back-end frameworks around. It is currently at rank #198 of the most popular Github repositories (based on stars); quite an achievement. And it is deserved; this framework does a great job at structuring larger back-end systems; just like Spring does in the Java ecosystem.\nL38: \nL39: In this article, we’ll explore how to handle input validation with NestJS. I will cover the most frequent use case: RESTful APIs, but most of what I’ll explain also applies to GraphQL APIs and WebSockets.\nL40: \nL41: Let’s dive right in!\nL42: \nL43: ## Validation? Why?\nL44: \nL45: Injection attacks are still part of the OWASP Top 10; a list of the most critical security threats to Web applications.\nL46: \nL47: As the 2019 report mentions, injection flaws are very prevalent and can result in data loss, corruption or disclosure of data to unauthorized parties or even complete host takeover (aka oopsie doopsie).\nL48: \nL49: If the data that your application handles is not important, then you probably don’t care, but most often this is only true of toy projects. For most real world applications, data is critical and must be protected adequately. Failing to do so can lead to devastating business impacts.\nL50: \nL51: But what does this have to do with validation? Well validation is one of the main ways to circumvent injection attacks. All client/user-supplied data MUST be validated, filtered and properly sanitized by the applications.\nL52: \nL53: By validating incoming data, you can ensure that:\nL54: \nL55:   * The data has the expected shape \nL56:   * The data has the expected types/formats \nL57:   * The data is valid from a business point of view \nL58:   * The data is valid for the intended purpose \nL59: \nL60: That way, if an attacker tries to manipulate inputs so as to pollute your data or break into your systems, then you’ll at least try to fight against it.\nL61: \nL62: Validation alone is unfortunately not sufficient, but we’ll focus solely on it in this article. I strongly encourage you to read the full report here to learn more about how to protect yourself against the most prevalent threats to application security (even if there are many more those those critical ones).\nL63: \nL64: By the way, the OWASP also maintains a nice cheatsheet about input validation which you should take a look at.\nL65: \nL66: In the next sections, I’ll explain what NestJS has to offer regarding validation and we’ll dive in an example together, demonstrating how to configure validation support and how to enforce validations.\nL67: \nL68: ## NestJS support for validation \nL69: \nL70: Being a framework, NestJS does a great job at providing us with many tools, bells and whistles out of the box. Two of those tools are the support for Pipes and Validation.\nL71: \nL72: As you probably know, NestJS is heavily inspired by Angular, so it’s no wonder that it has support for pipes like Angular does.\nL73: \nL74: NestJS pipes have two main use cases:\nL75: \nL76:   * transformation of input data \nL77:   * validation of input data \nL78: \nL79: When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL80: \nL81: Out of the box, NestJS includes a number of pipes; some of which are dedicated to validation:\nL82: \nL83:   * ValidationPipe (which we’ll explore in this article)\nL84:   * ParseIntPipe \nL85:   * ParseBoolPipe \nL86:   * ParseArrayPipe \nL87:   * ParseUUIDPipe \nL88: \nL89: There are multiple ways to bind pipes to route handler methods (again, we’re focusing on RESTful APIs here, but I’ll mention other types of APIs later on).\nL90: \nL91: Here’s a first one, taken from the official documentation:\nL92: \nL93:     @Get(':id')\nL94:     async findOne(@Param('id', ParseIntPipe) id: number) {\nL95:       return this.catsService.findOne(id);\nL96:     }\nL97: \nL98: In the example above, the built-in `ParseIntPipe` is associated with the `findOne` route handler method. Before the method is called, the pipe will be invoked to validate that the `id` parameter is indeed an integer. Easy as pie, right?\nL99: \nL100: The nice thing about NestJS validation pipes is that when the method is invoked, then you can consider that the data you have received is structurally valid (shape and form); otherwise an exception would’ve been thrown (and automagically converted into an HTTP 4xx error for the client). That is of course not enough for input validation, but it goes a long way already.\nL101: \nL102: If inputs fail to pass validation checks, then the client will receive an error such as this one:\nL103: \nL104:     {\nL105:       \"statusCode\": 400,\nL106:       \"message\": \"Validation failed (numeric string is expected)\",\nL107:       \"error\": \"Bad Request\"\nL108:     }\nL109: \nL110: To me, it is a good enough default for client errors, even if I prefer the structure proposed by RFC 7807 (problem details for HTTP APIs), but that’s another subject.\nL111: \nL112: This means that your RESTful route handler methods can respect the Single Responsibility Principle (SRP) and concentrate on forwarding the requests to some other places in the system, where they can be further validated/processed/handled.\nL113: \nL114: Note that it is also possible to create and use a specific instance of a NestJS pipe:\nL115: \nL116:     @Get(':id')\nL117:     async findOne(\nL118:       @Param('id', new ParseIntPipe({ errorHttpStatusCode: HttpStatus.NOT_ACCEPTABLE }))\nL119:       id: number,\nL120:     ) {\nL121:       return this.catsService.findOne(id);\nL122:     }\nL123: \nL124: Here, a custom instance of the `ParseIntPipe` with a specific configuration was associated with the injected `id` param. This is interesting because it means that you can rely on the default behavior, but also customize it when you need to.\nL125: \nL126: You can of course create your own pipes, to perform any validation you’d like; we’ll look at that a bit later in this article.\nL127: \nL128: Another way to define pipes is to add the `UsePipes()` decorator:\nL129: \nL130:     @Post()\nL131:     @UsePipes(new JoiValidationPipe(createCatSchema))\nL132:     async create(@Body() createCatDto: CreateCatDto) {\nL133:       this.catsService.create(createCatDto);\nL134:     }\nL135: \nL136: With the above, the `JoiValidationPipe` (which is not a built-in pipe) will validate the input data against the provided Joi schema (more on this in the next section).\nL137: \nL138: ## Supported validation types \nL139: \nL140: NestJS supports different means of validating data. In this article, I’ll only discuss the solution using class-validator, as it covers my needs perfectly, but I’ll still mention the other ones for the sake of completeness.\nL141: \nL142: ### Schema-based validation with Joi \nL143: \nL144: The first approach discussed in the Pipes documentation is using schema-based validation, for instance using the Joi library:\nL145: \nL146: The above is a custom NestJS pipe. As you can see, it is quite simple to create one: it’s just a class implementing `PipeTransform` and its `transform` method, which receives the raw value sent to the server, as well as metadata.\nL147: \nL148: In this case, the custom pipe makes use of Joi to validate that the input data respects the configured Joi schema. Each instance of this pipe expects a schema to be passed into the constructor.\nL149: \nL150: This is how the schema is passed in by the route handler methods:\nL151: \nL152:     @UsePipes(new JoiValidationPipe(createCatSchema))\nL153: \nL154: In my current project, I chose not to use this approach because, unfortunately, I couldn’t find an easy/maintainable way to keep my validation schemas strongly aligned with my TypeScript interfaces. I did find libraries that could’ve helped: typesafe-joi and joi-extract-type, but both of those were either unmaintained/abandoned or only compatible with legacy versions of Joi, so it felt like a risky bet to make.\nL155: \nL156: ### Schema based validation with JSON schema \nL157: \nL158: Another approach for schema-based validation is to use JSON schemas and validate data against those using libraries such as the ajv JSON schema validator.\nL159: \nL160: This also requires the creation of custom validation pipes for NestJS as there is no built-in support.\nL161: \nL162: I’ve rejected this option for my project because of the complexity/overhead; again related to keeping the data model and the validation schemas in sync.\nL163: \nL164: I did find the following library to generate JSON schemas from TypeScript code, but didn’t look into it in detail: https://github.com/YousefED/typescript-json-schema\nL165: \nL166: If you’re interested in that approach, then take a look at the following articles:\nL167: \nL168:   * https://medium.com/javascript-in-plain-english/how-to-test-json-schema-with-ajv-in-typescript-bd0361e0c03e\nL169:   * https://levelup.gitconnected.com/typescript-validation-with-ajv-1b70a76dd678\nL170: \nL171: ### class-validator \nL172: \nL173: The last approach, which is also the one that’s (IMO) currently best supported by NestJS, uses class-validator.\nL174: \nL175: class-validator is a very popular TypeScript validation library that provides many validation decorators.\nL176: \nL177: In order to co configure validation with class-validator, you simply have to add decorators on fields that need validation. Here’s an example taken from the official docs:\nL178: \nL179: As you can see, expressing the validation rules is pretty straightforward.\nL180: \nL181: Note that while class-validator expect you to be using classes. It does actually support schema-based validation as well, but I wasn’t convinced by the maturity of that approach. The `ValidationSchema` type provided out of the box is weakly typed (goodbye refactoring!) and there are unfixed bugs around it, so I wouldn’t recommend it.\nL182: \nL183: In my project, it was a bit frustrating because I could manage without classes so far (and felt pretty happy about it!), but validation kind of forced me to create classes after all. Still, it felt like the safest bet at this point, given the low maturity of JS/TS validation (just my opinion of course!), compared to other languages/platforms (I sometimes miss bean validation :p).\nL184: \nL185: Also, this approach has great support out of the box by NestJS, through its `ValidationPipe`, which we’ll explore next.\nL186: \nL187: ### Other options \nL188: \nL189: In this section, I’ve covered the different solutions mentioned in NestJS’s documentation, but it’s far from all that you can do.\nL190: \nL191: There are a myriad of options for runtime type checking/validation, such as io-ts, which I wrote about in my TS book, zod, runtypes, vest, and many more. You can find a nice article about this subject here.\nL192: \nL193: As a side note, a NestJS maintainer also recommended Marshall to me as an alternative to class-validator, as it is apparently much more performant and provides a custom NestJS pipe for ease of use. Still, I chose class-validator for now as it is supported right out of the box and battle tested. If NestJS switches over, then I’ll probably follow along. Anyhow, to me, maintainability and support trump performance… until performance really becomes a bottleneck ;-)\nL194: \nL195: ## ValidationPipe \nL196: \nL197: As I’ve mentioned, NestJS provides a built-in `ValidationPipe`. That pipe actually uses class-validator and class-transformer (two libraries that go hand in hand) underneath the cover.\nL198: \nL199: The interesting thing about this built-in pipe is that it handles validation as well as transformation of input data into class instances. Thus, if you use it, then your request handlers will receive class instances with properly validated data.\nL200: \nL201: For the validation pipe to kick in, you need to refer to classes in your route handler arguments. If you use “any” or an interface, then the validation pipe won’t be able to help! In my project, it was annoying because it forced me to introduce classes just for the sake of validation, but I known that I’ll ultimately benefit from those for other purposes with NestJS.\nL202: \nL203: The `ValidationPipe` of NestJS can be tweaked according to your needs; you can make it more or less strict, you can disable or enable data transformation, etc.\nL204: \nL205: To use this pipe, you have multiple options. Just like I showed earlier, you can declare it locally on a route handler (e.g., through `@UsePipes`), but you can also enable it globally for your application. The advantage of declaring it as a global pipe is that it’ll always be there (at least for HTTP route handlers); no need to think about it, so it’s a safer route (pun intended). Less to think about = less potential mistakes.\nL206: \nL207: To configure this pipe globally, open your “main.ts” file and add the following:\nL208: \nL209:     app.useGlobalPipes(new ValidationPipe({ ... }));\nL210: \nL211: Here’s how I’ve configured this pipe for my current project:\nL212: \nL213: As you can see, I’ve tweaked the configuration a bit; let me explain:\nL214: \nL215:   * `whitelist: true` tells NestJS to strip the validated (i.e., returned) object of any properties that do not use any validation decorators. This of course means that all fields in your class should be annotated with class-validator decorators; otherwise the fields will be removed. The good news is that it ensures that you will never receive unexpected fields. This is especially important to avoid injecting data silently \nL216:   * `forbidNonWhitelisted: true` instructs NestJS to throw an exception if there are unexpected fields. This is stricter, but even clearer. At least the client will know if/when it provides invalid/unexpected data \nL217:   * `forbitUnknownValues` unknown objects are immediately rejected \nL218:   * `validationError: { value: false }` tells NestJS not to reflect the value at fault in the error responses. This lightens the responses and might limit sensitive data exposure in some cases \nL219:   * `transform: true` tells NestJS to return the validated class instance \nL220: \nL221: With this global configuration in place, all the route handlers that depend on classes will have validation in place; assuming that those classes are all properly annotated with class-validator decorators. Neat!\nL222: \nL223: ## ValidationPipe example \nL224: \nL225: Here’s a concrete example using the `ValidationPipe` of NestJS.\nL226: \nL227: This is the controller that should receive validated data. Here, let’s first concentrate on the `@Body()`. As you can see, we inject the body of the POST request, and expect it to be an instance of the `MeetingPartialUpdate` class.\nL228: \nL229: If the `ValidationPipe` is enabled/configured globally (cfr. last section), and if `MeetingPartialUpdate` is a class annotated with class-validator decorators, then the `ValidationPipe` will handle validations for us. The same is true for the injected parameters (I’ll come back to this later).\nL230: \nL231: Here’s what the body class looks like:\nL232: \nL233: This is standard class-validator usage, so nothing special to mention here if you’re already familiar with class-validator. If you’re not, then notice that we use quite a few validators here, some of which are marked as optional. We’re also leveraging nested validation support, Regex matching, etc.\nL234: \nL235: There are many more validators included in the library, so it’s quite powerful. You can also easily create custom validators (classes and decorators) if needed.\nL236: \nL237: With the above, the `ValidationPipe` will ensure that the received data matches our expectations (shape and content).\nL238: \nL239: This is a strong first step forward good input validation. But we can do better!\nL240: \nL241: ## Validating resource handler parameters \nL242: \nL243: In the previous section, I’ve focused on the validation of the body. But, as I’ve mentioned, the other input parameter that is injected is also validated.\nL244: \nL245: I think that it’s important to mention that the `ValidationPipe` validates everything that is class-based (and correctly annotated). Based on this, I really recommend you to create classes for all of the inputs (body, query parameters, URL parameters, etc) and use those so that you get strict input validation for everything. And I mean this also for single string parameters; even if it means introducing a class with a single field. It’s clearly worth it.\nL246: \nL247: In the previous example, the `MeetingsControllerInputParams` class only contains two fields, corresponding to the two URL parameters:\nL248: \nL249: That way, the URL parameters are also validated. Quite cool if you ask me!\nL250: \nL251: ## One step further \nL252: \nL253: As I’ve said, validation is more complex than that. Fields must be valid (structure/shape), but they also need to match. For instance, when updating a resource, the resource identifier is mentioned once in the URL, but it is also present in the body of the request. Both values must be the same for the update request to be considered valid and class-validator can’t help with such scenarios as the data is decoupled.\nL254: \nL255: The same goes for other things, but it’s a point to keep in mind: don’t consider that simple/basic input validation will cut it, security wise. Then there’s also of course optimistic concurrency handling, authentication, authorization and quite a lot of additional things to take care of.. ;-)\nL256: \nL257: To go further with input validation in my project, I’ve used a guard because it matched my requirements but, depending on which validations you need to perform, a pipe might be more adequate. Through this generic guard, I could implement checks such as:\nL258: \nL259:   * matching between URL parameters and body values \nL260:   * presence of the If-Match header and matching with the body values \nL261:   * etc \nL262: \nL263: Note that business services that sit behind REST controllers, lower in the architecture, perform additional validations (business-wise!) and authorization. I’ll write about that another day.\nL264: \nL265: ## GraphQL \u0026 WebSockets \nL266: \nL267: As with RESTful APIs, GraphQL APIs and WebSocket “tunnels” also need proper validation.\nL268: \nL269: For GraphQL, the good news is that it is apparently possible to declare the validation pipe along with the `@Args` decorator, as shared here by John Niomair: https://github.com/nestjs/nest/issues/819#issuecomment-480247274\nL270: \nL271: Finally, the built-in validation pipe is supposed to work all the same for WebSocket gateways, so you should be able to add the `UsePipes` decorator on the gateway methods and go from there (I don’t think it works with the global pipes). Although I didn’t test this myself so far…\nL272: \nL273: ## Conclusion \nL274: \nL275: In this article, I’ve explained why input validation matters so much for security. Then, I’ve described the built-in validation support of NestJS.\nL276: \nL277: Finally, I’ve walked you through an example and shared some thoughts about how to properly validate your inputs.\nL278: \nL279: Thanks to the whole setup, the route handlers of our NestJS controllers can focus solely on passing commands/queries around and don’t have to worry about input validation, which is great for separation of concerns.\nL280: \nL281: Once again, this is just the tip of the iceberg. Validation is required across many layers, in different shapes and forms. In addition, validation is only a small part of the overall picture; many other aspects must be taken care of to ensure a good security posture (e.g., authentication, authorization, business validations, error handling, audit logging, monitoring, etc).\nL282: \nL283: That's it for today! ✨\nL284: \nL285: Subscribe to the newsletter\nL286: \nL287: ## About Sébastien \nL288: \nL289: Hello everyone! I'm Sébastien Dubois. I'm an author, founder, and CTO. I write books and articles about software development \u0026 IT, personal knowledge management, personal organization, and productivity. I also craft lovely digital products   \nL290: \nL291: If you've enjoyed this article and want to read more like this, then become a subscriber, check out my Obsidian Starter Kit, the PKM Library and my collection of books about software development .  \nL292: \nL293: You can follow me on Twitter   \nL294: \nL295: If you want to discuss, then don't hesitate to join the Personal Knowledge Management community or the Software Crafters community.\nL296: \nL297: #### Read next\nL298: \nL299:  TypeScript 3 Projects: What's next? An appendix to my TypeScript book Sebastien Dubois Nov 12, 2019    Configuring and using the Apollo client in a Next.js TypeScript application Learn how to integrate the Apollo GraphQL client in a Next.js TypeScript application Sebastien Dubois Feb 24, 2021    On the importance of non-goals Goals are key to progress, but non-goals are complementary, and help go in the right direction. Here's why. Sebastien Dubois Aug 4, 2023  \nL300: \nL301: #### Comments () \nL302: \nL303: ### Subscribe to Sébastien Dubois\nL304: \nL305: Don't miss out on the latest Knowledge Management news. Sign up now to get access to the library of members-only articles.\nL306: \nL307: Subscribe now\nL308: \nL309:   * Sign up\nL310: \nL311: Passion makes all the difference.\nVisible: 0% - 100%"}]},"command":"click","args":[6],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"c44ab270-773c-4f50-80aa-e5b8b0143154","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"c44ab270-773c-4f50-80aa-e5b8b0143154","children":["90910b26-0ce6-4c9a-ac77-6b82c92d4498"]},"c44ab270-773c-4f50-80aa-e5b8b0143154":{"id":"c44ab270-773c-4f50-80aa-e5b8b0143154","message":{"id":"c44ab270-773c-4f50-80aa-e5b8b0143154","author":{"role":"assistant","metadata":{}},"create_time":1703480183.156905,"content":{"content_type":"code","language":"unknown","text":"click(6)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"906ee60c-6093-4aee-b682-f52c33f0b9f9","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"906ee60c-6093-4aee-b682-f52c33f0b9f9","children":["e1ab7557-ed13-451e-b7a2-8de9aca7f653"]},"906ee60c-6093-4aee-b682-f52c33f0b9f9":{"id":"906ee60c-6093-4aee-b682-f52c33f0b9f9","message":{"id":"906ee60c-6093-4aee-b682-f52c33f0b9f9","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.148643,"content":{"content_type":"tether_browsing_display","result":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Validation | NestJS - A progressive Node.js framework","url":"https://docs.nestjs.com/techniques/validation","text":"\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: "},{"type":"webpage","title":"Custom validation with database in NestJS - DEV Community","url":"https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao","text":"\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: "},{"type":"webpage","title":"Validation - GitHub: Let’s build from here","url":"https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md","text":"\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: "},{"type":"webpage","title":"Injecting request object to a custom validation class in NestJS","url":"https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal","text":"\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: "},{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: "},{"type":"webpage","title":"NestJS and ‘class validator’ cheat sheet - DEV Community","url":"https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao","text":"\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: "},{"type":"webpage","title":"How to implement input validation with NestJS - Sébastien Dubois","url":"https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/","text":"\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: "},{"type":"webpage","title":"How to use class-validator and generate custom error object in nest.js","url":"https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h","text":"\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: "},{"type":"webpage","title":"Building a REST API with NestJS and Prisma: Input Validation ...","url":"https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1","text":"\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: "},{"type":"webpage","title":"NestJS Custom Payload Validation - DEV Community","url":"https://dev.to/shubham_kadam/nestjs-custom-payload-validation-3hh7","text":"\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: "},{"type":"webpage","title":"Mastering Email Validation in NestJS: A Comprehensive Guide","url":"https://emaillistvalidation.com/blog/mastering-email-validation-in-nestjs-a-comprehensive-guide/","text":"\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: "},{"type":"webpage","title":"Custom Card v2 Signature Validation in NestJS - community.hubspot.com","url":"https://community.hubspot.com/t5/APIs-Integrations/Custom-Card-v2-Signature-Validation-in-NestJS/m-p/897350","text":"\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"},{"type":"webpage","title":"Search results for query: 'nestjs class-validator custom validation method documentation'","url":"","text":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"}]},"command":"back","args":[],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"ac5a24d7-4001-45b1-820c-ade5767e83b0","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"ac5a24d7-4001-45b1-820c-ade5767e83b0","children":["c44ab270-773c-4f50-80aa-e5b8b0143154"]},"ac5a24d7-4001-45b1-820c-ade5767e83b0":{"id":"ac5a24d7-4001-45b1-820c-ade5767e83b0","message":{"id":"ac5a24d7-4001-45b1-820c-ade5767e83b0","author":{"role":"assistant","metadata":{}},"create_time":1703480183.139115,"content":{"content_type":"code","language":"unknown","text":"back()"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"cea888d7-5e29-46d2-887d-9e2ae9119887","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"cea888d7-5e29-46d2-887d-9e2ae9119887","children":["906ee60c-6093-4aee-b682-f52c33f0b9f9"]},"cea888d7-5e29-46d2-887d-9e2ae9119887":{"id":"cea888d7-5e29-46d2-887d-9e2ae9119887","message":{"id":"cea888d7-5e29-46d2-887d-9e2ae9119887","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.131259,"content":{"content_type":"tether_browsing_display","result":"L0: \nL1: URL: https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao\nL2:   \nL3: \nL4:   【0†Skip to content】 \nL5: \nL6: Navigation menu 【1† 】 \nL7: \nL8:  Search\nL9: \nL10: 【2† Search 】 \nL11: \nL12:   【3† Log in 】  【4† Create account 】 \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30: 【5† Share to Twitter †twitter.com】 【6† Share to LinkedIn †www.linkedin.com】 【7† Share to Reddit †www.reddit.com】 【8† Share to Hacker News †news.ycombinator.com】 【9† Share to Facebook †www.facebook.com】 【10† Share to Mastodon †toot.kytta.dev】 \nL31: \nL32:  Share Post via...  【11†Report Abuse】 \nL33: \nL34:   【12† †res.cloudinary.com】 \nL35: \nL36: [Image 6: Krzysztof Szala]\nL37: \nL38: 【13†Krzysztof Szala】 \nL39: \nL40: Posted on Mar 27, 2021 • Updated on Apr 7, 2021\nL41: \nL42: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL43: \nL44: #  Custom validation with database in NestJS \nL45: \nL46: 【14†# nestjs】 【15†# typescript】 【16†# node】 【17†# javascript】 \nL47: \nL48: ##  【18†Validation tricks in NestJS (4 Part Series)】 \nL49: \nL50: 【19† 1 Custom validation with database in NestJS 】 【20† 2 Validating nested objects with class-validator in NestJS 】 【21† 3 Validating numeric query parameters in NestJS 】 【22† 4 Injecting request object to a custom validation class in NestJS 】 \nL51: \nL52: NestJS is an outstanding web framework which supports natively TypeScript out of the box. Its maintainers and community provides great and large documentation, which leads us by hand through the most important parts of the framework.\nL53: \nL54: But when you start to write an application for serious, you figure out quickly, it doesn't coverage some very typical cases (at least for me).\nL55: \nL56: Framework provides several ways for validation data coming with requests. We can basically use Pipes, a feature called schema-based validation (using 【23†joi library†joi.dev】) or integration with class-validator library through `ValidatorPipe`. And the last one is my favorite one. Why? The main reason is that you can keep your whole validation definitions outside the controller. It's a great way to separate different concerns.\nL57: \nL58: 【24†Class-Validator library†github.com】 is a powerful tool, which brings whole set of differential validation decorators like `@Length(10, 20)`, `@IsInt()`, `@Contains('example')` etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL59: \nL60: But what if you would like to create your own validator, and use it with class-validator library? Easy, just quick look at 【25†the documentation†github.com】 and you can write your own rules and can use it with `@Validate()` decorator. Better! It's fabulously simple to write own decorators and have your whole request validation class consists.\nL61: \nL62: Problems start when we are forced to check something for example in persistent storage, like database. In short – we must inject some dependency responsible for interacting with the database. Dependency like e.g. `UserRepository` which is obviously responsible for users entities.\nL63: \nL64: Luckly for us, `class-validator` provides very handy `useContainer` function, which allow to set the container to be used by `class-validor` library.\nL65: \nL66: So add this code in your main.ts file (`app` variable is your Nest application instance):  \nL67: \nL68:     useContainer(app.select(AppModule), { fallbackOnErrors: true });\nL69: \nL70: Enter fullscreen mode Exit fullscreen mode\nL71: \nL72: It allows `class-validator` to use NestJS dependency injection container.\nL73: \nL74: Then we can create a repository, which will query our database:  \nL75: \nL76:     @Injectable()\nL77:     class UserRepository {\nL78:       async getOneOrFail(userId: number): Promise\u003cUserEntity\u003e {\nL79:         // some code which fetch user entity or throw exception\nL80:       }\nL81:     }\nL82: \nL83: Enter fullscreen mode Exit fullscreen mode\nL84: \nL85: Ok, let's write a `Validator Constraint` which will hold our own validation logic. As you can see, our dependency is simply injected into the class constructor:  \nL86: \nL87:     @ValidatorConstraint({ name: 'UserExists', async: true })\nL88:     @Injectable()\nL89:     export class UserExistsRule implements ValidatorConstraintInterface {\nL90:       constructor(private usersRepository: UsersRepository) {}\nL91: \nL92:       async validate(value: number) {\nL93:         try {\nL94:           await this.usersRepository.getOneOrFail(value);\nL95:         } catch (e) {\nL96:           return false;\nL97:         }\nL98: \nL99:         return true;\nL100:       }\nL101: \nL102:       defaultMessage(args: ValidationArguments) {\nL103:         return `User doesn't exist`;\nL104:       }\nL105:     }\nL106: \nL107: Enter fullscreen mode Exit fullscreen mode\nL108: \nL109: Don't forget to 【26†declare you injectable classes as providers†docs.nestjs.com】 in the appropriate module.\nL110: \nL111: Now you can use your custom validation constraint. Simply decorate class property with `@Validate(UserExistsRule)` decorator:  \nL112: \nL113:     export class User {\nL114:       @IsInt()\nL115:       @Validate(UserExistsRule);\nL116:       readonly id: number;\nL117:     }\nL118: \nL119: Enter fullscreen mode Exit fullscreen mode\nL120: \nL121: If the user doesn't exist in the database, you should get error with default message \"User doesn't exist\". Although using `@Validate()` is fine enough, you can write your own decorator, which will be much more convenient. Having written Validator Constraint is quick and easy. We need to just write decorator factory with `registerDecorator()` function.  \nL122: \nL123:     export function UserExists(validationOptions?: ValidationOptions) {\nL124:       return function (object: any, propertyName: string) {\nL125:         registerDecorator({\nL126:           name: 'UserExists',\nL127:           target: object.constructor,\nL128:           propertyName: propertyName,\nL129:           options: validationOptions,\nL130:           validator: UserExistsRule,\nL131:         });\nL132:       };\nL133:     }\nL134: \nL135: Enter fullscreen mode Exit fullscreen mode\nL136: \nL137: As you can see, you can either write new validator logic, or use written before validator constraint (in our case – `UserExistsRule` class).\nL138: \nL139: Now we can go back to our `User` class, and use `@UserExists` validator instead of `@Validate(UserExistsRule)` decorator.  \nL140: \nL141:     export class User {\nL142:       @IsInt()\nL143:       @UserExists();\nL144:       readonly id: number;\nL145:     }\nL146: \nL147: Enter fullscreen mode Exit fullscreen mode\nL148: \nL149: Hope this little article will help you with many common scenarios during your application development with NestJS framework. I use that technique almost every day!\nL150: \nL151: ##  【18†Validation tricks in NestJS (4 Part Series)】 \nL152: \nL153: 【19† 1 Custom validation with database in NestJS 】 【20† 2 Validating nested objects with class-validator in NestJS 】 【21† 3 Validating numeric query parameters in NestJS 】 【22† 4 Injecting request object to a custom validation class in NestJS 】 \nL154: \nL155: ##  Top comments (20)\nL156: \nL157: Subscribe\nL158: \nL159:     [Image 12: pic] \nL160: \nL161: Personal Trusted User\nL162: \nL163: 【27† Create template 】 \nL164: \nL165: Templates let you quickly answer FAQs or store snippets for re-use.\nL166: \nL167: Submit Preview 【28†Dismiss】 \nL168: \nL169:   Collapse Expand\nL170: \nL171: 【29† 】 \nL172: \nL173: 【29† Scott Molinari 】 \nL174: \nL175:  Scott Molinari \nL176: \nL177: 【29† Scott Molinari 】 \nL178: \nL179: Follow\nL180: \nL181: Just a hobbyist programmer with an eye on new technologies. Currently helping Quasar and NestJS Frameworks, because....well.....because they're awesome! :-) \nL182: \nL183:   * Joined \nL184: \nL185: Dec 11, 2018\nL186: \nL187: • 【30† Mar 28 '21 】 \nL188: \nL189:  Dropdown menu\nL190: \nL191:   * 【30†Copy link】\nL192:   *   * Hide \nL193:   *   *   * \nL194: \nL195: Hey. Nice article. Two things.\nL196: \nL197: \u003e If the user exists in the database, you should get error with default message \"User doesn't exist\".\nL198: \nL199: Did you possibly mean to write the error as \"User already exists\"?\nL200: \nL201: Also, I feel validation is very often based on business rules. And as such, it would be a lot of running to the programmer to ask him or her to update decorators. How would one take rules from a database (created by business) and use them dynamically within the code? I think that solution would be a whole lot smarter. The same goes for authorization rules, don't you think? \nL202: \nL203: Scott\nL204: \nL205:  Like comment:  Like comment:  3 likes Like  Comment button Reply \nL206: \nL207: Collapse Expand\nL208: \nL209: 【13† 】 \nL210: \nL211: 【13† Krzysztof Szala 】 \nL212: \nL213:  Krzysztof Szala \nL214: \nL215: 【13† Krzysztof Szala 】 \nL216: \nL217: Follow\nL218: \nL219: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL220: \nL221:   * Location \nL222: \nL223: Silesia \nL224: \nL225:   * Joined \nL226: \nL227: May 30, 2020\nL228: \nL229: • 【31† Mar 28 '21 • Edited on Mar 28 • Edited 】 \nL230: \nL231:  Dropdown menu\nL232: \nL233:   * 【31†Copy link】\nL234:   *   * Hide \nL235:   *   *   * \nL236: \nL237: Hi Scott, thank you for your comment!\nL238: \nL239: \u003e Did you possibly mean to write the error as \"User already exists\"?\nL240: \nL241: No, it tests if user exists in database, if it doesn't validator should return error, that \"user doesn't exist\". It can be useful, when you check for example user id for crud operations, and don't want to run any logic, if input data isn't valid.\nL242: \nL243: \u003e Also, I feel validation is very often based on business rules. And as such, it would be a lot of running to the programmer to ask him or her to update decorators. How would one take rules from a database (created by business) and use them dynamically within the code? I think that solution would be a whole lot smarter. The same goes for authorization rules, don't you think?\nL244: \nL245: To be honest, I'm not the biggest fan of storing business logic in the database. There are several reasons for that. I have some experience with it, and it never ends well. Business logic stored outside code base is much harder to test, and it isn't possible to test it with unit-test (as unit tests should be database independent). For me business logic changes only when code is changed. This is why we write unit tests, right? They test business logic. If there is no business logic in our services (like simple CRUD operations), unit tests look like testing mocked data.\nL246: \nL247: Ok, you can store some data in DB, like for example – a user role, and list of access routes. But the business logic is still in the code base. Roles, and theirs access routes, are only input data, for authorization rules.\nL248: \nL249: Not sure if that what I'm saying is clear and makes sense :D\nL250: \nL251: Regards\nL252: \nL253:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL254: \nL255: Collapse Expand\nL256: \nL257: 【29† 】 \nL258: \nL259: 【29† Scott Molinari 】 \nL260: \nL261:  Scott Molinari \nL262: \nL263: 【29† Scott Molinari 】 \nL264: \nL265: Follow\nL266: \nL267: Just a hobbyist programmer with an eye on new technologies. Currently helping Quasar and NestJS Frameworks, because....well.....because they're awesome! :-) \nL268: \nL269:   * Joined \nL270: \nL271: Dec 11, 2018\nL272: \nL273: • 【32† Mar 30 '21 • Edited on Mar 31 • Edited 】 \nL274: \nL275:  Dropdown menu\nL276: \nL277:   * 【32†Copy link】\nL278:   *   * Hide \nL279:   *   *   * \nL280: \nL281: Ok. Looked again at the code. My bad on the message. I was thinking in terms of creation of the user (and the user being unique), whereas the code is talking about the retrieval of the user. :) What I was thinking as a validation would be on a create or update DTO. \nL282: \nL283: I see what you are saying with testing, however, that's also the point I'm trying to make to some degree I believe. Unit tests should test that the validation system works, but the conditions of the validation are meta to the \"unit\". The conditions are and must be variable as business changes all the time and thus, those rules themselve don't need testing. The system/ unit should take a set of rules and run validation on that set of rules. What's in the rules doesn't matter, the proper validation does. \nL284: \nL285: The \"testing\" of the rules would lie solely with the business, since they are setting them. And because the rules are metadata to the system, it has to be purely manual on their part. Or, it could be within integration testing, but that would also be insanely complex, depending on the validations needed. :D \nL286: \nL287: The goal I'm shooting for is to have a system of validation (and authorization) that is mainly independent of the programmer. It would be designed for a larger system with complex business operations. I've seen it done from a user's perspective. I'm just not quite sure how to make it happen with Nest. But, your article gave me more insight into the topic. Thanks!\nL288: \nL289:  Like comment:  Like comment:  1 like Like  Thread Thread \nL290: \nL291: 【13† 】 \nL292: \nL293: 【13† Krzysztof Szala 】 \nL294: \nL295:  Krzysztof Szala \nL296: \nL297: 【13† Krzysztof Szala 】 \nL298: \nL299: Follow\nL300: \nL301: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL302: \nL303:   * Location \nL304: \nL305: Silesia \nL306: \nL307:   * Joined \nL308: \nL309: May 30, 2020\nL310: \nL311: • 【33† Apr 2 '21 • Edited on Apr 2 • Edited 】 \nL312: \nL313:  Dropdown menu\nL314: \nL315:   * 【33†Copy link】\nL316:   *   * Hide \nL317:   *   *   * \nL318: \nL319: It's interesting point of view Scott, but I'll stand by my opinion, that validation rules belong to the code base, not to the storage ;) Anyway, thanks for great comments, appriciate that! Have a nice weekend!\nL320: \nL321:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL322: \nL323: Collapse Expand\nL324: \nL325: 【34† 】 \nL326: \nL327: 【34† Svarup Desai 】 \nL328: \nL329:  Svarup Desai \nL330: \nL331: 【34† Svarup Desai 】 \nL332: \nL333: Follow\nL334: \nL335:   * Joined \nL336: \nL337: Sep 12, 2020\nL338: \nL339: • 【35† Oct 7 '22 】 \nL340: \nL341:  Dropdown menu\nL342: \nL343:   * 【35†Copy link】\nL344:   *   * Hide \nL345:   *   *   * \nL346: \nL347: one thing that not mentioned is that, we have to add in `app.module.ts`  \nL348: \nL349:     @Module({\nL350:       imports: ...,\nL351:       controllers: [AppController],\nL352:       providers: [\nL353:         AppService,\nL354:         ...,\nL355:         // Line below added\nL356:         UserExistsRule,\nL357:       ],\nL358:     })\nL359:     export class AppModule {}\nL360: \nL361: Enter fullscreen mode Exit fullscreen mode\nL362: \nL363:  Like comment:  Like comment:  3 likes Like  Comment button Reply \nL364: \nL365: Collapse Expand\nL366: \nL367: 【36† 】 \nL368: \nL369: 【36† Mattias Fjellvang 】 \nL370: \nL371:  Mattias Fjellvang \nL372: \nL373: 【36† Mattias Fjellvang 】 \nL374: \nL375: Follow\nL376: \nL377:   * Joined \nL378: \nL379: Feb 15, 2020\nL380: \nL381: • 【37† Jan 5 '22 】 \nL382: \nL383:  Dropdown menu\nL384: \nL385:   * 【37†Copy link】\nL386:   *   * Hide \nL387:   *   *   * \nL388: \nL389: This is a great article and just what I was looking for. However, is there a way to provide the container (using useContainer(app.select(AppModule), { fallbackOnErrors: true });) in the app.module.ts instead of in the main.ts file? Because I'd like this to be testable, and if I define it inside app.module.ts, my e2e tests would not function with my custom decorators.\nL390: \nL391:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL392: \nL393: Collapse Expand\nL394: \nL395: 【38† 】 \nL396: \nL397: 【38† davidN96 】 \nL398: \nL399:  davidN96 \nL400: \nL401: 【38† davidN96 】 \nL402: \nL403: Follow\nL404: \nL405:   * Joined \nL406: \nL407: Apr 25, 2021\nL408: \nL409: • 【39† Apr 25 '21 】 \nL410: \nL411:  Dropdown menu\nL412: \nL413:   * 【39†Copy link】\nL414:   *   * Hide \nL415:   *   *   * \nL416: \nL417: Hey! Great article! Could you share a link to repo with code from this article? I'm newbie in Nest, I have a problem with database dependency injection. I'll be very thankful\nL418: \nL419:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL420: \nL421: Collapse Expand\nL422: \nL423: 【13† 】 \nL424: \nL425: 【13† Krzysztof Szala 】 \nL426: \nL427:  Krzysztof Szala \nL428: \nL429: 【13† Krzysztof Szala 】 \nL430: \nL431: Follow\nL432: \nL433: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL434: \nL435:   * Location \nL436: \nL437: Silesia \nL438: \nL439:   * Joined \nL440: \nL441: May 30, 2020\nL442: \nL443: • 【40† Apr 27 '21 】 \nL444: \nL445:  Dropdown menu\nL446: \nL447:   * 【40†Copy link】\nL448:   *   * Hide \nL449:   *   *   * \nL450: \nL451: Thank you. I'll try to upload some repos, when I find some time. What kind of problems do you have with database DI? Maybe I can help here. Regards.\nL452: \nL453:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL454: \nL455: Collapse Expand\nL456: \nL457: 【38† 】 \nL458: \nL459: 【38† davidN96 】 \nL460: \nL461:  davidN96 \nL462: \nL463: 【38† davidN96 】 \nL464: \nL465: Follow\nL466: \nL467:   * Joined \nL468: \nL469: Apr 25, 2021\nL470: \nL471: • 【41† Apr 27 '21 】 \nL472: \nL473:  Dropdown menu\nL474: \nL475:   * 【41†Copy link】\nL476:   *   * Hide \nL477:   *   *   * \nL478: \nL479: Hey! Thank you for your response! Well, I've found the problem. I've accidentally imported useContainer from typeorm instead of class-validator (VSC hints). Now everything works great. Thank you for a great article!\nL480: \nL481:  Like comment:  Like comment:  2 likes Like  Thread Thread \nL482: \nL483: 【13† 】 \nL484: \nL485: 【13† Krzysztof Szala 】 \nL486: \nL487:  Krzysztof Szala \nL488: \nL489: 【13† Krzysztof Szala 】 \nL490: \nL491: Follow\nL492: \nL493: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL494: \nL495:   * Location \nL496: \nL497: Silesia \nL498: \nL499:   * Joined \nL500: \nL501: May 30, 2020\nL502: \nL503: • 【42† Apr 27 '21 】 \nL504: \nL505:  Dropdown menu\nL506: \nL507:   * 【42†Copy link】\nL508:   *   * Hide \nL509:   *   *   * \nL510: \nL511: That's great, happy to help! :)\nL512: \nL513:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL514: \nL515: Collapse Expand\nL516: \nL517: 【43† 】 \nL518: \nL519: 【43† José Neto 】 \nL520: \nL521:  José Neto \nL522: \nL523: 【43† José Neto 】 \nL524: \nL525: Follow\nL526: \nL527: A funny web developer \nL528: \nL529:   * Location \nL530: \nL531: Lisbon \nL532: \nL533:   * Work \nL534: \nL535: Frontend Engineer at TripAdvisor \nL536: \nL537:   * Joined \nL538: \nL539: Mar 17, 2019\nL540: \nL541: • 【44† Aug 22 '21 】 \nL542: \nL543:  Dropdown menu\nL544: \nL545:   * 【44†Copy link】\nL546:   *   * Hide \nL547:   *   *   * \nL548: \nL549: Awesome, thanks!\nL550: \nL551:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL552: \nL553: Collapse Expand\nL554: \nL555: 【13† 】 \nL556: \nL557: 【13† Krzysztof Szala 】 \nL558: \nL559:  Krzysztof Szala \nL560: \nL561: 【13† Krzysztof Szala 】 \nL562: \nL563: Follow\nL564: \nL565: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL566: \nL567:   * Location \nL568: \nL569: Silesia \nL570: \nL571:   * Joined \nL572: \nL573: May 30, 2020\nL574: \nL575: • 【45† Aug 23 '21 】 \nL576: \nL577:  Dropdown menu\nL578: \nL579:   * 【45†Copy link】\nL580:   *   * Hide \nL581:   *   *   * \nL582: \nL583: You’re welcome!\nL584: \nL585:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL586: \nL587: Collapse Expand\nL588: \nL589: 【46† 】 \nL590: \nL591: 【46† huynh nguyen toan 】 \nL592: \nL593:  huynh nguyen toan \nL594: \nL595: 【46† huynh nguyen toan 】 \nL596: \nL597: Follow\nL598: \nL599:   * Joined \nL600: \nL601: Oct 11, 2021\nL602: \nL603: • 【47† Jul 2 】 \nL604: \nL605:  Dropdown menu\nL606: \nL607:   * 【47†Copy link】\nL608:   *   * Hide \nL609:   *   *   * \nL610: \nL611: Thanks bro.\nL612: \nL613:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL614: \nL615: Collapse Expand\nL616: \nL617: 【48† 】 \nL618: \nL619: 【48† Tafadzwa Muteke 】 \nL620: \nL621:  Tafadzwa Muteke \nL622: \nL623: 【48† Tafadzwa Muteke 】 \nL624: \nL625: Follow\nL626: \nL627: Designer, developer. \nL628: \nL629:   * Location \nL630: \nL631: Harare, Zimbabwe \nL632: \nL633:   * Education \nL634: \nL635: Computer Science \nL636: \nL637:   * Work \nL638: \nL639: Mr at Irus Edge Digital Agency \nL640: \nL641:   * Joined \nL642: \nL643: Oct 2, 2019\nL644: \nL645: • 【49† Dec 17 '21 】 \nL646: \nL647:  Dropdown menu\nL648: \nL649:   * 【49†Copy link】\nL650:   *   * Hide \nL651:   *   *   * \nL652: \nL653: Thank you, Krzysztof!\nL654: \nL655:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL656: \nL657: Collapse Expand\nL658: \nL659: 【13† 】 \nL660: \nL661: 【13† Krzysztof Szala 】 \nL662: \nL663:  Krzysztof Szala \nL664: \nL665: 【13† Krzysztof Szala 】 \nL666: \nL667: Follow\nL668: \nL669: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL670: \nL671:   * Location \nL672: \nL673: Silesia \nL674: \nL675:   * Joined \nL676: \nL677: May 30, 2020\nL678: \nL679: • 【50† Dec 21 '21 】 \nL680: \nL681:  Dropdown menu\nL682: \nL683:   * 【50†Copy link】\nL684:   *   * Hide \nL685:   *   *   * \nL686: \nL687: Glad I could help!\nL688: \nL689:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL690: \nL691: Collapse Expand\nL692: \nL693: 【51† 】 \nL694: \nL695: 【51† Esron Silva 】 \nL696: \nL697:  Esron Silva \nL698: \nL699: 【51† Esron Silva 】 \nL700: \nL701: Follow\nL702: \nL703: FullStack Developer. Computer Engineer. \nL704: \nL705:   * Location \nL706: \nL707: Petrolina - PE, Brasil \nL708: \nL709:   * Education \nL710: \nL711: Bachelor in Computer Engineering. \nL712: \nL713:   * Work \nL714: \nL715: Computer Engineer and Full Stack Developer at Sysvale \nL716: \nL717:   * Joined \nL718: \nL719: Jun 6, 2019\nL720: \nL721: • 【52† Apr 12 '22 】 \nL722: \nL723:  Dropdown menu\nL724: \nL725:   * 【52†Copy link】\nL726:   *   * Hide \nL727:   *   *   * \nL728: \nL729: Awesome content right here. You saved me a ton of work and time.\nL730: \nL731:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL732: \nL733: Collapse Expand\nL734: \nL735: 【13† 】 \nL736: \nL737: 【13† Krzysztof Szala 】 \nL738: \nL739:  Krzysztof Szala \nL740: \nL741: 【13† Krzysztof Szala 】 \nL742: \nL743: Follow\nL744: \nL745: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL746: \nL747:   * Location \nL748: \nL749: Silesia \nL750: \nL751:   * Joined \nL752: \nL753: May 30, 2020\nL754: \nL755: • 【53† Apr 17 '22 】 \nL756: \nL757:  Dropdown menu\nL758: \nL759:   * 【53†Copy link】\nL760:   *   * Hide \nL761:   *   *   * \nL762: \nL763: I’m glad I could help! \nL764: \nL765:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL766: \nL767: Collapse Expand\nL768: \nL769: 【54† 】 \nL770: \nL771: 【54† Navin Mishra 】 \nL772: \nL773:  Navin Mishra \nL774: \nL775: 【54† Navin Mishra 】 \nL776: \nL777: Follow\nL778: \nL779: Programming enthusiast who wants to learn and grow everyday. \nL780: \nL781:   * Location \nL782: \nL783: kathmandu, nepal \nL784: \nL785:   * Education \nL786: \nL787: Tribhuwan University \nL788: \nL789:   * Work \nL790: \nL791: Developer, interest on business terms \nL792: \nL793:   * Joined \nL794: \nL795: Jun 14, 2022\nL796: \nL797: • 【55† Dec 8 】 \nL798: \nL799:  Dropdown menu\nL800: \nL801:   * 【55†Copy link】\nL802:   *   * Hide \nL803:   *   *   * \nL804: \nL805: great article. very helpful\nL806: \nL807:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL808: \nL809: Collapse Expand\nL810: \nL811: 【56† 】 \nL812: \nL813: 【56† Jedediah 】 \nL814: \nL815:  Jedediah \nL816: \nL817: 【56† Jedediah 】 \nL818: \nL819: Follow\nL820: \nL821:   * Joined \nL822: \nL823: Apr 28, 2022\nL824: \nL825: • 【57† Apr 28 '22 】 \nL826: \nL827:  Dropdown menu\nL828: \nL829:   * 【57†Copy link】\nL830:   *   * Hide \nL831:   *   *   * \nL832: \nL833: Signed up Dev.to just to say thank you! A great series for Nestjs! Great job!\nL834: \nL835:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL836: \nL837: Collapse Expand\nL838:\nVisible: 0% - 85%","summary":"Custom validation with database in NestJS - DEV Community (dev.to)\n","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Custom validation with database in NestJS - DEV Community","url":"https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao","text":"L0: \nL1: URL: https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao\nL2:   \nL3: \nL4:   Skip to content \nL5: \nL6: Navigation menu   \nL7: \nL8:  Search\nL9: \nL10:  Search  \nL11: \nL12:    Log in    Create account  \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30:  Share to Twitter   Share to LinkedIn   Share to Reddit   Share to Hacker News   Share to Facebook   Share to Mastodon  \nL31: \nL32:  Share Post via...  Report Abuse \nL33: \nL34:     \nL35: \nL36: [Image 6: Krzysztof Szala]\nL37: \nL38: Krzysztof Szala \nL39: \nL40: Posted on Mar 27, 2021 • Updated on Apr 7, 2021\nL41: \nL42: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL43: \nL44: #  Custom validation with database in NestJS \nL45: \nL46: # nestjs # typescript # node # javascript \nL47: \nL48: ##  Validation tricks in NestJS (4 Part Series) \nL49: \nL50:  1 Custom validation with database in NestJS   2 Validating nested objects with class-validator in NestJS   3 Validating numeric query parameters in NestJS   4 Injecting request object to a custom validation class in NestJS  \nL51: \nL52: NestJS is an outstanding web framework which supports natively TypeScript out of the box. Its maintainers and community provides great and large documentation, which leads us by hand through the most important parts of the framework.\nL53: \nL54: But when you start to write an application for serious, you figure out quickly, it doesn't coverage some very typical cases (at least for me).\nL55: \nL56: Framework provides several ways for validation data coming with requests. We can basically use Pipes, a feature called schema-based validation (using joi library) or integration with class-validator library through `ValidatorPipe`. And the last one is my favorite one. Why? The main reason is that you can keep your whole validation definitions outside the controller. It's a great way to separate different concerns.\nL57: \nL58: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like `@Length(10, 20)`, `@IsInt()`, `@Contains('example')` etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL59: \nL60: But what if you would like to create your own validator, and use it with class-validator library? Easy, just quick look at the documentation and you can write your own rules and can use it with `@Validate()` decorator. Better! It's fabulously simple to write own decorators and have your whole request validation class consists.\nL61: \nL62: Problems start when we are forced to check something for example in persistent storage, like database. In short – we must inject some dependency responsible for interacting with the database. Dependency like e.g. `UserRepository` which is obviously responsible for users entities.\nL63: \nL64: Luckly for us, `class-validator` provides very handy `useContainer` function, which allow to set the container to be used by `class-validor` library.\nL65: \nL66: So add this code in your main.ts file (`app` variable is your Nest application instance):  \nL67: \nL68:     useContainer(app.select(AppModule), { fallbackOnErrors: true });\nL69: \nL70: Enter fullscreen mode Exit fullscreen mode\nL71: \nL72: It allows `class-validator` to use NestJS dependency injection container.\nL73: \nL74: Then we can create a repository, which will query our database:  \nL75: \nL76:     @Injectable()\nL77:     class UserRepository {\nL78:       async getOneOrFail(userId: number): Promise\u003cUserEntity\u003e {\nL79:         // some code which fetch user entity or throw exception\nL80:       }\nL81:     }\nL82: \nL83: Enter fullscreen mode Exit fullscreen mode\nL84: \nL85: Ok, let's write a `Validator Constraint` which will hold our own validation logic. As you can see, our dependency is simply injected into the class constructor:  \nL86: \nL87:     @ValidatorConstraint({ name: 'UserExists', async: true })\nL88:     @Injectable()\nL89:     export class UserExistsRule implements ValidatorConstraintInterface {\nL90:       constructor(private usersRepository: UsersRepository) {}\nL91: \nL92:       async validate(value: number) {\nL93:         try {\nL94:           await this.usersRepository.getOneOrFail(value);\nL95:         } catch (e) {\nL96:           return false;\nL97:         }\nL98: \nL99:         return true;\nL100:       }\nL101: \nL102:       defaultMessage(args: ValidationArguments) {\nL103:         return `User doesn't exist`;\nL104:       }\nL105:     }\nL106: \nL107: Enter fullscreen mode Exit fullscreen mode\nL108: \nL109: Don't forget to declare you injectable classes as providers in the appropriate module.\nL110: \nL111: Now you can use your custom validation constraint. Simply decorate class property with `@Validate(UserExistsRule)` decorator:  \nL112: \nL113:     export class User {\nL114:       @IsInt()\nL115:       @Validate(UserExistsRule);\nL116:       readonly id: number;\nL117:     }\nL118: \nL119: Enter fullscreen mode Exit fullscreen mode\nL120: \nL121: If the user doesn't exist in the database, you should get error with default message \"User doesn't exist\". Although using `@Validate()` is fine enough, you can write your own decorator, which will be much more convenient. Having written Validator Constraint is quick and easy. We need to just write decorator factory with `registerDecorator()` function.  \nL122: \nL123:     export function UserExists(validationOptions?: ValidationOptions) {\nL124:       return function (object: any, propertyName: string) {\nL125:         registerDecorator({\nL126:           name: 'UserExists',\nL127:           target: object.constructor,\nL128:           propertyName: propertyName,\nL129:           options: validationOptions,\nL130:           validator: UserExistsRule,\nL131:         });\nL132:       };\nL133:     }\nL134: \nL135: Enter fullscreen mode Exit fullscreen mode\nL136: \nL137: As you can see, you can either write new validator logic, or use written before validator constraint (in our case – `UserExistsRule` class).\nL138: \nL139: Now we can go back to our `User` class, and use `@UserExists` validator instead of `@Validate(UserExistsRule)` decorator.  \nL140: \nL141:     export class User {\nL142:       @IsInt()\nL143:       @UserExists();\nL144:       readonly id: number;\nL145:     }\nL146: \nL147: Enter fullscreen mode Exit fullscreen mode\nL148: \nL149: Hope this little article will help you with many common scenarios during your application development with NestJS framework. I use that technique almost every day!\nL150: \nL151: ##  Validation tricks in NestJS (4 Part Series) \nL152: \nL153:  1 Custom validation with database in NestJS   2 Validating nested objects with class-validator in NestJS   3 Validating numeric query parameters in NestJS   4 Injecting request object to a custom validation class in NestJS  \nL154: \nL155: ##  Top comments (20)\nL156: \nL157: Subscribe\nL158: \nL159:     [Image 12: pic] \nL160: \nL161: Personal Trusted User\nL162: \nL163:  Create template  \nL164: \nL165: Templates let you quickly answer FAQs or store snippets for re-use.\nL166: \nL167: Submit Preview Dismiss \nL168: \nL169:   Collapse Expand\nL170: \nL171:   \nL172: \nL173:  Scott Molinari  \nL174: \nL175:  Scott Molinari \nL176: \nL177:  Scott Molinari  \nL178: \nL179: Follow\nL180: \nL181: Just a hobbyist programmer with an eye on new technologies. Currently helping Quasar and NestJS Frameworks, because....well.....because they're awesome! :-) \nL182: \nL183:   * Joined \nL184: \nL185: Dec 11, 2018\nL186: \nL187: •  Mar 28 '21  \nL188: \nL189:  Dropdown menu\nL190: \nL191:   * Copy link\nL192:   *   * Hide \nL193:   *   *   * \nL194: \nL195: Hey. Nice article. Two things.\nL196: \nL197: \u003e If the user exists in the database, you should get error with default message \"User doesn't exist\".\nL198: \nL199: Did you possibly mean to write the error as \"User already exists\"?\nL200: \nL201: Also, I feel validation is very often based on business rules. And as such, it would be a lot of running to the programmer to ask him or her to update decorators. How would one take rules from a database (created by business) and use them dynamically within the code? I think that solution would be a whole lot smarter. The same goes for authorization rules, don't you think? \nL202: \nL203: Scott\nL204: \nL205:  Like comment:  Like comment:  3 likes Like  Comment button Reply \nL206: \nL207: Collapse Expand\nL208: \nL209:   \nL210: \nL211:  Krzysztof Szala  \nL212: \nL213:  Krzysztof Szala \nL214: \nL215:  Krzysztof Szala  \nL216: \nL217: Follow\nL218: \nL219: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL220: \nL221:   * Location \nL222: \nL223: Silesia \nL224: \nL225:   * Joined \nL226: \nL227: May 30, 2020\nL228: \nL229: •  Mar 28 '21 • Edited on Mar 28 • Edited  \nL230: \nL231:  Dropdown menu\nL232: \nL233:   * Copy link\nL234:   *   * Hide \nL235:   *   *   * \nL236: \nL237: Hi Scott, thank you for your comment!\nL238: \nL239: \u003e Did you possibly mean to write the error as \"User already exists\"?\nL240: \nL241: No, it tests if user exists in database, if it doesn't validator should return error, that \"user doesn't exist\". It can be useful, when you check for example user id for crud operations, and don't want to run any logic, if input data isn't valid.\nL242: \nL243: \u003e Also, I feel validation is very often based on business rules. And as such, it would be a lot of running to the programmer to ask him or her to update decorators. How would one take rules from a database (created by business) and use them dynamically within the code? I think that solution would be a whole lot smarter. The same goes for authorization rules, don't you think?\nL244: \nL245: To be honest, I'm not the biggest fan of storing business logic in the database. There are several reasons for that. I have some experience with it, and it never ends well. Business logic stored outside code base is much harder to test, and it isn't possible to test it with unit-test (as unit tests should be database independent). For me business logic changes only when code is changed. This is why we write unit tests, right? They test business logic. If there is no business logic in our services (like simple CRUD operations), unit tests look like testing mocked data.\nL246: \nL247: Ok, you can store some data in DB, like for example – a user role, and list of access routes. But the business logic is still in the code base. Roles, and theirs access routes, are only input data, for authorization rules.\nL248: \nL249: Not sure if that what I'm saying is clear and makes sense :D\nL250: \nL251: Regards\nL252: \nL253:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL254: \nL255: Collapse Expand\nL256: \nL257:   \nL258: \nL259:  Scott Molinari  \nL260: \nL261:  Scott Molinari \nL262: \nL263:  Scott Molinari  \nL264: \nL265: Follow\nL266: \nL267: Just a hobbyist programmer with an eye on new technologies. Currently helping Quasar and NestJS Frameworks, because....well.....because they're awesome! :-) \nL268: \nL269:   * Joined \nL270: \nL271: Dec 11, 2018\nL272: \nL273: •  Mar 30 '21 • Edited on Mar 31 • Edited  \nL274: \nL275:  Dropdown menu\nL276: \nL277:   * Copy link\nL278:   *   * Hide \nL279:   *   *   * \nL280: \nL281: Ok. Looked again at the code. My bad on the message. I was thinking in terms of creation of the user (and the user being unique), whereas the code is talking about the retrieval of the user. :) What I was thinking as a validation would be on a create or update DTO. \nL282: \nL283: I see what you are saying with testing, however, that's also the point I'm trying to make to some degree I believe. Unit tests should test that the validation system works, but the conditions of the validation are meta to the \"unit\". The conditions are and must be variable as business changes all the time and thus, those rules themselve don't need testing. The system/ unit should take a set of rules and run validation on that set of rules. What's in the rules doesn't matter, the proper validation does. \nL284: \nL285: The \"testing\" of the rules would lie solely with the business, since they are setting them. And because the rules are metadata to the system, it has to be purely manual on their part. Or, it could be within integration testing, but that would also be insanely complex, depending on the validations needed. :D \nL286: \nL287: The goal I'm shooting for is to have a system of validation (and authorization) that is mainly independent of the programmer. It would be designed for a larger system with complex business operations. I've seen it done from a user's perspective. I'm just not quite sure how to make it happen with Nest. But, your article gave me more insight into the topic. Thanks!\nL288: \nL289:  Like comment:  Like comment:  1 like Like  Thread Thread \nL290: \nL291:   \nL292: \nL293:  Krzysztof Szala  \nL294: \nL295:  Krzysztof Szala \nL296: \nL297:  Krzysztof Szala  \nL298: \nL299: Follow\nL300: \nL301: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL302: \nL303:   * Location \nL304: \nL305: Silesia \nL306: \nL307:   * Joined \nL308: \nL309: May 30, 2020\nL310: \nL311: •  Apr 2 '21 • Edited on Apr 2 • Edited  \nL312: \nL313:  Dropdown menu\nL314: \nL315:   * Copy link\nL316:   *   * Hide \nL317:   *   *   * \nL318: \nL319: It's interesting point of view Scott, but I'll stand by my opinion, that validation rules belong to the code base, not to the storage ;) Anyway, thanks for great comments, appriciate that! Have a nice weekend!\nL320: \nL321:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL322: \nL323: Collapse Expand\nL324: \nL325:   \nL326: \nL327:  Svarup Desai  \nL328: \nL329:  Svarup Desai \nL330: \nL331:  Svarup Desai  \nL332: \nL333: Follow\nL334: \nL335:   * Joined \nL336: \nL337: Sep 12, 2020\nL338: \nL339: •  Oct 7 '22  \nL340: \nL341:  Dropdown menu\nL342: \nL343:   * Copy link\nL344:   *   * Hide \nL345:   *   *   * \nL346: \nL347: one thing that not mentioned is that, we have to add in `app.module.ts`  \nL348: \nL349:     @Module({\nL350:       imports: ...,\nL351:       controllers: [AppController],\nL352:       providers: [\nL353:         AppService,\nL354:         ...,\nL355:         // Line below added\nL356:         UserExistsRule,\nL357:       ],\nL358:     })\nL359:     export class AppModule {}\nL360: \nL361: Enter fullscreen mode Exit fullscreen mode\nL362: \nL363:  Like comment:  Like comment:  3 likes Like  Comment button Reply \nL364: \nL365: Collapse Expand\nL366: \nL367:   \nL368: \nL369:  Mattias Fjellvang  \nL370: \nL371:  Mattias Fjellvang \nL372: \nL373:  Mattias Fjellvang  \nL374: \nL375: Follow\nL376: \nL377:   * Joined \nL378: \nL379: Feb 15, 2020\nL380: \nL381: •  Jan 5 '22  \nL382: \nL383:  Dropdown menu\nL384: \nL385:   * Copy link\nL386:   *   * Hide \nL387:   *   *   * \nL388: \nL389: This is a great article and just what I was looking for. However, is there a way to provide the container (using useContainer(app.select(AppModule), { fallbackOnErrors: true });) in the app.module.ts instead of in the main.ts file? Because I'd like this to be testable, and if I define it inside app.module.ts, my e2e tests would not function with my custom decorators.\nL390: \nL391:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL392: \nL393: Collapse Expand\nL394: \nL395:   \nL396: \nL397:  davidN96  \nL398: \nL399:  davidN96 \nL400: \nL401:  davidN96  \nL402: \nL403: Follow\nL404: \nL405:   * Joined \nL406: \nL407: Apr 25, 2021\nL408: \nL409: •  Apr 25 '21  \nL410: \nL411:  Dropdown menu\nL412: \nL413:   * Copy link\nL414:   *   * Hide \nL415:   *   *   * \nL416: \nL417: Hey! Great article! Could you share a link to repo with code from this article? I'm newbie in Nest, I have a problem with database dependency injection. I'll be very thankful\nL418: \nL419:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL420: \nL421: Collapse Expand\nL422: \nL423:   \nL424: \nL425:  Krzysztof Szala  \nL426: \nL427:  Krzysztof Szala \nL428: \nL429:  Krzysztof Szala  \nL430: \nL431: Follow\nL432: \nL433: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL434: \nL435:   * Location \nL436: \nL437: Silesia \nL438: \nL439:   * Joined \nL440: \nL441: May 30, 2020\nL442: \nL443: •  Apr 27 '21  \nL444: \nL445:  Dropdown menu\nL446: \nL447:   * Copy link\nL448:   *   * Hide \nL449:   *   *   * \nL450: \nL451: Thank you. I'll try to upload some repos, when I find some time. What kind of problems do you have with database DI? Maybe I can help here. Regards.\nL452: \nL453:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL454: \nL455: Collapse Expand\nL456: \nL457:   \nL458: \nL459:  davidN96  \nL460: \nL461:  davidN96 \nL462: \nL463:  davidN96  \nL464: \nL465: Follow\nL466: \nL467:   * Joined \nL468: \nL469: Apr 25, 2021\nL470: \nL471: •  Apr 27 '21  \nL472: \nL473:  Dropdown menu\nL474: \nL475:   * Copy link\nL476:   *   * Hide \nL477:   *   *   * \nL478: \nL479: Hey! Thank you for your response! Well, I've found the problem. I've accidentally imported useContainer from typeorm instead of class-validator (VSC hints). Now everything works great. Thank you for a great article!\nL480: \nL481:  Like comment:  Like comment:  2 likes Like  Thread Thread \nL482: \nL483:   \nL484: \nL485:  Krzysztof Szala  \nL486: \nL487:  Krzysztof Szala \nL488: \nL489:  Krzysztof Szala  \nL490: \nL491: Follow\nL492: \nL493: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL494: \nL495:   * Location \nL496: \nL497: Silesia \nL498: \nL499:   * Joined \nL500: \nL501: May 30, 2020\nL502: \nL503: •  Apr 27 '21  \nL504: \nL505:  Dropdown menu\nL506: \nL507:   * Copy link\nL508:   *   * Hide \nL509:   *   *   * \nL510: \nL511: That's great, happy to help! :)\nL512: \nL513:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL514: \nL515: Collapse Expand\nL516: \nL517:   \nL518: \nL519:  José Neto  \nL520: \nL521:  José Neto \nL522: \nL523:  José Neto  \nL524: \nL525: Follow\nL526: \nL527: A funny web developer \nL528: \nL529:   * Location \nL530: \nL531: Lisbon \nL532: \nL533:   * Work \nL534: \nL535: Frontend Engineer at TripAdvisor \nL536: \nL537:   * Joined \nL538: \nL539: Mar 17, 2019\nL540: \nL541: •  Aug 22 '21  \nL542: \nL543:  Dropdown menu\nL544: \nL545:   * Copy link\nL546:   *   * Hide \nL547:   *   *   * \nL548: \nL549: Awesome, thanks!\nL550: \nL551:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL552: \nL553: Collapse Expand\nL554: \nL555:   \nL556: \nL557:  Krzysztof Szala  \nL558: \nL559:  Krzysztof Szala \nL560: \nL561:  Krzysztof Szala  \nL562: \nL563: Follow\nL564: \nL565: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL566: \nL567:   * Location \nL568: \nL569: Silesia \nL570: \nL571:   * Joined \nL572: \nL573: May 30, 2020\nL574: \nL575: •  Aug 23 '21  \nL576: \nL577:  Dropdown menu\nL578: \nL579:   * Copy link\nL580:   *   * Hide \nL581:   *   *   * \nL582: \nL583: You’re welcome!\nL584: \nL585:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL586: \nL587: Collapse Expand\nL588: \nL589:   \nL590: \nL591:  huynh nguyen toan  \nL592: \nL593:  huynh nguyen toan \nL594: \nL595:  huynh nguyen toan  \nL596: \nL597: Follow\nL598: \nL599:   * Joined \nL600: \nL601: Oct 11, 2021\nL602: \nL603: •  Jul 2  \nL604: \nL605:  Dropdown menu\nL606: \nL607:   * Copy link\nL608:   *   * Hide \nL609:   *   *   * \nL610: \nL611: Thanks bro.\nL612: \nL613:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL614: \nL615: Collapse Expand\nL616: \nL617:   \nL618: \nL619:  Tafadzwa Muteke  \nL620: \nL621:  Tafadzwa Muteke \nL622: \nL623:  Tafadzwa Muteke  \nL624: \nL625: Follow\nL626: \nL627: Designer, developer. \nL628: \nL629:   * Location \nL630: \nL631: Harare, Zimbabwe \nL632: \nL633:   * Education \nL634: \nL635: Computer Science \nL636: \nL637:   * Work \nL638: \nL639: Mr at Irus Edge Digital Agency \nL640: \nL641:   * Joined \nL642: \nL643: Oct 2, 2019\nL644: \nL645: •  Dec 17 '21  \nL646: \nL647:  Dropdown menu\nL648: \nL649:   * Copy link\nL650:   *   * Hide \nL651:   *   *   * \nL652: \nL653: Thank you, Krzysztof!\nL654: \nL655:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL656: \nL657: Collapse Expand\nL658: \nL659:   \nL660: \nL661:  Krzysztof Szala  \nL662: \nL663:  Krzysztof Szala \nL664: \nL665:  Krzysztof Szala  \nL666: \nL667: Follow\nL668: \nL669: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL670: \nL671:   * Location \nL672: \nL673: Silesia \nL674: \nL675:   * Joined \nL676: \nL677: May 30, 2020\nL678: \nL679: •  Dec 21 '21  \nL680: \nL681:  Dropdown menu\nL682: \nL683:   * Copy link\nL684:   *   * Hide \nL685:   *   *   * \nL686: \nL687: Glad I could help!\nL688: \nL689:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL690: \nL691: Collapse Expand\nL692: \nL693:   \nL694: \nL695:  Esron Silva  \nL696: \nL697:  Esron Silva \nL698: \nL699:  Esron Silva  \nL700: \nL701: Follow\nL702: \nL703: FullStack Developer. Computer Engineer. \nL704: \nL705:   * Location \nL706: \nL707: Petrolina - PE, Brasil \nL708: \nL709:   * Education \nL710: \nL711: Bachelor in Computer Engineering. \nL712: \nL713:   * Work \nL714: \nL715: Computer Engineer and Full Stack Developer at Sysvale \nL716: \nL717:   * Joined \nL718: \nL719: Jun 6, 2019\nL720: \nL721: •  Apr 12 '22  \nL722: \nL723:  Dropdown menu\nL724: \nL725:   * Copy link\nL726:   *   * Hide \nL727:   *   *   * \nL728: \nL729: Awesome content right here. You saved me a ton of work and time.\nL730: \nL731:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL732: \nL733: Collapse Expand\nL734: \nL735:   \nL736: \nL737:  Krzysztof Szala  \nL738: \nL739:  Krzysztof Szala \nL740: \nL741:  Krzysztof Szala  \nL742: \nL743: Follow\nL744: \nL745: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL746: \nL747:   * Location \nL748: \nL749: Silesia \nL750: \nL751:   * Joined \nL752: \nL753: May 30, 2020\nL754: \nL755: •  Apr 17 '22  \nL756: \nL757:  Dropdown menu\nL758: \nL759:   * Copy link\nL760:   *   * Hide \nL761:   *   *   * \nL762: \nL763: I’m glad I could help! \nL764: \nL765:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL766: \nL767: Collapse Expand\nL768: \nL769:   \nL770: \nL771:  Navin Mishra  \nL772: \nL773:  Navin Mishra \nL774: \nL775:  Navin Mishra  \nL776: \nL777: Follow\nL778: \nL779: Programming enthusiast who wants to learn and grow everyday. \nL780: \nL781:   * Location \nL782: \nL783: kathmandu, nepal \nL784: \nL785:   * Education \nL786: \nL787: Tribhuwan University \nL788: \nL789:   * Work \nL790: \nL791: Developer, interest on business terms \nL792: \nL793:   * Joined \nL794: \nL795: Jun 14, 2022\nL796: \nL797: •  Dec 8  \nL798: \nL799:  Dropdown menu\nL800: \nL801:   * Copy link\nL802:   *   * Hide \nL803:   *   *   * \nL804: \nL805: great article. very helpful\nL806: \nL807:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL808: \nL809: Collapse Expand\nL810: \nL811:   \nL812: \nL813:  Jedediah  \nL814: \nL815:  Jedediah \nL816: \nL817:  Jedediah  \nL818: \nL819: Follow\nL820: \nL821:   * Joined \nL822: \nL823: Apr 28, 2022\nL824: \nL825: •  Apr 28 '22  \nL826: \nL827:  Dropdown menu\nL828: \nL829:   * Copy link\nL830:   *   * Hide \nL831:   *   *   * \nL832: \nL833: Signed up Dev.to just to say thank you! A great series for Nestjs! Great job!\nL834: \nL835:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL836: \nL837: Collapse Expand\nL838:\nVisible: 0% - 85%"}]},"command":"click","args":[1],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"260acd90-06dc-47c4-9247-a40c8e86c71e","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"260acd90-06dc-47c4-9247-a40c8e86c71e","children":["ac5a24d7-4001-45b1-820c-ade5767e83b0"]},"260acd90-06dc-47c4-9247-a40c8e86c71e":{"id":"260acd90-06dc-47c4-9247-a40c8e86c71e","message":{"id":"260acd90-06dc-47c4-9247-a40c8e86c71e","author":{"role":"assistant","metadata":{}},"create_time":1703480183.123878,"content":{"content_type":"code","language":"unknown","text":"click(1)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"54e54fe9-e264-4233-bbf0-0f251cdd6e23","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"54e54fe9-e264-4233-bbf0-0f251cdd6e23","children":["cea888d7-5e29-46d2-887d-9e2ae9119887"]},"54e54fe9-e264-4233-bbf0-0f251cdd6e23":{"id":"54e54fe9-e264-4233-bbf0-0f251cdd6e23","message":{"id":"54e54fe9-e264-4233-bbf0-0f251cdd6e23","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.118091,"content":{"content_type":"tether_browsing_display","result":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Validation | NestJS - A progressive Node.js framework","url":"https://docs.nestjs.com/techniques/validation","text":"\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: "},{"type":"webpage","title":"Custom validation with database in NestJS - DEV Community","url":"https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao","text":"\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: "},{"type":"webpage","title":"Validation - GitHub: Let’s build from here","url":"https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md","text":"\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: "},{"type":"webpage","title":"Injecting request object to a custom validation class in NestJS","url":"https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal","text":"\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: "},{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: "},{"type":"webpage","title":"NestJS and ‘class validator’ cheat sheet - DEV Community","url":"https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao","text":"\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: "},{"type":"webpage","title":"How to implement input validation with NestJS - Sébastien Dubois","url":"https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/","text":"\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: "},{"type":"webpage","title":"How to use class-validator and generate custom error object in nest.js","url":"https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h","text":"\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: "},{"type":"webpage","title":"Building a REST API with NestJS and Prisma: Input Validation ...","url":"https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1","text":"\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: "},{"type":"webpage","title":"NestJS Custom Payload Validation - DEV Community","url":"https://dev.to/shubham_kadam/nestjs-custom-payload-validation-3hh7","text":"\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: "},{"type":"webpage","title":"Mastering Email Validation in NestJS: A Comprehensive Guide","url":"https://emaillistvalidation.com/blog/mastering-email-validation-in-nestjs-a-comprehensive-guide/","text":"\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: "},{"type":"webpage","title":"Custom Card v2 Signature Validation in NestJS - community.hubspot.com","url":"https://community.hubspot.com/t5/APIs-Integrations/Custom-Card-v2-Signature-Validation-in-NestJS/m-p/897350","text":"\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"},{"type":"webpage","title":"Search results for query: 'nestjs class-validator custom validation method documentation'","url":"","text":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"}]},"command":"back","args":[],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"74013678-9825-4779-bcd4-ac54ca2ade5b","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"74013678-9825-4779-bcd4-ac54ca2ade5b","children":["260acd90-06dc-47c4-9247-a40c8e86c71e"]},"74013678-9825-4779-bcd4-ac54ca2ade5b":{"id":"74013678-9825-4779-bcd4-ac54ca2ade5b","message":{"id":"74013678-9825-4779-bcd4-ac54ca2ade5b","author":{"role":"assistant","metadata":{}},"create_time":1703480183.110946,"content":{"content_type":"code","language":"unknown","text":"back()"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"d146efe0-f7b8-49c2-b8bf-4e56b5500760","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"d146efe0-f7b8-49c2-b8bf-4e56b5500760","children":["54e54fe9-e264-4233-bbf0-0f251cdd6e23"]},"d146efe0-f7b8-49c2-b8bf-4e56b5500760":{"id":"d146efe0-f7b8-49c2-b8bf-4e56b5500760","message":{"id":"d146efe0-f7b8-49c2-b8bf-4e56b5500760","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.105651,"content":{"content_type":"tether_browsing_display","result":"L0: \nL1: URL: https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao\nL2:   \nL3: \nL4:   【0†Skip to content】 \nL5: \nL6: Navigation menu 【1† 】 \nL7: \nL8:  Search\nL9: \nL10: 【2† Search 】 \nL11: \nL12:   【3† Log in 】  【4† Create account 】 \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30: 【5† Share to Twitter †twitter.com】 【6† Share to LinkedIn †www.linkedin.com】 【7† Share to Reddit †www.reddit.com】 【8† Share to Hacker News †news.ycombinator.com】 【9† Share to Facebook †www.facebook.com】 【10† Share to Mastodon †toot.kytta.dev】 \nL31: \nL32:  Share Post via...  【11†Report Abuse】 \nL33: \nL34: [Image 6: Krishna Damaraju]\nL35: \nL36: 【12†Krishna Damaraju】 \nL37: \nL38: Posted on Jun 13, 2022\nL39: \nL40: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL41: \nL42: #  NestJS and ‘class validator’ cheat sheet \nL43: \nL44: 【13†# nestjs】 【14†# validation】 【15†# node】 【16†# typescript】 \nL45: \nL46: [Image 12: nestjs-and-class-validator-cheat-sheet]\nL47: \nL48: `NestJs` along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helped me in defining those cases and you can use these to scale to some extent.\nL49: \nL50: ##  【17† 】 1️⃣ Validating String \nL51: \nL52: ###  【18† 】 Any String \nL53: \nL54:     // example.dto.ts\nL55:     import {\nL56:       IsString,\nL57:       IsNotEmpty,\nL58:       MinLength,\nL59:       MaxLength\nL60:     } from 'class-validator'\nL61: \nL62:     export class AnyString {\nL63:         @IsString()\nL64:         @IsNotEmpty()\nL65:         @MinLength(3)\nL66:       @MaxLength(65)\nL67:         userName: string\nL68:     }\nL69: \nL70: Enter fullscreen mode Exit fullscreen mode\nL71: \nL72: ###  【19† 】 Specific String \nL73: \nL74:     // example.dto.ts\nL75:     import {\nL76:       ArrayNotEmpty,\nL77:       IsArray,\nL78:         IsIn\nL79:     } from 'class-validator'\nL80: \nL81:     const weekdays = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];\nL82: \nL83:     export class SpecificString {\nL84:       @IsArray()\nL85:       @ArrayNotEmpty()\nL86: \nL87:         @IsIn(weekdays)\nL88:       day: string[]\nL89:     }\nL90: \nL91: Enter fullscreen mode Exit fullscreen mode\nL92: \nL93: ###  【20† 】 Array of strings \nL94: \nL95:     // example.dto.ts\nL96:     import {\nL97:       ArrayNotEmpty,\nL98:       Contains,\nL99:       IsArray,\nL100:       IsString,\nL101:       Matches,\nL102:       MaxLength\nL103:     } from 'class-validator'\nL104: \nL105:     export class StringArray {\nL106:       @IsArray()\nL107:       @ArrayNotEmpty()\nL108: \nL109:       // check if every array item is string\nL110:       @IsString({ each: true }) \nL111:         // Pass `each: true` when you want this validation to run on every array item\nL112: \nL113:       // Check if every array item has max length\nL114:       @MaxLength(6, { each: true })\nL115: \nL116:       // Check if every array item is only alphabets\nL117:       @Matches('^[a-zA-Z\\\\s]+$', undefined, { each: true })\nL118: \nL119:       // CHeck if every array item contains a text\nL120:       @Contains('hello', { each: true })\nL121:       stringArray: string[]\nL122:     }\nL123: \nL124: Enter fullscreen mode Exit fullscreen mode\nL125: \nL126: ###  【21† 】 Array of Strings with a custom prefix \nL127: \nL128:     // example.dto.ts\nL129:     import {\nL130:       ArrayNotEmpty,\nL131:       IsArray,\nL132:       Validate,\nL133:       ValidateNested,\nL134:       ValidatorConstraint,\nL135:       ValidatorConstraintInterface\nL136:     } from 'class-validator'\nL137: \nL138:     @ValidatorConstraint({ name: 'arrayPrefixValidator' })\nL139:     export class ArrayPrefixValidator implements ValidatorConstraintInterface {\nL140:       validate(values: string[] = []): boolean {\nL141:         if (values.length) {\nL142:           return values.every((value) =\u003e value.startsWith('str-'))\nL143:         }\nL144:         return false\nL145:       }\nL146:     }\nL147: \nL148:     export class StringArray {\nL149:       @IsArray()\nL150:       @ArrayNotEmpty()\nL151: \nL152:       // Check if every array item contains a prefix str-\nL153:       @Validate(ArrayPrefixValidator, { message: 'No str- prefix' })\nL154:       stringArray: string[]\nL155:     }\nL156: \nL157: Enter fullscreen mode Exit fullscreen mode\nL158: \nL159: ##  【22† 】 2️⃣ Validating Number \nL160: \nL161: ###  【23† 】 Any number \nL162: \nL163:     // example.dto.ts\nL164: \nL165:     import {\nL166:       IsNumber,\nL167:       IsNotEmpty,\nL168:       MinLength,\nL169:       MaxLength\nL170:     } from 'class-validator'\nL171: \nL172:     export class AnyString {\nL173:         @IsNumber()\nL174:         @IsNotEmpty()\nL175:         @MinLength(3)\nL176:       @MaxLength(65)\nL177:         userName: string\nL178:     }\nL179: \nL180: Enter fullscreen mode Exit fullscreen mode\nL181: \nL182: ###  【24† 】 Specific Number \nL183: \nL184:     // example.dto.ts\nL185: \nL186:     import {\nL187:       IsNumber,\nL188:       IsNotEmpty,\nL189:       MinLength,\nL190:       MaxLength,\nL191:       ValidatorConstraint,\nL192:       ValidatorConstraintInterface\nL193:     } from 'class-validator'\nL194: \nL195:     @ValidatorConstraint({ name: 'isDividedBy17' })\nL196:     export class IsDividedBy17 implements ValidatorConstraintInterface {\nL197:       validate(value: number): boolean {\nL198:         if (value {\nL199:           return value % 17 === 0\nL200:         }\nL201:         return false\nL202:       }\nL203:     }\nL204: \nL205:     export class SpecificNumber {\nL206:       @IsNumber()\nL207:         @IsNotEmpty()\nL208: \nL209:       // Check if number is divisible by 17\nL210:       @Validate(IsDividedBy17, { message: 'No divided by 17' })\nL211:       specificNumber: number\nL212:     }\nL213: \nL214: Enter fullscreen mode Exit fullscreen mode\nL215: \nL216: ###  【25† 】 Array of numbers \nL217: \nL218:     // example.dto.ts\nL219: \nL220:     import {\nL221:       IsNumber,\nL222:       IsNotEmpty,\nL223:       MinLength,\nL224:       MaxLength,\nL225:       ValidatorConstraint,\nL226:       ValidatorConstraintInterface\nL227:     } from 'class-validator'\nL228: \nL229:     @ValidatorConstraint({ name: 'isEvenNumber' })\nL230:     export class IsEvenNumber implements ValidatorConstraintInterface {\nL231:       validate(numbers: number): boolean {\nL232:         if (numbers {\nL233:           return numbers.every(number =\u003e number % 2 === 0)\nL234:         }\nL235:         return false\nL236:       }\nL237:     }\nL238: \nL239:     export class SpecificNumber {\nL240:       @IsNumber()\nL241:         @IsNotEmpty()\nL242: \nL243:       // Check if everynumber is even\nL244:         @Validate(IsEvenNumber, { message: 'No divided by 17' })\nL245:       numbersList: number[]\nL246:     }\nL247: \nL248: Enter fullscreen mode Exit fullscreen mode\nL249: \nL250: ###  【26† 】 3️⃣ Custom Object \nL251: \nL252: For example you have a payload like below  \nL253: \nL254:     {\nL255:         movies: [{\nL256:             name: \"The jurassic park\",\nL257:             yearOfRelease: 1999,\nL258:             languages: [\"en\"]\nL259:             gener: [\"sci-fi\", \"thriller\"]\nL260:         },\nL261:         {\nL262:             name: \"The Croods\",\nL263:             yearOfRelease: 2012,\nL264:             languages: [\"en\", \"fr\", \"es\"]\nL265:             gener: [\"animation\", \"kids\"]\nL266:         }]\nL267:     }\nL268: \nL269: Enter fullscreen mode Exit fullscreen mode\nL270: \nL271: To validate such object  \nL272: \nL273:     // example.dto.ts\nL274: \nL275:     import {\nL276:       IsNumber,\nL277:       IsNotEmpty,\nL278:       MinLength,\nL279:       MaxLength,\nL280:       ValidatorConstraint,\nL281:       ValidatorConstraintInterface\nL282:     } from 'class-validator'\nL283: \nL284:     @ValidatorConstraint({ name: 'isEvenNumber' })\nL285:     export class IsEvenNumber implements ValidatorConstraintInterface {\nL286:       validate(numbers: number): boolean {\nL287:         if (numbers {\nL288:           return numbers.every(number =\u003e number % 2 === 0)\nL289:         }\nL290:         return false\nL291:       }\nL292:     }\nL293: \nL294:     const validLanguages = [\"en\", \"es\", \"fr\"] \nL295:     const validGeneres = [\"sci-fi\", \"thriller\", \"animation\", \"horror\", \"vintage\"]\nL296: \nL297:     //  Types here\nL298:     export class Movie {\nL299:       @IsString()\nL300:         @IsNotEmpty()\nL301:         @ISRequired()\nL302:       name: string\nL303: \nL304:       @IsNotEmpty()\nL305:       @IsNumber()\nL306:         @ISRequired()\nL307:       yearOfRelease: number\nL308: \nL309:       @IsNotEmpty()\nL310:       @IsString()\nL311:         @IsIn(validLanguages)\nL312:         @ISRequired()\nL313:       languages: string[]\nL314: \nL315:       @IsNotEmpty()\nL316:       @IsString()\nL317:         @IsIn(validGeneres)\nL318:         @ISRequired()\nL319:       genre: string[]\nL320:     }\nL321: \nL322:     export class MoviesList {\nL323:       @IsArray()\nL324:         @ArrayNotEmpty()\nL325:         @Type(() =\u003e Movie)\nL326:       movies: Movie[]\nL327:     }\nL328: \nL329: Enter fullscreen mode Exit fullscreen mode\nL330: \nL331: \u003e Thanks for reading till here. I'd like to hear your thoughts.\nL332: \nL333: Originally posted: 【27†https://www.krishnadamaraju.me/nestjs-and-class-validator-cheat-sheet†www.krishnadamaraju.me】\nL334: \nL335: ##  Top comments (1)\nL336: \nL337: Subscribe\nL338: \nL339:     [Image 13: pic] \nL340: \nL341: Personal Trusted User\nL342: \nL343: 【28† Create template 】 \nL344: \nL345: Templates let you quickly answer FAQs or store snippets for re-use.\nL346: \nL347: Submit Preview 【29†Dismiss】 \nL348: \nL349:   Collapse Expand\nL350: \nL351: 【30† 】 \nL352: \nL353: 【30† Mohammed Shaheem P 】 \nL354: \nL355:  Mohammed Shaheem P \nL356: \nL357: 【30† Mohammed Shaheem P 】 \nL358: \nL359: Follow\nL360: \nL361: It's not a bug \nL362: \nL363:   * Location \nL364: \nL365: Kerala, India \nL366: \nL367:   * Education \nL368: \nL369: Bachelors of Technology in Computer Science and Engineering \nL370: \nL371:   * Work \nL372: \nL373: Full Stack Web Developer \nL374: \nL375:   * Joined \nL376: \nL377: May 26, 2021\nL378: \nL379: • 【31† Feb 8 • Edited on Feb 8 • Edited 】 \nL380: \nL381:  Dropdown menu\nL382: \nL383:   * 【31†Copy link】\nL384:   *   * Hide \nL385:   *   *   * \nL386: \nL387: Under 【32†specific string section】,  \nL388: shouldn't the type of day be `string` instead of `string[]` ?\nL389: \nL390:  Like comment:  Like comment:  Like  Comment button Reply \nL391: \nL392: 【33†Code of Conduct】 • 【11†Report abuse】 \nL393: \nL394: Are you sure you want to hide this comment? It will become hidden in your post, but will still be visible via the comment's permalink. \nL395: \nL396: Hide child comments as well\nL397: \nL398: Confirm \nL399: \nL400: For further actions, you may consider blocking this person and/or 【11†reporting abuse】\nL401: \nL402: ## Read next\nL403: \nL404: 【34† JavaScript Magic Tricks: Web Application Firewall WangLiwen - Nov 27 】 【35† Begineer: TypeScript Utility Types Max Wiggedal - Nov 26 】 【36† Yet Another Newsletter LOL: Getting Griddy Nick Taylor - Nov 26 】 【37† Socket.io: Real-time Web Communication Made Easy Introduction Bek Brace - Nov 24 】 \nL405: \nL406: 【12† Krishna Damaraju 】 \nL407: \nL408: Follow\nL409: \nL410: A JS dev -- with no adjectives attached. \nL411: \nL412:   * Work \nL413: \nL414: Sr. Frontend Engineer \nL415: \nL416:   * Joined \nL417: \nL418: Jul 11, 2017\nL419: \nL420: ###  More from 【12†Krishna Damaraju】 \nL421: \nL422: 【38† Usage of `React.FC` from my experience # react # typescript # javascript # frontend 】 【39† 5 steps to SetUp SASS with Grunt and NodeJS for Beginners # beginners # tutorial # node # grunt 】 \nL423: \nL424: Once suspended, sarathsantoshdamaraju will not be able to comment or publish posts until their suspension is removed. \nL425: \nL426: Note:  \nL427: \nL428:  Submit \u0026 Suspend \nL429: \nL430: Once unsuspended, sarathsantoshdamaraju will be able to comment and publish posts again. \nL431: \nL432: Note:  \nL433: \nL434:  Submit \u0026 Unsuspend \nL435: \nL436: Once unpublished, all posts by sarathsantoshdamaraju will become hidden and only accessible to themselves. \nL437: \nL438: If sarathsantoshdamaraju is not suspended, they can still re-publish their posts from their dashboard. \nL439: \nL440: Note: \nL441: \nL442:  Unpublish all posts \nL443: \nL444: Once unpublished, this post will become invisible to the public and only accessible to Krishna Damaraju. \nL445: \nL446: They can still re-publish the post if they are not suspended.\nL447: \nL448:  Unpublish Post \nL449: \nL450: Thanks for keeping DEV Community safe. Here is what you can do to flag sarathsantoshdamaraju: \nL451: \nL452:  Make all posts by sarathsantoshdamaraju less visible \nL453: \nL454: sarathsantoshdamaraju consistently posts content that violates DEV Community's code of conduct because it is harassing, offensive or spammy. \nL455: \nL456: 【40† Report other inappropriate conduct †javascript:void(0);】 \nL457: \nL458:  Confirm Flag \nL459: \nL460: Unflagging sarathsantoshdamaraju will restore default visibility to their posts. \nL461: \nL462:  Confirm Unflag \nL463: \nL464: 【1†DEV Community】 — A constructive and inclusive social network for software developers. With you every step of your journey. \nL465: \nL466: * 【1† Home 】 \nL467: * 【41† Podcasts 】 \nL468: * 【42† Videos 】 \nL469: * 【43† Tags 】 \nL470: * 【44† FAQ 】 \nL471: * 【45† Forem Shop †shop.forem.com】 \nL472: * 【46† Advertise on DEV 】 \nL473: * 【47† About 】 \nL474: * 【48† Contact 】 \nL475: * 【49† Guides 】 \nL476: * 【50† Software comparisons 】 \nL477: \nL478: * 【33† Code of Conduct 】 \nL479: * 【51† Privacy Policy 】 \nL480: * 【52† Terms of use 】 \nL481: \nL482: Built on 【53†Forem†www.forem.com】 — the 【54†open source】 software that powers 【55†DEV】 and other inclusive communities.\nL483: \nL484: Made with love and 【56†Ruby on Rails】. DEV Community © 2016 - 2023.\nL485: \nL486: [Image 14: DEV Community] \nL487: \nL488: We're a place where coders share, stay up-to-date and grow their careers. \nL489: \nL490: 【3† Log in 】 【4† Create account 】 \nL491: \nL492:  [Image 15] [Image 16] [Image 17] [Image 18] [Image 19]\nVisible: 0% - 100%","summary":"NestJS and ‘class validator’ cheat sheet - DEV Community (dev.to)\n","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"NestJS and ‘class validator’ cheat sheet - DEV Community","url":"https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao","text":"L0: \nL1: URL: https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao\nL2:   \nL3: \nL4:   Skip to content \nL5: \nL6: Navigation menu   \nL7: \nL8:  Search\nL9: \nL10:  Search  \nL11: \nL12:    Log in    Create account  \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30:  Share to Twitter   Share to LinkedIn   Share to Reddit   Share to Hacker News   Share to Facebook   Share to Mastodon  \nL31: \nL32:  Share Post via...  Report Abuse \nL33: \nL34: [Image 6: Krishna Damaraju]\nL35: \nL36: Krishna Damaraju \nL37: \nL38: Posted on Jun 13, 2022\nL39: \nL40: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL41: \nL42: #  NestJS and ‘class validator’ cheat sheet \nL43: \nL44: # nestjs # validation # node # typescript \nL45: \nL46: [Image 12: nestjs-and-class-validator-cheat-sheet]\nL47: \nL48: `NestJs` along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helped me in defining those cases and you can use these to scale to some extent.\nL49: \nL50: ##    1️⃣ Validating String \nL51: \nL52: ###    Any String \nL53: \nL54:     // example.dto.ts\nL55:     import {\nL56:       IsString,\nL57:       IsNotEmpty,\nL58:       MinLength,\nL59:       MaxLength\nL60:     } from 'class-validator'\nL61: \nL62:     export class AnyString {\nL63:         @IsString()\nL64:         @IsNotEmpty()\nL65:         @MinLength(3)\nL66:       @MaxLength(65)\nL67:         userName: string\nL68:     }\nL69: \nL70: Enter fullscreen mode Exit fullscreen mode\nL71: \nL72: ###    Specific String \nL73: \nL74:     // example.dto.ts\nL75:     import {\nL76:       ArrayNotEmpty,\nL77:       IsArray,\nL78:         IsIn\nL79:     } from 'class-validator'\nL80: \nL81:     const weekdays = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];\nL82: \nL83:     export class SpecificString {\nL84:       @IsArray()\nL85:       @ArrayNotEmpty()\nL86: \nL87:         @IsIn(weekdays)\nL88:       day: string[]\nL89:     }\nL90: \nL91: Enter fullscreen mode Exit fullscreen mode\nL92: \nL93: ###    Array of strings \nL94: \nL95:     // example.dto.ts\nL96:     import {\nL97:       ArrayNotEmpty,\nL98:       Contains,\nL99:       IsArray,\nL100:       IsString,\nL101:       Matches,\nL102:       MaxLength\nL103:     } from 'class-validator'\nL104: \nL105:     export class StringArray {\nL106:       @IsArray()\nL107:       @ArrayNotEmpty()\nL108: \nL109:       // check if every array item is string\nL110:       @IsString({ each: true }) \nL111:         // Pass `each: true` when you want this validation to run on every array item\nL112: \nL113:       // Check if every array item has max length\nL114:       @MaxLength(6, { each: true })\nL115: \nL116:       // Check if every array item is only alphabets\nL117:       @Matches('^[a-zA-Z\\\\s]+$', undefined, { each: true })\nL118: \nL119:       // CHeck if every array item contains a text\nL120:       @Contains('hello', { each: true })\nL121:       stringArray: string[]\nL122:     }\nL123: \nL124: Enter fullscreen mode Exit fullscreen mode\nL125: \nL126: ###    Array of Strings with a custom prefix \nL127: \nL128:     // example.dto.ts\nL129:     import {\nL130:       ArrayNotEmpty,\nL131:       IsArray,\nL132:       Validate,\nL133:       ValidateNested,\nL134:       ValidatorConstraint,\nL135:       ValidatorConstraintInterface\nL136:     } from 'class-validator'\nL137: \nL138:     @ValidatorConstraint({ name: 'arrayPrefixValidator' })\nL139:     export class ArrayPrefixValidator implements ValidatorConstraintInterface {\nL140:       validate(values: string[] = []): boolean {\nL141:         if (values.length) {\nL142:           return values.every((value) =\u003e value.startsWith('str-'))\nL143:         }\nL144:         return false\nL145:       }\nL146:     }\nL147: \nL148:     export class StringArray {\nL149:       @IsArray()\nL150:       @ArrayNotEmpty()\nL151: \nL152:       // Check if every array item contains a prefix str-\nL153:       @Validate(ArrayPrefixValidator, { message: 'No str- prefix' })\nL154:       stringArray: string[]\nL155:     }\nL156: \nL157: Enter fullscreen mode Exit fullscreen mode\nL158: \nL159: ##    2️⃣ Validating Number \nL160: \nL161: ###    Any number \nL162: \nL163:     // example.dto.ts\nL164: \nL165:     import {\nL166:       IsNumber,\nL167:       IsNotEmpty,\nL168:       MinLength,\nL169:       MaxLength\nL170:     } from 'class-validator'\nL171: \nL172:     export class AnyString {\nL173:         @IsNumber()\nL174:         @IsNotEmpty()\nL175:         @MinLength(3)\nL176:       @MaxLength(65)\nL177:         userName: string\nL178:     }\nL179: \nL180: Enter fullscreen mode Exit fullscreen mode\nL181: \nL182: ###    Specific Number \nL183: \nL184:     // example.dto.ts\nL185: \nL186:     import {\nL187:       IsNumber,\nL188:       IsNotEmpty,\nL189:       MinLength,\nL190:       MaxLength,\nL191:       ValidatorConstraint,\nL192:       ValidatorConstraintInterface\nL193:     } from 'class-validator'\nL194: \nL195:     @ValidatorConstraint({ name: 'isDividedBy17' })\nL196:     export class IsDividedBy17 implements ValidatorConstraintInterface {\nL197:       validate(value: number): boolean {\nL198:         if (value {\nL199:           return value % 17 === 0\nL200:         }\nL201:         return false\nL202:       }\nL203:     }\nL204: \nL205:     export class SpecificNumber {\nL206:       @IsNumber()\nL207:         @IsNotEmpty()\nL208: \nL209:       // Check if number is divisible by 17\nL210:       @Validate(IsDividedBy17, { message: 'No divided by 17' })\nL211:       specificNumber: number\nL212:     }\nL213: \nL214: Enter fullscreen mode Exit fullscreen mode\nL215: \nL216: ###    Array of numbers \nL217: \nL218:     // example.dto.ts\nL219: \nL220:     import {\nL221:       IsNumber,\nL222:       IsNotEmpty,\nL223:       MinLength,\nL224:       MaxLength,\nL225:       ValidatorConstraint,\nL226:       ValidatorConstraintInterface\nL227:     } from 'class-validator'\nL228: \nL229:     @ValidatorConstraint({ name: 'isEvenNumber' })\nL230:     export class IsEvenNumber implements ValidatorConstraintInterface {\nL231:       validate(numbers: number): boolean {\nL232:         if (numbers {\nL233:           return numbers.every(number =\u003e number % 2 === 0)\nL234:         }\nL235:         return false\nL236:       }\nL237:     }\nL238: \nL239:     export class SpecificNumber {\nL240:       @IsNumber()\nL241:         @IsNotEmpty()\nL242: \nL243:       // Check if everynumber is even\nL244:         @Validate(IsEvenNumber, { message: 'No divided by 17' })\nL245:       numbersList: number[]\nL246:     }\nL247: \nL248: Enter fullscreen mode Exit fullscreen mode\nL249: \nL250: ###    3️⃣ Custom Object \nL251: \nL252: For example you have a payload like below  \nL253: \nL254:     {\nL255:         movies: [{\nL256:             name: \"The jurassic park\",\nL257:             yearOfRelease: 1999,\nL258:             languages: [\"en\"]\nL259:             gener: [\"sci-fi\", \"thriller\"]\nL260:         },\nL261:         {\nL262:             name: \"The Croods\",\nL263:             yearOfRelease: 2012,\nL264:             languages: [\"en\", \"fr\", \"es\"]\nL265:             gener: [\"animation\", \"kids\"]\nL266:         }]\nL267:     }\nL268: \nL269: Enter fullscreen mode Exit fullscreen mode\nL270: \nL271: To validate such object  \nL272: \nL273:     // example.dto.ts\nL274: \nL275:     import {\nL276:       IsNumber,\nL277:       IsNotEmpty,\nL278:       MinLength,\nL279:       MaxLength,\nL280:       ValidatorConstraint,\nL281:       ValidatorConstraintInterface\nL282:     } from 'class-validator'\nL283: \nL284:     @ValidatorConstraint({ name: 'isEvenNumber' })\nL285:     export class IsEvenNumber implements ValidatorConstraintInterface {\nL286:       validate(numbers: number): boolean {\nL287:         if (numbers {\nL288:           return numbers.every(number =\u003e number % 2 === 0)\nL289:         }\nL290:         return false\nL291:       }\nL292:     }\nL293: \nL294:     const validLanguages = [\"en\", \"es\", \"fr\"] \nL295:     const validGeneres = [\"sci-fi\", \"thriller\", \"animation\", \"horror\", \"vintage\"]\nL296: \nL297:     //  Types here\nL298:     export class Movie {\nL299:       @IsString()\nL300:         @IsNotEmpty()\nL301:         @ISRequired()\nL302:       name: string\nL303: \nL304:       @IsNotEmpty()\nL305:       @IsNumber()\nL306:         @ISRequired()\nL307:       yearOfRelease: number\nL308: \nL309:       @IsNotEmpty()\nL310:       @IsString()\nL311:         @IsIn(validLanguages)\nL312:         @ISRequired()\nL313:       languages: string[]\nL314: \nL315:       @IsNotEmpty()\nL316:       @IsString()\nL317:         @IsIn(validGeneres)\nL318:         @ISRequired()\nL319:       genre: string[]\nL320:     }\nL321: \nL322:     export class MoviesList {\nL323:       @IsArray()\nL324:         @ArrayNotEmpty()\nL325:         @Type(() =\u003e Movie)\nL326:       movies: Movie[]\nL327:     }\nL328: \nL329: Enter fullscreen mode Exit fullscreen mode\nL330: \nL331: \u003e Thanks for reading till here. I'd like to hear your thoughts.\nL332: \nL333: Originally posted: https://www.krishnadamaraju.me/nestjs-and-class-validator-cheat-sheet\nL334: \nL335: ##  Top comments (1)\nL336: \nL337: Subscribe\nL338: \nL339:     [Image 13: pic] \nL340: \nL341: Personal Trusted User\nL342: \nL343:  Create template  \nL344: \nL345: Templates let you quickly answer FAQs or store snippets for re-use.\nL346: \nL347: Submit Preview Dismiss \nL348: \nL349:   Collapse Expand\nL350: \nL351:   \nL352: \nL353:  Mohammed Shaheem P  \nL354: \nL355:  Mohammed Shaheem P \nL356: \nL357:  Mohammed Shaheem P  \nL358: \nL359: Follow\nL360: \nL361: It's not a bug \nL362: \nL363:   * Location \nL364: \nL365: Kerala, India \nL366: \nL367:   * Education \nL368: \nL369: Bachelors of Technology in Computer Science and Engineering \nL370: \nL371:   * Work \nL372: \nL373: Full Stack Web Developer \nL374: \nL375:   * Joined \nL376: \nL377: May 26, 2021\nL378: \nL379: •  Feb 8 • Edited on Feb 8 • Edited  \nL380: \nL381:  Dropdown menu\nL382: \nL383:   * Copy link\nL384:   *   * Hide \nL385:   *   *   * \nL386: \nL387: Under specific string section,  \nL388: shouldn't the type of day be `string` instead of `string[]` ?\nL389: \nL390:  Like comment:  Like comment:  Like  Comment button Reply \nL391: \nL392: Code of Conduct • Report abuse \nL393: \nL394: Are you sure you want to hide this comment? It will become hidden in your post, but will still be visible via the comment's permalink. \nL395: \nL396: Hide child comments as well\nL397: \nL398: Confirm \nL399: \nL400: For further actions, you may consider blocking this person and/or reporting abuse\nL401: \nL402: ## Read next\nL403: \nL404:  JavaScript Magic Tricks: Web Application Firewall WangLiwen - Nov 27   Begineer: TypeScript Utility Types Max Wiggedal - Nov 26   Yet Another Newsletter LOL: Getting Griddy Nick Taylor - Nov 26   Socket.io: Real-time Web Communication Made Easy Introduction Bek Brace - Nov 24  \nL405: \nL406:  Krishna Damaraju  \nL407: \nL408: Follow\nL409: \nL410: A JS dev -- with no adjectives attached. \nL411: \nL412:   * Work \nL413: \nL414: Sr. Frontend Engineer \nL415: \nL416:   * Joined \nL417: \nL418: Jul 11, 2017\nL419: \nL420: ###  More from Krishna Damaraju \nL421: \nL422:  Usage of `React.FC` from my experience # react # typescript # javascript # frontend   5 steps to SetUp SASS with Grunt and NodeJS for Beginners # beginners # tutorial # node # grunt  \nL423: \nL424: Once suspended, sarathsantoshdamaraju will not be able to comment or publish posts until their suspension is removed. \nL425: \nL426: Note:  \nL427: \nL428:  Submit \u0026 Suspend \nL429: \nL430: Once unsuspended, sarathsantoshdamaraju will be able to comment and publish posts again. \nL431: \nL432: Note:  \nL433: \nL434:  Submit \u0026 Unsuspend \nL435: \nL436: Once unpublished, all posts by sarathsantoshdamaraju will become hidden and only accessible to themselves. \nL437: \nL438: If sarathsantoshdamaraju is not suspended, they can still re-publish their posts from their dashboard. \nL439: \nL440: Note: \nL441: \nL442:  Unpublish all posts \nL443: \nL444: Once unpublished, this post will become invisible to the public and only accessible to Krishna Damaraju. \nL445: \nL446: They can still re-publish the post if they are not suspended.\nL447: \nL448:  Unpublish Post \nL449: \nL450: Thanks for keeping DEV Community safe. Here is what you can do to flag sarathsantoshdamaraju: \nL451: \nL452:  Make all posts by sarathsantoshdamaraju less visible \nL453: \nL454: sarathsantoshdamaraju consistently posts content that violates DEV Community's code of conduct because it is harassing, offensive or spammy. \nL455: \nL456:  Report other inappropriate conduct  \nL457: \nL458:  Confirm Flag \nL459: \nL460: Unflagging sarathsantoshdamaraju will restore default visibility to their posts. \nL461: \nL462:  Confirm Unflag \nL463: \nL464: DEV Community — A constructive and inclusive social network for software developers. With you every step of your journey. \nL465: \nL466: *  Home  \nL467: *  Podcasts  \nL468: *  Videos  \nL469: *  Tags  \nL470: *  FAQ  \nL471: *  Forem Shop  \nL472: *  Advertise on DEV  \nL473: *  About  \nL474: *  Contact  \nL475: *  Guides  \nL476: *  Software comparisons  \nL477: \nL478: *  Code of Conduct  \nL479: *  Privacy Policy  \nL480: *  Terms of use  \nL481: \nL482: Built on Forem — the open source software that powers DEV and other inclusive communities.\nL483: \nL484: Made with love and Ruby on Rails. DEV Community © 2016 - 2023.\nL485: \nL486: [Image 14: DEV Community] \nL487: \nL488: We're a place where coders share, stay up-to-date and grow their careers. \nL489: \nL490:  Log in   Create account  \nL491: \nL492:  [Image 15] [Image 16] [Image 17] [Image 18] [Image 19]\nVisible: 0% - 100%"}]},"command":"click","args":[5],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"e6d541f6-1869-4489-bb3b-acec2db807f9","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"e6d541f6-1869-4489-bb3b-acec2db807f9","children":["74013678-9825-4779-bcd4-ac54ca2ade5b"]},"e6d541f6-1869-4489-bb3b-acec2db807f9":{"id":"e6d541f6-1869-4489-bb3b-acec2db807f9","message":{"id":"e6d541f6-1869-4489-bb3b-acec2db807f9","author":{"role":"assistant","metadata":{}},"create_time":1703480183.099927,"content":{"content_type":"code","language":"unknown","text":"click(5)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"4aac5c1e-5495-4398-96f6-624e8fd178c7","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"4aac5c1e-5495-4398-96f6-624e8fd178c7","children":["d146efe0-f7b8-49c2-b8bf-4e56b5500760"]},"4aac5c1e-5495-4398-96f6-624e8fd178c7":{"id":"4aac5c1e-5495-4398-96f6-624e8fd178c7","message":{"id":"4aac5c1e-5495-4398-96f6-624e8fd178c7","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.095263,"content":{"content_type":"tether_browsing_display","result":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Validation | NestJS - A progressive Node.js framework","url":"https://docs.nestjs.com/techniques/validation","text":"\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: "},{"type":"webpage","title":"Custom validation with database in NestJS - DEV Community","url":"https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao","text":"\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: "},{"type":"webpage","title":"Validation - GitHub: Let’s build from here","url":"https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md","text":"\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: "},{"type":"webpage","title":"Injecting request object to a custom validation class in NestJS","url":"https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal","text":"\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: "},{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: "},{"type":"webpage","title":"NestJS and ‘class validator’ cheat sheet - DEV Community","url":"https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao","text":"\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: "},{"type":"webpage","title":"How to implement input validation with NestJS - Sébastien Dubois","url":"https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/","text":"\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: "},{"type":"webpage","title":"How to use class-validator and generate custom error object in nest.js","url":"https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h","text":"\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: "},{"type":"webpage","title":"Building a REST API with NestJS and Prisma: Input Validation ...","url":"https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1","text":"\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: "},{"type":"webpage","title":"NestJS Custom Payload Validation - DEV Community","url":"https://dev.to/shubham_kadam/nestjs-custom-payload-validation-3hh7","text":"\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: "},{"type":"webpage","title":"Mastering Email Validation in NestJS: A Comprehensive Guide","url":"https://emaillistvalidation.com/blog/mastering-email-validation-in-nestjs-a-comprehensive-guide/","text":"\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: "},{"type":"webpage","title":"Custom Card v2 Signature Validation in NestJS - community.hubspot.com","url":"https://community.hubspot.com/t5/APIs-Integrations/Custom-Card-v2-Signature-Validation-in-NestJS/m-p/897350","text":"\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"},{"type":"webpage","title":"Search results for query: 'nestjs class-validator custom validation method documentation'","url":"","text":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"}]},"command":"back","args":[],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"517966d9-d3e8-4662-805a-6717ff61478e","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"517966d9-d3e8-4662-805a-6717ff61478e","children":["e6d541f6-1869-4489-bb3b-acec2db807f9"]},"517966d9-d3e8-4662-805a-6717ff61478e":{"id":"517966d9-d3e8-4662-805a-6717ff61478e","message":{"id":"517966d9-d3e8-4662-805a-6717ff61478e","author":{"role":"assistant","metadata":{}},"create_time":1703480183.089548,"content":{"content_type":"code","language":"unknown","text":"back()"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"6b086037-464a-4140-8980-c8174d290dc5","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"6b086037-464a-4140-8980-c8174d290dc5","children":["4aac5c1e-5495-4398-96f6-624e8fd178c7"]},"6b086037-464a-4140-8980-c8174d290dc5":{"id":"6b086037-464a-4140-8980-c8174d290dc5","message":{"id":"6b086037-464a-4140-8980-c8174d290dc5","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.08553,"content":{"content_type":"tether_browsing_display","result":"L0: \nL1: URL: https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md\nL2: 【0†Skip to content】 \nL3: \nL4: Toggle navigation\nL5: \nL6: 【1† 】 \nL7: \nL8: 【2† Sign in 】 \nL9: \nL10:   * Product \nL11: \nL12:     * 【3† Actions Automate any workflow 】\nL13:     * 【4† Packages Host and manage packages 】\nL14:     * 【5† Security Find and fix vulnerabilities 】\nL15:     * 【6† Codespaces Instant dev environments 】\nL16:     * 【7† Copilot Write better code with AI 】\nL17:     * 【8† Code review Manage code changes 】\nL18:     * 【9† Issues Plan and track work 】\nL19:     * 【10† Discussions Collaborate outside of code 】\nL20: \nL21: Explore\nL22:     * 【11† All features 】\nL23:     * 【12† Documentation †docs.github.com】\nL24:     * 【13† GitHub Skills †skills.github.com】\nL25:     * 【14† Blog †github.blog】\nL26: \nL27:   * Solutions \nL28: \nL29: For\nL30:     * 【15† Enterprise 】\nL31:     * 【16† Teams 】\nL32:     * 【17† Startups 】\nL33:     * 【18† Education †education.github.com】\nL34: \nL35: By Solution\nL36:     * 【19† CI/CD \u0026 Automation 】\nL37:     * 【20† DevOps †resources.github.com】\nL38:     * 【21† DevSecOps †resources.github.com】\nL39: \nL40: Resources\nL41:     * 【22† Learning Pathways †resources.github.com】\nL42:     * 【23† White papers, Ebooks, Webinars †resources.github.com】\nL43:     * 【24† Customer Stories 】\nL44:     * 【25† Partners †partner.github.com】\nL45: \nL46:   * Open Source \nL47: \nL48:     * 【26† GitHub Sponsors Fund open source developers 】\nL49: \nL50:     * 【27† The ReadME Project GitHub community articles 】\nL51: \nL52: Repositories\nL53:     * 【28† Topics 】\nL54:     * 【29† Trending 】\nL55:     * 【30† Collections 】\nL56: \nL57:   * 【31†Pricing】 \nL58: \nL59: Search or jump to...\nL60: \nL61: # Search code, repositories, users, issues, pull requests...\nL62: \nL63:  Search \nL64: \nL65: Clear  \nL66: \nL67: 【32† Search syntax tips †docs.github.com】 \nL68: \nL69: #  Provide feedback \nL70: \nL71: We read every piece of feedback, and take your input very seriously.\nL72: \nL73:   Include my email address so I can be contacted\nL74: \nL75: Cancel  Submit feedback \nL76: \nL77: #  Saved searches \nL78: \nL79: ## Use saved searches to filter your results more quickly\nL80: \nL81: Name \nL82: \nL83: Query \nL84: \nL85: To see all available qualifiers, see our 【32†documentation†docs.github.com】. \nL86: \nL87: Cancel  Create saved search \nL88: \nL89: 【2† Sign in 】 \nL90: \nL91: 【33† Sign up 】 \nL92: \nL93: You signed in with another tab or window. 【34†Reload】 to refresh your session. You signed out in another tab or window. 【34†Reload】 to refresh your session. You switched accounts on another tab or window. 【34†Reload】 to refresh your session.   Dismiss alert\nL94: \nL95: {{ message }}\nL96: \nL97: 【35† nestjs 】  / 【36†docs.nestjs.com】  Public\nL98: \nL99:   * 【37† Notifications 】 \nL100:   * 【37† Fork 1.5k 】 \nL101:   * 【37† Star 1k 】 \nL102: \nL103:   * 【36† Code  】\nL104:   * 【38† Issues 90 】\nL105:   * 【39† Pull requests 82 】\nL106:   * 【40† Actions  】\nL107:   * 【41† Projects 0 】\nL108:   * 【42† Security 】\nL109:   * 【43† Insights  】\nL110: \nL111:   Additional navigation options  \nL112: \nL113:   * 【36† Code 】 \nL114:   * 【38† Issues 】 \nL115:   * 【39† Pull requests 】 \nL116:   * 【40† Actions 】 \nL117:   * 【41† Projects 】 \nL118:   * 【42† Security 】 \nL119:   * 【43† Insights 】 \nL120: \nL121: ## Footer\nL122: \nL123: 【44† 】  © 2023 GitHub, Inc. \nL124: \nL125: ### Footer navigation\nL126: \nL127:   * 【45†Terms†docs.github.com】 \nL128:   * 【46†Privacy†docs.github.com】 \nL129:   * 【47†Security】 \nL130:   * 【48†Status†www.githubstatus.com】 \nL131:   * 【12†Docs†docs.github.com】 \nL132:   * 【49†Contact†support.github.com】 \nL133:   * Manage cookies \nL134:   * Do not share my personal information \nL135: \nL136:   You can’t perform that action at this time. \nL137: \nL138:\nVisible: 0% - 100%","summary":"docs.nestjs.com/content/techniques/validation.md at master · nestjs/docs.nestjs.com · GitHub (github.com)\n","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"docs.nestjs.com/content/techniques/validation.md at master · nestjs/docs.nestjs.com · GitHub","url":"https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md","text":"L0: \nL1: URL: https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md\nL2: Skip to content \nL3: \nL4: Toggle navigation\nL5: \nL6:   \nL7: \nL8:  Sign in  \nL9: \nL10:   * Product \nL11: \nL12:     *  Actions Automate any workflow \nL13:     *  Packages Host and manage packages \nL14:     *  Security Find and fix vulnerabilities \nL15:     *  Codespaces Instant dev environments \nL16:     *  Copilot Write better code with AI \nL17:     *  Code review Manage code changes \nL18:     *  Issues Plan and track work \nL19:     *  Discussions Collaborate outside of code \nL20: \nL21: Explore\nL22:     *  All features \nL23:     *  Documentation \nL24:     *  GitHub Skills \nL25:     *  Blog \nL26: \nL27:   * Solutions \nL28: \nL29: For\nL30:     *  Enterprise \nL31:     *  Teams \nL32:     *  Startups \nL33:     *  Education \nL34: \nL35: By Solution\nL36:     *  CI/CD \u0026 Automation \nL37:     *  DevOps \nL38:     *  DevSecOps \nL39: \nL40: Resources\nL41:     *  Learning Pathways \nL42:     *  White papers, Ebooks, Webinars \nL43:     *  Customer Stories \nL44:     *  Partners \nL45: \nL46:   * Open Source \nL47: \nL48:     *  GitHub Sponsors Fund open source developers \nL49: \nL50:     *  The ReadME Project GitHub community articles \nL51: \nL52: Repositories\nL53:     *  Topics \nL54:     *  Trending \nL55:     *  Collections \nL56: \nL57:   * Pricing \nL58: \nL59: Search or jump to...\nL60: \nL61: # Search code, repositories, users, issues, pull requests...\nL62: \nL63:  Search \nL64: \nL65: Clear  \nL66: \nL67:  Search syntax tips  \nL68: \nL69: #  Provide feedback \nL70: \nL71: We read every piece of feedback, and take your input very seriously.\nL72: \nL73:   Include my email address so I can be contacted\nL74: \nL75: Cancel  Submit feedback \nL76: \nL77: #  Saved searches \nL78: \nL79: ## Use saved searches to filter your results more quickly\nL80: \nL81: Name \nL82: \nL83: Query \nL84: \nL85: To see all available qualifiers, see our documentation. \nL86: \nL87: Cancel  Create saved search \nL88: \nL89:  Sign in  \nL90: \nL91:  Sign up  \nL92: \nL93: You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session.   Dismiss alert\nL94: \nL95: {{ message }}\nL96: \nL97:  nestjs   / docs.nestjs.com  Public\nL98: \nL99:   *  Notifications  \nL100:   *  Fork 1.5k  \nL101:   *  Star 1k  \nL102: \nL103:   *  Code  \nL104:   *  Issues 90 \nL105:   *  Pull requests 82 \nL106:   *  Actions  \nL107:   *  Projects 0 \nL108:   *  Security \nL109:   *  Insights  \nL110: \nL111:   Additional navigation options  \nL112: \nL113:   *  Code  \nL114:   *  Issues  \nL115:   *  Pull requests  \nL116:   *  Actions  \nL117:   *  Projects  \nL118:   *  Security  \nL119:   *  Insights  \nL120: \nL121: ## Footer\nL122: \nL123:    © 2023 GitHub, Inc. \nL124: \nL125: ### Footer navigation\nL126: \nL127:   * Terms \nL128:   * Privacy \nL129:   * Security \nL130:   * Status \nL131:   * Docs \nL132:   * Contact \nL133:   * Manage cookies \nL134:   * Do not share my personal information \nL135: \nL136:   You can’t perform that action at this time. \nL137: \nL138:\nVisible: 0% - 100%"}]},"command":"click","args":[2],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"2dcaa71f-d7ca-4c19-99d9-00168ed4dd98","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"2dcaa71f-d7ca-4c19-99d9-00168ed4dd98","children":["517966d9-d3e8-4662-805a-6717ff61478e"]},"2dcaa71f-d7ca-4c19-99d9-00168ed4dd98":{"id":"2dcaa71f-d7ca-4c19-99d9-00168ed4dd98","message":{"id":"2dcaa71f-d7ca-4c19-99d9-00168ed4dd98","author":{"role":"assistant","metadata":{}},"create_time":1703480183.080539,"content":{"content_type":"code","language":"unknown","text":"click(2)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"f9115e9b-64ff-4573-b317-899ac407e44f","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"f9115e9b-64ff-4573-b317-899ac407e44f","children":["6b086037-464a-4140-8980-c8174d290dc5"]},"f9115e9b-64ff-4573-b317-899ac407e44f":{"id":"f9115e9b-64ff-4573-b317-899ac407e44f","message":{"id":"f9115e9b-64ff-4573-b317-899ac407e44f","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.080344,"content":{"content_type":"system_error","name":"tool_error","text":"Error when executing command `click(0)`\nPage at URL https://docs.nestjs.com/techniques/validation had no contents.\nThe page you opened had no contents.\nChatGPT, before attempting another click, look carefully at the currently visible information. Is there enough information on the page or in the search results to answer the user now? If so, go ahead and do that."},"status":"finished_successfully","weight":1,"metadata":{"command":"click","status":"failed","is_complete":true,"model_slug":"gpt-4","parent_id":"dcf4e3e0-af15-4cfc-9b5c-9b435547738c","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"dcf4e3e0-af15-4cfc-9b5c-9b435547738c","children":["2dcaa71f-d7ca-4c19-99d9-00168ed4dd98"]},"dcf4e3e0-af15-4cfc-9b5c-9b435547738c":{"id":"dcf4e3e0-af15-4cfc-9b5c-9b435547738c","message":{"id":"dcf4e3e0-af15-4cfc-9b5c-9b435547738c","author":{"role":"assistant","metadata":{}},"create_time":1703480183.075525,"content":{"content_type":"code","language":"unknown","text":"click(0)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"8b6a840b-c536-483c-8ec8-890c0eaed318","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"8b6a840b-c536-483c-8ec8-890c0eaed318","children":["f9115e9b-64ff-4573-b317-899ac407e44f"]},"8b6a840b-c536-483c-8ec8-890c0eaed318":{"id":"8b6a840b-c536-483c-8ec8-890c0eaed318","message":{"id":"8b6a840b-c536-483c-8ec8-890c0eaed318","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.071879,"content":{"content_type":"tether_browsing_display","result":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Validation | NestJS - A progressive Node.js framework","url":"https://docs.nestjs.com/techniques/validation","text":"\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: "},{"type":"webpage","title":"Custom validation with database in NestJS - DEV Community","url":"https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao","text":"\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: "},{"type":"webpage","title":"Validation - GitHub: Let’s build from here","url":"https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md","text":"\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: "},{"type":"webpage","title":"Injecting request object to a custom validation class in NestJS","url":"https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal","text":"\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: "},{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: "},{"type":"webpage","title":"NestJS and ‘class validator’ cheat sheet - DEV Community","url":"https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao","text":"\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: "},{"type":"webpage","title":"How to implement input validation with NestJS - Sébastien Dubois","url":"https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/","text":"\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: "},{"type":"webpage","title":"How to use class-validator and generate custom error object in nest.js","url":"https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h","text":"\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: "},{"type":"webpage","title":"Building a REST API with NestJS and Prisma: Input Validation ...","url":"https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1","text":"\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: "},{"type":"webpage","title":"NestJS Custom Payload Validation - DEV Community","url":"https://dev.to/shubham_kadam/nestjs-custom-payload-validation-3hh7","text":"\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: "},{"type":"webpage","title":"Mastering Email Validation in NestJS: A Comprehensive Guide","url":"https://emaillistvalidation.com/blog/mastering-email-validation-in-nestjs-a-comprehensive-guide/","text":"\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: "},{"type":"webpage","title":"Custom Card v2 Signature Validation in NestJS - community.hubspot.com","url":"https://community.hubspot.com/t5/APIs-Integrations/Custom-Card-v2-Signature-Validation-in-NestJS/m-p/897350","text":"\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"},{"type":"webpage","title":"Search results for query: 'nestjs class-validator custom validation method documentation'","url":"","text":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"}]},"command":"search","args":["nestjs class-validator custom validation method documentation"],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"969c52cf-d29c-4570-9d92-9a78e9dbf947","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"969c52cf-d29c-4570-9d92-9a78e9dbf947","children":["dcf4e3e0-af15-4cfc-9b5c-9b435547738c"]},"969c52cf-d29c-4570-9d92-9a78e9dbf947":{"id":"969c52cf-d29c-4570-9d92-9a78e9dbf947","message":{"id":"969c52cf-d29c-4570-9d92-9a78e9dbf947","author":{"role":"assistant","metadata":{}},"create_time":1703480183.069745,"content":{"content_type":"code","language":"unknown","text":"search(\"nestjs class-validator custom validation method documentation\")"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"f2e4ff9c-7d50-4db8-a87e-5279ce4632aa","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"f2e4ff9c-7d50-4db8-a87e-5279ce4632aa","children":["8b6a840b-c536-483c-8ec8-890c0eaed318"]},"f2e4ff9c-7d50-4db8-a87e-5279ce4632aa":{"id":"f2e4ff9c-7d50-4db8-a87e-5279ce4632aa","message":{"id":"f2e4ff9c-7d50-4db8-a87e-5279ce4632aa","author":{"role":"tool","name":"python","metadata":{}},"create_time":1703480183.069294,"update_time":1703480125.6680086,"content":{"content_type":"execution_output","text":"---------------------------------------------------------------------------\nNameError                                 Traceback (most recent call last)\nCell In[1], line 1\n----\u003e 1 search(\"nestjs class-validator custom validation method documentation\")\n\nNameError: name 'search' is not defined\n"},"status":"finished_successfully","weight":1,"metadata":{"is_complete":true,"aggregate_result":{"status":"failed_with_in_kernel_exception","run_id":"a5df76b3-e82d-497f-a2ab-cc263ab30649","start_time":1703480122.0300615,"update_time":1703480125.6680086,"code":"search(\"nestjs class-validator custom validation method documentation\")","end_time":1703480125.6680086,"in_kernel_exception":{"name":"NameError","traceback":["---------------------------------------------------------------------------\n","NameError                                 Traceback (most recent call last)\n","Cell In[1], line 1\n----\u003e 1 search(\"nestjs class-validator custom validation method documentation\")\n\n","NameError: name 'search' is not defined\n"],"args":["name 'search' is not defined"],"notes":[]},"messages":[],"jupyter_messages":[{"msg_type":"status","parent_header":{"msg_id":"4f9d30b1-6a5ce727ad12f2f981cdc6b7_2_1","version":"5.3"},"content":{"execution_state":"busy"}},{"msg_type":"execute_input","parent_header":{"msg_id":"4f9d30b1-6a5ce727ad12f2f981cdc6b7_2_1","version":"5.3"}},{"msg_type":"error","parent_header":{"msg_id":"4f9d30b1-6a5ce727ad12f2f981cdc6b7_2_1","version":"5.3"},"content":{"traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","Cell \u001b[0;32mIn[1], line 1\u001b[0m\n\u001b[0;32m----\u003e 1\u001b[0m \u001b[43msearch\u001b[49m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mnestjs class-validator custom validation method documentation\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n","\u001b[0;31mNameError\u001b[0m: name 'search' is not defined"],"ename":"NameError","evalue":"name 'search' is not defined"}}]},"model_slug":"gpt-4","parent_id":"711e47e6-521a-4f60-ad67-59c3fc439998","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"711e47e6-521a-4f60-ad67-59c3fc439998","children":["969c52cf-d29c-4570-9d92-9a78e9dbf947"]},"711e47e6-521a-4f60-ad67-59c3fc439998":{"id":"711e47e6-521a-4f60-ad67-59c3fc439998","message":{"id":"711e47e6-521a-4f60-ad67-59c3fc439998","author":{"role":"assistant","metadata":{}},"create_time":1703480183.066913,"content":{"content_type":"code","language":"unknown","text":"search(\"nestjs class-validator custom validation method documentation\")"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa27caa-e51d-44f0-b314-f7c794c642de","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"python"},"parent":"aaa27caa-e51d-44f0-b314-f7c794c642de","children":["f2e4ff9c-7d50-4db8-a87e-5279ce4632aa"]},"aaa27caa-e51d-44f0-b314-f7c794c642de":{"id":"aaa27caa-e51d-44f0-b314-f7c794c642de","message":{"id":"aaa27caa-e51d-44f0-b314-f7c794c642de","author":{"role":"user","metadata":{}},"create_time":1703480118.987945,"content":{"content_type":"text","parts":["can you send me a doc that descirbes that you can define a function like this? "]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"cf477ecc-f017-4622-81f8-d2e002544c1b","children":["711e47e6-521a-4f60-ad67-59c3fc439998"]},"cf477ecc-f017-4622-81f8-d2e002544c1b":{"id":"cf477ecc-f017-4622-81f8-d2e002544c1b","message":{"id":"cf477ecc-f017-4622-81f8-d2e002544c1b","author":{"role":"assistant","metadata":{}},"create_time":1703479703.191578,"content":{"content_type":"text","parts":["Your approach is mostly correct for the requirement you've described. You're using the `@ValidateIf` decorator to conditionally apply validation rules based on the `accessLevel` property. This decorator is part of the `class-validator` package and is used for conditional validation.\n\nIn your `CreateRoomDto`, you want to:\n- Require a `password` only when `accessLevel` is `\"PROTECTED\"`.\n- Reject or ignore `password` when `accessLevel` is not `\"PROTECTED\"`.\n\nHere's how you can modify your DTO to meet these requirements:\n\n```typescript\nimport { IsString, IsNotEmpty, MinLength, ValidateIf } from 'class-validator';\nimport { ApiProperty } from '@nestjs/swagger';\n\nexport class CreateRoomDto {\n  @IsString()\n  @IsNotEmpty()\n  @ApiProperty()\n  name: string;\n\n  @IsString()\n  @IsNotEmpty()\n  @ApiProperty()\n  accessLevel: 'PUBLIC' | 'PRIVATE' | 'PROTECTED';\n\n  @ValidateIf((o) =\u003e o.accessLevel === 'PROTECTED')\n  @IsString()\n  @MinLength(4)\n  @ApiProperty({ required: false })\n  password?: string;\n\n  @ValidateIf((o) =\u003e o.accessLevel !== 'PROTECTED' \u0026\u0026 o.password != null)\n  passwordNotAllowed() {\n    return false; // This will always fail validation if condition is true\n  }\n}\n```\n\nExplanation:\n- The `@ValidateIf` decorator for `password` ensures that the `password` field is validated only when `accessLevel` is `'PROTECTED'`. This includes checking that it's a string and has a minimum length of 4.\n- The `passwordNotAllowed` method, decorated with `@ValidateIf`, checks if `accessLevel` is not `'PROTECTED'` and a `password` is provided. If both conditions are true, it returns `false`, failing the validation. This method effectively rejects the `password` field when `accessLevel` is not `'PROTECTED'`.\n\nThis setup ensures that a `password` is only allowed and validated when `accessLevel` is `'PROTECTED'`, and it is rejected otherwise."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa25d32-8ddd-484c-af9b-e17fd3893529","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"aaa25d32-8ddd-484c-af9b-e17fd3893529","children":["aaa27caa-e51d-44f0-b314-f7c794c642de"]},"aaa25d32-8ddd-484c-af9b-e17fd3893529":{"id":"aaa25d32-8ddd-484c-af9b-e17fd3893529","message":{"id":"aaa25d32-8ddd-484c-af9b-e17fd3893529","author":{"role":"user","metadata":{}},"create_time":1703479689.228917,"content":{"content_type":"text","parts":["What I actually want to do is\n- allow password only when accessLevel is \"PROTECTED\"\n- reject password when accessLevel is not \"PROTECTED\"\n\n```\nexport class CreateRoomDto {\n  @IsString()\n  @IsNotEmpty()\n  @ApiProperty()\n  name: string;\n\n  @IsString()\n  @IsNotEmpty()\n  @ApiProperty()\n  accessLevel: 'PUBLIC' | 'PRIVATE' | 'PROTECTED';\n\n  @ValidateIf((o) =\u003e o.accessLevel === 'PROTECTED')\n  @IsString()\n  @MinLength(4)\n  @ApiProperty({ required: false })\n  password?: string;\n}\n```"]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"f171c27f-2e5b-4657-a693-86d18595a809","children":["cf477ecc-f017-4622-81f8-d2e002544c1b"]},"f171c27f-2e5b-4657-a693-86d18595a809":{"id":"f171c27f-2e5b-4657-a693-86d18595a809","message":{"id":"f171c27f-2e5b-4657-a693-86d18595a809","author":{"role":"assistant","metadata":{}},"create_time":1703479413.535959,"content":{"content_type":"text","parts":["To achieve this kind of conditional validation in Nest.js, where either both `a` and `b` should be present or neither of them should be, you can use class-validator with custom validation logic. Here's a step-by-step guide on how to do it:\n\n1. **Install class-validator and class-transformer**: These packages are often used in NestJS for DTO validation and transformation. If you haven't already installed them, do so by running:\n\n   ```bash\n   npm install class-validator class-transformer\n   ```\n\n2. **Create the DTO Class**: Define your DTO class with the properties `a` and `b`.\n\n   ```typescript\n   import { IsOptional, Validate } from 'class-validator';\n\n   export class YourDto {\n     @IsOptional()\n     a?: string;\n\n     @IsOptional()\n     b?: string;\n   }\n   ```\n\n3. **Custom Validator**: Create a custom validator that checks if either both `a` and `b` are present or neither of them.\n\n   ```typescript\n   import { \n     registerDecorator, \n     ValidationOptions, \n     ValidationArguments \n   } from 'class-validator';\n\n   function IsEitherBothOrNone(validationOptions?: ValidationOptions) {\n     return function (object: any, propertyName: string) {\n       registerDecorator({\n         name: 'isEitherBothOrNone',\n         target: object.constructor,\n         propertyName: propertyName,\n         options: validationOptions,\n         validator: {\n           validate(value: any, args: ValidationArguments) {\n             const relatedPropertyName = args.constraints[0];\n             const relatedValue = (args.object as any)[relatedPropertyName];\n             return (\n               (value != null \u0026\u0026 relatedValue != null) || \n               (value == null \u0026\u0026 relatedValue == null)\n             );\n           },\n         },\n       });\n     };\n   }\n   ```\n\n4. **Apply the Custom Validator**: Use the custom validator in your DTO class. \n\n   ```typescript\n   export class YourDto {\n     @IsOptional()\n     @IsEitherBothOrNone('b', {\n       message: 'Both a and b must be present or neither',\n     })\n     a?: string;\n\n     @IsOptional()\n     b?: string;\n   }\n   ```\n\n5. **Use the DTO in Your Controller**: Ensure that you use this DTO in your controller and enable validation in your NestJS application.\n\n   ```typescript\n   @Post()\n   async create(@Body() dto: YourDto) {\n     // Your logic here\n   }\n   ```\n\n6. **Enable Global Validation**: In your main application file (usually `main.ts`), make sure to enable global validation.\n\n   ```typescript\n   import { ValidationPipe } from '@nestjs/common';\n\n   async function bootstrap() {\n     const app = await NestFactory.create(AppModule);\n     app.useGlobalPipes(new ValidationPipe());\n     await app.listen(3000);\n   }\n   bootstrap();\n   ```\n\nWith this setup, your application will validate that either both `a` and `b` are provided in the request, or neither of them is. This kind of conditional validation is powerful for handling complex validation scenarios in Nest.js."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa21174-0a20-40c7-b39f-11f7b5f82925","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"aaa21174-0a20-40c7-b39f-11f7b5f82925","children":["aaa25d32-8ddd-484c-af9b-e17fd3893529"]},"aaa21174-0a20-40c7-b39f-11f7b5f82925":{"id":"aaa21174-0a20-40c7-b39f-11f7b5f82925","message":{"id":"aaa21174-0a20-40c7-b39f-11f7b5f82925","author":{"role":"user","metadata":{}},"create_time":1703479382.04501,"content":{"content_type":"text","parts":["In Nest.JS, if you want to validate if dto has a and b or neither of them. How do you do it?"]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"3e10c24f-8bd1-4743-bfcc-28956a600eb8","children":["f171c27f-2e5b-4657-a693-86d18595a809"]},"3e10c24f-8bd1-4743-bfcc-28956a600eb8":{"id":"3e10c24f-8bd1-4743-bfcc-28956a600eb8","message":{"id":"3e10c24f-8bd1-4743-bfcc-28956a600eb8","author":{"role":"system","metadata":{}},"content":{"content_type":"text","parts":[""]},"status":"finished_successfully","end_turn":true,"weight":0,"metadata":{"shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d","is_visually_hidden_from_conversation":true},"recipient":"all"},"parent":"aaa10064-a110-4c1f-ae69-64331993b872","children":["aaa21174-0a20-40c7-b39f-11f7b5f82925"]},"aaa10064-a110-4c1f-ae69-64331993b872":{"id":"aaa10064-a110-4c1f-ae69-64331993b872","children":["3e10c24f-8bd1-4743-bfcc-28956a600eb8"]}},"moderation_results":[],"current_node":"103a5ed8-66ec-4d8d-b0e9-a3b9123436fa","conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d","is_archived":false,"safe_urls":["https://levelup.gitconnected.com/typescript-validation-with-ajv-1b70a76dd678†levelup.gitconnected.com","https://www.npmjs.com/package/class-validator†www.npmjs.com","https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao","http://localhost:3000/api/†localhost:3000","www.dsebastien.net","https://www.prisma.io/blog/nestjs-prisma-validation-7d056s1kola1","https://medium.com/javascript-in-plain-english/how-to-test-json-schema-with-ajv-in-typescript-bd0361e0c03e†medium.com","https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h","https://www.krishnadamaraju.me/nestjs-and-class-validator-cheat-sheet†www.krishnadamaraju.me","dev.to","https://github.com/yousefed/typescript-json-schema†github.com","https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","https://github.com/nestjs/nest/issues/819#issuecomment-480247274†github.com","https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao","https://docs.nestjs.com/techniques/validation","https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/","app.select","https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal","https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md","github.com","www.prisma.io","【46†classes†github.com"],"is_public":true,"linear_conversation":[{"id":"aaa10064-a110-4c1f-ae69-64331993b872","children":["3e10c24f-8bd1-4743-bfcc-28956a600eb8"]},{"id":"3e10c24f-8bd1-4743-bfcc-28956a600eb8","message":{"id":"3e10c24f-8bd1-4743-bfcc-28956a600eb8","author":{"role":"system","metadata":{}},"content":{"content_type":"text","parts":[""]},"status":"finished_successfully","end_turn":true,"weight":0,"metadata":{"shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d","is_visually_hidden_from_conversation":true},"recipient":"all"},"parent":"aaa10064-a110-4c1f-ae69-64331993b872","children":["aaa21174-0a20-40c7-b39f-11f7b5f82925"]},{"id":"aaa21174-0a20-40c7-b39f-11f7b5f82925","message":{"id":"aaa21174-0a20-40c7-b39f-11f7b5f82925","author":{"role":"user","metadata":{}},"create_time":1703479382.04501,"content":{"content_type":"text","parts":["In Nest.JS, if you want to validate if dto has a and b or neither of them. How do you do it?"]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"3e10c24f-8bd1-4743-bfcc-28956a600eb8","children":["f171c27f-2e5b-4657-a693-86d18595a809"]},{"id":"f171c27f-2e5b-4657-a693-86d18595a809","message":{"id":"f171c27f-2e5b-4657-a693-86d18595a809","author":{"role":"assistant","metadata":{}},"create_time":1703479413.535959,"content":{"content_type":"text","parts":["To achieve this kind of conditional validation in Nest.js, where either both `a` and `b` should be present or neither of them should be, you can use class-validator with custom validation logic. Here's a step-by-step guide on how to do it:\n\n1. **Install class-validator and class-transformer**: These packages are often used in NestJS for DTO validation and transformation. If you haven't already installed them, do so by running:\n\n   ```bash\n   npm install class-validator class-transformer\n   ```\n\n2. **Create the DTO Class**: Define your DTO class with the properties `a` and `b`.\n\n   ```typescript\n   import { IsOptional, Validate } from 'class-validator';\n\n   export class YourDto {\n     @IsOptional()\n     a?: string;\n\n     @IsOptional()\n     b?: string;\n   }\n   ```\n\n3. **Custom Validator**: Create a custom validator that checks if either both `a` and `b` are present or neither of them.\n\n   ```typescript\n   import { \n     registerDecorator, \n     ValidationOptions, \n     ValidationArguments \n   } from 'class-validator';\n\n   function IsEitherBothOrNone(validationOptions?: ValidationOptions) {\n     return function (object: any, propertyName: string) {\n       registerDecorator({\n         name: 'isEitherBothOrNone',\n         target: object.constructor,\n         propertyName: propertyName,\n         options: validationOptions,\n         validator: {\n           validate(value: any, args: ValidationArguments) {\n             const relatedPropertyName = args.constraints[0];\n             const relatedValue = (args.object as any)[relatedPropertyName];\n             return (\n               (value != null \u0026\u0026 relatedValue != null) || \n               (value == null \u0026\u0026 relatedValue == null)\n             );\n           },\n         },\n       });\n     };\n   }\n   ```\n\n4. **Apply the Custom Validator**: Use the custom validator in your DTO class. \n\n   ```typescript\n   export class YourDto {\n     @IsOptional()\n     @IsEitherBothOrNone('b', {\n       message: 'Both a and b must be present or neither',\n     })\n     a?: string;\n\n     @IsOptional()\n     b?: string;\n   }\n   ```\n\n5. **Use the DTO in Your Controller**: Ensure that you use this DTO in your controller and enable validation in your NestJS application.\n\n   ```typescript\n   @Post()\n   async create(@Body() dto: YourDto) {\n     // Your logic here\n   }\n   ```\n\n6. **Enable Global Validation**: In your main application file (usually `main.ts`), make sure to enable global validation.\n\n   ```typescript\n   import { ValidationPipe } from '@nestjs/common';\n\n   async function bootstrap() {\n     const app = await NestFactory.create(AppModule);\n     app.useGlobalPipes(new ValidationPipe());\n     await app.listen(3000);\n   }\n   bootstrap();\n   ```\n\nWith this setup, your application will validate that either both `a` and `b` are provided in the request, or neither of them is. This kind of conditional validation is powerful for handling complex validation scenarios in Nest.js."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa21174-0a20-40c7-b39f-11f7b5f82925","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"aaa21174-0a20-40c7-b39f-11f7b5f82925","children":["aaa25d32-8ddd-484c-af9b-e17fd3893529"]},{"id":"aaa25d32-8ddd-484c-af9b-e17fd3893529","message":{"id":"aaa25d32-8ddd-484c-af9b-e17fd3893529","author":{"role":"user","metadata":{}},"create_time":1703479689.228917,"content":{"content_type":"text","parts":["What I actually want to do is\n- allow password only when accessLevel is \"PROTECTED\"\n- reject password when accessLevel is not \"PROTECTED\"\n\n```\nexport class CreateRoomDto {\n  @IsString()\n  @IsNotEmpty()\n  @ApiProperty()\n  name: string;\n\n  @IsString()\n  @IsNotEmpty()\n  @ApiProperty()\n  accessLevel: 'PUBLIC' | 'PRIVATE' | 'PROTECTED';\n\n  @ValidateIf((o) =\u003e o.accessLevel === 'PROTECTED')\n  @IsString()\n  @MinLength(4)\n  @ApiProperty({ required: false })\n  password?: string;\n}\n```"]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"f171c27f-2e5b-4657-a693-86d18595a809","children":["cf477ecc-f017-4622-81f8-d2e002544c1b"]},{"id":"cf477ecc-f017-4622-81f8-d2e002544c1b","message":{"id":"cf477ecc-f017-4622-81f8-d2e002544c1b","author":{"role":"assistant","metadata":{}},"create_time":1703479703.191578,"content":{"content_type":"text","parts":["Your approach is mostly correct for the requirement you've described. You're using the `@ValidateIf` decorator to conditionally apply validation rules based on the `accessLevel` property. This decorator is part of the `class-validator` package and is used for conditional validation.\n\nIn your `CreateRoomDto`, you want to:\n- Require a `password` only when `accessLevel` is `\"PROTECTED\"`.\n- Reject or ignore `password` when `accessLevel` is not `\"PROTECTED\"`.\n\nHere's how you can modify your DTO to meet these requirements:\n\n```typescript\nimport { IsString, IsNotEmpty, MinLength, ValidateIf } from 'class-validator';\nimport { ApiProperty } from '@nestjs/swagger';\n\nexport class CreateRoomDto {\n  @IsString()\n  @IsNotEmpty()\n  @ApiProperty()\n  name: string;\n\n  @IsString()\n  @IsNotEmpty()\n  @ApiProperty()\n  accessLevel: 'PUBLIC' | 'PRIVATE' | 'PROTECTED';\n\n  @ValidateIf((o) =\u003e o.accessLevel === 'PROTECTED')\n  @IsString()\n  @MinLength(4)\n  @ApiProperty({ required: false })\n  password?: string;\n\n  @ValidateIf((o) =\u003e o.accessLevel !== 'PROTECTED' \u0026\u0026 o.password != null)\n  passwordNotAllowed() {\n    return false; // This will always fail validation if condition is true\n  }\n}\n```\n\nExplanation:\n- The `@ValidateIf` decorator for `password` ensures that the `password` field is validated only when `accessLevel` is `'PROTECTED'`. This includes checking that it's a string and has a minimum length of 4.\n- The `passwordNotAllowed` method, decorated with `@ValidateIf`, checks if `accessLevel` is not `'PROTECTED'` and a `password` is provided. If both conditions are true, it returns `false`, failing the validation. This method effectively rejects the `password` field when `accessLevel` is not `'PROTECTED'`.\n\nThis setup ensures that a `password` is only allowed and validated when `accessLevel` is `'PROTECTED'`, and it is rejected otherwise."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa25d32-8ddd-484c-af9b-e17fd3893529","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"aaa25d32-8ddd-484c-af9b-e17fd3893529","children":["aaa27caa-e51d-44f0-b314-f7c794c642de"]},{"id":"aaa27caa-e51d-44f0-b314-f7c794c642de","message":{"id":"aaa27caa-e51d-44f0-b314-f7c794c642de","author":{"role":"user","metadata":{}},"create_time":1703480118.987945,"content":{"content_type":"text","parts":["can you send me a doc that descirbes that you can define a function like this? "]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"cf477ecc-f017-4622-81f8-d2e002544c1b","children":["711e47e6-521a-4f60-ad67-59c3fc439998"]},{"id":"711e47e6-521a-4f60-ad67-59c3fc439998","message":{"id":"711e47e6-521a-4f60-ad67-59c3fc439998","author":{"role":"assistant","metadata":{}},"create_time":1703480183.066913,"content":{"content_type":"code","language":"unknown","text":"search(\"nestjs class-validator custom validation method documentation\")"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa27caa-e51d-44f0-b314-f7c794c642de","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"python"},"parent":"aaa27caa-e51d-44f0-b314-f7c794c642de","children":["f2e4ff9c-7d50-4db8-a87e-5279ce4632aa"]},{"id":"f2e4ff9c-7d50-4db8-a87e-5279ce4632aa","message":{"id":"f2e4ff9c-7d50-4db8-a87e-5279ce4632aa","author":{"role":"tool","name":"python","metadata":{}},"create_time":1703480183.069294,"update_time":1703480125.6680086,"content":{"content_type":"execution_output","text":"---------------------------------------------------------------------------\nNameError                                 Traceback (most recent call last)\nCell In[1], line 1\n----\u003e 1 search(\"nestjs class-validator custom validation method documentation\")\n\nNameError: name 'search' is not defined\n"},"status":"finished_successfully","weight":1,"metadata":{"is_complete":true,"aggregate_result":{"status":"failed_with_in_kernel_exception","run_id":"a5df76b3-e82d-497f-a2ab-cc263ab30649","start_time":1703480122.0300615,"update_time":1703480125.6680086,"code":"search(\"nestjs class-validator custom validation method documentation\")","end_time":1703480125.6680086,"in_kernel_exception":{"name":"NameError","traceback":["---------------------------------------------------------------------------\n","NameError                                 Traceback (most recent call last)\n","Cell In[1], line 1\n----\u003e 1 search(\"nestjs class-validator custom validation method documentation\")\n\n","NameError: name 'search' is not defined\n"],"args":["name 'search' is not defined"],"notes":[]},"messages":[],"jupyter_messages":[{"msg_type":"status","parent_header":{"msg_id":"4f9d30b1-6a5ce727ad12f2f981cdc6b7_2_1","version":"5.3"},"content":{"execution_state":"busy"}},{"msg_type":"execute_input","parent_header":{"msg_id":"4f9d30b1-6a5ce727ad12f2f981cdc6b7_2_1","version":"5.3"}},{"msg_type":"error","parent_header":{"msg_id":"4f9d30b1-6a5ce727ad12f2f981cdc6b7_2_1","version":"5.3"},"content":{"traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","Cell \u001b[0;32mIn[1], line 1\u001b[0m\n\u001b[0;32m----\u003e 1\u001b[0m \u001b[43msearch\u001b[49m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mnestjs class-validator custom validation method documentation\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n","\u001b[0;31mNameError\u001b[0m: name 'search' is not defined"],"ename":"NameError","evalue":"name 'search' is not defined"}}]},"model_slug":"gpt-4","parent_id":"711e47e6-521a-4f60-ad67-59c3fc439998","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"711e47e6-521a-4f60-ad67-59c3fc439998","children":["969c52cf-d29c-4570-9d92-9a78e9dbf947"]},{"id":"969c52cf-d29c-4570-9d92-9a78e9dbf947","message":{"id":"969c52cf-d29c-4570-9d92-9a78e9dbf947","author":{"role":"assistant","metadata":{}},"create_time":1703480183.069745,"content":{"content_type":"code","language":"unknown","text":"search(\"nestjs class-validator custom validation method documentation\")"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"f2e4ff9c-7d50-4db8-a87e-5279ce4632aa","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"f2e4ff9c-7d50-4db8-a87e-5279ce4632aa","children":["8b6a840b-c536-483c-8ec8-890c0eaed318"]},{"id":"8b6a840b-c536-483c-8ec8-890c0eaed318","message":{"id":"8b6a840b-c536-483c-8ec8-890c0eaed318","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.071879,"content":{"content_type":"tether_browsing_display","result":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Validation | NestJS - A progressive Node.js framework","url":"https://docs.nestjs.com/techniques/validation","text":"\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: "},{"type":"webpage","title":"Custom validation with database in NestJS - DEV Community","url":"https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao","text":"\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: "},{"type":"webpage","title":"Validation - GitHub: Let’s build from here","url":"https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md","text":"\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: "},{"type":"webpage","title":"Injecting request object to a custom validation class in NestJS","url":"https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal","text":"\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: "},{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: "},{"type":"webpage","title":"NestJS and ‘class validator’ cheat sheet - DEV Community","url":"https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao","text":"\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: "},{"type":"webpage","title":"How to implement input validation with NestJS - Sébastien Dubois","url":"https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/","text":"\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: "},{"type":"webpage","title":"How to use class-validator and generate custom error object in nest.js","url":"https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h","text":"\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: "},{"type":"webpage","title":"Building a REST API with NestJS and Prisma: Input Validation ...","url":"https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1","text":"\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: "},{"type":"webpage","title":"NestJS Custom Payload Validation - DEV Community","url":"https://dev.to/shubham_kadam/nestjs-custom-payload-validation-3hh7","text":"\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: "},{"type":"webpage","title":"Mastering Email Validation in NestJS: A Comprehensive Guide","url":"https://emaillistvalidation.com/blog/mastering-email-validation-in-nestjs-a-comprehensive-guide/","text":"\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: "},{"type":"webpage","title":"Custom Card v2 Signature Validation in NestJS - community.hubspot.com","url":"https://community.hubspot.com/t5/APIs-Integrations/Custom-Card-v2-Signature-Validation-in-NestJS/m-p/897350","text":"\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"},{"type":"webpage","title":"Search results for query: 'nestjs class-validator custom validation method documentation'","url":"","text":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"}]},"command":"search","args":["nestjs class-validator custom validation method documentation"],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"969c52cf-d29c-4570-9d92-9a78e9dbf947","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"969c52cf-d29c-4570-9d92-9a78e9dbf947","children":["dcf4e3e0-af15-4cfc-9b5c-9b435547738c"]},{"id":"dcf4e3e0-af15-4cfc-9b5c-9b435547738c","message":{"id":"dcf4e3e0-af15-4cfc-9b5c-9b435547738c","author":{"role":"assistant","metadata":{}},"create_time":1703480183.075525,"content":{"content_type":"code","language":"unknown","text":"click(0)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"8b6a840b-c536-483c-8ec8-890c0eaed318","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"8b6a840b-c536-483c-8ec8-890c0eaed318","children":["f9115e9b-64ff-4573-b317-899ac407e44f"]},{"id":"f9115e9b-64ff-4573-b317-899ac407e44f","message":{"id":"f9115e9b-64ff-4573-b317-899ac407e44f","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.080344,"content":{"content_type":"system_error","name":"tool_error","text":"Error when executing command `click(0)`\nPage at URL https://docs.nestjs.com/techniques/validation had no contents.\nThe page you opened had no contents.\nChatGPT, before attempting another click, look carefully at the currently visible information. Is there enough information on the page or in the search results to answer the user now? If so, go ahead and do that."},"status":"finished_successfully","weight":1,"metadata":{"command":"click","status":"failed","is_complete":true,"model_slug":"gpt-4","parent_id":"dcf4e3e0-af15-4cfc-9b5c-9b435547738c","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"dcf4e3e0-af15-4cfc-9b5c-9b435547738c","children":["2dcaa71f-d7ca-4c19-99d9-00168ed4dd98"]},{"id":"2dcaa71f-d7ca-4c19-99d9-00168ed4dd98","message":{"id":"2dcaa71f-d7ca-4c19-99d9-00168ed4dd98","author":{"role":"assistant","metadata":{}},"create_time":1703480183.080539,"content":{"content_type":"code","language":"unknown","text":"click(2)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"f9115e9b-64ff-4573-b317-899ac407e44f","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"f9115e9b-64ff-4573-b317-899ac407e44f","children":["6b086037-464a-4140-8980-c8174d290dc5"]},{"id":"6b086037-464a-4140-8980-c8174d290dc5","message":{"id":"6b086037-464a-4140-8980-c8174d290dc5","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.08553,"content":{"content_type":"tether_browsing_display","result":"L0: \nL1: URL: https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md\nL2: 【0†Skip to content】 \nL3: \nL4: Toggle navigation\nL5: \nL6: 【1† 】 \nL7: \nL8: 【2† Sign in 】 \nL9: \nL10:   * Product \nL11: \nL12:     * 【3† Actions Automate any workflow 】\nL13:     * 【4† Packages Host and manage packages 】\nL14:     * 【5† Security Find and fix vulnerabilities 】\nL15:     * 【6† Codespaces Instant dev environments 】\nL16:     * 【7† Copilot Write better code with AI 】\nL17:     * 【8† Code review Manage code changes 】\nL18:     * 【9† Issues Plan and track work 】\nL19:     * 【10† Discussions Collaborate outside of code 】\nL20: \nL21: Explore\nL22:     * 【11† All features 】\nL23:     * 【12† Documentation †docs.github.com】\nL24:     * 【13† GitHub Skills †skills.github.com】\nL25:     * 【14† Blog †github.blog】\nL26: \nL27:   * Solutions \nL28: \nL29: For\nL30:     * 【15† Enterprise 】\nL31:     * 【16† Teams 】\nL32:     * 【17† Startups 】\nL33:     * 【18† Education †education.github.com】\nL34: \nL35: By Solution\nL36:     * 【19† CI/CD \u0026 Automation 】\nL37:     * 【20† DevOps †resources.github.com】\nL38:     * 【21† DevSecOps †resources.github.com】\nL39: \nL40: Resources\nL41:     * 【22† Learning Pathways †resources.github.com】\nL42:     * 【23† White papers, Ebooks, Webinars †resources.github.com】\nL43:     * 【24† Customer Stories 】\nL44:     * 【25† Partners †partner.github.com】\nL45: \nL46:   * Open Source \nL47: \nL48:     * 【26† GitHub Sponsors Fund open source developers 】\nL49: \nL50:     * 【27† The ReadME Project GitHub community articles 】\nL51: \nL52: Repositories\nL53:     * 【28† Topics 】\nL54:     * 【29† Trending 】\nL55:     * 【30† Collections 】\nL56: \nL57:   * 【31†Pricing】 \nL58: \nL59: Search or jump to...\nL60: \nL61: # Search code, repositories, users, issues, pull requests...\nL62: \nL63:  Search \nL64: \nL65: Clear  \nL66: \nL67: 【32† Search syntax tips †docs.github.com】 \nL68: \nL69: #  Provide feedback \nL70: \nL71: We read every piece of feedback, and take your input very seriously.\nL72: \nL73:   Include my email address so I can be contacted\nL74: \nL75: Cancel  Submit feedback \nL76: \nL77: #  Saved searches \nL78: \nL79: ## Use saved searches to filter your results more quickly\nL80: \nL81: Name \nL82: \nL83: Query \nL84: \nL85: To see all available qualifiers, see our 【32†documentation†docs.github.com】. \nL86: \nL87: Cancel  Create saved search \nL88: \nL89: 【2† Sign in 】 \nL90: \nL91: 【33† Sign up 】 \nL92: \nL93: You signed in with another tab or window. 【34†Reload】 to refresh your session. You signed out in another tab or window. 【34†Reload】 to refresh your session. You switched accounts on another tab or window. 【34†Reload】 to refresh your session.   Dismiss alert\nL94: \nL95: {{ message }}\nL96: \nL97: 【35† nestjs 】  / 【36†docs.nestjs.com】  Public\nL98: \nL99:   * 【37† Notifications 】 \nL100:   * 【37† Fork 1.5k 】 \nL101:   * 【37† Star 1k 】 \nL102: \nL103:   * 【36† Code  】\nL104:   * 【38† Issues 90 】\nL105:   * 【39† Pull requests 82 】\nL106:   * 【40† Actions  】\nL107:   * 【41† Projects 0 】\nL108:   * 【42† Security 】\nL109:   * 【43† Insights  】\nL110: \nL111:   Additional navigation options  \nL112: \nL113:   * 【36† Code 】 \nL114:   * 【38† Issues 】 \nL115:   * 【39† Pull requests 】 \nL116:   * 【40† Actions 】 \nL117:   * 【41† Projects 】 \nL118:   * 【42† Security 】 \nL119:   * 【43† Insights 】 \nL120: \nL121: ## Footer\nL122: \nL123: 【44† 】  © 2023 GitHub, Inc. \nL124: \nL125: ### Footer navigation\nL126: \nL127:   * 【45†Terms†docs.github.com】 \nL128:   * 【46†Privacy†docs.github.com】 \nL129:   * 【47†Security】 \nL130:   * 【48†Status†www.githubstatus.com】 \nL131:   * 【12†Docs†docs.github.com】 \nL132:   * 【49†Contact†support.github.com】 \nL133:   * Manage cookies \nL134:   * Do not share my personal information \nL135: \nL136:   You can’t perform that action at this time. \nL137: \nL138:\nVisible: 0% - 100%","summary":"docs.nestjs.com/content/techniques/validation.md at master · nestjs/docs.nestjs.com · GitHub (github.com)\n","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"docs.nestjs.com/content/techniques/validation.md at master · nestjs/docs.nestjs.com · GitHub","url":"https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md","text":"L0: \nL1: URL: https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md\nL2: Skip to content \nL3: \nL4: Toggle navigation\nL5: \nL6:   \nL7: \nL8:  Sign in  \nL9: \nL10:   * Product \nL11: \nL12:     *  Actions Automate any workflow \nL13:     *  Packages Host and manage packages \nL14:     *  Security Find and fix vulnerabilities \nL15:     *  Codespaces Instant dev environments \nL16:     *  Copilot Write better code with AI \nL17:     *  Code review Manage code changes \nL18:     *  Issues Plan and track work \nL19:     *  Discussions Collaborate outside of code \nL20: \nL21: Explore\nL22:     *  All features \nL23:     *  Documentation \nL24:     *  GitHub Skills \nL25:     *  Blog \nL26: \nL27:   * Solutions \nL28: \nL29: For\nL30:     *  Enterprise \nL31:     *  Teams \nL32:     *  Startups \nL33:     *  Education \nL34: \nL35: By Solution\nL36:     *  CI/CD \u0026 Automation \nL37:     *  DevOps \nL38:     *  DevSecOps \nL39: \nL40: Resources\nL41:     *  Learning Pathways \nL42:     *  White papers, Ebooks, Webinars \nL43:     *  Customer Stories \nL44:     *  Partners \nL45: \nL46:   * Open Source \nL47: \nL48:     *  GitHub Sponsors Fund open source developers \nL49: \nL50:     *  The ReadME Project GitHub community articles \nL51: \nL52: Repositories\nL53:     *  Topics \nL54:     *  Trending \nL55:     *  Collections \nL56: \nL57:   * Pricing \nL58: \nL59: Search or jump to...\nL60: \nL61: # Search code, repositories, users, issues, pull requests...\nL62: \nL63:  Search \nL64: \nL65: Clear  \nL66: \nL67:  Search syntax tips  \nL68: \nL69: #  Provide feedback \nL70: \nL71: We read every piece of feedback, and take your input very seriously.\nL72: \nL73:   Include my email address so I can be contacted\nL74: \nL75: Cancel  Submit feedback \nL76: \nL77: #  Saved searches \nL78: \nL79: ## Use saved searches to filter your results more quickly\nL80: \nL81: Name \nL82: \nL83: Query \nL84: \nL85: To see all available qualifiers, see our documentation. \nL86: \nL87: Cancel  Create saved search \nL88: \nL89:  Sign in  \nL90: \nL91:  Sign up  \nL92: \nL93: You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session.   Dismiss alert\nL94: \nL95: {{ message }}\nL96: \nL97:  nestjs   / docs.nestjs.com  Public\nL98: \nL99:   *  Notifications  \nL100:   *  Fork 1.5k  \nL101:   *  Star 1k  \nL102: \nL103:   *  Code  \nL104:   *  Issues 90 \nL105:   *  Pull requests 82 \nL106:   *  Actions  \nL107:   *  Projects 0 \nL108:   *  Security \nL109:   *  Insights  \nL110: \nL111:   Additional navigation options  \nL112: \nL113:   *  Code  \nL114:   *  Issues  \nL115:   *  Pull requests  \nL116:   *  Actions  \nL117:   *  Projects  \nL118:   *  Security  \nL119:   *  Insights  \nL120: \nL121: ## Footer\nL122: \nL123:    © 2023 GitHub, Inc. \nL124: \nL125: ### Footer navigation\nL126: \nL127:   * Terms \nL128:   * Privacy \nL129:   * Security \nL130:   * Status \nL131:   * Docs \nL132:   * Contact \nL133:   * Manage cookies \nL134:   * Do not share my personal information \nL135: \nL136:   You can’t perform that action at this time. \nL137: \nL138:\nVisible: 0% - 100%"}]},"command":"click","args":[2],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"2dcaa71f-d7ca-4c19-99d9-00168ed4dd98","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"2dcaa71f-d7ca-4c19-99d9-00168ed4dd98","children":["517966d9-d3e8-4662-805a-6717ff61478e"]},{"id":"517966d9-d3e8-4662-805a-6717ff61478e","message":{"id":"517966d9-d3e8-4662-805a-6717ff61478e","author":{"role":"assistant","metadata":{}},"create_time":1703480183.089548,"content":{"content_type":"code","language":"unknown","text":"back()"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"6b086037-464a-4140-8980-c8174d290dc5","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"6b086037-464a-4140-8980-c8174d290dc5","children":["4aac5c1e-5495-4398-96f6-624e8fd178c7"]},{"id":"4aac5c1e-5495-4398-96f6-624e8fd178c7","message":{"id":"4aac5c1e-5495-4398-96f6-624e8fd178c7","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.095263,"content":{"content_type":"tether_browsing_display","result":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Validation | NestJS - A progressive Node.js framework","url":"https://docs.nestjs.com/techniques/validation","text":"\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: "},{"type":"webpage","title":"Custom validation with database in NestJS - DEV Community","url":"https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao","text":"\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: "},{"type":"webpage","title":"Validation - GitHub: Let’s build from here","url":"https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md","text":"\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: "},{"type":"webpage","title":"Injecting request object to a custom validation class in NestJS","url":"https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal","text":"\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: "},{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: "},{"type":"webpage","title":"NestJS and ‘class validator’ cheat sheet - DEV Community","url":"https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao","text":"\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: "},{"type":"webpage","title":"How to implement input validation with NestJS - Sébastien Dubois","url":"https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/","text":"\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: "},{"type":"webpage","title":"How to use class-validator and generate custom error object in nest.js","url":"https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h","text":"\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: "},{"type":"webpage","title":"Building a REST API with NestJS and Prisma: Input Validation ...","url":"https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1","text":"\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: "},{"type":"webpage","title":"NestJS Custom Payload Validation - DEV Community","url":"https://dev.to/shubham_kadam/nestjs-custom-payload-validation-3hh7","text":"\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: "},{"type":"webpage","title":"Mastering Email Validation in NestJS: A Comprehensive Guide","url":"https://emaillistvalidation.com/blog/mastering-email-validation-in-nestjs-a-comprehensive-guide/","text":"\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: "},{"type":"webpage","title":"Custom Card v2 Signature Validation in NestJS - community.hubspot.com","url":"https://community.hubspot.com/t5/APIs-Integrations/Custom-Card-v2-Signature-Validation-in-NestJS/m-p/897350","text":"\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"},{"type":"webpage","title":"Search results for query: 'nestjs class-validator custom validation method documentation'","url":"","text":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"}]},"command":"back","args":[],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"517966d9-d3e8-4662-805a-6717ff61478e","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"517966d9-d3e8-4662-805a-6717ff61478e","children":["e6d541f6-1869-4489-bb3b-acec2db807f9"]},{"id":"e6d541f6-1869-4489-bb3b-acec2db807f9","message":{"id":"e6d541f6-1869-4489-bb3b-acec2db807f9","author":{"role":"assistant","metadata":{}},"create_time":1703480183.099927,"content":{"content_type":"code","language":"unknown","text":"click(5)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"4aac5c1e-5495-4398-96f6-624e8fd178c7","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"4aac5c1e-5495-4398-96f6-624e8fd178c7","children":["d146efe0-f7b8-49c2-b8bf-4e56b5500760"]},{"id":"d146efe0-f7b8-49c2-b8bf-4e56b5500760","message":{"id":"d146efe0-f7b8-49c2-b8bf-4e56b5500760","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.105651,"content":{"content_type":"tether_browsing_display","result":"L0: \nL1: URL: https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao\nL2:   \nL3: \nL4:   【0†Skip to content】 \nL5: \nL6: Navigation menu 【1† 】 \nL7: \nL8:  Search\nL9: \nL10: 【2† Search 】 \nL11: \nL12:   【3† Log in 】  【4† Create account 】 \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30: 【5† Share to Twitter †twitter.com】 【6† Share to LinkedIn †www.linkedin.com】 【7† Share to Reddit †www.reddit.com】 【8† Share to Hacker News †news.ycombinator.com】 【9† Share to Facebook †www.facebook.com】 【10† Share to Mastodon †toot.kytta.dev】 \nL31: \nL32:  Share Post via...  【11†Report Abuse】 \nL33: \nL34: [Image 6: Krishna Damaraju]\nL35: \nL36: 【12†Krishna Damaraju】 \nL37: \nL38: Posted on Jun 13, 2022\nL39: \nL40: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL41: \nL42: #  NestJS and ‘class validator’ cheat sheet \nL43: \nL44: 【13†# nestjs】 【14†# validation】 【15†# node】 【16†# typescript】 \nL45: \nL46: [Image 12: nestjs-and-class-validator-cheat-sheet]\nL47: \nL48: `NestJs` along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helped me in defining those cases and you can use these to scale to some extent.\nL49: \nL50: ##  【17† 】 1️⃣ Validating String \nL51: \nL52: ###  【18† 】 Any String \nL53: \nL54:     // example.dto.ts\nL55:     import {\nL56:       IsString,\nL57:       IsNotEmpty,\nL58:       MinLength,\nL59:       MaxLength\nL60:     } from 'class-validator'\nL61: \nL62:     export class AnyString {\nL63:         @IsString()\nL64:         @IsNotEmpty()\nL65:         @MinLength(3)\nL66:       @MaxLength(65)\nL67:         userName: string\nL68:     }\nL69: \nL70: Enter fullscreen mode Exit fullscreen mode\nL71: \nL72: ###  【19† 】 Specific String \nL73: \nL74:     // example.dto.ts\nL75:     import {\nL76:       ArrayNotEmpty,\nL77:       IsArray,\nL78:         IsIn\nL79:     } from 'class-validator'\nL80: \nL81:     const weekdays = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];\nL82: \nL83:     export class SpecificString {\nL84:       @IsArray()\nL85:       @ArrayNotEmpty()\nL86: \nL87:         @IsIn(weekdays)\nL88:       day: string[]\nL89:     }\nL90: \nL91: Enter fullscreen mode Exit fullscreen mode\nL92: \nL93: ###  【20† 】 Array of strings \nL94: \nL95:     // example.dto.ts\nL96:     import {\nL97:       ArrayNotEmpty,\nL98:       Contains,\nL99:       IsArray,\nL100:       IsString,\nL101:       Matches,\nL102:       MaxLength\nL103:     } from 'class-validator'\nL104: \nL105:     export class StringArray {\nL106:       @IsArray()\nL107:       @ArrayNotEmpty()\nL108: \nL109:       // check if every array item is string\nL110:       @IsString({ each: true }) \nL111:         // Pass `each: true` when you want this validation to run on every array item\nL112: \nL113:       // Check if every array item has max length\nL114:       @MaxLength(6, { each: true })\nL115: \nL116:       // Check if every array item is only alphabets\nL117:       @Matches('^[a-zA-Z\\\\s]+$', undefined, { each: true })\nL118: \nL119:       // CHeck if every array item contains a text\nL120:       @Contains('hello', { each: true })\nL121:       stringArray: string[]\nL122:     }\nL123: \nL124: Enter fullscreen mode Exit fullscreen mode\nL125: \nL126: ###  【21† 】 Array of Strings with a custom prefix \nL127: \nL128:     // example.dto.ts\nL129:     import {\nL130:       ArrayNotEmpty,\nL131:       IsArray,\nL132:       Validate,\nL133:       ValidateNested,\nL134:       ValidatorConstraint,\nL135:       ValidatorConstraintInterface\nL136:     } from 'class-validator'\nL137: \nL138:     @ValidatorConstraint({ name: 'arrayPrefixValidator' })\nL139:     export class ArrayPrefixValidator implements ValidatorConstraintInterface {\nL140:       validate(values: string[] = []): boolean {\nL141:         if (values.length) {\nL142:           return values.every((value) =\u003e value.startsWith('str-'))\nL143:         }\nL144:         return false\nL145:       }\nL146:     }\nL147: \nL148:     export class StringArray {\nL149:       @IsArray()\nL150:       @ArrayNotEmpty()\nL151: \nL152:       // Check if every array item contains a prefix str-\nL153:       @Validate(ArrayPrefixValidator, { message: 'No str- prefix' })\nL154:       stringArray: string[]\nL155:     }\nL156: \nL157: Enter fullscreen mode Exit fullscreen mode\nL158: \nL159: ##  【22† 】 2️⃣ Validating Number \nL160: \nL161: ###  【23† 】 Any number \nL162: \nL163:     // example.dto.ts\nL164: \nL165:     import {\nL166:       IsNumber,\nL167:       IsNotEmpty,\nL168:       MinLength,\nL169:       MaxLength\nL170:     } from 'class-validator'\nL171: \nL172:     export class AnyString {\nL173:         @IsNumber()\nL174:         @IsNotEmpty()\nL175:         @MinLength(3)\nL176:       @MaxLength(65)\nL177:         userName: string\nL178:     }\nL179: \nL180: Enter fullscreen mode Exit fullscreen mode\nL181: \nL182: ###  【24† 】 Specific Number \nL183: \nL184:     // example.dto.ts\nL185: \nL186:     import {\nL187:       IsNumber,\nL188:       IsNotEmpty,\nL189:       MinLength,\nL190:       MaxLength,\nL191:       ValidatorConstraint,\nL192:       ValidatorConstraintInterface\nL193:     } from 'class-validator'\nL194: \nL195:     @ValidatorConstraint({ name: 'isDividedBy17' })\nL196:     export class IsDividedBy17 implements ValidatorConstraintInterface {\nL197:       validate(value: number): boolean {\nL198:         if (value {\nL199:           return value % 17 === 0\nL200:         }\nL201:         return false\nL202:       }\nL203:     }\nL204: \nL205:     export class SpecificNumber {\nL206:       @IsNumber()\nL207:         @IsNotEmpty()\nL208: \nL209:       // Check if number is divisible by 17\nL210:       @Validate(IsDividedBy17, { message: 'No divided by 17' })\nL211:       specificNumber: number\nL212:     }\nL213: \nL214: Enter fullscreen mode Exit fullscreen mode\nL215: \nL216: ###  【25† 】 Array of numbers \nL217: \nL218:     // example.dto.ts\nL219: \nL220:     import {\nL221:       IsNumber,\nL222:       IsNotEmpty,\nL223:       MinLength,\nL224:       MaxLength,\nL225:       ValidatorConstraint,\nL226:       ValidatorConstraintInterface\nL227:     } from 'class-validator'\nL228: \nL229:     @ValidatorConstraint({ name: 'isEvenNumber' })\nL230:     export class IsEvenNumber implements ValidatorConstraintInterface {\nL231:       validate(numbers: number): boolean {\nL232:         if (numbers {\nL233:           return numbers.every(number =\u003e number % 2 === 0)\nL234:         }\nL235:         return false\nL236:       }\nL237:     }\nL238: \nL239:     export class SpecificNumber {\nL240:       @IsNumber()\nL241:         @IsNotEmpty()\nL242: \nL243:       // Check if everynumber is even\nL244:         @Validate(IsEvenNumber, { message: 'No divided by 17' })\nL245:       numbersList: number[]\nL246:     }\nL247: \nL248: Enter fullscreen mode Exit fullscreen mode\nL249: \nL250: ###  【26† 】 3️⃣ Custom Object \nL251: \nL252: For example you have a payload like below  \nL253: \nL254:     {\nL255:         movies: [{\nL256:             name: \"The jurassic park\",\nL257:             yearOfRelease: 1999,\nL258:             languages: [\"en\"]\nL259:             gener: [\"sci-fi\", \"thriller\"]\nL260:         },\nL261:         {\nL262:             name: \"The Croods\",\nL263:             yearOfRelease: 2012,\nL264:             languages: [\"en\", \"fr\", \"es\"]\nL265:             gener: [\"animation\", \"kids\"]\nL266:         }]\nL267:     }\nL268: \nL269: Enter fullscreen mode Exit fullscreen mode\nL270: \nL271: To validate such object  \nL272: \nL273:     // example.dto.ts\nL274: \nL275:     import {\nL276:       IsNumber,\nL277:       IsNotEmpty,\nL278:       MinLength,\nL279:       MaxLength,\nL280:       ValidatorConstraint,\nL281:       ValidatorConstraintInterface\nL282:     } from 'class-validator'\nL283: \nL284:     @ValidatorConstraint({ name: 'isEvenNumber' })\nL285:     export class IsEvenNumber implements ValidatorConstraintInterface {\nL286:       validate(numbers: number): boolean {\nL287:         if (numbers {\nL288:           return numbers.every(number =\u003e number % 2 === 0)\nL289:         }\nL290:         return false\nL291:       }\nL292:     }\nL293: \nL294:     const validLanguages = [\"en\", \"es\", \"fr\"] \nL295:     const validGeneres = [\"sci-fi\", \"thriller\", \"animation\", \"horror\", \"vintage\"]\nL296: \nL297:     //  Types here\nL298:     export class Movie {\nL299:       @IsString()\nL300:         @IsNotEmpty()\nL301:         @ISRequired()\nL302:       name: string\nL303: \nL304:       @IsNotEmpty()\nL305:       @IsNumber()\nL306:         @ISRequired()\nL307:       yearOfRelease: number\nL308: \nL309:       @IsNotEmpty()\nL310:       @IsString()\nL311:         @IsIn(validLanguages)\nL312:         @ISRequired()\nL313:       languages: string[]\nL314: \nL315:       @IsNotEmpty()\nL316:       @IsString()\nL317:         @IsIn(validGeneres)\nL318:         @ISRequired()\nL319:       genre: string[]\nL320:     }\nL321: \nL322:     export class MoviesList {\nL323:       @IsArray()\nL324:         @ArrayNotEmpty()\nL325:         @Type(() =\u003e Movie)\nL326:       movies: Movie[]\nL327:     }\nL328: \nL329: Enter fullscreen mode Exit fullscreen mode\nL330: \nL331: \u003e Thanks for reading till here. I'd like to hear your thoughts.\nL332: \nL333: Originally posted: 【27†https://www.krishnadamaraju.me/nestjs-and-class-validator-cheat-sheet†www.krishnadamaraju.me】\nL334: \nL335: ##  Top comments (1)\nL336: \nL337: Subscribe\nL338: \nL339:     [Image 13: pic] \nL340: \nL341: Personal Trusted User\nL342: \nL343: 【28† Create template 】 \nL344: \nL345: Templates let you quickly answer FAQs or store snippets for re-use.\nL346: \nL347: Submit Preview 【29†Dismiss】 \nL348: \nL349:   Collapse Expand\nL350: \nL351: 【30† 】 \nL352: \nL353: 【30† Mohammed Shaheem P 】 \nL354: \nL355:  Mohammed Shaheem P \nL356: \nL357: 【30† Mohammed Shaheem P 】 \nL358: \nL359: Follow\nL360: \nL361: It's not a bug \nL362: \nL363:   * Location \nL364: \nL365: Kerala, India \nL366: \nL367:   * Education \nL368: \nL369: Bachelors of Technology in Computer Science and Engineering \nL370: \nL371:   * Work \nL372: \nL373: Full Stack Web Developer \nL374: \nL375:   * Joined \nL376: \nL377: May 26, 2021\nL378: \nL379: • 【31† Feb 8 • Edited on Feb 8 • Edited 】 \nL380: \nL381:  Dropdown menu\nL382: \nL383:   * 【31†Copy link】\nL384:   *   * Hide \nL385:   *   *   * \nL386: \nL387: Under 【32†specific string section】,  \nL388: shouldn't the type of day be `string` instead of `string[]` ?\nL389: \nL390:  Like comment:  Like comment:  Like  Comment button Reply \nL391: \nL392: 【33†Code of Conduct】 • 【11†Report abuse】 \nL393: \nL394: Are you sure you want to hide this comment? It will become hidden in your post, but will still be visible via the comment's permalink. \nL395: \nL396: Hide child comments as well\nL397: \nL398: Confirm \nL399: \nL400: For further actions, you may consider blocking this person and/or 【11†reporting abuse】\nL401: \nL402: ## Read next\nL403: \nL404: 【34† JavaScript Magic Tricks: Web Application Firewall WangLiwen - Nov 27 】 【35† Begineer: TypeScript Utility Types Max Wiggedal - Nov 26 】 【36† Yet Another Newsletter LOL: Getting Griddy Nick Taylor - Nov 26 】 【37† Socket.io: Real-time Web Communication Made Easy Introduction Bek Brace - Nov 24 】 \nL405: \nL406: 【12† Krishna Damaraju 】 \nL407: \nL408: Follow\nL409: \nL410: A JS dev -- with no adjectives attached. \nL411: \nL412:   * Work \nL413: \nL414: Sr. Frontend Engineer \nL415: \nL416:   * Joined \nL417: \nL418: Jul 11, 2017\nL419: \nL420: ###  More from 【12†Krishna Damaraju】 \nL421: \nL422: 【38† Usage of `React.FC` from my experience # react # typescript # javascript # frontend 】 【39† 5 steps to SetUp SASS with Grunt and NodeJS for Beginners # beginners # tutorial # node # grunt 】 \nL423: \nL424: Once suspended, sarathsantoshdamaraju will not be able to comment or publish posts until their suspension is removed. \nL425: \nL426: Note:  \nL427: \nL428:  Submit \u0026 Suspend \nL429: \nL430: Once unsuspended, sarathsantoshdamaraju will be able to comment and publish posts again. \nL431: \nL432: Note:  \nL433: \nL434:  Submit \u0026 Unsuspend \nL435: \nL436: Once unpublished, all posts by sarathsantoshdamaraju will become hidden and only accessible to themselves. \nL437: \nL438: If sarathsantoshdamaraju is not suspended, they can still re-publish their posts from their dashboard. \nL439: \nL440: Note: \nL441: \nL442:  Unpublish all posts \nL443: \nL444: Once unpublished, this post will become invisible to the public and only accessible to Krishna Damaraju. \nL445: \nL446: They can still re-publish the post if they are not suspended.\nL447: \nL448:  Unpublish Post \nL449: \nL450: Thanks for keeping DEV Community safe. Here is what you can do to flag sarathsantoshdamaraju: \nL451: \nL452:  Make all posts by sarathsantoshdamaraju less visible \nL453: \nL454: sarathsantoshdamaraju consistently posts content that violates DEV Community's code of conduct because it is harassing, offensive or spammy. \nL455: \nL456: 【40† Report other inappropriate conduct †javascript:void(0);】 \nL457: \nL458:  Confirm Flag \nL459: \nL460: Unflagging sarathsantoshdamaraju will restore default visibility to their posts. \nL461: \nL462:  Confirm Unflag \nL463: \nL464: 【1†DEV Community】 — A constructive and inclusive social network for software developers. With you every step of your journey. \nL465: \nL466: * 【1† Home 】 \nL467: * 【41† Podcasts 】 \nL468: * 【42† Videos 】 \nL469: * 【43† Tags 】 \nL470: * 【44† FAQ 】 \nL471: * 【45† Forem Shop †shop.forem.com】 \nL472: * 【46† Advertise on DEV 】 \nL473: * 【47† About 】 \nL474: * 【48† Contact 】 \nL475: * 【49† Guides 】 \nL476: * 【50† Software comparisons 】 \nL477: \nL478: * 【33† Code of Conduct 】 \nL479: * 【51† Privacy Policy 】 \nL480: * 【52† Terms of use 】 \nL481: \nL482: Built on 【53†Forem†www.forem.com】 — the 【54†open source】 software that powers 【55†DEV】 and other inclusive communities.\nL483: \nL484: Made with love and 【56†Ruby on Rails】. DEV Community © 2016 - 2023.\nL485: \nL486: [Image 14: DEV Community] \nL487: \nL488: We're a place where coders share, stay up-to-date and grow their careers. \nL489: \nL490: 【3† Log in 】 【4† Create account 】 \nL491: \nL492:  [Image 15] [Image 16] [Image 17] [Image 18] [Image 19]\nVisible: 0% - 100%","summary":"NestJS and ‘class validator’ cheat sheet - DEV Community (dev.to)\n","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"NestJS and ‘class validator’ cheat sheet - DEV Community","url":"https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao","text":"L0: \nL1: URL: https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao\nL2:   \nL3: \nL4:   Skip to content \nL5: \nL6: Navigation menu   \nL7: \nL8:  Search\nL9: \nL10:  Search  \nL11: \nL12:    Log in    Create account  \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30:  Share to Twitter   Share to LinkedIn   Share to Reddit   Share to Hacker News   Share to Facebook   Share to Mastodon  \nL31: \nL32:  Share Post via...  Report Abuse \nL33: \nL34: [Image 6: Krishna Damaraju]\nL35: \nL36: Krishna Damaraju \nL37: \nL38: Posted on Jun 13, 2022\nL39: \nL40: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL41: \nL42: #  NestJS and ‘class validator’ cheat sheet \nL43: \nL44: # nestjs # validation # node # typescript \nL45: \nL46: [Image 12: nestjs-and-class-validator-cheat-sheet]\nL47: \nL48: `NestJs` along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helped me in defining those cases and you can use these to scale to some extent.\nL49: \nL50: ##    1️⃣ Validating String \nL51: \nL52: ###    Any String \nL53: \nL54:     // example.dto.ts\nL55:     import {\nL56:       IsString,\nL57:       IsNotEmpty,\nL58:       MinLength,\nL59:       MaxLength\nL60:     } from 'class-validator'\nL61: \nL62:     export class AnyString {\nL63:         @IsString()\nL64:         @IsNotEmpty()\nL65:         @MinLength(3)\nL66:       @MaxLength(65)\nL67:         userName: string\nL68:     }\nL69: \nL70: Enter fullscreen mode Exit fullscreen mode\nL71: \nL72: ###    Specific String \nL73: \nL74:     // example.dto.ts\nL75:     import {\nL76:       ArrayNotEmpty,\nL77:       IsArray,\nL78:         IsIn\nL79:     } from 'class-validator'\nL80: \nL81:     const weekdays = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];\nL82: \nL83:     export class SpecificString {\nL84:       @IsArray()\nL85:       @ArrayNotEmpty()\nL86: \nL87:         @IsIn(weekdays)\nL88:       day: string[]\nL89:     }\nL90: \nL91: Enter fullscreen mode Exit fullscreen mode\nL92: \nL93: ###    Array of strings \nL94: \nL95:     // example.dto.ts\nL96:     import {\nL97:       ArrayNotEmpty,\nL98:       Contains,\nL99:       IsArray,\nL100:       IsString,\nL101:       Matches,\nL102:       MaxLength\nL103:     } from 'class-validator'\nL104: \nL105:     export class StringArray {\nL106:       @IsArray()\nL107:       @ArrayNotEmpty()\nL108: \nL109:       // check if every array item is string\nL110:       @IsString({ each: true }) \nL111:         // Pass `each: true` when you want this validation to run on every array item\nL112: \nL113:       // Check if every array item has max length\nL114:       @MaxLength(6, { each: true })\nL115: \nL116:       // Check if every array item is only alphabets\nL117:       @Matches('^[a-zA-Z\\\\s]+$', undefined, { each: true })\nL118: \nL119:       // CHeck if every array item contains a text\nL120:       @Contains('hello', { each: true })\nL121:       stringArray: string[]\nL122:     }\nL123: \nL124: Enter fullscreen mode Exit fullscreen mode\nL125: \nL126: ###    Array of Strings with a custom prefix \nL127: \nL128:     // example.dto.ts\nL129:     import {\nL130:       ArrayNotEmpty,\nL131:       IsArray,\nL132:       Validate,\nL133:       ValidateNested,\nL134:       ValidatorConstraint,\nL135:       ValidatorConstraintInterface\nL136:     } from 'class-validator'\nL137: \nL138:     @ValidatorConstraint({ name: 'arrayPrefixValidator' })\nL139:     export class ArrayPrefixValidator implements ValidatorConstraintInterface {\nL140:       validate(values: string[] = []): boolean {\nL141:         if (values.length) {\nL142:           return values.every((value) =\u003e value.startsWith('str-'))\nL143:         }\nL144:         return false\nL145:       }\nL146:     }\nL147: \nL148:     export class StringArray {\nL149:       @IsArray()\nL150:       @ArrayNotEmpty()\nL151: \nL152:       // Check if every array item contains a prefix str-\nL153:       @Validate(ArrayPrefixValidator, { message: 'No str- prefix' })\nL154:       stringArray: string[]\nL155:     }\nL156: \nL157: Enter fullscreen mode Exit fullscreen mode\nL158: \nL159: ##    2️⃣ Validating Number \nL160: \nL161: ###    Any number \nL162: \nL163:     // example.dto.ts\nL164: \nL165:     import {\nL166:       IsNumber,\nL167:       IsNotEmpty,\nL168:       MinLength,\nL169:       MaxLength\nL170:     } from 'class-validator'\nL171: \nL172:     export class AnyString {\nL173:         @IsNumber()\nL174:         @IsNotEmpty()\nL175:         @MinLength(3)\nL176:       @MaxLength(65)\nL177:         userName: string\nL178:     }\nL179: \nL180: Enter fullscreen mode Exit fullscreen mode\nL181: \nL182: ###    Specific Number \nL183: \nL184:     // example.dto.ts\nL185: \nL186:     import {\nL187:       IsNumber,\nL188:       IsNotEmpty,\nL189:       MinLength,\nL190:       MaxLength,\nL191:       ValidatorConstraint,\nL192:       ValidatorConstraintInterface\nL193:     } from 'class-validator'\nL194: \nL195:     @ValidatorConstraint({ name: 'isDividedBy17' })\nL196:     export class IsDividedBy17 implements ValidatorConstraintInterface {\nL197:       validate(value: number): boolean {\nL198:         if (value {\nL199:           return value % 17 === 0\nL200:         }\nL201:         return false\nL202:       }\nL203:     }\nL204: \nL205:     export class SpecificNumber {\nL206:       @IsNumber()\nL207:         @IsNotEmpty()\nL208: \nL209:       // Check if number is divisible by 17\nL210:       @Validate(IsDividedBy17, { message: 'No divided by 17' })\nL211:       specificNumber: number\nL212:     }\nL213: \nL214: Enter fullscreen mode Exit fullscreen mode\nL215: \nL216: ###    Array of numbers \nL217: \nL218:     // example.dto.ts\nL219: \nL220:     import {\nL221:       IsNumber,\nL222:       IsNotEmpty,\nL223:       MinLength,\nL224:       MaxLength,\nL225:       ValidatorConstraint,\nL226:       ValidatorConstraintInterface\nL227:     } from 'class-validator'\nL228: \nL229:     @ValidatorConstraint({ name: 'isEvenNumber' })\nL230:     export class IsEvenNumber implements ValidatorConstraintInterface {\nL231:       validate(numbers: number): boolean {\nL232:         if (numbers {\nL233:           return numbers.every(number =\u003e number % 2 === 0)\nL234:         }\nL235:         return false\nL236:       }\nL237:     }\nL238: \nL239:     export class SpecificNumber {\nL240:       @IsNumber()\nL241:         @IsNotEmpty()\nL242: \nL243:       // Check if everynumber is even\nL244:         @Validate(IsEvenNumber, { message: 'No divided by 17' })\nL245:       numbersList: number[]\nL246:     }\nL247: \nL248: Enter fullscreen mode Exit fullscreen mode\nL249: \nL250: ###    3️⃣ Custom Object \nL251: \nL252: For example you have a payload like below  \nL253: \nL254:     {\nL255:         movies: [{\nL256:             name: \"The jurassic park\",\nL257:             yearOfRelease: 1999,\nL258:             languages: [\"en\"]\nL259:             gener: [\"sci-fi\", \"thriller\"]\nL260:         },\nL261:         {\nL262:             name: \"The Croods\",\nL263:             yearOfRelease: 2012,\nL264:             languages: [\"en\", \"fr\", \"es\"]\nL265:             gener: [\"animation\", \"kids\"]\nL266:         }]\nL267:     }\nL268: \nL269: Enter fullscreen mode Exit fullscreen mode\nL270: \nL271: To validate such object  \nL272: \nL273:     // example.dto.ts\nL274: \nL275:     import {\nL276:       IsNumber,\nL277:       IsNotEmpty,\nL278:       MinLength,\nL279:       MaxLength,\nL280:       ValidatorConstraint,\nL281:       ValidatorConstraintInterface\nL282:     } from 'class-validator'\nL283: \nL284:     @ValidatorConstraint({ name: 'isEvenNumber' })\nL285:     export class IsEvenNumber implements ValidatorConstraintInterface {\nL286:       validate(numbers: number): boolean {\nL287:         if (numbers {\nL288:           return numbers.every(number =\u003e number % 2 === 0)\nL289:         }\nL290:         return false\nL291:       }\nL292:     }\nL293: \nL294:     const validLanguages = [\"en\", \"es\", \"fr\"] \nL295:     const validGeneres = [\"sci-fi\", \"thriller\", \"animation\", \"horror\", \"vintage\"]\nL296: \nL297:     //  Types here\nL298:     export class Movie {\nL299:       @IsString()\nL300:         @IsNotEmpty()\nL301:         @ISRequired()\nL302:       name: string\nL303: \nL304:       @IsNotEmpty()\nL305:       @IsNumber()\nL306:         @ISRequired()\nL307:       yearOfRelease: number\nL308: \nL309:       @IsNotEmpty()\nL310:       @IsString()\nL311:         @IsIn(validLanguages)\nL312:         @ISRequired()\nL313:       languages: string[]\nL314: \nL315:       @IsNotEmpty()\nL316:       @IsString()\nL317:         @IsIn(validGeneres)\nL318:         @ISRequired()\nL319:       genre: string[]\nL320:     }\nL321: \nL322:     export class MoviesList {\nL323:       @IsArray()\nL324:         @ArrayNotEmpty()\nL325:         @Type(() =\u003e Movie)\nL326:       movies: Movie[]\nL327:     }\nL328: \nL329: Enter fullscreen mode Exit fullscreen mode\nL330: \nL331: \u003e Thanks for reading till here. I'd like to hear your thoughts.\nL332: \nL333: Originally posted: https://www.krishnadamaraju.me/nestjs-and-class-validator-cheat-sheet\nL334: \nL335: ##  Top comments (1)\nL336: \nL337: Subscribe\nL338: \nL339:     [Image 13: pic] \nL340: \nL341: Personal Trusted User\nL342: \nL343:  Create template  \nL344: \nL345: Templates let you quickly answer FAQs or store snippets for re-use.\nL346: \nL347: Submit Preview Dismiss \nL348: \nL349:   Collapse Expand\nL350: \nL351:   \nL352: \nL353:  Mohammed Shaheem P  \nL354: \nL355:  Mohammed Shaheem P \nL356: \nL357:  Mohammed Shaheem P  \nL358: \nL359: Follow\nL360: \nL361: It's not a bug \nL362: \nL363:   * Location \nL364: \nL365: Kerala, India \nL366: \nL367:   * Education \nL368: \nL369: Bachelors of Technology in Computer Science and Engineering \nL370: \nL371:   * Work \nL372: \nL373: Full Stack Web Developer \nL374: \nL375:   * Joined \nL376: \nL377: May 26, 2021\nL378: \nL379: •  Feb 8 • Edited on Feb 8 • Edited  \nL380: \nL381:  Dropdown menu\nL382: \nL383:   * Copy link\nL384:   *   * Hide \nL385:   *   *   * \nL386: \nL387: Under specific string section,  \nL388: shouldn't the type of day be `string` instead of `string[]` ?\nL389: \nL390:  Like comment:  Like comment:  Like  Comment button Reply \nL391: \nL392: Code of Conduct • Report abuse \nL393: \nL394: Are you sure you want to hide this comment? It will become hidden in your post, but will still be visible via the comment's permalink. \nL395: \nL396: Hide child comments as well\nL397: \nL398: Confirm \nL399: \nL400: For further actions, you may consider blocking this person and/or reporting abuse\nL401: \nL402: ## Read next\nL403: \nL404:  JavaScript Magic Tricks: Web Application Firewall WangLiwen - Nov 27   Begineer: TypeScript Utility Types Max Wiggedal - Nov 26   Yet Another Newsletter LOL: Getting Griddy Nick Taylor - Nov 26   Socket.io: Real-time Web Communication Made Easy Introduction Bek Brace - Nov 24  \nL405: \nL406:  Krishna Damaraju  \nL407: \nL408: Follow\nL409: \nL410: A JS dev -- with no adjectives attached. \nL411: \nL412:   * Work \nL413: \nL414: Sr. Frontend Engineer \nL415: \nL416:   * Joined \nL417: \nL418: Jul 11, 2017\nL419: \nL420: ###  More from Krishna Damaraju \nL421: \nL422:  Usage of `React.FC` from my experience # react # typescript # javascript # frontend   5 steps to SetUp SASS with Grunt and NodeJS for Beginners # beginners # tutorial # node # grunt  \nL423: \nL424: Once suspended, sarathsantoshdamaraju will not be able to comment or publish posts until their suspension is removed. \nL425: \nL426: Note:  \nL427: \nL428:  Submit \u0026 Suspend \nL429: \nL430: Once unsuspended, sarathsantoshdamaraju will be able to comment and publish posts again. \nL431: \nL432: Note:  \nL433: \nL434:  Submit \u0026 Unsuspend \nL435: \nL436: Once unpublished, all posts by sarathsantoshdamaraju will become hidden and only accessible to themselves. \nL437: \nL438: If sarathsantoshdamaraju is not suspended, they can still re-publish their posts from their dashboard. \nL439: \nL440: Note: \nL441: \nL442:  Unpublish all posts \nL443: \nL444: Once unpublished, this post will become invisible to the public and only accessible to Krishna Damaraju. \nL445: \nL446: They can still re-publish the post if they are not suspended.\nL447: \nL448:  Unpublish Post \nL449: \nL450: Thanks for keeping DEV Community safe. Here is what you can do to flag sarathsantoshdamaraju: \nL451: \nL452:  Make all posts by sarathsantoshdamaraju less visible \nL453: \nL454: sarathsantoshdamaraju consistently posts content that violates DEV Community's code of conduct because it is harassing, offensive or spammy. \nL455: \nL456:  Report other inappropriate conduct  \nL457: \nL458:  Confirm Flag \nL459: \nL460: Unflagging sarathsantoshdamaraju will restore default visibility to their posts. \nL461: \nL462:  Confirm Unflag \nL463: \nL464: DEV Community — A constructive and inclusive social network for software developers. With you every step of your journey. \nL465: \nL466: *  Home  \nL467: *  Podcasts  \nL468: *  Videos  \nL469: *  Tags  \nL470: *  FAQ  \nL471: *  Forem Shop  \nL472: *  Advertise on DEV  \nL473: *  About  \nL474: *  Contact  \nL475: *  Guides  \nL476: *  Software comparisons  \nL477: \nL478: *  Code of Conduct  \nL479: *  Privacy Policy  \nL480: *  Terms of use  \nL481: \nL482: Built on Forem — the open source software that powers DEV and other inclusive communities.\nL483: \nL484: Made with love and Ruby on Rails. DEV Community © 2016 - 2023.\nL485: \nL486: [Image 14: DEV Community] \nL487: \nL488: We're a place where coders share, stay up-to-date and grow their careers. \nL489: \nL490:  Log in   Create account  \nL491: \nL492:  [Image 15] [Image 16] [Image 17] [Image 18] [Image 19]\nVisible: 0% - 100%"}]},"command":"click","args":[5],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"e6d541f6-1869-4489-bb3b-acec2db807f9","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"e6d541f6-1869-4489-bb3b-acec2db807f9","children":["74013678-9825-4779-bcd4-ac54ca2ade5b"]},{"id":"74013678-9825-4779-bcd4-ac54ca2ade5b","message":{"id":"74013678-9825-4779-bcd4-ac54ca2ade5b","author":{"role":"assistant","metadata":{}},"create_time":1703480183.110946,"content":{"content_type":"code","language":"unknown","text":"back()"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"d146efe0-f7b8-49c2-b8bf-4e56b5500760","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"d146efe0-f7b8-49c2-b8bf-4e56b5500760","children":["54e54fe9-e264-4233-bbf0-0f251cdd6e23"]},{"id":"54e54fe9-e264-4233-bbf0-0f251cdd6e23","message":{"id":"54e54fe9-e264-4233-bbf0-0f251cdd6e23","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.118091,"content":{"content_type":"tether_browsing_display","result":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Validation | NestJS - A progressive Node.js framework","url":"https://docs.nestjs.com/techniques/validation","text":"\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: "},{"type":"webpage","title":"Custom validation with database in NestJS - DEV Community","url":"https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao","text":"\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: "},{"type":"webpage","title":"Validation - GitHub: Let’s build from here","url":"https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md","text":"\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: "},{"type":"webpage","title":"Injecting request object to a custom validation class in NestJS","url":"https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal","text":"\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: "},{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: "},{"type":"webpage","title":"NestJS and ‘class validator’ cheat sheet - DEV Community","url":"https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao","text":"\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: "},{"type":"webpage","title":"How to implement input validation with NestJS - Sébastien Dubois","url":"https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/","text":"\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: "},{"type":"webpage","title":"How to use class-validator and generate custom error object in nest.js","url":"https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h","text":"\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: "},{"type":"webpage","title":"Building a REST API with NestJS and Prisma: Input Validation ...","url":"https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1","text":"\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: "},{"type":"webpage","title":"NestJS Custom Payload Validation - DEV Community","url":"https://dev.to/shubham_kadam/nestjs-custom-payload-validation-3hh7","text":"\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: "},{"type":"webpage","title":"Mastering Email Validation in NestJS: A Comprehensive Guide","url":"https://emaillistvalidation.com/blog/mastering-email-validation-in-nestjs-a-comprehensive-guide/","text":"\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: "},{"type":"webpage","title":"Custom Card v2 Signature Validation in NestJS - community.hubspot.com","url":"https://community.hubspot.com/t5/APIs-Integrations/Custom-Card-v2-Signature-Validation-in-NestJS/m-p/897350","text":"\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"},{"type":"webpage","title":"Search results for query: 'nestjs class-validator custom validation method documentation'","url":"","text":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"}]},"command":"back","args":[],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"74013678-9825-4779-bcd4-ac54ca2ade5b","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"74013678-9825-4779-bcd4-ac54ca2ade5b","children":["260acd90-06dc-47c4-9247-a40c8e86c71e"]},{"id":"260acd90-06dc-47c4-9247-a40c8e86c71e","message":{"id":"260acd90-06dc-47c4-9247-a40c8e86c71e","author":{"role":"assistant","metadata":{}},"create_time":1703480183.123878,"content":{"content_type":"code","language":"unknown","text":"click(1)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"54e54fe9-e264-4233-bbf0-0f251cdd6e23","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"54e54fe9-e264-4233-bbf0-0f251cdd6e23","children":["cea888d7-5e29-46d2-887d-9e2ae9119887"]},{"id":"cea888d7-5e29-46d2-887d-9e2ae9119887","message":{"id":"cea888d7-5e29-46d2-887d-9e2ae9119887","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.131259,"content":{"content_type":"tether_browsing_display","result":"L0: \nL1: URL: https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao\nL2:   \nL3: \nL4:   【0†Skip to content】 \nL5: \nL6: Navigation menu 【1† 】 \nL7: \nL8:  Search\nL9: \nL10: 【2† Search 】 \nL11: \nL12:   【3† Log in 】  【4† Create account 】 \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30: 【5† Share to Twitter †twitter.com】 【6† Share to LinkedIn †www.linkedin.com】 【7† Share to Reddit †www.reddit.com】 【8† Share to Hacker News †news.ycombinator.com】 【9† Share to Facebook †www.facebook.com】 【10† Share to Mastodon †toot.kytta.dev】 \nL31: \nL32:  Share Post via...  【11†Report Abuse】 \nL33: \nL34:   【12† †res.cloudinary.com】 \nL35: \nL36: [Image 6: Krzysztof Szala]\nL37: \nL38: 【13†Krzysztof Szala】 \nL39: \nL40: Posted on Mar 27, 2021 • Updated on Apr 7, 2021\nL41: \nL42: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL43: \nL44: #  Custom validation with database in NestJS \nL45: \nL46: 【14†# nestjs】 【15†# typescript】 【16†# node】 【17†# javascript】 \nL47: \nL48: ##  【18†Validation tricks in NestJS (4 Part Series)】 \nL49: \nL50: 【19† 1 Custom validation with database in NestJS 】 【20† 2 Validating nested objects with class-validator in NestJS 】 【21† 3 Validating numeric query parameters in NestJS 】 【22† 4 Injecting request object to a custom validation class in NestJS 】 \nL51: \nL52: NestJS is an outstanding web framework which supports natively TypeScript out of the box. Its maintainers and community provides great and large documentation, which leads us by hand through the most important parts of the framework.\nL53: \nL54: But when you start to write an application for serious, you figure out quickly, it doesn't coverage some very typical cases (at least for me).\nL55: \nL56: Framework provides several ways for validation data coming with requests. We can basically use Pipes, a feature called schema-based validation (using 【23†joi library†joi.dev】) or integration with class-validator library through `ValidatorPipe`. And the last one is my favorite one. Why? The main reason is that you can keep your whole validation definitions outside the controller. It's a great way to separate different concerns.\nL57: \nL58: 【24†Class-Validator library†github.com】 is a powerful tool, which brings whole set of differential validation decorators like `@Length(10, 20)`, `@IsInt()`, `@Contains('example')` etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL59: \nL60: But what if you would like to create your own validator, and use it with class-validator library? Easy, just quick look at 【25†the documentation†github.com】 and you can write your own rules and can use it with `@Validate()` decorator. Better! It's fabulously simple to write own decorators and have your whole request validation class consists.\nL61: \nL62: Problems start when we are forced to check something for example in persistent storage, like database. In short – we must inject some dependency responsible for interacting with the database. Dependency like e.g. `UserRepository` which is obviously responsible for users entities.\nL63: \nL64: Luckly for us, `class-validator` provides very handy `useContainer` function, which allow to set the container to be used by `class-validor` library.\nL65: \nL66: So add this code in your main.ts file (`app` variable is your Nest application instance):  \nL67: \nL68:     useContainer(app.select(AppModule), { fallbackOnErrors: true });\nL69: \nL70: Enter fullscreen mode Exit fullscreen mode\nL71: \nL72: It allows `class-validator` to use NestJS dependency injection container.\nL73: \nL74: Then we can create a repository, which will query our database:  \nL75: \nL76:     @Injectable()\nL77:     class UserRepository {\nL78:       async getOneOrFail(userId: number): Promise\u003cUserEntity\u003e {\nL79:         // some code which fetch user entity or throw exception\nL80:       }\nL81:     }\nL82: \nL83: Enter fullscreen mode Exit fullscreen mode\nL84: \nL85: Ok, let's write a `Validator Constraint` which will hold our own validation logic. As you can see, our dependency is simply injected into the class constructor:  \nL86: \nL87:     @ValidatorConstraint({ name: 'UserExists', async: true })\nL88:     @Injectable()\nL89:     export class UserExistsRule implements ValidatorConstraintInterface {\nL90:       constructor(private usersRepository: UsersRepository) {}\nL91: \nL92:       async validate(value: number) {\nL93:         try {\nL94:           await this.usersRepository.getOneOrFail(value);\nL95:         } catch (e) {\nL96:           return false;\nL97:         }\nL98: \nL99:         return true;\nL100:       }\nL101: \nL102:       defaultMessage(args: ValidationArguments) {\nL103:         return `User doesn't exist`;\nL104:       }\nL105:     }\nL106: \nL107: Enter fullscreen mode Exit fullscreen mode\nL108: \nL109: Don't forget to 【26†declare you injectable classes as providers†docs.nestjs.com】 in the appropriate module.\nL110: \nL111: Now you can use your custom validation constraint. Simply decorate class property with `@Validate(UserExistsRule)` decorator:  \nL112: \nL113:     export class User {\nL114:       @IsInt()\nL115:       @Validate(UserExistsRule);\nL116:       readonly id: number;\nL117:     }\nL118: \nL119: Enter fullscreen mode Exit fullscreen mode\nL120: \nL121: If the user doesn't exist in the database, you should get error with default message \"User doesn't exist\". Although using `@Validate()` is fine enough, you can write your own decorator, which will be much more convenient. Having written Validator Constraint is quick and easy. We need to just write decorator factory with `registerDecorator()` function.  \nL122: \nL123:     export function UserExists(validationOptions?: ValidationOptions) {\nL124:       return function (object: any, propertyName: string) {\nL125:         registerDecorator({\nL126:           name: 'UserExists',\nL127:           target: object.constructor,\nL128:           propertyName: propertyName,\nL129:           options: validationOptions,\nL130:           validator: UserExistsRule,\nL131:         });\nL132:       };\nL133:     }\nL134: \nL135: Enter fullscreen mode Exit fullscreen mode\nL136: \nL137: As you can see, you can either write new validator logic, or use written before validator constraint (in our case – `UserExistsRule` class).\nL138: \nL139: Now we can go back to our `User` class, and use `@UserExists` validator instead of `@Validate(UserExistsRule)` decorator.  \nL140: \nL141:     export class User {\nL142:       @IsInt()\nL143:       @UserExists();\nL144:       readonly id: number;\nL145:     }\nL146: \nL147: Enter fullscreen mode Exit fullscreen mode\nL148: \nL149: Hope this little article will help you with many common scenarios during your application development with NestJS framework. I use that technique almost every day!\nL150: \nL151: ##  【18†Validation tricks in NestJS (4 Part Series)】 \nL152: \nL153: 【19† 1 Custom validation with database in NestJS 】 【20† 2 Validating nested objects with class-validator in NestJS 】 【21† 3 Validating numeric query parameters in NestJS 】 【22† 4 Injecting request object to a custom validation class in NestJS 】 \nL154: \nL155: ##  Top comments (20)\nL156: \nL157: Subscribe\nL158: \nL159:     [Image 12: pic] \nL160: \nL161: Personal Trusted User\nL162: \nL163: 【27† Create template 】 \nL164: \nL165: Templates let you quickly answer FAQs or store snippets for re-use.\nL166: \nL167: Submit Preview 【28†Dismiss】 \nL168: \nL169:   Collapse Expand\nL170: \nL171: 【29† 】 \nL172: \nL173: 【29† Scott Molinari 】 \nL174: \nL175:  Scott Molinari \nL176: \nL177: 【29† Scott Molinari 】 \nL178: \nL179: Follow\nL180: \nL181: Just a hobbyist programmer with an eye on new technologies. Currently helping Quasar and NestJS Frameworks, because....well.....because they're awesome! :-) \nL182: \nL183:   * Joined \nL184: \nL185: Dec 11, 2018\nL186: \nL187: • 【30† Mar 28 '21 】 \nL188: \nL189:  Dropdown menu\nL190: \nL191:   * 【30†Copy link】\nL192:   *   * Hide \nL193:   *   *   * \nL194: \nL195: Hey. Nice article. Two things.\nL196: \nL197: \u003e If the user exists in the database, you should get error with default message \"User doesn't exist\".\nL198: \nL199: Did you possibly mean to write the error as \"User already exists\"?\nL200: \nL201: Also, I feel validation is very often based on business rules. And as such, it would be a lot of running to the programmer to ask him or her to update decorators. How would one take rules from a database (created by business) and use them dynamically within the code? I think that solution would be a whole lot smarter. The same goes for authorization rules, don't you think? \nL202: \nL203: Scott\nL204: \nL205:  Like comment:  Like comment:  3 likes Like  Comment button Reply \nL206: \nL207: Collapse Expand\nL208: \nL209: 【13† 】 \nL210: \nL211: 【13† Krzysztof Szala 】 \nL212: \nL213:  Krzysztof Szala \nL214: \nL215: 【13† Krzysztof Szala 】 \nL216: \nL217: Follow\nL218: \nL219: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL220: \nL221:   * Location \nL222: \nL223: Silesia \nL224: \nL225:   * Joined \nL226: \nL227: May 30, 2020\nL228: \nL229: • 【31† Mar 28 '21 • Edited on Mar 28 • Edited 】 \nL230: \nL231:  Dropdown menu\nL232: \nL233:   * 【31†Copy link】\nL234:   *   * Hide \nL235:   *   *   * \nL236: \nL237: Hi Scott, thank you for your comment!\nL238: \nL239: \u003e Did you possibly mean to write the error as \"User already exists\"?\nL240: \nL241: No, it tests if user exists in database, if it doesn't validator should return error, that \"user doesn't exist\". It can be useful, when you check for example user id for crud operations, and don't want to run any logic, if input data isn't valid.\nL242: \nL243: \u003e Also, I feel validation is very often based on business rules. And as such, it would be a lot of running to the programmer to ask him or her to update decorators. How would one take rules from a database (created by business) and use them dynamically within the code? I think that solution would be a whole lot smarter. The same goes for authorization rules, don't you think?\nL244: \nL245: To be honest, I'm not the biggest fan of storing business logic in the database. There are several reasons for that. I have some experience with it, and it never ends well. Business logic stored outside code base is much harder to test, and it isn't possible to test it with unit-test (as unit tests should be database independent). For me business logic changes only when code is changed. This is why we write unit tests, right? They test business logic. If there is no business logic in our services (like simple CRUD operations), unit tests look like testing mocked data.\nL246: \nL247: Ok, you can store some data in DB, like for example – a user role, and list of access routes. But the business logic is still in the code base. Roles, and theirs access routes, are only input data, for authorization rules.\nL248: \nL249: Not sure if that what I'm saying is clear and makes sense :D\nL250: \nL251: Regards\nL252: \nL253:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL254: \nL255: Collapse Expand\nL256: \nL257: 【29† 】 \nL258: \nL259: 【29† Scott Molinari 】 \nL260: \nL261:  Scott Molinari \nL262: \nL263: 【29† Scott Molinari 】 \nL264: \nL265: Follow\nL266: \nL267: Just a hobbyist programmer with an eye on new technologies. Currently helping Quasar and NestJS Frameworks, because....well.....because they're awesome! :-) \nL268: \nL269:   * Joined \nL270: \nL271: Dec 11, 2018\nL272: \nL273: • 【32† Mar 30 '21 • Edited on Mar 31 • Edited 】 \nL274: \nL275:  Dropdown menu\nL276: \nL277:   * 【32†Copy link】\nL278:   *   * Hide \nL279:   *   *   * \nL280: \nL281: Ok. Looked again at the code. My bad on the message. I was thinking in terms of creation of the user (and the user being unique), whereas the code is talking about the retrieval of the user. :) What I was thinking as a validation would be on a create or update DTO. \nL282: \nL283: I see what you are saying with testing, however, that's also the point I'm trying to make to some degree I believe. Unit tests should test that the validation system works, but the conditions of the validation are meta to the \"unit\". The conditions are and must be variable as business changes all the time and thus, those rules themselve don't need testing. The system/ unit should take a set of rules and run validation on that set of rules. What's in the rules doesn't matter, the proper validation does. \nL284: \nL285: The \"testing\" of the rules would lie solely with the business, since they are setting them. And because the rules are metadata to the system, it has to be purely manual on their part. Or, it could be within integration testing, but that would also be insanely complex, depending on the validations needed. :D \nL286: \nL287: The goal I'm shooting for is to have a system of validation (and authorization) that is mainly independent of the programmer. It would be designed for a larger system with complex business operations. I've seen it done from a user's perspective. I'm just not quite sure how to make it happen with Nest. But, your article gave me more insight into the topic. Thanks!\nL288: \nL289:  Like comment:  Like comment:  1 like Like  Thread Thread \nL290: \nL291: 【13† 】 \nL292: \nL293: 【13† Krzysztof Szala 】 \nL294: \nL295:  Krzysztof Szala \nL296: \nL297: 【13† Krzysztof Szala 】 \nL298: \nL299: Follow\nL300: \nL301: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL302: \nL303:   * Location \nL304: \nL305: Silesia \nL306: \nL307:   * Joined \nL308: \nL309: May 30, 2020\nL310: \nL311: • 【33† Apr 2 '21 • Edited on Apr 2 • Edited 】 \nL312: \nL313:  Dropdown menu\nL314: \nL315:   * 【33†Copy link】\nL316:   *   * Hide \nL317:   *   *   * \nL318: \nL319: It's interesting point of view Scott, but I'll stand by my opinion, that validation rules belong to the code base, not to the storage ;) Anyway, thanks for great comments, appriciate that! Have a nice weekend!\nL320: \nL321:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL322: \nL323: Collapse Expand\nL324: \nL325: 【34† 】 \nL326: \nL327: 【34† Svarup Desai 】 \nL328: \nL329:  Svarup Desai \nL330: \nL331: 【34† Svarup Desai 】 \nL332: \nL333: Follow\nL334: \nL335:   * Joined \nL336: \nL337: Sep 12, 2020\nL338: \nL339: • 【35† Oct 7 '22 】 \nL340: \nL341:  Dropdown menu\nL342: \nL343:   * 【35†Copy link】\nL344:   *   * Hide \nL345:   *   *   * \nL346: \nL347: one thing that not mentioned is that, we have to add in `app.module.ts`  \nL348: \nL349:     @Module({\nL350:       imports: ...,\nL351:       controllers: [AppController],\nL352:       providers: [\nL353:         AppService,\nL354:         ...,\nL355:         // Line below added\nL356:         UserExistsRule,\nL357:       ],\nL358:     })\nL359:     export class AppModule {}\nL360: \nL361: Enter fullscreen mode Exit fullscreen mode\nL362: \nL363:  Like comment:  Like comment:  3 likes Like  Comment button Reply \nL364: \nL365: Collapse Expand\nL366: \nL367: 【36† 】 \nL368: \nL369: 【36† Mattias Fjellvang 】 \nL370: \nL371:  Mattias Fjellvang \nL372: \nL373: 【36† Mattias Fjellvang 】 \nL374: \nL375: Follow\nL376: \nL377:   * Joined \nL378: \nL379: Feb 15, 2020\nL380: \nL381: • 【37† Jan 5 '22 】 \nL382: \nL383:  Dropdown menu\nL384: \nL385:   * 【37†Copy link】\nL386:   *   * Hide \nL387:   *   *   * \nL388: \nL389: This is a great article and just what I was looking for. However, is there a way to provide the container (using useContainer(app.select(AppModule), { fallbackOnErrors: true });) in the app.module.ts instead of in the main.ts file? Because I'd like this to be testable, and if I define it inside app.module.ts, my e2e tests would not function with my custom decorators.\nL390: \nL391:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL392: \nL393: Collapse Expand\nL394: \nL395: 【38† 】 \nL396: \nL397: 【38† davidN96 】 \nL398: \nL399:  davidN96 \nL400: \nL401: 【38† davidN96 】 \nL402: \nL403: Follow\nL404: \nL405:   * Joined \nL406: \nL407: Apr 25, 2021\nL408: \nL409: • 【39† Apr 25 '21 】 \nL410: \nL411:  Dropdown menu\nL412: \nL413:   * 【39†Copy link】\nL414:   *   * Hide \nL415:   *   *   * \nL416: \nL417: Hey! Great article! Could you share a link to repo with code from this article? I'm newbie in Nest, I have a problem with database dependency injection. I'll be very thankful\nL418: \nL419:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL420: \nL421: Collapse Expand\nL422: \nL423: 【13† 】 \nL424: \nL425: 【13† Krzysztof Szala 】 \nL426: \nL427:  Krzysztof Szala \nL428: \nL429: 【13† Krzysztof Szala 】 \nL430: \nL431: Follow\nL432: \nL433: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL434: \nL435:   * Location \nL436: \nL437: Silesia \nL438: \nL439:   * Joined \nL440: \nL441: May 30, 2020\nL442: \nL443: • 【40† Apr 27 '21 】 \nL444: \nL445:  Dropdown menu\nL446: \nL447:   * 【40†Copy link】\nL448:   *   * Hide \nL449:   *   *   * \nL450: \nL451: Thank you. I'll try to upload some repos, when I find some time. What kind of problems do you have with database DI? Maybe I can help here. Regards.\nL452: \nL453:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL454: \nL455: Collapse Expand\nL456: \nL457: 【38† 】 \nL458: \nL459: 【38† davidN96 】 \nL460: \nL461:  davidN96 \nL462: \nL463: 【38† davidN96 】 \nL464: \nL465: Follow\nL466: \nL467:   * Joined \nL468: \nL469: Apr 25, 2021\nL470: \nL471: • 【41† Apr 27 '21 】 \nL472: \nL473:  Dropdown menu\nL474: \nL475:   * 【41†Copy link】\nL476:   *   * Hide \nL477:   *   *   * \nL478: \nL479: Hey! Thank you for your response! Well, I've found the problem. I've accidentally imported useContainer from typeorm instead of class-validator (VSC hints). Now everything works great. Thank you for a great article!\nL480: \nL481:  Like comment:  Like comment:  2 likes Like  Thread Thread \nL482: \nL483: 【13† 】 \nL484: \nL485: 【13† Krzysztof Szala 】 \nL486: \nL487:  Krzysztof Szala \nL488: \nL489: 【13† Krzysztof Szala 】 \nL490: \nL491: Follow\nL492: \nL493: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL494: \nL495:   * Location \nL496: \nL497: Silesia \nL498: \nL499:   * Joined \nL500: \nL501: May 30, 2020\nL502: \nL503: • 【42† Apr 27 '21 】 \nL504: \nL505:  Dropdown menu\nL506: \nL507:   * 【42†Copy link】\nL508:   *   * Hide \nL509:   *   *   * \nL510: \nL511: That's great, happy to help! :)\nL512: \nL513:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL514: \nL515: Collapse Expand\nL516: \nL517: 【43† 】 \nL518: \nL519: 【43† José Neto 】 \nL520: \nL521:  José Neto \nL522: \nL523: 【43† José Neto 】 \nL524: \nL525: Follow\nL526: \nL527: A funny web developer \nL528: \nL529:   * Location \nL530: \nL531: Lisbon \nL532: \nL533:   * Work \nL534: \nL535: Frontend Engineer at TripAdvisor \nL536: \nL537:   * Joined \nL538: \nL539: Mar 17, 2019\nL540: \nL541: • 【44† Aug 22 '21 】 \nL542: \nL543:  Dropdown menu\nL544: \nL545:   * 【44†Copy link】\nL546:   *   * Hide \nL547:   *   *   * \nL548: \nL549: Awesome, thanks!\nL550: \nL551:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL552: \nL553: Collapse Expand\nL554: \nL555: 【13† 】 \nL556: \nL557: 【13† Krzysztof Szala 】 \nL558: \nL559:  Krzysztof Szala \nL560: \nL561: 【13† Krzysztof Szala 】 \nL562: \nL563: Follow\nL564: \nL565: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL566: \nL567:   * Location \nL568: \nL569: Silesia \nL570: \nL571:   * Joined \nL572: \nL573: May 30, 2020\nL574: \nL575: • 【45† Aug 23 '21 】 \nL576: \nL577:  Dropdown menu\nL578: \nL579:   * 【45†Copy link】\nL580:   *   * Hide \nL581:   *   *   * \nL582: \nL583: You’re welcome!\nL584: \nL585:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL586: \nL587: Collapse Expand\nL588: \nL589: 【46† 】 \nL590: \nL591: 【46† huynh nguyen toan 】 \nL592: \nL593:  huynh nguyen toan \nL594: \nL595: 【46† huynh nguyen toan 】 \nL596: \nL597: Follow\nL598: \nL599:   * Joined \nL600: \nL601: Oct 11, 2021\nL602: \nL603: • 【47† Jul 2 】 \nL604: \nL605:  Dropdown menu\nL606: \nL607:   * 【47†Copy link】\nL608:   *   * Hide \nL609:   *   *   * \nL610: \nL611: Thanks bro.\nL612: \nL613:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL614: \nL615: Collapse Expand\nL616: \nL617: 【48† 】 \nL618: \nL619: 【48† Tafadzwa Muteke 】 \nL620: \nL621:  Tafadzwa Muteke \nL622: \nL623: 【48† Tafadzwa Muteke 】 \nL624: \nL625: Follow\nL626: \nL627: Designer, developer. \nL628: \nL629:   * Location \nL630: \nL631: Harare, Zimbabwe \nL632: \nL633:   * Education \nL634: \nL635: Computer Science \nL636: \nL637:   * Work \nL638: \nL639: Mr at Irus Edge Digital Agency \nL640: \nL641:   * Joined \nL642: \nL643: Oct 2, 2019\nL644: \nL645: • 【49† Dec 17 '21 】 \nL646: \nL647:  Dropdown menu\nL648: \nL649:   * 【49†Copy link】\nL650:   *   * Hide \nL651:   *   *   * \nL652: \nL653: Thank you, Krzysztof!\nL654: \nL655:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL656: \nL657: Collapse Expand\nL658: \nL659: 【13† 】 \nL660: \nL661: 【13† Krzysztof Szala 】 \nL662: \nL663:  Krzysztof Szala \nL664: \nL665: 【13† Krzysztof Szala 】 \nL666: \nL667: Follow\nL668: \nL669: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL670: \nL671:   * Location \nL672: \nL673: Silesia \nL674: \nL675:   * Joined \nL676: \nL677: May 30, 2020\nL678: \nL679: • 【50† Dec 21 '21 】 \nL680: \nL681:  Dropdown menu\nL682: \nL683:   * 【50†Copy link】\nL684:   *   * Hide \nL685:   *   *   * \nL686: \nL687: Glad I could help!\nL688: \nL689:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL690: \nL691: Collapse Expand\nL692: \nL693: 【51† 】 \nL694: \nL695: 【51† Esron Silva 】 \nL696: \nL697:  Esron Silva \nL698: \nL699: 【51† Esron Silva 】 \nL700: \nL701: Follow\nL702: \nL703: FullStack Developer. Computer Engineer. \nL704: \nL705:   * Location \nL706: \nL707: Petrolina - PE, Brasil \nL708: \nL709:   * Education \nL710: \nL711: Bachelor in Computer Engineering. \nL712: \nL713:   * Work \nL714: \nL715: Computer Engineer and Full Stack Developer at Sysvale \nL716: \nL717:   * Joined \nL718: \nL719: Jun 6, 2019\nL720: \nL721: • 【52† Apr 12 '22 】 \nL722: \nL723:  Dropdown menu\nL724: \nL725:   * 【52†Copy link】\nL726:   *   * Hide \nL727:   *   *   * \nL728: \nL729: Awesome content right here. You saved me a ton of work and time.\nL730: \nL731:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL732: \nL733: Collapse Expand\nL734: \nL735: 【13† 】 \nL736: \nL737: 【13† Krzysztof Szala 】 \nL738: \nL739:  Krzysztof Szala \nL740: \nL741: 【13† Krzysztof Szala 】 \nL742: \nL743: Follow\nL744: \nL745: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL746: \nL747:   * Location \nL748: \nL749: Silesia \nL750: \nL751:   * Joined \nL752: \nL753: May 30, 2020\nL754: \nL755: • 【53† Apr 17 '22 】 \nL756: \nL757:  Dropdown menu\nL758: \nL759:   * 【53†Copy link】\nL760:   *   * Hide \nL761:   *   *   * \nL762: \nL763: I’m glad I could help! \nL764: \nL765:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL766: \nL767: Collapse Expand\nL768: \nL769: 【54† 】 \nL770: \nL771: 【54† Navin Mishra 】 \nL772: \nL773:  Navin Mishra \nL774: \nL775: 【54† Navin Mishra 】 \nL776: \nL777: Follow\nL778: \nL779: Programming enthusiast who wants to learn and grow everyday. \nL780: \nL781:   * Location \nL782: \nL783: kathmandu, nepal \nL784: \nL785:   * Education \nL786: \nL787: Tribhuwan University \nL788: \nL789:   * Work \nL790: \nL791: Developer, interest on business terms \nL792: \nL793:   * Joined \nL794: \nL795: Jun 14, 2022\nL796: \nL797: • 【55† Dec 8 】 \nL798: \nL799:  Dropdown menu\nL800: \nL801:   * 【55†Copy link】\nL802:   *   * Hide \nL803:   *   *   * \nL804: \nL805: great article. very helpful\nL806: \nL807:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL808: \nL809: Collapse Expand\nL810: \nL811: 【56† 】 \nL812: \nL813: 【56† Jedediah 】 \nL814: \nL815:  Jedediah \nL816: \nL817: 【56† Jedediah 】 \nL818: \nL819: Follow\nL820: \nL821:   * Joined \nL822: \nL823: Apr 28, 2022\nL824: \nL825: • 【57† Apr 28 '22 】 \nL826: \nL827:  Dropdown menu\nL828: \nL829:   * 【57†Copy link】\nL830:   *   * Hide \nL831:   *   *   * \nL832: \nL833: Signed up Dev.to just to say thank you! A great series for Nestjs! Great job!\nL834: \nL835:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL836: \nL837: Collapse Expand\nL838:\nVisible: 0% - 85%","summary":"Custom validation with database in NestJS - DEV Community (dev.to)\n","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Custom validation with database in NestJS - DEV Community","url":"https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao","text":"L0: \nL1: URL: https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao\nL2:   \nL3: \nL4:   Skip to content \nL5: \nL6: Navigation menu   \nL7: \nL8:  Search\nL9: \nL10:  Search  \nL11: \nL12:    Log in    Create account  \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30:  Share to Twitter   Share to LinkedIn   Share to Reddit   Share to Hacker News   Share to Facebook   Share to Mastodon  \nL31: \nL32:  Share Post via...  Report Abuse \nL33: \nL34:     \nL35: \nL36: [Image 6: Krzysztof Szala]\nL37: \nL38: Krzysztof Szala \nL39: \nL40: Posted on Mar 27, 2021 • Updated on Apr 7, 2021\nL41: \nL42: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL43: \nL44: #  Custom validation with database in NestJS \nL45: \nL46: # nestjs # typescript # node # javascript \nL47: \nL48: ##  Validation tricks in NestJS (4 Part Series) \nL49: \nL50:  1 Custom validation with database in NestJS   2 Validating nested objects with class-validator in NestJS   3 Validating numeric query parameters in NestJS   4 Injecting request object to a custom validation class in NestJS  \nL51: \nL52: NestJS is an outstanding web framework which supports natively TypeScript out of the box. Its maintainers and community provides great and large documentation, which leads us by hand through the most important parts of the framework.\nL53: \nL54: But when you start to write an application for serious, you figure out quickly, it doesn't coverage some very typical cases (at least for me).\nL55: \nL56: Framework provides several ways for validation data coming with requests. We can basically use Pipes, a feature called schema-based validation (using joi library) or integration with class-validator library through `ValidatorPipe`. And the last one is my favorite one. Why? The main reason is that you can keep your whole validation definitions outside the controller. It's a great way to separate different concerns.\nL57: \nL58: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like `@Length(10, 20)`, `@IsInt()`, `@Contains('example')` etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL59: \nL60: But what if you would like to create your own validator, and use it with class-validator library? Easy, just quick look at the documentation and you can write your own rules and can use it with `@Validate()` decorator. Better! It's fabulously simple to write own decorators and have your whole request validation class consists.\nL61: \nL62: Problems start when we are forced to check something for example in persistent storage, like database. In short – we must inject some dependency responsible for interacting with the database. Dependency like e.g. `UserRepository` which is obviously responsible for users entities.\nL63: \nL64: Luckly for us, `class-validator` provides very handy `useContainer` function, which allow to set the container to be used by `class-validor` library.\nL65: \nL66: So add this code in your main.ts file (`app` variable is your Nest application instance):  \nL67: \nL68:     useContainer(app.select(AppModule), { fallbackOnErrors: true });\nL69: \nL70: Enter fullscreen mode Exit fullscreen mode\nL71: \nL72: It allows `class-validator` to use NestJS dependency injection container.\nL73: \nL74: Then we can create a repository, which will query our database:  \nL75: \nL76:     @Injectable()\nL77:     class UserRepository {\nL78:       async getOneOrFail(userId: number): Promise\u003cUserEntity\u003e {\nL79:         // some code which fetch user entity or throw exception\nL80:       }\nL81:     }\nL82: \nL83: Enter fullscreen mode Exit fullscreen mode\nL84: \nL85: Ok, let's write a `Validator Constraint` which will hold our own validation logic. As you can see, our dependency is simply injected into the class constructor:  \nL86: \nL87:     @ValidatorConstraint({ name: 'UserExists', async: true })\nL88:     @Injectable()\nL89:     export class UserExistsRule implements ValidatorConstraintInterface {\nL90:       constructor(private usersRepository: UsersRepository) {}\nL91: \nL92:       async validate(value: number) {\nL93:         try {\nL94:           await this.usersRepository.getOneOrFail(value);\nL95:         } catch (e) {\nL96:           return false;\nL97:         }\nL98: \nL99:         return true;\nL100:       }\nL101: \nL102:       defaultMessage(args: ValidationArguments) {\nL103:         return `User doesn't exist`;\nL104:       }\nL105:     }\nL106: \nL107: Enter fullscreen mode Exit fullscreen mode\nL108: \nL109: Don't forget to declare you injectable classes as providers in the appropriate module.\nL110: \nL111: Now you can use your custom validation constraint. Simply decorate class property with `@Validate(UserExistsRule)` decorator:  \nL112: \nL113:     export class User {\nL114:       @IsInt()\nL115:       @Validate(UserExistsRule);\nL116:       readonly id: number;\nL117:     }\nL118: \nL119: Enter fullscreen mode Exit fullscreen mode\nL120: \nL121: If the user doesn't exist in the database, you should get error with default message \"User doesn't exist\". Although using `@Validate()` is fine enough, you can write your own decorator, which will be much more convenient. Having written Validator Constraint is quick and easy. We need to just write decorator factory with `registerDecorator()` function.  \nL122: \nL123:     export function UserExists(validationOptions?: ValidationOptions) {\nL124:       return function (object: any, propertyName: string) {\nL125:         registerDecorator({\nL126:           name: 'UserExists',\nL127:           target: object.constructor,\nL128:           propertyName: propertyName,\nL129:           options: validationOptions,\nL130:           validator: UserExistsRule,\nL131:         });\nL132:       };\nL133:     }\nL134: \nL135: Enter fullscreen mode Exit fullscreen mode\nL136: \nL137: As you can see, you can either write new validator logic, or use written before validator constraint (in our case – `UserExistsRule` class).\nL138: \nL139: Now we can go back to our `User` class, and use `@UserExists` validator instead of `@Validate(UserExistsRule)` decorator.  \nL140: \nL141:     export class User {\nL142:       @IsInt()\nL143:       @UserExists();\nL144:       readonly id: number;\nL145:     }\nL146: \nL147: Enter fullscreen mode Exit fullscreen mode\nL148: \nL149: Hope this little article will help you with many common scenarios during your application development with NestJS framework. I use that technique almost every day!\nL150: \nL151: ##  Validation tricks in NestJS (4 Part Series) \nL152: \nL153:  1 Custom validation with database in NestJS   2 Validating nested objects with class-validator in NestJS   3 Validating numeric query parameters in NestJS   4 Injecting request object to a custom validation class in NestJS  \nL154: \nL155: ##  Top comments (20)\nL156: \nL157: Subscribe\nL158: \nL159:     [Image 12: pic] \nL160: \nL161: Personal Trusted User\nL162: \nL163:  Create template  \nL164: \nL165: Templates let you quickly answer FAQs or store snippets for re-use.\nL166: \nL167: Submit Preview Dismiss \nL168: \nL169:   Collapse Expand\nL170: \nL171:   \nL172: \nL173:  Scott Molinari  \nL174: \nL175:  Scott Molinari \nL176: \nL177:  Scott Molinari  \nL178: \nL179: Follow\nL180: \nL181: Just a hobbyist programmer with an eye on new technologies. Currently helping Quasar and NestJS Frameworks, because....well.....because they're awesome! :-) \nL182: \nL183:   * Joined \nL184: \nL185: Dec 11, 2018\nL186: \nL187: •  Mar 28 '21  \nL188: \nL189:  Dropdown menu\nL190: \nL191:   * Copy link\nL192:   *   * Hide \nL193:   *   *   * \nL194: \nL195: Hey. Nice article. Two things.\nL196: \nL197: \u003e If the user exists in the database, you should get error with default message \"User doesn't exist\".\nL198: \nL199: Did you possibly mean to write the error as \"User already exists\"?\nL200: \nL201: Also, I feel validation is very often based on business rules. And as such, it would be a lot of running to the programmer to ask him or her to update decorators. How would one take rules from a database (created by business) and use them dynamically within the code? I think that solution would be a whole lot smarter. The same goes for authorization rules, don't you think? \nL202: \nL203: Scott\nL204: \nL205:  Like comment:  Like comment:  3 likes Like  Comment button Reply \nL206: \nL207: Collapse Expand\nL208: \nL209:   \nL210: \nL211:  Krzysztof Szala  \nL212: \nL213:  Krzysztof Szala \nL214: \nL215:  Krzysztof Szala  \nL216: \nL217: Follow\nL218: \nL219: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL220: \nL221:   * Location \nL222: \nL223: Silesia \nL224: \nL225:   * Joined \nL226: \nL227: May 30, 2020\nL228: \nL229: •  Mar 28 '21 • Edited on Mar 28 • Edited  \nL230: \nL231:  Dropdown menu\nL232: \nL233:   * Copy link\nL234:   *   * Hide \nL235:   *   *   * \nL236: \nL237: Hi Scott, thank you for your comment!\nL238: \nL239: \u003e Did you possibly mean to write the error as \"User already exists\"?\nL240: \nL241: No, it tests if user exists in database, if it doesn't validator should return error, that \"user doesn't exist\". It can be useful, when you check for example user id for crud operations, and don't want to run any logic, if input data isn't valid.\nL242: \nL243: \u003e Also, I feel validation is very often based on business rules. And as such, it would be a lot of running to the programmer to ask him or her to update decorators. How would one take rules from a database (created by business) and use them dynamically within the code? I think that solution would be a whole lot smarter. The same goes for authorization rules, don't you think?\nL244: \nL245: To be honest, I'm not the biggest fan of storing business logic in the database. There are several reasons for that. I have some experience with it, and it never ends well. Business logic stored outside code base is much harder to test, and it isn't possible to test it with unit-test (as unit tests should be database independent). For me business logic changes only when code is changed. This is why we write unit tests, right? They test business logic. If there is no business logic in our services (like simple CRUD operations), unit tests look like testing mocked data.\nL246: \nL247: Ok, you can store some data in DB, like for example – a user role, and list of access routes. But the business logic is still in the code base. Roles, and theirs access routes, are only input data, for authorization rules.\nL248: \nL249: Not sure if that what I'm saying is clear and makes sense :D\nL250: \nL251: Regards\nL252: \nL253:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL254: \nL255: Collapse Expand\nL256: \nL257:   \nL258: \nL259:  Scott Molinari  \nL260: \nL261:  Scott Molinari \nL262: \nL263:  Scott Molinari  \nL264: \nL265: Follow\nL266: \nL267: Just a hobbyist programmer with an eye on new technologies. Currently helping Quasar and NestJS Frameworks, because....well.....because they're awesome! :-) \nL268: \nL269:   * Joined \nL270: \nL271: Dec 11, 2018\nL272: \nL273: •  Mar 30 '21 • Edited on Mar 31 • Edited  \nL274: \nL275:  Dropdown menu\nL276: \nL277:   * Copy link\nL278:   *   * Hide \nL279:   *   *   * \nL280: \nL281: Ok. Looked again at the code. My bad on the message. I was thinking in terms of creation of the user (and the user being unique), whereas the code is talking about the retrieval of the user. :) What I was thinking as a validation would be on a create or update DTO. \nL282: \nL283: I see what you are saying with testing, however, that's also the point I'm trying to make to some degree I believe. Unit tests should test that the validation system works, but the conditions of the validation are meta to the \"unit\". The conditions are and must be variable as business changes all the time and thus, those rules themselve don't need testing. The system/ unit should take a set of rules and run validation on that set of rules. What's in the rules doesn't matter, the proper validation does. \nL284: \nL285: The \"testing\" of the rules would lie solely with the business, since they are setting them. And because the rules are metadata to the system, it has to be purely manual on their part. Or, it could be within integration testing, but that would also be insanely complex, depending on the validations needed. :D \nL286: \nL287: The goal I'm shooting for is to have a system of validation (and authorization) that is mainly independent of the programmer. It would be designed for a larger system with complex business operations. I've seen it done from a user's perspective. I'm just not quite sure how to make it happen with Nest. But, your article gave me more insight into the topic. Thanks!\nL288: \nL289:  Like comment:  Like comment:  1 like Like  Thread Thread \nL290: \nL291:   \nL292: \nL293:  Krzysztof Szala  \nL294: \nL295:  Krzysztof Szala \nL296: \nL297:  Krzysztof Szala  \nL298: \nL299: Follow\nL300: \nL301: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL302: \nL303:   * Location \nL304: \nL305: Silesia \nL306: \nL307:   * Joined \nL308: \nL309: May 30, 2020\nL310: \nL311: •  Apr 2 '21 • Edited on Apr 2 • Edited  \nL312: \nL313:  Dropdown menu\nL314: \nL315:   * Copy link\nL316:   *   * Hide \nL317:   *   *   * \nL318: \nL319: It's interesting point of view Scott, but I'll stand by my opinion, that validation rules belong to the code base, not to the storage ;) Anyway, thanks for great comments, appriciate that! Have a nice weekend!\nL320: \nL321:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL322: \nL323: Collapse Expand\nL324: \nL325:   \nL326: \nL327:  Svarup Desai  \nL328: \nL329:  Svarup Desai \nL330: \nL331:  Svarup Desai  \nL332: \nL333: Follow\nL334: \nL335:   * Joined \nL336: \nL337: Sep 12, 2020\nL338: \nL339: •  Oct 7 '22  \nL340: \nL341:  Dropdown menu\nL342: \nL343:   * Copy link\nL344:   *   * Hide \nL345:   *   *   * \nL346: \nL347: one thing that not mentioned is that, we have to add in `app.module.ts`  \nL348: \nL349:     @Module({\nL350:       imports: ...,\nL351:       controllers: [AppController],\nL352:       providers: [\nL353:         AppService,\nL354:         ...,\nL355:         // Line below added\nL356:         UserExistsRule,\nL357:       ],\nL358:     })\nL359:     export class AppModule {}\nL360: \nL361: Enter fullscreen mode Exit fullscreen mode\nL362: \nL363:  Like comment:  Like comment:  3 likes Like  Comment button Reply \nL364: \nL365: Collapse Expand\nL366: \nL367:   \nL368: \nL369:  Mattias Fjellvang  \nL370: \nL371:  Mattias Fjellvang \nL372: \nL373:  Mattias Fjellvang  \nL374: \nL375: Follow\nL376: \nL377:   * Joined \nL378: \nL379: Feb 15, 2020\nL380: \nL381: •  Jan 5 '22  \nL382: \nL383:  Dropdown menu\nL384: \nL385:   * Copy link\nL386:   *   * Hide \nL387:   *   *   * \nL388: \nL389: This is a great article and just what I was looking for. However, is there a way to provide the container (using useContainer(app.select(AppModule), { fallbackOnErrors: true });) in the app.module.ts instead of in the main.ts file? Because I'd like this to be testable, and if I define it inside app.module.ts, my e2e tests would not function with my custom decorators.\nL390: \nL391:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL392: \nL393: Collapse Expand\nL394: \nL395:   \nL396: \nL397:  davidN96  \nL398: \nL399:  davidN96 \nL400: \nL401:  davidN96  \nL402: \nL403: Follow\nL404: \nL405:   * Joined \nL406: \nL407: Apr 25, 2021\nL408: \nL409: •  Apr 25 '21  \nL410: \nL411:  Dropdown menu\nL412: \nL413:   * Copy link\nL414:   *   * Hide \nL415:   *   *   * \nL416: \nL417: Hey! Great article! Could you share a link to repo with code from this article? I'm newbie in Nest, I have a problem with database dependency injection. I'll be very thankful\nL418: \nL419:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL420: \nL421: Collapse Expand\nL422: \nL423:   \nL424: \nL425:  Krzysztof Szala  \nL426: \nL427:  Krzysztof Szala \nL428: \nL429:  Krzysztof Szala  \nL430: \nL431: Follow\nL432: \nL433: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL434: \nL435:   * Location \nL436: \nL437: Silesia \nL438: \nL439:   * Joined \nL440: \nL441: May 30, 2020\nL442: \nL443: •  Apr 27 '21  \nL444: \nL445:  Dropdown menu\nL446: \nL447:   * Copy link\nL448:   *   * Hide \nL449:   *   *   * \nL450: \nL451: Thank you. I'll try to upload some repos, when I find some time. What kind of problems do you have with database DI? Maybe I can help here. Regards.\nL452: \nL453:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL454: \nL455: Collapse Expand\nL456: \nL457:   \nL458: \nL459:  davidN96  \nL460: \nL461:  davidN96 \nL462: \nL463:  davidN96  \nL464: \nL465: Follow\nL466: \nL467:   * Joined \nL468: \nL469: Apr 25, 2021\nL470: \nL471: •  Apr 27 '21  \nL472: \nL473:  Dropdown menu\nL474: \nL475:   * Copy link\nL476:   *   * Hide \nL477:   *   *   * \nL478: \nL479: Hey! Thank you for your response! Well, I've found the problem. I've accidentally imported useContainer from typeorm instead of class-validator (VSC hints). Now everything works great. Thank you for a great article!\nL480: \nL481:  Like comment:  Like comment:  2 likes Like  Thread Thread \nL482: \nL483:   \nL484: \nL485:  Krzysztof Szala  \nL486: \nL487:  Krzysztof Szala \nL488: \nL489:  Krzysztof Szala  \nL490: \nL491: Follow\nL492: \nL493: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL494: \nL495:   * Location \nL496: \nL497: Silesia \nL498: \nL499:   * Joined \nL500: \nL501: May 30, 2020\nL502: \nL503: •  Apr 27 '21  \nL504: \nL505:  Dropdown menu\nL506: \nL507:   * Copy link\nL508:   *   * Hide \nL509:   *   *   * \nL510: \nL511: That's great, happy to help! :)\nL512: \nL513:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL514: \nL515: Collapse Expand\nL516: \nL517:   \nL518: \nL519:  José Neto  \nL520: \nL521:  José Neto \nL522: \nL523:  José Neto  \nL524: \nL525: Follow\nL526: \nL527: A funny web developer \nL528: \nL529:   * Location \nL530: \nL531: Lisbon \nL532: \nL533:   * Work \nL534: \nL535: Frontend Engineer at TripAdvisor \nL536: \nL537:   * Joined \nL538: \nL539: Mar 17, 2019\nL540: \nL541: •  Aug 22 '21  \nL542: \nL543:  Dropdown menu\nL544: \nL545:   * Copy link\nL546:   *   * Hide \nL547:   *   *   * \nL548: \nL549: Awesome, thanks!\nL550: \nL551:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL552: \nL553: Collapse Expand\nL554: \nL555:   \nL556: \nL557:  Krzysztof Szala  \nL558: \nL559:  Krzysztof Szala \nL560: \nL561:  Krzysztof Szala  \nL562: \nL563: Follow\nL564: \nL565: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL566: \nL567:   * Location \nL568: \nL569: Silesia \nL570: \nL571:   * Joined \nL572: \nL573: May 30, 2020\nL574: \nL575: •  Aug 23 '21  \nL576: \nL577:  Dropdown menu\nL578: \nL579:   * Copy link\nL580:   *   * Hide \nL581:   *   *   * \nL582: \nL583: You’re welcome!\nL584: \nL585:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL586: \nL587: Collapse Expand\nL588: \nL589:   \nL590: \nL591:  huynh nguyen toan  \nL592: \nL593:  huynh nguyen toan \nL594: \nL595:  huynh nguyen toan  \nL596: \nL597: Follow\nL598: \nL599:   * Joined \nL600: \nL601: Oct 11, 2021\nL602: \nL603: •  Jul 2  \nL604: \nL605:  Dropdown menu\nL606: \nL607:   * Copy link\nL608:   *   * Hide \nL609:   *   *   * \nL610: \nL611: Thanks bro.\nL612: \nL613:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL614: \nL615: Collapse Expand\nL616: \nL617:   \nL618: \nL619:  Tafadzwa Muteke  \nL620: \nL621:  Tafadzwa Muteke \nL622: \nL623:  Tafadzwa Muteke  \nL624: \nL625: Follow\nL626: \nL627: Designer, developer. \nL628: \nL629:   * Location \nL630: \nL631: Harare, Zimbabwe \nL632: \nL633:   * Education \nL634: \nL635: Computer Science \nL636: \nL637:   * Work \nL638: \nL639: Mr at Irus Edge Digital Agency \nL640: \nL641:   * Joined \nL642: \nL643: Oct 2, 2019\nL644: \nL645: •  Dec 17 '21  \nL646: \nL647:  Dropdown menu\nL648: \nL649:   * Copy link\nL650:   *   * Hide \nL651:   *   *   * \nL652: \nL653: Thank you, Krzysztof!\nL654: \nL655:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL656: \nL657: Collapse Expand\nL658: \nL659:   \nL660: \nL661:  Krzysztof Szala  \nL662: \nL663:  Krzysztof Szala \nL664: \nL665:  Krzysztof Szala  \nL666: \nL667: Follow\nL668: \nL669: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL670: \nL671:   * Location \nL672: \nL673: Silesia \nL674: \nL675:   * Joined \nL676: \nL677: May 30, 2020\nL678: \nL679: •  Dec 21 '21  \nL680: \nL681:  Dropdown menu\nL682: \nL683:   * Copy link\nL684:   *   * Hide \nL685:   *   *   * \nL686: \nL687: Glad I could help!\nL688: \nL689:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL690: \nL691: Collapse Expand\nL692: \nL693:   \nL694: \nL695:  Esron Silva  \nL696: \nL697:  Esron Silva \nL698: \nL699:  Esron Silva  \nL700: \nL701: Follow\nL702: \nL703: FullStack Developer. Computer Engineer. \nL704: \nL705:   * Location \nL706: \nL707: Petrolina - PE, Brasil \nL708: \nL709:   * Education \nL710: \nL711: Bachelor in Computer Engineering. \nL712: \nL713:   * Work \nL714: \nL715: Computer Engineer and Full Stack Developer at Sysvale \nL716: \nL717:   * Joined \nL718: \nL719: Jun 6, 2019\nL720: \nL721: •  Apr 12 '22  \nL722: \nL723:  Dropdown menu\nL724: \nL725:   * Copy link\nL726:   *   * Hide \nL727:   *   *   * \nL728: \nL729: Awesome content right here. You saved me a ton of work and time.\nL730: \nL731:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL732: \nL733: Collapse Expand\nL734: \nL735:   \nL736: \nL737:  Krzysztof Szala  \nL738: \nL739:  Krzysztof Szala \nL740: \nL741:  Krzysztof Szala  \nL742: \nL743: Follow\nL744: \nL745: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL746: \nL747:   * Location \nL748: \nL749: Silesia \nL750: \nL751:   * Joined \nL752: \nL753: May 30, 2020\nL754: \nL755: •  Apr 17 '22  \nL756: \nL757:  Dropdown menu\nL758: \nL759:   * Copy link\nL760:   *   * Hide \nL761:   *   *   * \nL762: \nL763: I’m glad I could help! \nL764: \nL765:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL766: \nL767: Collapse Expand\nL768: \nL769:   \nL770: \nL771:  Navin Mishra  \nL772: \nL773:  Navin Mishra \nL774: \nL775:  Navin Mishra  \nL776: \nL777: Follow\nL778: \nL779: Programming enthusiast who wants to learn and grow everyday. \nL780: \nL781:   * Location \nL782: \nL783: kathmandu, nepal \nL784: \nL785:   * Education \nL786: \nL787: Tribhuwan University \nL788: \nL789:   * Work \nL790: \nL791: Developer, interest on business terms \nL792: \nL793:   * Joined \nL794: \nL795: Jun 14, 2022\nL796: \nL797: •  Dec 8  \nL798: \nL799:  Dropdown menu\nL800: \nL801:   * Copy link\nL802:   *   * Hide \nL803:   *   *   * \nL804: \nL805: great article. very helpful\nL806: \nL807:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL808: \nL809: Collapse Expand\nL810: \nL811:   \nL812: \nL813:  Jedediah  \nL814: \nL815:  Jedediah \nL816: \nL817:  Jedediah  \nL818: \nL819: Follow\nL820: \nL821:   * Joined \nL822: \nL823: Apr 28, 2022\nL824: \nL825: •  Apr 28 '22  \nL826: \nL827:  Dropdown menu\nL828: \nL829:   * Copy link\nL830:   *   * Hide \nL831:   *   *   * \nL832: \nL833: Signed up Dev.to just to say thank you! A great series for Nestjs! Great job!\nL834: \nL835:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL836: \nL837: Collapse Expand\nL838:\nVisible: 0% - 85%"}]},"command":"click","args":[1],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"260acd90-06dc-47c4-9247-a40c8e86c71e","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"260acd90-06dc-47c4-9247-a40c8e86c71e","children":["ac5a24d7-4001-45b1-820c-ade5767e83b0"]},{"id":"ac5a24d7-4001-45b1-820c-ade5767e83b0","message":{"id":"ac5a24d7-4001-45b1-820c-ade5767e83b0","author":{"role":"assistant","metadata":{}},"create_time":1703480183.139115,"content":{"content_type":"code","language":"unknown","text":"back()"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"cea888d7-5e29-46d2-887d-9e2ae9119887","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"cea888d7-5e29-46d2-887d-9e2ae9119887","children":["906ee60c-6093-4aee-b682-f52c33f0b9f9"]},{"id":"906ee60c-6093-4aee-b682-f52c33f0b9f9","message":{"id":"906ee60c-6093-4aee-b682-f52c33f0b9f9","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.148643,"content":{"content_type":"tether_browsing_display","result":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Validation | NestJS - A progressive Node.js framework","url":"https://docs.nestjs.com/techniques/validation","text":"\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: "},{"type":"webpage","title":"Custom validation with database in NestJS - DEV Community","url":"https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao","text":"\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: "},{"type":"webpage","title":"Validation - GitHub: Let’s build from here","url":"https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md","text":"\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: "},{"type":"webpage","title":"Injecting request object to a custom validation class in NestJS","url":"https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal","text":"\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: "},{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: "},{"type":"webpage","title":"NestJS and ‘class validator’ cheat sheet - DEV Community","url":"https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao","text":"\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: "},{"type":"webpage","title":"How to implement input validation with NestJS - Sébastien Dubois","url":"https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/","text":"\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: "},{"type":"webpage","title":"How to use class-validator and generate custom error object in nest.js","url":"https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h","text":"\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: "},{"type":"webpage","title":"Building a REST API with NestJS and Prisma: Input Validation ...","url":"https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1","text":"\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: "},{"type":"webpage","title":"NestJS Custom Payload Validation - DEV Community","url":"https://dev.to/shubham_kadam/nestjs-custom-payload-validation-3hh7","text":"\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: "},{"type":"webpage","title":"Mastering Email Validation in NestJS: A Comprehensive Guide","url":"https://emaillistvalidation.com/blog/mastering-email-validation-in-nestjs-a-comprehensive-guide/","text":"\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: "},{"type":"webpage","title":"Custom Card v2 Signature Validation in NestJS - community.hubspot.com","url":"https://community.hubspot.com/t5/APIs-Integrations/Custom-Card-v2-Signature-Validation-in-NestJS/m-p/897350","text":"\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"},{"type":"webpage","title":"Search results for query: 'nestjs class-validator custom validation method documentation'","url":"","text":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"}]},"command":"back","args":[],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"ac5a24d7-4001-45b1-820c-ade5767e83b0","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"ac5a24d7-4001-45b1-820c-ade5767e83b0","children":["c44ab270-773c-4f50-80aa-e5b8b0143154"]},{"id":"c44ab270-773c-4f50-80aa-e5b8b0143154","message":{"id":"c44ab270-773c-4f50-80aa-e5b8b0143154","author":{"role":"assistant","metadata":{}},"create_time":1703480183.156905,"content":{"content_type":"code","language":"unknown","text":"click(6)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"906ee60c-6093-4aee-b682-f52c33f0b9f9","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"906ee60c-6093-4aee-b682-f52c33f0b9f9","children":["e1ab7557-ed13-451e-b7a2-8de9aca7f653"]},{"id":"e1ab7557-ed13-451e-b7a2-8de9aca7f653","message":{"id":"e1ab7557-ed13-451e-b7a2-8de9aca7f653","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.166702,"content":{"content_type":"tether_browsing_display","result":"L0: \nL1: URL: https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/\nL2: \nL3: 【0† Sébastien Dubois 】 \nL4: \nL5:   * 【1†Home】\nL6:   * 【2†Newsletter】\nL7:   * 【3†Courses】\nL8:   * 【4†Obsidian Starter Kit†obsidianstarterkit.com】\nL9:   * 【5†PKM Coaching†developassion.gumroad.com】\nL10:   * 【6†PKM Library†developassion.gumroad.com】\nL11:   * 【7†YouTube†youtube.com】\nL12:   * 【8†Projects】\nL13:   * 【9†Books】\nL14:   * 【10†About】\nL15:   * 【11†Now】\nL16:   * 【12†Uses】\nL17:   * 【13†Links】\nL18: \nL19: Subscribe \nL20: \nL21: 【14†blog】 \nL22: \nL23: # How to implement input validation with NestJS\nL24: \nL25: 【15† 】 \nL26: \nL27: ####  【15†Sebastien Dubois】 \nL28: \nL29: Jul 23, 2020 12 min\nL30: \nL31: Learn how to validate incoming data with NestJS\nL32: \nL33: [Image 0: How to implement input validation with NestJS] \nL34: \nL35: Validating incoming data is of the utmost importance for security. Let’s explore why and how to handle this concern with 【16†NestJS†nestjs.com】.\nL36: \nL37: 【16†NestJS†nestjs.com】 is one of the most popular Node-based back-end frameworks around. It is currently at 【17†rank #198 of the most popular Github repositories†gitstar-ranking.com】 (based on stars); quite an achievement. And it is deserved; this framework does a great job at structuring larger back-end systems; just like Spring does in the Java ecosystem.\nL38: \nL39: In this article, we’ll explore how to handle input validation with 【16†NestJS†nestjs.com】. I will cover the most frequent use case: RESTful APIs, but most of what I’ll explain also applies to GraphQL APIs and WebSockets.\nL40: \nL41: Let’s dive right in!\nL42: \nL43: ## Validation? Why?\nL44: \nL45: Injection attacks are still part of the 【18†OWASP Top 10†owasp.org】; a list of the most critical security threats to Web applications.\nL46: \nL47: As 【19†the 2019 report mentions†github.com】, injection flaws are very prevalent and can result in data loss, corruption or disclosure of data to unauthorized parties or even complete host takeover (aka oopsie doopsie).\nL48: \nL49: If the data that your application handles is not important, then you probably don’t care, but most often this is only true of toy projects. For most real world applications, data is critical and must be protected adequately. Failing to do so can lead to devastating business impacts.\nL50: \nL51: But what does this have to do with validation? Well validation is one of the main ways to circumvent injection attacks. All client/user-supplied data MUST be validated, filtered and properly sanitized by the applications.\nL52: \nL53: By validating incoming data, you can ensure that:\nL54: \nL55:   * The data has the expected shape \nL56:   * The data has the expected types/formats \nL57:   * The data is valid from a business point of view \nL58:   * The data is valid for the intended purpose \nL59: \nL60: That way, if an attacker tries to manipulate inputs so as to pollute your data or break into your systems, then you’ll at least try to fight against it.\nL61: \nL62: Validation alone is unfortunately not sufficient, but we’ll focus solely on it in this article. I strongly encourage you to read the 【19†full report here†github.com】 to learn more about how to protect yourself against the most prevalent threats to application security (even if there are many more those those critical ones).\nL63: \nL64: By the way, the OWASP also maintains a 【20†nice cheatsheet about input validation†cheatsheetseries.owasp.org】 which you should take a look at.\nL65: \nL66: In the next sections, I’ll explain what NestJS has to offer regarding validation and we’ll dive in an example together, demonstrating how to configure validation support and how to enforce validations.\nL67: \nL68: ## NestJS support for validation \nL69: \nL70: Being a framework, NestJS does a great job at providing us with many tools, bells and whistles out of the box. Two of those tools are the support for 【21†Pipes†docs.nestjs.com】 and 【22†Validation†docs.nestjs.com】.\nL71: \nL72: As you probably know, NestJS is heavily inspired by Angular, so it’s no wonder that it has support for pipes like Angular does.\nL73: \nL74: NestJS pipes have two main use cases:\nL75: \nL76:   * transformation of input data \nL77:   * validation of input data \nL78: \nL79: When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL80: \nL81: Out of the box, NestJS includes a number of pipes; some of which are dedicated to validation:\nL82: \nL83:   * ValidationPipe (which we’ll explore in this article)\nL84:   * ParseIntPipe \nL85:   * ParseBoolPipe \nL86:   * ParseArrayPipe \nL87:   * ParseUUIDPipe \nL88: \nL89: There are multiple ways to bind pipes to route handler methods (again, we’re focusing on RESTful APIs here, but I’ll mention other types of APIs later on).\nL90: \nL91: Here’s a first one, taken from the official documentation:\nL92: \nL93:     @Get(':id')\nL94:     async findOne(@Param('id', ParseIntPipe) id: number) {\nL95:       return this.catsService.findOne(id);\nL96:     }\nL97: \nL98: In the example above, the built-in `ParseIntPipe` is associated with the `findOne` route handler method. Before the method is called, the pipe will be invoked to validate that the `id` parameter is indeed an integer. Easy as pie, right?\nL99: \nL100: The nice thing about NestJS validation pipes is that when the method is invoked, then you can consider that the data you have received is structurally valid (shape and form); otherwise an exception would’ve been thrown (and automagically converted into an HTTP 4xx error for the client). That is of course not enough for input validation, but it goes a long way already.\nL101: \nL102: If inputs fail to pass validation checks, then the client will receive an error such as this one:\nL103: \nL104:     {\nL105:       \"statusCode\": 400,\nL106:       \"message\": \"Validation failed (numeric string is expected)\",\nL107:       \"error\": \"Bad Request\"\nL108:     }\nL109: \nL110: To me, it is a good enough default for client errors, even if I prefer the structure proposed by 【23†RFC 7807 (problem details for HTTP APIs)†github.com】, but that’s another subject.\nL111: \nL112: This means that your RESTful route handler methods can respect the 【24†Single Responsibility Principle (SRP)†en.wikipedia.org】 and concentrate on forwarding the requests to some other places in the system, where they can be further validated/processed/handled.\nL113: \nL114: Note that it is also possible to create and use a specific instance of a NestJS pipe:\nL115: \nL116:     @Get(':id')\nL117:     async findOne(\nL118:       @Param('id', new ParseIntPipe({ errorHttpStatusCode: HttpStatus.NOT_ACCEPTABLE }))\nL119:       id: number,\nL120:     ) {\nL121:       return this.catsService.findOne(id);\nL122:     }\nL123: \nL124: Here, a custom instance of the `ParseIntPipe` with a specific configuration was associated with the injected `id` param. This is interesting because it means that you can rely on the default behavior, but also customize it when you need to.\nL125: \nL126: You can of course create your own pipes, to perform any validation you’d like; we’ll look at that a bit later in this article.\nL127: \nL128: Another way to define pipes is to add the `UsePipes()` decorator:\nL129: \nL130:     @Post()\nL131:     @UsePipes(new JoiValidationPipe(createCatSchema))\nL132:     async create(@Body() createCatDto: CreateCatDto) {\nL133:       this.catsService.create(createCatDto);\nL134:     }\nL135: \nL136: With the above, the `JoiValidationPipe` (which is not a built-in pipe) will validate the input data against the provided Joi schema (more on this in the next section).\nL137: \nL138: ## Supported validation types \nL139: \nL140: NestJS supports different means of 【22†validating data†docs.nestjs.com】. In this article, I’ll only discuss the solution using 【25†class-validator,†github.com】 as it covers my needs perfectly, but I’ll still mention the other ones for the sake of completeness.\nL141: \nL142: ### Schema-based validation with Joi \nL143: \nL144: The first approach discussed in the 【21†Pipes documentation†docs.nestjs.com】 is using schema-based validation, for instance using the 【26†Joi†github.com】 library:\nL145: \nL146: The above is a custom NestJS pipe. As you can see, it is quite simple to create one: it’s just a class implementing `PipeTransform` and its `transform` method, which receives the raw value sent to the server, as well as metadata.\nL147: \nL148: In this case, the custom pipe makes use of Joi to validate that the input data respects the configured Joi schema. Each instance of this pipe expects a schema to be passed into the constructor.\nL149: \nL150: This is how the schema is passed in by the route handler methods:\nL151: \nL152:     @UsePipes(new JoiValidationPipe(createCatSchema))\nL153: \nL154: In my current project, I chose not to use this approach because, unfortunately, I couldn’t find an easy/maintainable way to keep my validation schemas strongly aligned with my TypeScript interfaces. I did find libraries that could’ve helped: 【27†typesafe-joi†github.com】 and 【28†joi-extract-type†github.com】, but both of those were either unmaintained/abandoned or only compatible with legacy versions of Joi, so it felt like a risky bet to make.\nL155: \nL156: ### Schema based validation with JSON schema \nL157: \nL158: Another approach for schema-based validation is to use 【29†JSON schemas†json-schema.org】 and validate data against those using libraries such as the 【30†ajv†ajv.js.org】 JSON schema validator.\nL159: \nL160: This also requires the creation of custom validation pipes for NestJS as there is no built-in support.\nL161: \nL162: I’ve rejected this option for my project because of the complexity/overhead; again related to keeping the data model and the validation schemas in sync.\nL163: \nL164: I did find the following library to generate JSON schemas from TypeScript code, but didn’t look into it in detail: 【31†https://github.com/YousefED/typescript-json-schema†github.com】\nL165: \nL166: If you’re interested in that approach, then take a look at the following articles:\nL167: \nL168:   * 【32†https://medium.com/javascript-in-plain-english/how-to-test-json-schema-with-ajv-in-typescript-bd0361e0c03e†medium.com】\nL169:   * 【33†https://levelup.gitconnected.com/typescript-validation-with-ajv-1b70a76dd678†levelup.gitconnected.com】\nL170: \nL171: ### class-validator \nL172: \nL173: The last approach, which is also the one that’s (IMO) currently best supported by NestJS, uses 【25†class-validator†github.com】.\nL174: \nL175: class-validator is a very popular TypeScript validation library that provides 【34†many validation decorators†github.com】.\nL176: \nL177: In order to co configure validation with class-validator, you simply have to add decorators on fields that need validation. Here’s an example taken from the official docs:\nL178: \nL179: As you can see, expressing the validation rules is pretty straightforward.\nL180: \nL181: Note that while class-validator expect you to be using classes. It 【35†does actually support schema-based validation†github.com】 as well, but I wasn’t convinced by the maturity of that approach. The `ValidationSchema` type provided out of the box is 【36†weakly typed†github.com】 (goodbye refactoring!) and there are 【37†unfixed bugs†github.com】 around it, so I wouldn’t recommend it.\nL182: \nL183: In my project, it was a bit frustrating because I could manage without classes so far (and felt pretty happy about it!), but validation kind of forced me to create classes after all. Still, it felt like the safest bet at this point, given the low maturity of JS/TS validation (just my opinion of course!), compared to other languages/platforms (I sometimes miss bean validation :p).\nL184: \nL185: Also, this approach has great support out of the box by NestJS, through its `ValidationPipe`, which we’ll explore next.\nL186: \nL187: ### Other options \nL188: \nL189: In this section, I’ve covered the different solutions mentioned in NestJS’s documentation, but it’s far from all that you can do.\nL190: \nL191: There are a myriad of options for runtime type checking/validation, such as 【38†io-ts†github.com】, which I wrote about in 【39†my TS book†www.amazon.com】, 【40†zod†github.com】, 【41†runtypes†github.com】, 【42†vest†github.com】, and many more. You can find a 【43†nice article about this subject here†2ality.com】.\nL192: \nL193: As a side note, a NestJS maintainer also recommended 【44†Marshall†github.com】 to me as an alternative to class-validator, as it is apparently much more performant and provides a custom NestJS pipe for ease of use. Still, I chose class-validator for now as it is supported right out of the box and battle tested. If NestJS switches over, then I’ll probably follow along. Anyhow, to me, maintainability and support trump performance… until performance really becomes a bottleneck ;-)\nL194: \nL195: ## ValidationPipe \nL196: \nL197: As I’ve mentioned, NestJS provides a built-in `ValidationPipe`. That pipe actually uses 【25†class-validator†github.com】 and 【45†class-transformer†github.com】 (two libraries that go hand in hand) underneath the cover.\nL198: \nL199: The interesting thing about this built-in pipe is that it handles validation as well as transformation of input data into class instances. Thus, if you use it, then your request handlers will receive class instances with properly validated data.\nL200: \nL201: For the validation pipe to kick in, you need to refer to classes in your route handler arguments. If you use “any” or an interface, then the validation pipe won’t be able to help! In my project, it was annoying because it forced me to introduce classes just for the sake of validation, but I known that I’ll ultimately benefit from those for other purposes with NestJS.\nL202: \nL203: The `ValidationPipe` of NestJS can be tweaked according to your needs; you can make it more or less strict, you can disable or enable data transformation, etc.\nL204: \nL205: To use this pipe, you have multiple options. Just like I showed earlier, you can declare it locally on a route handler (e.g., through `@UsePipes`), but you can also enable it globally for your application. The advantage of declaring it as a global pipe is that it’ll always be there (at least for HTTP route handlers); no need to think about it, so it’s a safer route (pun intended). Less to think about = less potential mistakes.\nL206: \nL207: To configure this pipe globally, open your “main.ts” file and add the following:\nL208: \nL209:     app.useGlobalPipes(new ValidationPipe({ ... }));\nL210: \nL211: Here’s how I’ve configured this pipe for my current project:\nL212: \nL213: As you can see, I’ve tweaked the configuration a bit; let me explain:\nL214: \nL215:   * `whitelist: true` tells NestJS to strip the validated (i.e., returned) object of any properties that do not use any validation decorators. This of course means that all fields in your class should be annotated with class-validator decorators; otherwise the fields will be removed. The good news is that it ensures that you will never receive unexpected fields. This is especially important to avoid injecting data silently \nL216:   * `forbidNonWhitelisted: true` instructs NestJS to throw an exception if there are unexpected fields. This is stricter, but even clearer. At least the client will know if/when it provides invalid/unexpected data \nL217:   * `forbitUnknownValues` unknown objects are immediately rejected \nL218:   * `validationError: { value: false }` tells NestJS not to reflect the value at fault in the error responses. This lightens the responses and might limit sensitive data exposure in some cases \nL219:   * `transform: true` tells NestJS to return the validated class instance \nL220: \nL221: With this global configuration in place, all the route handlers that depend on classes will have validation in place; assuming that those classes are all properly annotated with class-validator decorators. Neat!\nL222: \nL223: ## ValidationPipe example \nL224: \nL225: Here’s a concrete example using the `ValidationPipe` of NestJS.\nL226: \nL227: This is the controller that should receive validated data. Here, let’s first concentrate on the `@Body()`. As you can see, we inject the body of the POST request, and expect it to be an instance of the `MeetingPartialUpdate` class.\nL228: \nL229: If the `ValidationPipe` is enabled/configured globally (cfr. last section), and if `MeetingPartialUpdate` is a class annotated with class-validator decorators, then the `ValidationPipe` will handle validations for us. The same is true for the injected parameters (I’ll come back to this later).\nL230: \nL231: Here’s what the body class looks like:\nL232: \nL233: This is standard class-validator usage, so nothing special to mention here if you’re already familiar with class-validator. If you’re not, then notice that we use quite a few validators here, some of which are marked as optional. We’re also leveraging nested validation support, Regex matching, etc.\nL234: \nL235: There are many more validators included in the library, so it’s quite powerful. You can also easily create 【46†custom validators†github.com】 (【46†classes†github.com】 and 【47†decorators†github.com】) if needed.\nL236: \nL237: With the above, the `ValidationPipe` will ensure that the received data matches our expectations (shape and content).\nL238: \nL239: This is a strong first step forward good input validation. But we can do better!\nL240: \nL241: ## Validating resource handler parameters \nL242: \nL243: In the previous section, I’ve focused on the validation of the body. But, as I’ve mentioned, the other input parameter that is injected is also validated.\nL244: \nL245: I think that it’s important to mention that the `ValidationPipe` validates everything that is class-based (and correctly annotated). Based on this, I really recommend you to create classes for all of the inputs (body, query parameters, URL parameters, etc) and use those so that you get strict input validation for everything. And I mean this also for single string parameters; even if it means introducing a class with a single field. It’s clearly worth it.\nL246: \nL247: In the previous example, the `MeetingsControllerInputParams` class only contains two fields, corresponding to the two URL parameters:\nL248: \nL249: That way, the URL parameters are also validated. Quite cool if you ask me!\nL250: \nL251: ## One step further \nL252: \nL253: As I’ve said, validation is more complex than that. Fields must be valid (structure/shape), but they also need to match. For instance, when updating a resource, the resource identifier is mentioned once in the URL, but it is also present in the body of the request. Both values must be the same for the update request to be considered valid and class-validator can’t help with such scenarios as the data is decoupled.\nL254: \nL255: The same goes for other things, but it’s a point to keep in mind: don’t consider that simple/basic input validation will cut it, security wise. Then there’s also of course optimistic concurrency handling, authentication, authorization and quite a lot of additional things to take care of.. ;-)\nL256: \nL257: To go further with input validation in my project, I’ve used a guard because it matched my requirements but, depending on which validations you need to perform, a pipe might be more adequate. Through this generic guard, I could implement checks such as:\nL258: \nL259:   * matching between URL parameters and body values \nL260:   * presence of the If-Match header and matching with the body values \nL261:   * etc \nL262: \nL263: Note that business services that sit behind REST controllers, lower in the architecture, perform additional validations (business-wise!) and authorization. I’ll write about that another day.\nL264: \nL265: ## GraphQL \u0026 WebSockets \nL266: \nL267: As with RESTful APIs, GraphQL APIs and WebSocket “tunnels” also need proper validation.\nL268: \nL269: For GraphQL, the good news is that it is apparently possible to declare the validation pipe along with the `@Args` decorator, as shared here by John Niomair: 【48†https://github.com/nestjs/nest/issues/819#issuecomment-480247274†github.com】\nL270: \nL271: Finally, the built-in validation pipe is supposed to work all the same for WebSocket gateways, so you should be able to add the `UsePipes` decorator on the gateway methods and go from there (I don’t think it works with the global pipes). Although I didn’t test this myself so far…\nL272: \nL273: ## Conclusion \nL274: \nL275: In this article, I’ve explained why input validation matters so much for security. Then, I’ve described the built-in validation support of NestJS.\nL276: \nL277: Finally, I’ve walked you through an example and shared some thoughts about how to properly validate your inputs.\nL278: \nL279: Thanks to the whole setup, the route handlers of our NestJS controllers can focus solely on passing commands/queries around and don’t have to worry about input validation, which is great for separation of concerns.\nL280: \nL281: Once again, this is just the tip of the iceberg. Validation is required across many layers, in different shapes and forms. In addition, validation is only a small part of the overall picture; many other aspects must be taken care of to ensure a good security posture (e.g., authentication, authorization, business validations, error handling, audit logging, monitoring, etc).\nL282: \nL283: That's it for today! ✨\nL284: \nL285: 【49†Subscribe to the newsletter】\nL286: \nL287: ## About Sébastien \nL288: \nL289: Hello everyone! I'm Sébastien Dubois. I'm an author, founder, and CTO. I write books and articles about software development \u0026 IT, personal knowledge management, personal organization, and productivity. I also craft lovely digital products   \nL290: \nL291: If you've enjoyed this article and want to read more like this, then 【50†become a subscriber】, check out my 【51†Obsidian Starter Kit†developassion.gumroad.com】, the 【6†PKM Library†developassion.gumroad.com】 and my 【52†collection of books about software development†dev-concepts.dev】 .  \nL292: \nL293: You can 【53†follow me on Twitter†twitter.com】   \nL294: \nL295: If you want to discuss, then don't hesitate to join the 【54†Personal Knowledge Management community†dsebastien.net】 or the 【55†Software Crafters community†dsebastien.net】.\nL296: \nL297: #### Read next\nL298: \nL299: 【56† TypeScript 3 Projects: What's next? An appendix to my TypeScript book Sebastien Dubois Nov 12, 2019 】  【57† Configuring and using the Apollo client in a Next.js TypeScript application Learn how to integrate the Apollo GraphQL client in a Next.js TypeScript application Sebastien Dubois Feb 24, 2021 】  【58† On the importance of non-goals Goals are key to progress, but non-goals are complementary, and help go in the right direction. Here's why. Sebastien Dubois Aug 4, 2023 】 \nL300: \nL301: #### Comments () \nL302: \nL303: ### Subscribe to Sébastien Dubois\nL304: \nL305: Don't miss out on the latest Knowledge Management news. Sign up now to get access to the library of members-only articles.\nL306: \nL307: Subscribe now\nL308: \nL309:   * Sign up\nL310: \nL311: Passion makes all the difference.\nVisible: 0% - 100%","summary":"How to implement input validation with NestJS (www.dsebastien.net)\n","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"How to implement input validation with NestJS","url":"https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/","text":"L0: \nL1: URL: https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/\nL2: \nL3:  Sébastien Dubois  \nL4: \nL5:   * Home\nL6:   * Newsletter\nL7:   * Courses\nL8:   * Obsidian Starter Kit\nL9:   * PKM Coaching\nL10:   * PKM Library\nL11:   * YouTube\nL12:   * Projects\nL13:   * Books\nL14:   * About\nL15:   * Now\nL16:   * Uses\nL17:   * Links\nL18: \nL19: Subscribe \nL20: \nL21: blog \nL22: \nL23: # How to implement input validation with NestJS\nL24: \nL25:   \nL26: \nL27: ####  Sebastien Dubois \nL28: \nL29: Jul 23, 2020 12 min\nL30: \nL31: Learn how to validate incoming data with NestJS\nL32: \nL33: [Image 0: How to implement input validation with NestJS] \nL34: \nL35: Validating incoming data is of the utmost importance for security. Let’s explore why and how to handle this concern with NestJS.\nL36: \nL37: NestJS is one of the most popular Node-based back-end frameworks around. It is currently at rank #198 of the most popular Github repositories (based on stars); quite an achievement. And it is deserved; this framework does a great job at structuring larger back-end systems; just like Spring does in the Java ecosystem.\nL38: \nL39: In this article, we’ll explore how to handle input validation with NestJS. I will cover the most frequent use case: RESTful APIs, but most of what I’ll explain also applies to GraphQL APIs and WebSockets.\nL40: \nL41: Let’s dive right in!\nL42: \nL43: ## Validation? Why?\nL44: \nL45: Injection attacks are still part of the OWASP Top 10; a list of the most critical security threats to Web applications.\nL46: \nL47: As the 2019 report mentions, injection flaws are very prevalent and can result in data loss, corruption or disclosure of data to unauthorized parties or even complete host takeover (aka oopsie doopsie).\nL48: \nL49: If the data that your application handles is not important, then you probably don’t care, but most often this is only true of toy projects. For most real world applications, data is critical and must be protected adequately. Failing to do so can lead to devastating business impacts.\nL50: \nL51: But what does this have to do with validation? Well validation is one of the main ways to circumvent injection attacks. All client/user-supplied data MUST be validated, filtered and properly sanitized by the applications.\nL52: \nL53: By validating incoming data, you can ensure that:\nL54: \nL55:   * The data has the expected shape \nL56:   * The data has the expected types/formats \nL57:   * The data is valid from a business point of view \nL58:   * The data is valid for the intended purpose \nL59: \nL60: That way, if an attacker tries to manipulate inputs so as to pollute your data or break into your systems, then you’ll at least try to fight against it.\nL61: \nL62: Validation alone is unfortunately not sufficient, but we’ll focus solely on it in this article. I strongly encourage you to read the full report here to learn more about how to protect yourself against the most prevalent threats to application security (even if there are many more those those critical ones).\nL63: \nL64: By the way, the OWASP also maintains a nice cheatsheet about input validation which you should take a look at.\nL65: \nL66: In the next sections, I’ll explain what NestJS has to offer regarding validation and we’ll dive in an example together, demonstrating how to configure validation support and how to enforce validations.\nL67: \nL68: ## NestJS support for validation \nL69: \nL70: Being a framework, NestJS does a great job at providing us with many tools, bells and whistles out of the box. Two of those tools are the support for Pipes and Validation.\nL71: \nL72: As you probably know, NestJS is heavily inspired by Angular, so it’s no wonder that it has support for pipes like Angular does.\nL73: \nL74: NestJS pipes have two main use cases:\nL75: \nL76:   * transformation of input data \nL77:   * validation of input data \nL78: \nL79: When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL80: \nL81: Out of the box, NestJS includes a number of pipes; some of which are dedicated to validation:\nL82: \nL83:   * ValidationPipe (which we’ll explore in this article)\nL84:   * ParseIntPipe \nL85:   * ParseBoolPipe \nL86:   * ParseArrayPipe \nL87:   * ParseUUIDPipe \nL88: \nL89: There are multiple ways to bind pipes to route handler methods (again, we’re focusing on RESTful APIs here, but I’ll mention other types of APIs later on).\nL90: \nL91: Here’s a first one, taken from the official documentation:\nL92: \nL93:     @Get(':id')\nL94:     async findOne(@Param('id', ParseIntPipe) id: number) {\nL95:       return this.catsService.findOne(id);\nL96:     }\nL97: \nL98: In the example above, the built-in `ParseIntPipe` is associated with the `findOne` route handler method. Before the method is called, the pipe will be invoked to validate that the `id` parameter is indeed an integer. Easy as pie, right?\nL99: \nL100: The nice thing about NestJS validation pipes is that when the method is invoked, then you can consider that the data you have received is structurally valid (shape and form); otherwise an exception would’ve been thrown (and automagically converted into an HTTP 4xx error for the client). That is of course not enough for input validation, but it goes a long way already.\nL101: \nL102: If inputs fail to pass validation checks, then the client will receive an error such as this one:\nL103: \nL104:     {\nL105:       \"statusCode\": 400,\nL106:       \"message\": \"Validation failed (numeric string is expected)\",\nL107:       \"error\": \"Bad Request\"\nL108:     }\nL109: \nL110: To me, it is a good enough default for client errors, even if I prefer the structure proposed by RFC 7807 (problem details for HTTP APIs), but that’s another subject.\nL111: \nL112: This means that your RESTful route handler methods can respect the Single Responsibility Principle (SRP) and concentrate on forwarding the requests to some other places in the system, where they can be further validated/processed/handled.\nL113: \nL114: Note that it is also possible to create and use a specific instance of a NestJS pipe:\nL115: \nL116:     @Get(':id')\nL117:     async findOne(\nL118:       @Param('id', new ParseIntPipe({ errorHttpStatusCode: HttpStatus.NOT_ACCEPTABLE }))\nL119:       id: number,\nL120:     ) {\nL121:       return this.catsService.findOne(id);\nL122:     }\nL123: \nL124: Here, a custom instance of the `ParseIntPipe` with a specific configuration was associated with the injected `id` param. This is interesting because it means that you can rely on the default behavior, but also customize it when you need to.\nL125: \nL126: You can of course create your own pipes, to perform any validation you’d like; we’ll look at that a bit later in this article.\nL127: \nL128: Another way to define pipes is to add the `UsePipes()` decorator:\nL129: \nL130:     @Post()\nL131:     @UsePipes(new JoiValidationPipe(createCatSchema))\nL132:     async create(@Body() createCatDto: CreateCatDto) {\nL133:       this.catsService.create(createCatDto);\nL134:     }\nL135: \nL136: With the above, the `JoiValidationPipe` (which is not a built-in pipe) will validate the input data against the provided Joi schema (more on this in the next section).\nL137: \nL138: ## Supported validation types \nL139: \nL140: NestJS supports different means of validating data. In this article, I’ll only discuss the solution using class-validator, as it covers my needs perfectly, but I’ll still mention the other ones for the sake of completeness.\nL141: \nL142: ### Schema-based validation with Joi \nL143: \nL144: The first approach discussed in the Pipes documentation is using schema-based validation, for instance using the Joi library:\nL145: \nL146: The above is a custom NestJS pipe. As you can see, it is quite simple to create one: it’s just a class implementing `PipeTransform` and its `transform` method, which receives the raw value sent to the server, as well as metadata.\nL147: \nL148: In this case, the custom pipe makes use of Joi to validate that the input data respects the configured Joi schema. Each instance of this pipe expects a schema to be passed into the constructor.\nL149: \nL150: This is how the schema is passed in by the route handler methods:\nL151: \nL152:     @UsePipes(new JoiValidationPipe(createCatSchema))\nL153: \nL154: In my current project, I chose not to use this approach because, unfortunately, I couldn’t find an easy/maintainable way to keep my validation schemas strongly aligned with my TypeScript interfaces. I did find libraries that could’ve helped: typesafe-joi and joi-extract-type, but both of those were either unmaintained/abandoned or only compatible with legacy versions of Joi, so it felt like a risky bet to make.\nL155: \nL156: ### Schema based validation with JSON schema \nL157: \nL158: Another approach for schema-based validation is to use JSON schemas and validate data against those using libraries such as the ajv JSON schema validator.\nL159: \nL160: This also requires the creation of custom validation pipes for NestJS as there is no built-in support.\nL161: \nL162: I’ve rejected this option for my project because of the complexity/overhead; again related to keeping the data model and the validation schemas in sync.\nL163: \nL164: I did find the following library to generate JSON schemas from TypeScript code, but didn’t look into it in detail: https://github.com/YousefED/typescript-json-schema\nL165: \nL166: If you’re interested in that approach, then take a look at the following articles:\nL167: \nL168:   * https://medium.com/javascript-in-plain-english/how-to-test-json-schema-with-ajv-in-typescript-bd0361e0c03e\nL169:   * https://levelup.gitconnected.com/typescript-validation-with-ajv-1b70a76dd678\nL170: \nL171: ### class-validator \nL172: \nL173: The last approach, which is also the one that’s (IMO) currently best supported by NestJS, uses class-validator.\nL174: \nL175: class-validator is a very popular TypeScript validation library that provides many validation decorators.\nL176: \nL177: In order to co configure validation with class-validator, you simply have to add decorators on fields that need validation. Here’s an example taken from the official docs:\nL178: \nL179: As you can see, expressing the validation rules is pretty straightforward.\nL180: \nL181: Note that while class-validator expect you to be using classes. It does actually support schema-based validation as well, but I wasn’t convinced by the maturity of that approach. The `ValidationSchema` type provided out of the box is weakly typed (goodbye refactoring!) and there are unfixed bugs around it, so I wouldn’t recommend it.\nL182: \nL183: In my project, it was a bit frustrating because I could manage without classes so far (and felt pretty happy about it!), but validation kind of forced me to create classes after all. Still, it felt like the safest bet at this point, given the low maturity of JS/TS validation (just my opinion of course!), compared to other languages/platforms (I sometimes miss bean validation :p).\nL184: \nL185: Also, this approach has great support out of the box by NestJS, through its `ValidationPipe`, which we’ll explore next.\nL186: \nL187: ### Other options \nL188: \nL189: In this section, I’ve covered the different solutions mentioned in NestJS’s documentation, but it’s far from all that you can do.\nL190: \nL191: There are a myriad of options for runtime type checking/validation, such as io-ts, which I wrote about in my TS book, zod, runtypes, vest, and many more. You can find a nice article about this subject here.\nL192: \nL193: As a side note, a NestJS maintainer also recommended Marshall to me as an alternative to class-validator, as it is apparently much more performant and provides a custom NestJS pipe for ease of use. Still, I chose class-validator for now as it is supported right out of the box and battle tested. If NestJS switches over, then I’ll probably follow along. Anyhow, to me, maintainability and support trump performance… until performance really becomes a bottleneck ;-)\nL194: \nL195: ## ValidationPipe \nL196: \nL197: As I’ve mentioned, NestJS provides a built-in `ValidationPipe`. That pipe actually uses class-validator and class-transformer (two libraries that go hand in hand) underneath the cover.\nL198: \nL199: The interesting thing about this built-in pipe is that it handles validation as well as transformation of input data into class instances. Thus, if you use it, then your request handlers will receive class instances with properly validated data.\nL200: \nL201: For the validation pipe to kick in, you need to refer to classes in your route handler arguments. If you use “any” or an interface, then the validation pipe won’t be able to help! In my project, it was annoying because it forced me to introduce classes just for the sake of validation, but I known that I’ll ultimately benefit from those for other purposes with NestJS.\nL202: \nL203: The `ValidationPipe` of NestJS can be tweaked according to your needs; you can make it more or less strict, you can disable or enable data transformation, etc.\nL204: \nL205: To use this pipe, you have multiple options. Just like I showed earlier, you can declare it locally on a route handler (e.g., through `@UsePipes`), but you can also enable it globally for your application. The advantage of declaring it as a global pipe is that it’ll always be there (at least for HTTP route handlers); no need to think about it, so it’s a safer route (pun intended). Less to think about = less potential mistakes.\nL206: \nL207: To configure this pipe globally, open your “main.ts” file and add the following:\nL208: \nL209:     app.useGlobalPipes(new ValidationPipe({ ... }));\nL210: \nL211: Here’s how I’ve configured this pipe for my current project:\nL212: \nL213: As you can see, I’ve tweaked the configuration a bit; let me explain:\nL214: \nL215:   * `whitelist: true` tells NestJS to strip the validated (i.e., returned) object of any properties that do not use any validation decorators. This of course means that all fields in your class should be annotated with class-validator decorators; otherwise the fields will be removed. The good news is that it ensures that you will never receive unexpected fields. This is especially important to avoid injecting data silently \nL216:   * `forbidNonWhitelisted: true` instructs NestJS to throw an exception if there are unexpected fields. This is stricter, but even clearer. At least the client will know if/when it provides invalid/unexpected data \nL217:   * `forbitUnknownValues` unknown objects are immediately rejected \nL218:   * `validationError: { value: false }` tells NestJS not to reflect the value at fault in the error responses. This lightens the responses and might limit sensitive data exposure in some cases \nL219:   * `transform: true` tells NestJS to return the validated class instance \nL220: \nL221: With this global configuration in place, all the route handlers that depend on classes will have validation in place; assuming that those classes are all properly annotated with class-validator decorators. Neat!\nL222: \nL223: ## ValidationPipe example \nL224: \nL225: Here’s a concrete example using the `ValidationPipe` of NestJS.\nL226: \nL227: This is the controller that should receive validated data. Here, let’s first concentrate on the `@Body()`. As you can see, we inject the body of the POST request, and expect it to be an instance of the `MeetingPartialUpdate` class.\nL228: \nL229: If the `ValidationPipe` is enabled/configured globally (cfr. last section), and if `MeetingPartialUpdate` is a class annotated with class-validator decorators, then the `ValidationPipe` will handle validations for us. The same is true for the injected parameters (I’ll come back to this later).\nL230: \nL231: Here’s what the body class looks like:\nL232: \nL233: This is standard class-validator usage, so nothing special to mention here if you’re already familiar with class-validator. If you’re not, then notice that we use quite a few validators here, some of which are marked as optional. We’re also leveraging nested validation support, Regex matching, etc.\nL234: \nL235: There are many more validators included in the library, so it’s quite powerful. You can also easily create custom validators (classes and decorators) if needed.\nL236: \nL237: With the above, the `ValidationPipe` will ensure that the received data matches our expectations (shape and content).\nL238: \nL239: This is a strong first step forward good input validation. But we can do better!\nL240: \nL241: ## Validating resource handler parameters \nL242: \nL243: In the previous section, I’ve focused on the validation of the body. But, as I’ve mentioned, the other input parameter that is injected is also validated.\nL244: \nL245: I think that it’s important to mention that the `ValidationPipe` validates everything that is class-based (and correctly annotated). Based on this, I really recommend you to create classes for all of the inputs (body, query parameters, URL parameters, etc) and use those so that you get strict input validation for everything. And I mean this also for single string parameters; even if it means introducing a class with a single field. It’s clearly worth it.\nL246: \nL247: In the previous example, the `MeetingsControllerInputParams` class only contains two fields, corresponding to the two URL parameters:\nL248: \nL249: That way, the URL parameters are also validated. Quite cool if you ask me!\nL250: \nL251: ## One step further \nL252: \nL253: As I’ve said, validation is more complex than that. Fields must be valid (structure/shape), but they also need to match. For instance, when updating a resource, the resource identifier is mentioned once in the URL, but it is also present in the body of the request. Both values must be the same for the update request to be considered valid and class-validator can’t help with such scenarios as the data is decoupled.\nL254: \nL255: The same goes for other things, but it’s a point to keep in mind: don’t consider that simple/basic input validation will cut it, security wise. Then there’s also of course optimistic concurrency handling, authentication, authorization and quite a lot of additional things to take care of.. ;-)\nL256: \nL257: To go further with input validation in my project, I’ve used a guard because it matched my requirements but, depending on which validations you need to perform, a pipe might be more adequate. Through this generic guard, I could implement checks such as:\nL258: \nL259:   * matching between URL parameters and body values \nL260:   * presence of the If-Match header and matching with the body values \nL261:   * etc \nL262: \nL263: Note that business services that sit behind REST controllers, lower in the architecture, perform additional validations (business-wise!) and authorization. I’ll write about that another day.\nL264: \nL265: ## GraphQL \u0026 WebSockets \nL266: \nL267: As with RESTful APIs, GraphQL APIs and WebSocket “tunnels” also need proper validation.\nL268: \nL269: For GraphQL, the good news is that it is apparently possible to declare the validation pipe along with the `@Args` decorator, as shared here by John Niomair: https://github.com/nestjs/nest/issues/819#issuecomment-480247274\nL270: \nL271: Finally, the built-in validation pipe is supposed to work all the same for WebSocket gateways, so you should be able to add the `UsePipes` decorator on the gateway methods and go from there (I don’t think it works with the global pipes). Although I didn’t test this myself so far…\nL272: \nL273: ## Conclusion \nL274: \nL275: In this article, I’ve explained why input validation matters so much for security. Then, I’ve described the built-in validation support of NestJS.\nL276: \nL277: Finally, I’ve walked you through an example and shared some thoughts about how to properly validate your inputs.\nL278: \nL279: Thanks to the whole setup, the route handlers of our NestJS controllers can focus solely on passing commands/queries around and don’t have to worry about input validation, which is great for separation of concerns.\nL280: \nL281: Once again, this is just the tip of the iceberg. Validation is required across many layers, in different shapes and forms. In addition, validation is only a small part of the overall picture; many other aspects must be taken care of to ensure a good security posture (e.g., authentication, authorization, business validations, error handling, audit logging, monitoring, etc).\nL282: \nL283: That's it for today! ✨\nL284: \nL285: Subscribe to the newsletter\nL286: \nL287: ## About Sébastien \nL288: \nL289: Hello everyone! I'm Sébastien Dubois. I'm an author, founder, and CTO. I write books and articles about software development \u0026 IT, personal knowledge management, personal organization, and productivity. I also craft lovely digital products   \nL290: \nL291: If you've enjoyed this article and want to read more like this, then become a subscriber, check out my Obsidian Starter Kit, the PKM Library and my collection of books about software development .  \nL292: \nL293: You can follow me on Twitter   \nL294: \nL295: If you want to discuss, then don't hesitate to join the Personal Knowledge Management community or the Software Crafters community.\nL296: \nL297: #### Read next\nL298: \nL299:  TypeScript 3 Projects: What's next? An appendix to my TypeScript book Sebastien Dubois Nov 12, 2019    Configuring and using the Apollo client in a Next.js TypeScript application Learn how to integrate the Apollo GraphQL client in a Next.js TypeScript application Sebastien Dubois Feb 24, 2021    On the importance of non-goals Goals are key to progress, but non-goals are complementary, and help go in the right direction. Here's why. Sebastien Dubois Aug 4, 2023  \nL300: \nL301: #### Comments () \nL302: \nL303: ### Subscribe to Sébastien Dubois\nL304: \nL305: Don't miss out on the latest Knowledge Management news. Sign up now to get access to the library of members-only articles.\nL306: \nL307: Subscribe now\nL308: \nL309:   * Sign up\nL310: \nL311: Passion makes all the difference.\nVisible: 0% - 100%"}]},"command":"click","args":[6],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"c44ab270-773c-4f50-80aa-e5b8b0143154","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"c44ab270-773c-4f50-80aa-e5b8b0143154","children":["90910b26-0ce6-4c9a-ac77-6b82c92d4498"]},{"id":"90910b26-0ce6-4c9a-ac77-6b82c92d4498","message":{"id":"90910b26-0ce6-4c9a-ac77-6b82c92d4498","author":{"role":"assistant","metadata":{}},"create_time":1703480183.175513,"content":{"content_type":"code","language":"unknown","text":"back()"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"e1ab7557-ed13-451e-b7a2-8de9aca7f653","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"e1ab7557-ed13-451e-b7a2-8de9aca7f653","children":["092f5747-d2b7-4ed8-999d-e0b6b76d8882"]},{"id":"092f5747-d2b7-4ed8-999d-e0b6b76d8882","message":{"id":"092f5747-d2b7-4ed8-999d-e0b6b76d8882","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.186066,"content":{"content_type":"tether_browsing_display","result":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Validation | NestJS - A progressive Node.js framework","url":"https://docs.nestjs.com/techniques/validation","text":"\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: "},{"type":"webpage","title":"Custom validation with database in NestJS - DEV Community","url":"https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao","text":"\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: "},{"type":"webpage","title":"Validation - GitHub: Let’s build from here","url":"https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md","text":"\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: "},{"type":"webpage","title":"Injecting request object to a custom validation class in NestJS","url":"https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal","text":"\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: "},{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: "},{"type":"webpage","title":"NestJS and ‘class validator’ cheat sheet - DEV Community","url":"https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao","text":"\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: "},{"type":"webpage","title":"How to implement input validation with NestJS - Sébastien Dubois","url":"https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/","text":"\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: "},{"type":"webpage","title":"How to use class-validator and generate custom error object in nest.js","url":"https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h","text":"\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: "},{"type":"webpage","title":"Building a REST API with NestJS and Prisma: Input Validation ...","url":"https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1","text":"\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: "},{"type":"webpage","title":"NestJS Custom Payload Validation - DEV Community","url":"https://dev.to/shubham_kadam/nestjs-custom-payload-validation-3hh7","text":"\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: "},{"type":"webpage","title":"Mastering Email Validation in NestJS: A Comprehensive Guide","url":"https://emaillistvalidation.com/blog/mastering-email-validation-in-nestjs-a-comprehensive-guide/","text":"\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: "},{"type":"webpage","title":"Custom Card v2 Signature Validation in NestJS - community.hubspot.com","url":"https://community.hubspot.com/t5/APIs-Integrations/Custom-Card-v2-Signature-Validation-in-NestJS/m-p/897350","text":"\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"},{"type":"webpage","title":"Search results for query: 'nestjs class-validator custom validation method documentation'","url":"","text":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"}]},"command":"back","args":[],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"90910b26-0ce6-4c9a-ac77-6b82c92d4498","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"90910b26-0ce6-4c9a-ac77-6b82c92d4498","children":["4da87626-aaca-4d09-80fd-db3c79a3aee3"]},{"id":"4da87626-aaca-4d09-80fd-db3c79a3aee3","message":{"id":"4da87626-aaca-4d09-80fd-db3c79a3aee3","author":{"role":"assistant","metadata":{}},"create_time":1703480183.194955,"content":{"content_type":"code","language":"unknown","text":"click(3)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"092f5747-d2b7-4ed8-999d-e0b6b76d8882","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"092f5747-d2b7-4ed8-999d-e0b6b76d8882","children":["ef34b855-867c-4ae6-ab80-9b79a353eebe"]},{"id":"ef34b855-867c-4ae6-ab80-9b79a353eebe","message":{"id":"ef34b855-867c-4ae6-ab80-9b79a353eebe","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.205306,"content":{"content_type":"tether_browsing_display","result":"L0: \nL1: URL: https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal\nL2:   \nL3: \nL4:   【0†Skip to content】 \nL5: \nL6: Navigation menu 【1† 】 \nL7: \nL8:  Search\nL9: \nL10: 【2† Search 】 \nL11: \nL12:   【3† Log in 】  【4† Create account 】 \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30: 【5† Share to Twitter †twitter.com】 【6† Share to LinkedIn †www.linkedin.com】 【7† Share to Reddit †www.reddit.com】 【8† Share to Hacker News †news.ycombinator.com】 【9† Share to Facebook †www.facebook.com】 【10† Share to Mastodon †toot.kytta.dev】 \nL31: \nL32:  Share Post via...  【11†Report Abuse】 \nL33: \nL34:   【12† †res.cloudinary.com】 \nL35: \nL36: [Image 6: Krzysztof Szala]\nL37: \nL38: 【13†Krzysztof Szala】 \nL39: \nL40: Posted on May 12, 2021 • Updated on Mar 29, 2022\nL41: \nL42: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL43: \nL44: #  Injecting request object to a custom validation class in NestJS \nL45: \nL46: 【14†# nestjs】 【15†# typescript】 【16†# javascript】 【17†# node】 \nL47: \nL48: ##  【18†Validation tricks in NestJS (4 Part Series)】 \nL49: \nL50: 【19† 1 Custom validation with database in NestJS 】 【20† 2 Validating nested objects with class-validator in NestJS 】 【21† 3 Validating numeric query parameters in NestJS 】 【22† 4 Injecting request object to a custom validation class in NestJS 】 \nL51: \nL52: I'm a big fan of how NestJS handle validation using class-validator library. There are many advantages of using an external library for validation. For most of the typical cases default integration via `ValidationPipe` is good enough. But as you know, daily work likes to verify and challenge us.\nL53: \nL54: A few days ago I had a specific need – I needed to validate something with ValidatorPipe and class-validator library, but one of the validation factors, was user ID. In this project, user ID is pulled out from JWT token, during the authorization process, and added to the request object.\nL55: \nL56: My first thought was – just use the Injection Request Scope, like we can do it in NestJS services:  \nL57: \nL58:     constructor(@Inject(REQUEST) private request: Request) {}\nL59: \nL60: Enter fullscreen mode Exit fullscreen mode\nL61: \nL62: Obviously – it doesn't work, otherwise this article wouldn't be here. 【23†Here is a short explanation†github.com】 made by NestJS creator, Kamil Myśliwiec: \nL63: \nL64: [Image 12: image]\nL65: \nL66: Ok. So, there is basically no simple way to get request object data in custom validation constraint. But there is a way around! Not perfect, but it works. And if it can't be pretty, at least it should do its job. What steps we need to take, to achieve it?\nL67: \nL68:   1. Create Interceptor, which will add the User Object to the request type you need (Query, Body or Param)\nL69:   2. Write your Validator Constraint, Extended Validation Arguments interface, use the User data you need.\nL70:   3. Create Pipe, which will strip the request type object from User data context.\nL71:   4. Create the appropriate decorators, one for each type of request.\nL72:   5. Use newly created decorators in Controllers, when you need to \"inject\" User data to your validation class.\nL73: \nL74: Not great, not terrible. Right?  \nL75: [Image 13: image]\nL76: \nL77: ##  【24† 】 Interceptor \nL78: \nL79: Create Interceptor, which will add User Object to request type you need (Query, Body or Param). For the demonstration purposes, I assume you store your User Object in `request.user` attribute.  \nL80: \nL81:     export const REQUEST_CONTEXT = '_requestContext';\nL82: \nL83:     @Injectable()\nL84:     export class InjectUserInterceptor implements NestInterceptor {\nL85:       constructor(private type?: Nullable\u003c'query' | 'body' | 'param'\u003e) {}\nL86: \nL87:       intercept(context: ExecutionContext, next: CallHandler): Observable\u003cany\u003e {\nL88:         const request = context.switchToHttp().getRequest();\nL89: \nL90:         if (this.type \u0026\u0026 request[this.type]) {\nL91:           request[this.type][REQUEST_CONTEXT] = {\nL92:             user: request.user,\nL93:           };\nL94:         }\nL95: \nL96:         return next.handle();\nL97:       }\nL98:     }\nL99: \nL100: Enter fullscreen mode Exit fullscreen mode\nL101: \nL102: ##  【25† 】 Custom validation decorator \nL103: \nL104: Write your Validator Constraint and custom decorator, Extended Validation Arguments interface, use the User data you need.  \nL105: \nL106:     @ValidatorConstraint({ async: true })\nL107:     @Injectable()\nL108:     export class IsUserCommentValidatorConstraint implements ValidatorConstraintInterface {\nL109:       constructor(private commentsRepository: CommentsRepository) {}\nL110: \nL111:       async validate(commentId: number, args?: ExtendedValidationArguments) {\nL112:         const userId = args?.object[REQUEST_CONTEXT].user.id;\nL113: \nL114:         if (userId \u0026\u0026 Number.isInteger(commentId)) {\nL115:           const comment = await this.commentsRepository.findByUserId(userId, commentId); // Checking if comment belongs to selected user\nL116: \nL117:           if (!comment) {\nL118:             return false;\nL119:           }\nL120:         }\nL121: \nL122:         return true;\nL123:       }\nL124: \nL125:       defaultMessage(): string {\nL126:         return 'The comment does not belong to the user';\nL127:       }\nL128:     }\nL129: \nL130:     export function IsUserComment(validationOptions?: ValidationOptions) {\nL131:       return function (object: any, propertyName: string) {\nL132:         registerDecorator({\nL133:           name: 'IsUserComment',\nL134:           target: object.constructor,\nL135:           propertyName: propertyName,\nL136:           options: validationOptions,\nL137:           validator: IsUserCommentValidatorConstraint,\nL138:         });\nL139:       };\nL140:     }\nL141: \nL142: Enter fullscreen mode Exit fullscreen mode\nL143: \nL144: If you don't know how to inject dependencies into a custom validator in class-validator library, 【19†this article】 can help you.\nL145: \nL146: My `ExtendedValidationArguments` interface looks like this:  \nL147: \nL148:     export interface ExtendedValidationArguments extends ValidationArguments {\nL149:       object: {\nL150:         [REQUEST_CONTEXT]: {\nL151:           user: IUser; // IUser is my interface for User class\nL152:         };\nL153:       };\nL154:     }\nL155: \nL156: Enter fullscreen mode Exit fullscreen mode\nL157: \nL158: It allows me to use valid typing in `ValidatorConstraint`. Without it, TypeScript will print out an error, that the `_requestContext` property doesn't exist.\nL159: \nL160: ##  【26† 】 Stripping Pipe \nL161: \nL162: Create Pipe, which will strip the request type object from User data context. If we don't do that, our DTO object will contain attached previously request data. We don't want that to happen. I'm using here one of the `lodash` function – 【27†omit()†lodash.com】. It allows removing chosen properties from an object.  \nL163: \nL164:     @Injectable()\nL165:     export class StripRequestContextPipe implements PipeTransform {\nL166:       transform(value: any) {\nL167:         return omit(value, REQUEST_CONTEXT);\nL168:       }\nL169:     }\nL170: \nL171: Enter fullscreen mode Exit fullscreen mode\nL172: \nL173: ##  【28† 】 New decorators \nL174: \nL175: Creating new decorators is not necessary, but it's definitely a more clean and DRY approach than manually adding Interceptors and Pipes to the methods. We're going to use NestJS built-in function – `applyDecorators`, which 【29†allows merging multiple different decorators into a new one†docs.nestjs.com】.  \nL176: \nL177:     export function InjectUserToQuery() {\nL178:       return applyDecorators(InjectUserTo('query'));\nL179:     }\nL180: \nL181:     export function InjectUserToBody() {\nL182:       return applyDecorators(InjectUserTo('body'));\nL183:     }\nL184: \nL185:     export function InjectUserToParam() {\nL186:       return applyDecorators(InjectUserTo('params'));\nL187:     }\nL188: \nL189:     export function InjectUserTo(context: 'query' | 'body' | 'params') {\nL190:       return applyDecorators(UseInterceptors(new InjectUserInterceptor(context)), UsePipes(StripRequestContextPipe));\nL191:     }\nL192: \nL193: Enter fullscreen mode Exit fullscreen mode\nL194: \nL195: To add your user data, just decorate your controller's method with one of the above decorators.  \nL196: \nL197:       @InjectUserToParam()\nL198:       async edit(@Param() params: EditParams){}\nL199: \nL200: Enter fullscreen mode Exit fullscreen mode\nL201: \nL202: Now, if you wanted to use your `IsUserComment` decorator in `EditParams`, you will be able to access injected user data.  \nL203: \nL204:     export class EditParams {\nL205:       @IsUserComment()\nL206:       commentId: number;\nL207:     }\nL208: \nL209: Enter fullscreen mode Exit fullscreen mode\nL210: \nL211: And that's all! You can use this method, to add any data from the request object to your custom validation class. Hope you find it helpful!\nL212: \nL213: You can find an 【30†example repository on my GitHub†github.com】.\nL214: \nL215: In case you use in your `ValidationPipe` `whitelist: true` parameter, and above example doesn't work for you – 【31†check this issue†github.com】.\nL216: \nL217: This article is highly inspired by the idea I've found in 【32†this comment†github.com】 on GitHub.\nL218: \nL219: PS. It's just proof of concept, and this comment ownership validation is a simple example of usage.\nL220: \nL221: ##  【18†Validation tricks in NestJS (4 Part Series)】 \nL222: \nL223: 【19† 1 Custom validation with database in NestJS 】 【20† 2 Validating nested objects with class-validator in NestJS 】 【21† 3 Validating numeric query parameters in NestJS 】 【22† 4 Injecting request object to a custom validation class in NestJS 】 \nL224: \nL225: ##  Top comments (20)\nL226: \nL227: Subscribe\nL228: \nL229:     [Image 14: pic] \nL230: \nL231: Personal Trusted User\nL232: \nL233: 【33† Create template 】 \nL234: \nL235: Templates let you quickly answer FAQs or store snippets for re-use.\nL236: \nL237: Submit Preview 【34†Dismiss】 \nL238: \nL239:   Collapse Expand\nL240: \nL241: 【35† 】 \nL242: \nL243: 【35† Walid-Gerges 】 \nL244: \nL245:  Walid-Gerges \nL246: \nL247: 【35† Walid-Gerges 】 \nL248: \nL249: Follow\nL250: \nL251:   * Joined \nL252: \nL253: Jul 26, 2021\nL254: \nL255: • 【36† May 26 '22 】 \nL256: \nL257:  Dropdown menu\nL258: \nL259:   * 【36†Copy link】\nL260:   *   * Hide \nL261:   *   *   * \nL262: \nL263: You can go a step forward and use request context.\nL264: \nL265: 【37†npmjs.com/package/@medibloc/nestjs...†www.npmjs.com】\nL266: \nL267: Thanks for your tips, it helped me.\nL268: \nL269:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL270: \nL271: Collapse Expand\nL272: \nL273: 【38† 】 \nL274: \nL275: 【38† Monirul Islam 】 \nL276: \nL277:  Monirul Islam \nL278: \nL279: 【38† Monirul Islam 】 \nL280: \nL281: Follow\nL282: \nL283: Full Stack Developer. Making the web awesome since 2018. \nL284: \nL285:   * Location \nL286: \nL287: Dhaka,Bangladesh \nL288: \nL289:   * Education \nL290: \nL291: Jahangirnagar University \nL292: \nL293:   * Work \nL294: \nL295: Sr. Software Engineer L-I at Vivasoft Ltd. \nL296: \nL297:   * Joined \nL298: \nL299: Sep 6, 2021\nL300: \nL301: • 【39† Sep 19 '21 】 \nL302: \nL303:  Dropdown menu\nL304: \nL305:   * 【39†Copy link】\nL306:   *   * Hide \nL307:   *   *   * \nL308: \nL309: this is not working ValidationArguments does not hold REQUEST_CONTEXT\nL310: \nL311:  Like comment:  Like comment:  Like  Comment button Reply \nL312: \nL313: Collapse Expand\nL314: \nL315: 【13† 】 \nL316: \nL317: 【13† Krzysztof Szala 】 \nL318: \nL319:  Krzysztof Szala \nL320: \nL321: 【13† Krzysztof Szala 】 \nL322: \nL323: Follow\nL324: \nL325: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL326: \nL327:   * Location \nL328: \nL329: Silesia \nL330: \nL331:   * Joined \nL332: \nL333: May 30, 2020\nL334: \nL335: • 【40† Sep 20 '21 】 \nL336: \nL337:  Dropdown menu\nL338: \nL339:   * 【40†Copy link】\nL340:   *   * Hide \nL341:   *   *   * \nL342: \nL343: There was obviously typo in decorator composition class. Instead of `AddUseTo`, there should be `InjectUserTo`. Please try if it works for you now.\nL344: \nL345:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL346: \nL347: Collapse Expand\nL348: \nL349: 【13† 】 \nL350: \nL351: 【13† Krzysztof Szala 】 \nL352: \nL353:  Krzysztof Szala \nL354: \nL355: 【13† Krzysztof Szala 】 \nL356: \nL357: Follow\nL358: \nL359: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL360: \nL361:   * Location \nL362: \nL363: Silesia \nL364: \nL365:   * Joined \nL366: \nL367: May 30, 2020\nL368: \nL369: • 【41† Sep 20 '21 • Edited on Sep 20 • Edited 】 \nL370: \nL371:  Dropdown menu\nL372: \nL373:   * 【41†Copy link】\nL374:   *   * Hide \nL375:   *   *   * \nL376: \nL377: Are you sure you created interceptor, which injects the REQUEST_CONTEXT? I'm using similar code in my production-ready app and it works for me.\nL378: \nL379:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL380: \nL381: Collapse Expand\nL382: \nL383: 【38† 】 \nL384: \nL385: 【38† Monirul Islam 】 \nL386: \nL387:  Monirul Islam \nL388: \nL389: 【38† Monirul Islam 】 \nL390: \nL391: Follow\nL392: \nL393: Full Stack Developer. Making the web awesome since 2018. \nL394: \nL395:   * Location \nL396: \nL397: Dhaka,Bangladesh \nL398: \nL399:   * Education \nL400: \nL401: Jahangirnagar University \nL402: \nL403:   * Work \nL404: \nL405: Sr. Software Engineer L-I at Vivasoft Ltd. \nL406: \nL407:   * Joined \nL408: \nL409: Sep 6, 2021\nL410: \nL411: • 【42† Sep 20 '21 】 \nL412: \nL413:  Dropdown menu\nL414: \nL415:   * 【42†Copy link】\nL416:   *   * Hide \nL417:   *   *   * \nL418: \nL419: yes i am using but its not working btw.I did exactly the way you said\nL420: \nL421:  Like comment:  Like comment:  Like  Thread Thread \nL422: \nL423: 【38† 】 \nL424: \nL425: 【38† Monirul Islam 】 \nL426: \nL427:  Monirul Islam \nL428: \nL429: 【38† Monirul Islam 】 \nL430: \nL431: Follow\nL432: \nL433: Full Stack Developer. Making the web awesome since 2018. \nL434: \nL435:   * Location \nL436: \nL437: Dhaka,Bangladesh \nL438: \nL439:   * Education \nL440: \nL441: Jahangirnagar University \nL442: \nL443:   * Work \nL444: \nL445: Sr. Software Engineer L-I at Vivasoft Ltd. \nL446: \nL447:   * Joined \nL448: \nL449: Sep 6, 2021\nL450: \nL451: • 【43† Sep 20 '21 】 \nL452: \nL453:  Dropdown menu\nL454: \nL455:   * 【43†Copy link】\nL456:   *   * Hide \nL457:   *   *   * \nL458: \nL459: even console logged the args but REQUEST_CONTEXT returns undefined\nL460: \nL461:  Like comment:  Like comment:  1 like Like  Thread Thread \nL462: \nL463: 【44† 】 \nL464: \nL465: 【44† Siavash Habil 】 \nL466: \nL467:  Siavash Habil \nL468: \nL469: 【44† Siavash Habil 】 \nL470: \nL471: Follow\nL472: \nL473:   * Joined \nL474: \nL475: Mar 29, 2022\nL476: \nL477: • 【45† Mar 29 '22 】 \nL478: \nL479:  Dropdown menu\nL480: \nL481:   * 【45†Copy link】\nL482:   *   * Hide \nL483:   *   *   * \nL484: \nL485: 【38†@monirul017】 【13†@avantar】   \nL486: I had exactly same problem and after investigating it is happening because of `{whitelist: true}` of ValidationPipe and when you set it to false it will working properly but I didn't continue in this way because I want to whitelist the properties so temporary I added `_requestContext` to the related DTO file that I used in my controller and added it as an @IsOptional() decorator  \nL487: \nL488:     import { REQUEST_CONTEXT } from '../../../interceptors/inject-request-param.interceptor';\nL489: \nL490:       @IsOptional()\nL491:       \\[REQUEST_CONTEXT\\]: any;\nL492: \nL493: Enter fullscreen mode Exit fullscreen mode\nL494: \nL495: Ignore \"\\\" from the above code.\nL496: \nL497: For others trying to use this article as a solution continue using from attached repository.\nL498: \nL499: At the end thank you 【13†@avantar】 for your solution.\nL500: \nL501:  Like comment:  Like comment:  3 likes Like  Thread Thread \nL502: \nL503: 【13† 】 \nL504: \nL505: 【13† Krzysztof Szala 】 \nL506: \nL507:  Krzysztof Szala \nL508: \nL509: 【13† Krzysztof Szala 】 \nL510: \nL511: Follow\nL512: \nL513: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL514: \nL515:   * Location \nL516: \nL517: Silesia \nL518: \nL519:   * Joined \nL520: \nL521: May 30, 2020\nL522: \nL523: • 【46† Mar 29 '22 】 \nL524: \nL525:  Dropdown menu\nL526: \nL527:   * 【46†Copy link】\nL528:   *   * Hide \nL529:   *   *   * \nL530: \nL531: Thank you, 【44†@siavash_habil】! This can be helpful as well.\nL532: \nL533: 【31†github.com/AvantaR/nestjs-validati...†github.com】\nL534: \nL535:  Like comment:  Like comment:  2 likes Like  Thread Thread \nL536: \nL537: 【44† 】 \nL538: \nL539: 【44† Siavash Habil 】 \nL540: \nL541:  Siavash Habil \nL542: \nL543: 【44† Siavash Habil 】 \nL544: \nL545: Follow\nL546: \nL547:   * Joined \nL548: \nL549: Mar 29, 2022\nL550: \nL551: • 【47† Mar 29 '22 】 \nL552: \nL553:  Dropdown menu\nL554: \nL555:   * 【47†Copy link】\nL556:   *   * Hide \nL557:   *   *   * \nL558: \nL559: 【13†@avantar】 This is almost happened at the same time for both of us because I solved it about 20 hours ago. :)  \nL560: Thank you for sharing.\nL561: \nL562:  Like comment:  Like comment:  1 like Like  Thread Thread \nL563: \nL564: 【13† 】 \nL565: \nL566: 【13† Krzysztof Szala 】 \nL567: \nL568:  Krzysztof Szala \nL569: \nL570: 【13† Krzysztof Szala 】 \nL571: \nL572: Follow\nL573: \nL574: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL575: \nL576:   * Location \nL577: \nL578: Silesia \nL579: \nL580:   * Joined \nL581: \nL582: May 30, 2020\nL583: \nL584: • 【48† Mar 29 '22 】 \nL585: \nL586:  Dropdown menu\nL587: \nL588:   * 【48†Copy link】\nL589:   *   * Hide \nL590:   *   *   * \nL591: \nL592: What a coincidence! Magic \nL593: \nL594:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL595: \nL596: Collapse Expand\nL597: \nL598: 【49† 】 \nL599: \nL600: 【49† tkssharma 】 \nL601: \nL602:  tkssharma \nL603: \nL604: 【49† tkssharma 】 \nL605: \nL606: Follow\nL607: \nL608: Hi, I’m Tarun. I help people to make a better world by building apps. I am Publisher, Trainer Developer, working on Enterprise and open source Technologies JavaScript frameworks (React Angular) \nL609: \nL610:   * Email \nL611: \nL612: 【50†tarun.softengg@gmail.com†mailto:tarun.softengg@gmail.com】 \nL613: \nL614:   * Location \nL615: \nL616: Delhi, India \nL617: \nL618:   * Work \nL619: \nL620: Lead Engineer \nL621: \nL622:   * Joined \nL623: \nL624: Nov 5, 2018\nL625: \nL626: • 【51† Sep 10 '21 】 \nL627: \nL628:  Dropdown menu\nL629: \nL630:   * 【51†Copy link】\nL631:   *   * Hide \nL632:   *   *   * \nL633: \nL634: this is awesome but not sure if i want to use this !! not a clean solution \nL635: \nL636:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL637: \nL638: Collapse Expand\nL639: \nL640: 【13† 】 \nL641: \nL642: 【13† Krzysztof Szala 】 \nL643: \nL644:  Krzysztof Szala \nL645: \nL646: 【13† Krzysztof Szala 】 \nL647: \nL648: Follow\nL649: \nL650: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL651: \nL652:   * Location \nL653: \nL654: Silesia \nL655: \nL656:   * Joined \nL657: \nL658: May 30, 2020\nL659: \nL660: • 【52† Sep 10 '21 】 \nL661: \nL662:  Dropdown menu\nL663: \nL664:   * 【52†Copy link】\nL665:   *   * Hide \nL666:   *   *   * \nL667: \nL668: Totally agree, but sometimes we need to do something dirty way ‍♂️ Thanks for your feedback! \nL669: \nL670:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL671: \nL672: Collapse Expand\nL673: \nL674: 【53† 】 \nL675: \nL676: 【53† Dolphine Dev 】 \nL677: \nL678:  Dolphine Dev \nL679: \nL680: 【53† Dolphine Dev 】 \nL681: \nL682: Follow\nL683: \nL684:   * Joined \nL685: \nL686: Aug 4, 2023\nL687: \nL688: • 【54† Aug 4 • Edited on Aug 4 • Edited 】 \nL689: \nL690:  Dropdown menu\nL691: \nL692:   * 【54†Copy link】\nL693:   *   * Hide \nL694:   *   *   * \nL695: \nL696: When using @ValidateNested(), the `args?.object[REQUEST_CONTEXT]` is undefined because the context passed to the nested validation is not the same as the one at the top level.\nL697: \nL698:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL699: \nL700: Collapse Expand\nL701: \nL702: 【55† 】 \nL703: \nL704: 【55† Wahyu Baskara 】 \nL705: \nL706:  Wahyu Baskara \nL707: \nL708: 【55† Wahyu Baskara 】 \nL709: \nL710: Follow\nL711: \nL712:   * Joined \nL713: \nL714: Apr 25, 2022\nL715: \nL716: • 【56† Aug 4 】 \nL717: \nL718:  Dropdown menu\nL719: \nL720:   * 【56†Copy link】\nL721:   *   * Hide \nL722:   *   *   * \nL723: \nL724: ValidationArguments does not hold REQUEST_CONTEXT when using nested validation object\nL725: \nL726:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL727: \nL728: Collapse Expand\nL729: \nL730: 【57† 】 \nL731: \nL732: 【57† Xjsny 】 \nL733: \nL734:  Xjsny \nL735: \nL736: 【57† Xjsny 】 \nL737: \nL738: Follow\nL739: \nL740:   * Joined \nL741: \nL742: Jun 15, 2022\nL743: \nL744: • 【58† Jun 15 '22 】 \nL745: \nL746:  Dropdown menu\nL747: \nL748:   * 【58†Copy link】\nL749:   *   * Hide \nL750:   *   *   * \nL751: \nL752: It didn’t work if I request data with multipart/form-data. Is there any solution for form data request.\nL753: \nL754:  Like comment:  Like comment:  Like  Comment button Reply \nL755: \nL756: Collapse Expand\nL757: \nL758: 【59† 】 \nL759: \nL760: 【59† htdai 】 \nL761: \nL762:  htdai \nL763: \nL764: 【59† htdai 】 \nL765: \nL766: Follow\nL767: \nL768: Full-stack Overflow Copyist \nL769: \nL770:   * Joined \nL771: \nL772: Mar 28, 2023\nL773: \nL774: • 【60† Mar 28 】 \nL775: \nL776:  Dropdown menu\nL777: \nL778:   * 【60†Copy link】\nL779:   *   * Hide \nL780:   *   *   * \nL781: \nL782: 【61†stackoverflow.com/a/75139788†stackoverflow.com】\nL783: \nL784: Maybe it's late but I found the solution for inject current user into body when using form-data  \nL785: I have tested and it works perfectly for me\nL786: \nL787:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL788: \nL789: Collapse Expand\nL790: \nL791: 【62† 】 \nL792: \nL793: 【62† Szymon Sukiennik 】 \nL794: \nL795:  Szymon Sukiennik \nL796: \nL797: 【62† Szymon Sukiennik 】 \nL798: \nL799: Follow\nL800: \nL801:   * Joined \nL802: \nL803: Nov 29, 2021\nL804: \nL805: • 【63† Nov 29 '21 】 \nL806: \nL807:  Dropdown menu\nL808: \nL809:   * 【63†Copy link】\nL810:   *   * Hide \nL811:   *   *   * \nL812: \nL813: Did you ever managed to port a similar approach to graphql in Nest? Namely, to have access to part or even whole gql context inside validator or validation rule?\nL814: \nL815:  Like comment:  Like comment:  Like  Comment button Reply \nL816: \nL817: Collapse Expand\nL818: \nL819: 【13† 】 \nL820: \nL821: 【13† Krzysztof Szala 】 \nL822: \nL823:  Krzysztof Szala \nL824: \nL825: 【13† Krzysztof Szala 】 \nL826: \nL827: Follow\nL828: \nL829: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL830: \nL831:   * Location \nL832: \nL833: Silesia \nL834: \nL835:   * Joined \nL836: \nL837: May 30, 2020\nL838: \nL839: • 【64† Mar 28 '22 】 \nL840: \nL841:  Dropdown menu\nL842: \nL843:   * 【64†Copy link】\nL844:   *   * Hide \nL845:   *   *   * \nL846: \nL847: Hi!\nL848: \nL849: No, I haven't tried to use it with GraphQL, sorry.\nL850: \nL851:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL852: \nL853: Collapse Expand\nL854: \nL855: 【65† 】 \nL856: \nL857: 【65† davidN96 】 \nL858: \nL859:  davidN96 \nL860: \nL861: 【65† davidN96 】 \nL862: \nL863: Follow\nL864: \nL865:   * Joined \nL866: \nL867: Apr 25, 2021\nL868: \nL869: • 【66† Jun 23 '21 】 \nL870: \nL871:  Dropdown menu\nL872: \nL873:   * 【66†Copy link】\nL874:   *   * Hide \nL875:   *   *   * \nL876: \nL877: Hey! Thank you for a great article!\nL878: \nL879:  Like comment:  Like comment\nVisible: 0% - 84%","summary":"Injecting request object to a custom validation class in NestJS - DEV Community (dev.to)\n","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Injecting request object to a custom validation class in NestJS - DEV Community","url":"https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal","text":"L0: \nL1: URL: https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal\nL2:   \nL3: \nL4:   Skip to content \nL5: \nL6: Navigation menu   \nL7: \nL8:  Search\nL9: \nL10:  Search  \nL11: \nL12:    Log in    Create account  \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30:  Share to Twitter   Share to LinkedIn   Share to Reddit   Share to Hacker News   Share to Facebook   Share to Mastodon  \nL31: \nL32:  Share Post via...  Report Abuse \nL33: \nL34:     \nL35: \nL36: [Image 6: Krzysztof Szala]\nL37: \nL38: Krzysztof Szala \nL39: \nL40: Posted on May 12, 2021 • Updated on Mar 29, 2022\nL41: \nL42: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL43: \nL44: #  Injecting request object to a custom validation class in NestJS \nL45: \nL46: # nestjs # typescript # javascript # node \nL47: \nL48: ##  Validation tricks in NestJS (4 Part Series) \nL49: \nL50:  1 Custom validation with database in NestJS   2 Validating nested objects with class-validator in NestJS   3 Validating numeric query parameters in NestJS   4 Injecting request object to a custom validation class in NestJS  \nL51: \nL52: I'm a big fan of how NestJS handle validation using class-validator library. There are many advantages of using an external library for validation. For most of the typical cases default integration via `ValidationPipe` is good enough. But as you know, daily work likes to verify and challenge us.\nL53: \nL54: A few days ago I had a specific need – I needed to validate something with ValidatorPipe and class-validator library, but one of the validation factors, was user ID. In this project, user ID is pulled out from JWT token, during the authorization process, and added to the request object.\nL55: \nL56: My first thought was – just use the Injection Request Scope, like we can do it in NestJS services:  \nL57: \nL58:     constructor(@Inject(REQUEST) private request: Request) {}\nL59: \nL60: Enter fullscreen mode Exit fullscreen mode\nL61: \nL62: Obviously – it doesn't work, otherwise this article wouldn't be here. Here is a short explanation made by NestJS creator, Kamil Myśliwiec: \nL63: \nL64: [Image 12: image]\nL65: \nL66: Ok. So, there is basically no simple way to get request object data in custom validation constraint. But there is a way around! Not perfect, but it works. And if it can't be pretty, at least it should do its job. What steps we need to take, to achieve it?\nL67: \nL68:   1. Create Interceptor, which will add the User Object to the request type you need (Query, Body or Param)\nL69:   2. Write your Validator Constraint, Extended Validation Arguments interface, use the User data you need.\nL70:   3. Create Pipe, which will strip the request type object from User data context.\nL71:   4. Create the appropriate decorators, one for each type of request.\nL72:   5. Use newly created decorators in Controllers, when you need to \"inject\" User data to your validation class.\nL73: \nL74: Not great, not terrible. Right?  \nL75: [Image 13: image]\nL76: \nL77: ##    Interceptor \nL78: \nL79: Create Interceptor, which will add User Object to request type you need (Query, Body or Param). For the demonstration purposes, I assume you store your User Object in `request.user` attribute.  \nL80: \nL81:     export const REQUEST_CONTEXT = '_requestContext';\nL82: \nL83:     @Injectable()\nL84:     export class InjectUserInterceptor implements NestInterceptor {\nL85:       constructor(private type?: Nullable\u003c'query' | 'body' | 'param'\u003e) {}\nL86: \nL87:       intercept(context: ExecutionContext, next: CallHandler): Observable\u003cany\u003e {\nL88:         const request = context.switchToHttp().getRequest();\nL89: \nL90:         if (this.type \u0026\u0026 request[this.type]) {\nL91:           request[this.type][REQUEST_CONTEXT] = {\nL92:             user: request.user,\nL93:           };\nL94:         }\nL95: \nL96:         return next.handle();\nL97:       }\nL98:     }\nL99: \nL100: Enter fullscreen mode Exit fullscreen mode\nL101: \nL102: ##    Custom validation decorator \nL103: \nL104: Write your Validator Constraint and custom decorator, Extended Validation Arguments interface, use the User data you need.  \nL105: \nL106:     @ValidatorConstraint({ async: true })\nL107:     @Injectable()\nL108:     export class IsUserCommentValidatorConstraint implements ValidatorConstraintInterface {\nL109:       constructor(private commentsRepository: CommentsRepository) {}\nL110: \nL111:       async validate(commentId: number, args?: ExtendedValidationArguments) {\nL112:         const userId = args?.object[REQUEST_CONTEXT].user.id;\nL113: \nL114:         if (userId \u0026\u0026 Number.isInteger(commentId)) {\nL115:           const comment = await this.commentsRepository.findByUserId(userId, commentId); // Checking if comment belongs to selected user\nL116: \nL117:           if (!comment) {\nL118:             return false;\nL119:           }\nL120:         }\nL121: \nL122:         return true;\nL123:       }\nL124: \nL125:       defaultMessage(): string {\nL126:         return 'The comment does not belong to the user';\nL127:       }\nL128:     }\nL129: \nL130:     export function IsUserComment(validationOptions?: ValidationOptions) {\nL131:       return function (object: any, propertyName: string) {\nL132:         registerDecorator({\nL133:           name: 'IsUserComment',\nL134:           target: object.constructor,\nL135:           propertyName: propertyName,\nL136:           options: validationOptions,\nL137:           validator: IsUserCommentValidatorConstraint,\nL138:         });\nL139:       };\nL140:     }\nL141: \nL142: Enter fullscreen mode Exit fullscreen mode\nL143: \nL144: If you don't know how to inject dependencies into a custom validator in class-validator library, this article can help you.\nL145: \nL146: My `ExtendedValidationArguments` interface looks like this:  \nL147: \nL148:     export interface ExtendedValidationArguments extends ValidationArguments {\nL149:       object: {\nL150:         [REQUEST_CONTEXT]: {\nL151:           user: IUser; // IUser is my interface for User class\nL152:         };\nL153:       };\nL154:     }\nL155: \nL156: Enter fullscreen mode Exit fullscreen mode\nL157: \nL158: It allows me to use valid typing in `ValidatorConstraint`. Without it, TypeScript will print out an error, that the `_requestContext` property doesn't exist.\nL159: \nL160: ##    Stripping Pipe \nL161: \nL162: Create Pipe, which will strip the request type object from User data context. If we don't do that, our DTO object will contain attached previously request data. We don't want that to happen. I'm using here one of the `lodash` function – omit(). It allows removing chosen properties from an object.  \nL163: \nL164:     @Injectable()\nL165:     export class StripRequestContextPipe implements PipeTransform {\nL166:       transform(value: any) {\nL167:         return omit(value, REQUEST_CONTEXT);\nL168:       }\nL169:     }\nL170: \nL171: Enter fullscreen mode Exit fullscreen mode\nL172: \nL173: ##    New decorators \nL174: \nL175: Creating new decorators is not necessary, but it's definitely a more clean and DRY approach than manually adding Interceptors and Pipes to the methods. We're going to use NestJS built-in function – `applyDecorators`, which allows merging multiple different decorators into a new one.  \nL176: \nL177:     export function InjectUserToQuery() {\nL178:       return applyDecorators(InjectUserTo('query'));\nL179:     }\nL180: \nL181:     export function InjectUserToBody() {\nL182:       return applyDecorators(InjectUserTo('body'));\nL183:     }\nL184: \nL185:     export function InjectUserToParam() {\nL186:       return applyDecorators(InjectUserTo('params'));\nL187:     }\nL188: \nL189:     export function InjectUserTo(context: 'query' | 'body' | 'params') {\nL190:       return applyDecorators(UseInterceptors(new InjectUserInterceptor(context)), UsePipes(StripRequestContextPipe));\nL191:     }\nL192: \nL193: Enter fullscreen mode Exit fullscreen mode\nL194: \nL195: To add your user data, just decorate your controller's method with one of the above decorators.  \nL196: \nL197:       @InjectUserToParam()\nL198:       async edit(@Param() params: EditParams){}\nL199: \nL200: Enter fullscreen mode Exit fullscreen mode\nL201: \nL202: Now, if you wanted to use your `IsUserComment` decorator in `EditParams`, you will be able to access injected user data.  \nL203: \nL204:     export class EditParams {\nL205:       @IsUserComment()\nL206:       commentId: number;\nL207:     }\nL208: \nL209: Enter fullscreen mode Exit fullscreen mode\nL210: \nL211: And that's all! You can use this method, to add any data from the request object to your custom validation class. Hope you find it helpful!\nL212: \nL213: You can find an example repository on my GitHub.\nL214: \nL215: In case you use in your `ValidationPipe` `whitelist: true` parameter, and above example doesn't work for you – check this issue.\nL216: \nL217: This article is highly inspired by the idea I've found in this comment on GitHub.\nL218: \nL219: PS. It's just proof of concept, and this comment ownership validation is a simple example of usage.\nL220: \nL221: ##  Validation tricks in NestJS (4 Part Series) \nL222: \nL223:  1 Custom validation with database in NestJS   2 Validating nested objects with class-validator in NestJS   3 Validating numeric query parameters in NestJS   4 Injecting request object to a custom validation class in NestJS  \nL224: \nL225: ##  Top comments (20)\nL226: \nL227: Subscribe\nL228: \nL229:     [Image 14: pic] \nL230: \nL231: Personal Trusted User\nL232: \nL233:  Create template  \nL234: \nL235: Templates let you quickly answer FAQs or store snippets for re-use.\nL236: \nL237: Submit Preview Dismiss \nL238: \nL239:   Collapse Expand\nL240: \nL241:   \nL242: \nL243:  Walid-Gerges  \nL244: \nL245:  Walid-Gerges \nL246: \nL247:  Walid-Gerges  \nL248: \nL249: Follow\nL250: \nL251:   * Joined \nL252: \nL253: Jul 26, 2021\nL254: \nL255: •  May 26 '22  \nL256: \nL257:  Dropdown menu\nL258: \nL259:   * Copy link\nL260:   *   * Hide \nL261:   *   *   * \nL262: \nL263: You can go a step forward and use request context.\nL264: \nL265: npmjs.com/package/@medibloc/nestjs...\nL266: \nL267: Thanks for your tips, it helped me.\nL268: \nL269:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL270: \nL271: Collapse Expand\nL272: \nL273:   \nL274: \nL275:  Monirul Islam  \nL276: \nL277:  Monirul Islam \nL278: \nL279:  Monirul Islam  \nL280: \nL281: Follow\nL282: \nL283: Full Stack Developer. Making the web awesome since 2018. \nL284: \nL285:   * Location \nL286: \nL287: Dhaka,Bangladesh \nL288: \nL289:   * Education \nL290: \nL291: Jahangirnagar University \nL292: \nL293:   * Work \nL294: \nL295: Sr. Software Engineer L-I at Vivasoft Ltd. \nL296: \nL297:   * Joined \nL298: \nL299: Sep 6, 2021\nL300: \nL301: •  Sep 19 '21  \nL302: \nL303:  Dropdown menu\nL304: \nL305:   * Copy link\nL306:   *   * Hide \nL307:   *   *   * \nL308: \nL309: this is not working ValidationArguments does not hold REQUEST_CONTEXT\nL310: \nL311:  Like comment:  Like comment:  Like  Comment button Reply \nL312: \nL313: Collapse Expand\nL314: \nL315:   \nL316: \nL317:  Krzysztof Szala  \nL318: \nL319:  Krzysztof Szala \nL320: \nL321:  Krzysztof Szala  \nL322: \nL323: Follow\nL324: \nL325: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL326: \nL327:   * Location \nL328: \nL329: Silesia \nL330: \nL331:   * Joined \nL332: \nL333: May 30, 2020\nL334: \nL335: •  Sep 20 '21  \nL336: \nL337:  Dropdown menu\nL338: \nL339:   * Copy link\nL340:   *   * Hide \nL341:   *   *   * \nL342: \nL343: There was obviously typo in decorator composition class. Instead of `AddUseTo`, there should be `InjectUserTo`. Please try if it works for you now.\nL344: \nL345:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL346: \nL347: Collapse Expand\nL348: \nL349:   \nL350: \nL351:  Krzysztof Szala  \nL352: \nL353:  Krzysztof Szala \nL354: \nL355:  Krzysztof Szala  \nL356: \nL357: Follow\nL358: \nL359: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL360: \nL361:   * Location \nL362: \nL363: Silesia \nL364: \nL365:   * Joined \nL366: \nL367: May 30, 2020\nL368: \nL369: •  Sep 20 '21 • Edited on Sep 20 • Edited  \nL370: \nL371:  Dropdown menu\nL372: \nL373:   * Copy link\nL374:   *   * Hide \nL375:   *   *   * \nL376: \nL377: Are you sure you created interceptor, which injects the REQUEST_CONTEXT? I'm using similar code in my production-ready app and it works for me.\nL378: \nL379:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL380: \nL381: Collapse Expand\nL382: \nL383:   \nL384: \nL385:  Monirul Islam  \nL386: \nL387:  Monirul Islam \nL388: \nL389:  Monirul Islam  \nL390: \nL391: Follow\nL392: \nL393: Full Stack Developer. Making the web awesome since 2018. \nL394: \nL395:   * Location \nL396: \nL397: Dhaka,Bangladesh \nL398: \nL399:   * Education \nL400: \nL401: Jahangirnagar University \nL402: \nL403:   * Work \nL404: \nL405: Sr. Software Engineer L-I at Vivasoft Ltd. \nL406: \nL407:   * Joined \nL408: \nL409: Sep 6, 2021\nL410: \nL411: •  Sep 20 '21  \nL412: \nL413:  Dropdown menu\nL414: \nL415:   * Copy link\nL416:   *   * Hide \nL417:   *   *   * \nL418: \nL419: yes i am using but its not working btw.I did exactly the way you said\nL420: \nL421:  Like comment:  Like comment:  Like  Thread Thread \nL422: \nL423:   \nL424: \nL425:  Monirul Islam  \nL426: \nL427:  Monirul Islam \nL428: \nL429:  Monirul Islam  \nL430: \nL431: Follow\nL432: \nL433: Full Stack Developer. Making the web awesome since 2018. \nL434: \nL435:   * Location \nL436: \nL437: Dhaka,Bangladesh \nL438: \nL439:   * Education \nL440: \nL441: Jahangirnagar University \nL442: \nL443:   * Work \nL444: \nL445: Sr. Software Engineer L-I at Vivasoft Ltd. \nL446: \nL447:   * Joined \nL448: \nL449: Sep 6, 2021\nL450: \nL451: •  Sep 20 '21  \nL452: \nL453:  Dropdown menu\nL454: \nL455:   * Copy link\nL456:   *   * Hide \nL457:   *   *   * \nL458: \nL459: even console logged the args but REQUEST_CONTEXT returns undefined\nL460: \nL461:  Like comment:  Like comment:  1 like Like  Thread Thread \nL462: \nL463:   \nL464: \nL465:  Siavash Habil  \nL466: \nL467:  Siavash Habil \nL468: \nL469:  Siavash Habil  \nL470: \nL471: Follow\nL472: \nL473:   * Joined \nL474: \nL475: Mar 29, 2022\nL476: \nL477: •  Mar 29 '22  \nL478: \nL479:  Dropdown menu\nL480: \nL481:   * Copy link\nL482:   *   * Hide \nL483:   *   *   * \nL484: \nL485: @monirul017 @avantar   \nL486: I had exactly same problem and after investigating it is happening because of `{whitelist: true}` of ValidationPipe and when you set it to false it will working properly but I didn't continue in this way because I want to whitelist the properties so temporary I added `_requestContext` to the related DTO file that I used in my controller and added it as an @IsOptional() decorator  \nL487: \nL488:     import { REQUEST_CONTEXT } from '../../../interceptors/inject-request-param.interceptor';\nL489: \nL490:       @IsOptional()\nL491:       \\[REQUEST_CONTEXT\\]: any;\nL492: \nL493: Enter fullscreen mode Exit fullscreen mode\nL494: \nL495: Ignore \"\\\" from the above code.\nL496: \nL497: For others trying to use this article as a solution continue using from attached repository.\nL498: \nL499: At the end thank you @avantar for your solution.\nL500: \nL501:  Like comment:  Like comment:  3 likes Like  Thread Thread \nL502: \nL503:   \nL504: \nL505:  Krzysztof Szala  \nL506: \nL507:  Krzysztof Szala \nL508: \nL509:  Krzysztof Szala  \nL510: \nL511: Follow\nL512: \nL513: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL514: \nL515:   * Location \nL516: \nL517: Silesia \nL518: \nL519:   * Joined \nL520: \nL521: May 30, 2020\nL522: \nL523: •  Mar 29 '22  \nL524: \nL525:  Dropdown menu\nL526: \nL527:   * Copy link\nL528:   *   * Hide \nL529:   *   *   * \nL530: \nL531: Thank you, @siavash_habil! This can be helpful as well.\nL532: \nL533: github.com/AvantaR/nestjs-validati...\nL534: \nL535:  Like comment:  Like comment:  2 likes Like  Thread Thread \nL536: \nL537:   \nL538: \nL539:  Siavash Habil  \nL540: \nL541:  Siavash Habil \nL542: \nL543:  Siavash Habil  \nL544: \nL545: Follow\nL546: \nL547:   * Joined \nL548: \nL549: Mar 29, 2022\nL550: \nL551: •  Mar 29 '22  \nL552: \nL553:  Dropdown menu\nL554: \nL555:   * Copy link\nL556:   *   * Hide \nL557:   *   *   * \nL558: \nL559: @avantar This is almost happened at the same time for both of us because I solved it about 20 hours ago. :)  \nL560: Thank you for sharing.\nL561: \nL562:  Like comment:  Like comment:  1 like Like  Thread Thread \nL563: \nL564:   \nL565: \nL566:  Krzysztof Szala  \nL567: \nL568:  Krzysztof Szala \nL569: \nL570:  Krzysztof Szala  \nL571: \nL572: Follow\nL573: \nL574: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL575: \nL576:   * Location \nL577: \nL578: Silesia \nL579: \nL580:   * Joined \nL581: \nL582: May 30, 2020\nL583: \nL584: •  Mar 29 '22  \nL585: \nL586:  Dropdown menu\nL587: \nL588:   * Copy link\nL589:   *   * Hide \nL590:   *   *   * \nL591: \nL592: What a coincidence! Magic \nL593: \nL594:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL595: \nL596: Collapse Expand\nL597: \nL598:   \nL599: \nL600:  tkssharma  \nL601: \nL602:  tkssharma \nL603: \nL604:  tkssharma  \nL605: \nL606: Follow\nL607: \nL608: Hi, I’m Tarun. I help people to make a better world by building apps. I am Publisher, Trainer Developer, working on Enterprise and open source Technologies JavaScript frameworks (React Angular) \nL609: \nL610:   * Email \nL611: \nL612: tarun.softengg@gmail.com \nL613: \nL614:   * Location \nL615: \nL616: Delhi, India \nL617: \nL618:   * Work \nL619: \nL620: Lead Engineer \nL621: \nL622:   * Joined \nL623: \nL624: Nov 5, 2018\nL625: \nL626: •  Sep 10 '21  \nL627: \nL628:  Dropdown menu\nL629: \nL630:   * Copy link\nL631:   *   * Hide \nL632:   *   *   * \nL633: \nL634: this is awesome but not sure if i want to use this !! not a clean solution \nL635: \nL636:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL637: \nL638: Collapse Expand\nL639: \nL640:   \nL641: \nL642:  Krzysztof Szala  \nL643: \nL644:  Krzysztof Szala \nL645: \nL646:  Krzysztof Szala  \nL647: \nL648: Follow\nL649: \nL650: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL651: \nL652:   * Location \nL653: \nL654: Silesia \nL655: \nL656:   * Joined \nL657: \nL658: May 30, 2020\nL659: \nL660: •  Sep 10 '21  \nL661: \nL662:  Dropdown menu\nL663: \nL664:   * Copy link\nL665:   *   * Hide \nL666:   *   *   * \nL667: \nL668: Totally agree, but sometimes we need to do something dirty way ‍♂️ Thanks for your feedback! \nL669: \nL670:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL671: \nL672: Collapse Expand\nL673: \nL674:   \nL675: \nL676:  Dolphine Dev  \nL677: \nL678:  Dolphine Dev \nL679: \nL680:  Dolphine Dev  \nL681: \nL682: Follow\nL683: \nL684:   * Joined \nL685: \nL686: Aug 4, 2023\nL687: \nL688: •  Aug 4 • Edited on Aug 4 • Edited  \nL689: \nL690:  Dropdown menu\nL691: \nL692:   * Copy link\nL693:   *   * Hide \nL694:   *   *   * \nL695: \nL696: When using @ValidateNested(), the `args?.object[REQUEST_CONTEXT]` is undefined because the context passed to the nested validation is not the same as the one at the top level.\nL697: \nL698:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL699: \nL700: Collapse Expand\nL701: \nL702:   \nL703: \nL704:  Wahyu Baskara  \nL705: \nL706:  Wahyu Baskara \nL707: \nL708:  Wahyu Baskara  \nL709: \nL710: Follow\nL711: \nL712:   * Joined \nL713: \nL714: Apr 25, 2022\nL715: \nL716: •  Aug 4  \nL717: \nL718:  Dropdown menu\nL719: \nL720:   * Copy link\nL721:   *   * Hide \nL722:   *   *   * \nL723: \nL724: ValidationArguments does not hold REQUEST_CONTEXT when using nested validation object\nL725: \nL726:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL727: \nL728: Collapse Expand\nL729: \nL730:   \nL731: \nL732:  Xjsny  \nL733: \nL734:  Xjsny \nL735: \nL736:  Xjsny  \nL737: \nL738: Follow\nL739: \nL740:   * Joined \nL741: \nL742: Jun 15, 2022\nL743: \nL744: •  Jun 15 '22  \nL745: \nL746:  Dropdown menu\nL747: \nL748:   * Copy link\nL749:   *   * Hide \nL750:   *   *   * \nL751: \nL752: It didn’t work if I request data with multipart/form-data. Is there any solution for form data request.\nL753: \nL754:  Like comment:  Like comment:  Like  Comment button Reply \nL755: \nL756: Collapse Expand\nL757: \nL758:   \nL759: \nL760:  htdai  \nL761: \nL762:  htdai \nL763: \nL764:  htdai  \nL765: \nL766: Follow\nL767: \nL768: Full-stack Overflow Copyist \nL769: \nL770:   * Joined \nL771: \nL772: Mar 28, 2023\nL773: \nL774: •  Mar 28  \nL775: \nL776:  Dropdown menu\nL777: \nL778:   * Copy link\nL779:   *   * Hide \nL780:   *   *   * \nL781: \nL782: stackoverflow.com/a/75139788\nL783: \nL784: Maybe it's late but I found the solution for inject current user into body when using form-data  \nL785: I have tested and it works perfectly for me\nL786: \nL787:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL788: \nL789: Collapse Expand\nL790: \nL791:   \nL792: \nL793:  Szymon Sukiennik  \nL794: \nL795:  Szymon Sukiennik \nL796: \nL797:  Szymon Sukiennik  \nL798: \nL799: Follow\nL800: \nL801:   * Joined \nL802: \nL803: Nov 29, 2021\nL804: \nL805: •  Nov 29 '21  \nL806: \nL807:  Dropdown menu\nL808: \nL809:   * Copy link\nL810:   *   * Hide \nL811:   *   *   * \nL812: \nL813: Did you ever managed to port a similar approach to graphql in Nest? Namely, to have access to part or even whole gql context inside validator or validation rule?\nL814: \nL815:  Like comment:  Like comment:  Like  Comment button Reply \nL816: \nL817: Collapse Expand\nL818: \nL819:   \nL820: \nL821:  Krzysztof Szala  \nL822: \nL823:  Krzysztof Szala \nL824: \nL825:  Krzysztof Szala  \nL826: \nL827: Follow\nL828: \nL829: PHP and TypeScript developer, currently working at DAZN. Don't want to miss my next article? Just click \nL830: \nL831:   * Location \nL832: \nL833: Silesia \nL834: \nL835:   * Joined \nL836: \nL837: May 30, 2020\nL838: \nL839: •  Mar 28 '22  \nL840: \nL841:  Dropdown menu\nL842: \nL843:   * Copy link\nL844:   *   * Hide \nL845:   *   *   * \nL846: \nL847: Hi!\nL848: \nL849: No, I haven't tried to use it with GraphQL, sorry.\nL850: \nL851:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL852: \nL853: Collapse Expand\nL854: \nL855:   \nL856: \nL857:  davidN96  \nL858: \nL859:  davidN96 \nL860: \nL861:  davidN96  \nL862: \nL863: Follow\nL864: \nL865:   * Joined \nL866: \nL867: Apr 25, 2021\nL868: \nL869: •  Jun 23 '21  \nL870: \nL871:  Dropdown menu\nL872: \nL873:   * Copy link\nL874:   *   * Hide \nL875:   *   *   * \nL876: \nL877: Hey! Thank you for a great article!\nL878: \nL879:  Like comment:  Like comment\nVisible: 0% - 84%"}]},"command":"click","args":[3],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"4da87626-aaca-4d09-80fd-db3c79a3aee3","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"4da87626-aaca-4d09-80fd-db3c79a3aee3","children":["9517698f-527f-4109-8348-b9a68f4532e0"]},{"id":"9517698f-527f-4109-8348-b9a68f4532e0","message":{"id":"9517698f-527f-4109-8348-b9a68f4532e0","author":{"role":"assistant","metadata":{}},"create_time":1703480183.216529,"content":{"content_type":"code","language":"unknown","text":"back()"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"ef34b855-867c-4ae6-ab80-9b79a353eebe","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"ef34b855-867c-4ae6-ab80-9b79a353eebe","children":["1e500484-a305-41d0-a815-90cdf6144f18"]},{"id":"1e500484-a305-41d0-a815-90cdf6144f18","message":{"id":"1e500484-a305-41d0-a815-90cdf6144f18","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.229744,"content":{"content_type":"tether_browsing_display","result":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Validation | NestJS - A progressive Node.js framework","url":"https://docs.nestjs.com/techniques/validation","text":"\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: "},{"type":"webpage","title":"Custom validation with database in NestJS - DEV Community","url":"https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao","text":"\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: "},{"type":"webpage","title":"Validation - GitHub: Let’s build from here","url":"https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md","text":"\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: "},{"type":"webpage","title":"Injecting request object to a custom validation class in NestJS","url":"https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal","text":"\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: "},{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: "},{"type":"webpage","title":"NestJS and ‘class validator’ cheat sheet - DEV Community","url":"https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao","text":"\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: "},{"type":"webpage","title":"How to implement input validation with NestJS - Sébastien Dubois","url":"https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/","text":"\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: "},{"type":"webpage","title":"How to use class-validator and generate custom error object in nest.js","url":"https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h","text":"\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: "},{"type":"webpage","title":"Building a REST API with NestJS and Prisma: Input Validation ...","url":"https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1","text":"\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: "},{"type":"webpage","title":"NestJS Custom Payload Validation - DEV Community","url":"https://dev.to/shubham_kadam/nestjs-custom-payload-validation-3hh7","text":"\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: "},{"type":"webpage","title":"Mastering Email Validation in NestJS: A Comprehensive Guide","url":"https://emaillistvalidation.com/blog/mastering-email-validation-in-nestjs-a-comprehensive-guide/","text":"\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: "},{"type":"webpage","title":"Custom Card v2 Signature Validation in NestJS - community.hubspot.com","url":"https://community.hubspot.com/t5/APIs-Integrations/Custom-Card-v2-Signature-Validation-in-NestJS/m-p/897350","text":"\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"},{"type":"webpage","title":"Search results for query: 'nestjs class-validator custom validation method documentation'","url":"","text":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"}]},"command":"back","args":[],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"9517698f-527f-4109-8348-b9a68f4532e0","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"9517698f-527f-4109-8348-b9a68f4532e0","children":["4aff2089-c41b-4702-8a1c-e4c9f79722fc"]},{"id":"4aff2089-c41b-4702-8a1c-e4c9f79722fc","message":{"id":"4aff2089-c41b-4702-8a1c-e4c9f79722fc","author":{"role":"assistant","metadata":{}},"create_time":1703480183.241577,"content":{"content_type":"code","language":"unknown","text":"click(4)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"1e500484-a305-41d0-a815-90cdf6144f18","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"1e500484-a305-41d0-a815-90cdf6144f18","children":["a4f0184b-a826-484a-a54a-78465cdb0067"]},{"id":"a4f0184b-a826-484a-a54a-78465cdb0067","message":{"id":"a4f0184b-a826-484a-a54a-78465cdb0067","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.254792,"content":{"content_type":"tether_browsing_display","result":"L0: \nL1: URL: https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m\nL2:   \nL3: \nL4:   【0†Skip to content】 \nL5: \nL6: Navigation menu 【1† 】 \nL7: \nL8:  Search\nL9: \nL10: 【2† Search 】 \nL11: \nL12:   【3† Log in 】  【4† Create account 】 \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30: 【5† Share to Twitter †twitter.com】 【6† Share to LinkedIn †www.linkedin.com】 【7† Share to Reddit †www.reddit.com】 【8† Share to Hacker News †news.ycombinator.com】 【9† Share to Facebook †www.facebook.com】 【10† Share to Mastodon †toot.kytta.dev】 \nL31: \nL32:  Share Post via...  【11†Report Abuse】 \nL33: \nL34: [Image 6: Vishnu C Prasad]\nL35: \nL36: 【12†Vishnu C Prasad】 \nL37: \nL38: Posted on Aug 15 • Originally published at 【13†vishnucprasad.Medium†vishnucprasad.medium.com】 \nL39: \nL40: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL41: \nL42: #  Simple Data Validation in NestJS: A Practical Guide \nL43: \nL44: 【14†# nestjs】 【15†# passportjs】 【16†# node】 【17†# typescript】 \nL45: \nL46: [Image 12: NestJS Data Validation]\nL47: \nL48: In modern web applications, data validation plays a crucial role in ensuring the integrity and security of the information being processed. NestJS, a popular Node.js framework, provides a robust and easy-to-use mechanism for data validation, making it easier for developers to handle incoming data and prevent common vulnerabilities like injection attacks or invalid inputs. In this article, we will explore the basics of data validation in NestJS, complete with code examples to illustrate the concepts.\nL49: \nL50: ###  【18† 】 Why Data Validation Matters \nL51: \nL52: Data validation involves checking whether input data conforms to predefined rules or patterns before processing it further. This step helps prevent incorrect or malicious data from compromising the application’s functionality or security. In the context of a NestJS application, proper data validation can help mitigate risks such as:\nL53: \nL54:   1. Injection Attacks: By validating and sanitizing input data, you can prevent SQL injection, NoSQL injection, and other types of code injection attacks.\nL55: \nL56:   2. Invalid Inputs: Avoid errors and exceptions resulting from unexpected data types or formats.\nL57: \nL58:   3. Data Integrity: Ensure that the data being processed adheres to the expected structure and rules, preventing inconsistencies.\nL59: \nL60: ###  【19† 】 Using class-validator with NestJS \nL61: \nL62: NestJS seamlessly integrates with the class-validator library, which provides decorators and utilities for validating data using class-based validation rules. To get started, let's assume we're building an API endpoint to create users. We want to validate the incoming data, such as the user's name and email, before saving it to the database.\nL63: \nL64: ####  【20† 】 Step 1: Install Dependencies \nL65: \nL66: First, create a new NestJS application or navigate to your existing project directory and install the required packages:  \nL67: \nL68:     npm install --save class-validator\nL69: \nL70: Enter fullscreen mode Exit fullscreen mode\nL71: \nL72: ####  【21† 】 Step 2: Create a DTO (Data Transfer Object) \nL73: \nL74: In NestJS, DTOs are used to define the shape of the incoming data and its validation rules. Let’s create a CreateUserDto class to represent the data expected when creating a new user:  \nL75: \nL76:     // src/users/dto/create-user.dto.ts\nL77: \nL78:     import { IsNotEmpty, IsEmail } from 'class-validator';\nL79: \nL80:     export class CreateUserDto {\nL81:       @IsNotEmpty()\nL82:       name: string;\nL83: \nL84:       @IsNotEmpty()\nL85:       @IsEmail()\nL86:       email: string;\nL87:     }\nL88: \nL89: Enter fullscreen mode Exit fullscreen mode\nL90: \nL91: In the CreateUserDto class, we've used the @IsNotEmpty() and @IsEmail() decorators from the class-validator library to specify that the name and email fields should not be empty and the email should be a valid email address.\nL92: \nL93: ####  【22† 】 Step 3: Create the Controller \nL94: \nL95: Now, let’s create a controller to handle the incoming requests and validate the data using the CreateUserDto class:  \nL96: \nL97:     // src/users/users.controller.ts\nL98: \nL99:     import { Controller, Post, Body } from '@nestjs/common';\nL100:     import { CreateUserDto } from './dto/create-user.dto';\nL101: \nL102:     @Controller('users')\nL103:     export class UsersController {\nL104:       @Post()\nL105:       async createUser(@Body() dto: CreateUserDto) {\nL106:         // At this point, \"dto\" has already been validated\nL107:         // You can now proceed with processing and saving the user data\nL108:         return 'User created successfully';\nL109:       }\nL110:     }\nL111: \nL112: Enter fullscreen mode Exit fullscreen mode\nL113: \nL114: In the createUser method of the UsersController, the @Body() decorator automatically maps the incoming request body to the createUserDto object and validates it according to the rules defined in the DTO.\nL115: \nL116: ####  【23† 】 Step 4: Enable Validation Globally \nL117: \nL118: By default, NestJS won’t perform automatic validation for DTOs unless you enable it. You can enable global validation by modifying your main.ts file:  \nL119: \nL120:     // src/main.ts\nL121: \nL122:     import { ValidationPipe } from '@nestjs/common';\nL123:     import { NestFactory } from '@nestjs/core';\nL124:     import { AppModule } from './app.module';\nL125: \nL126:     async function bootstrap() {\nL127:       const app = await NestFactory.create(AppModule);\nL128: \nL129:       // Enable global validation pipe\nL130:       app.useGlobalPipes(new ValidationPipe());\nL131: \nL132:       await app.listen(3000);\nL133:     }\nL134:     bootstrap();\nL135: \nL136: Enter fullscreen mode Exit fullscreen mode\nL137: \nL138: With this setup, the ValidationPipe will automatically validate incoming data using the DTO's validation rules for all routes.\nL139: \nL140: ###  【24† 】 Conclusion \nL141: \nL142: Data validation is a crucial aspect of building secure and reliable applications. NestJS, combined with the class-validator library, provides an elegant way to validate incoming data using decorators and class-based validation rules. By creating DTOs and enabling global validation, you can ensure that your NestJS application processes only valid and safe data, reducing the risk of vulnerabilities and errors.\nL143: \nL144: Remember that while this article covers the basics of data validation, more advanced scenarios might require additional validation techniques and error handling. Always tailor your validation strategies to your specific application’s needs and security requirements.\nL145: \nL146: ##  Top comments (0)\nL147: \nL148: Subscribe\nL149: \nL150:     [Image 13: pic] \nL151: \nL152: Personal Trusted User\nL153: \nL154: 【25† Create template 】 \nL155: \nL156: Templates let you quickly answer FAQs or store snippets for re-use.\nL157: \nL158: Submit Preview 【26†Dismiss】 \nL159: \nL160: 【27†Code of Conduct】 • 【11†Report abuse】 \nL161: \nL162: Are you sure you want to hide this comment? It will become hidden in your post, but will still be visible via the comment's permalink. \nL163: \nL164: Hide child comments as well\nL165: \nL166: Confirm \nL167: \nL168: For further actions, you may consider blocking this person and/or 【11†reporting abuse】\nL169: \nL170: ## Read next\nL171: \nL172: 【28† Build a full stack app with Rust, Next.js and Docker Francesco Ciulla - Dec 19 】 【29† Angular Addicts #20: unit testing the new defer blocks, NGRX Signal store extensions, app architectures \u0026 more Gergely Szerovay - Dec 12 】 【30† Tech Talk: React in the Terminal? Hold my Beer Manuel Artero Anguita - Dec 20 】 【31† How to know node vs react versions compatibility? suresh - Nov 17 】 \nL173: \nL174: 【12† Vishnu C Prasad 】 \nL175: \nL176: Follow\nL177: \nL178: Pragmatic and Ambitious developer with extensive expertise in app development and web development. \nL179: \nL180:   * Work \nL181: \nL182: Flutter \u0026 Nest JS Developer \nL183: \nL184:   * Joined \nL185: \nL186: Jan 3, 2023\nL187: \nL188: ###  More from 【12†Vishnu C Prasad】 \nL189: \nL190: 【32† Implementing the CQRS Pattern in NestJS with a Note API Example # nestjs # cqrs # node # typescript 】 【33† Establishing PostgreSQL Connection with TypeORM in NestJS # nestjs # typeorm # postgres # node 】 【34† Passport JWT Authentication in NestJS # nestjs # passportjs # jwt # node 】 \nL191: \nL192: Once suspended, vishnucprasad will not be able to comment or publish posts until their suspension is removed. \nL193: \nL194: Note:  \nL195: \nL196:  Submit \u0026 Suspend \nL197: \nL198: Once unsuspended, vishnucprasad will be able to comment and publish posts again. \nL199: \nL200: Note:  \nL201: \nL202:  Submit \u0026 Unsuspend \nL203: \nL204: Once unpublished, all posts by vishnucprasad will become hidden and only accessible to themselves. \nL205: \nL206: If vishnucprasad is not suspended, they can still re-publish their posts from their dashboard. \nL207: \nL208: Note: \nL209: \nL210:  Unpublish all posts \nL211: \nL212: Once unpublished, this post will become invisible to the public and only accessible to Vishnu C Prasad. \nL213: \nL214: They can still re-publish the post if they are not suspended.\nL215: \nL216:  Unpublish Post \nL217: \nL218: Thanks for keeping DEV Community safe. Here is what you can do to flag vishnucprasad: \nL219: \nL220:  Make all posts by vishnucprasad less visible \nL221: \nL222: vishnucprasad consistently posts content that violates DEV Community's code of conduct because it is harassing, offensive or spammy. \nL223: \nL224: 【35† Report other inappropriate conduct †javascript:void(0);】 \nL225: \nL226:  Confirm Flag \nL227: \nL228: Unflagging vishnucprasad will restore default visibility to their posts. \nL229: \nL230:  Confirm Unflag \nL231: \nL232: 【1†DEV Community】 — A constructive and inclusive social network for software developers. With you every step of your journey. \nL233: \nL234: * 【1† Home 】 \nL235: * 【36† Podcasts 】 \nL236: * 【37† Videos 】 \nL237: * 【38† Tags 】 \nL238: * 【39† FAQ 】 \nL239: * 【40† Forem Shop †shop.forem.com】 \nL240: * 【41† Advertise on DEV 】 \nL241: * 【42† About 】 \nL242: * 【43† Contact 】 \nL243: * 【44† Guides 】 \nL244: * 【45† Software comparisons 】 \nL245: \nL246: * 【27† Code of Conduct 】 \nL247: * 【46† Privacy Policy 】 \nL248: * 【47† Terms of use 】 \nL249: \nL250: Built on 【48†Forem†www.forem.com】 — the 【49†open source】 software that powers 【50†DEV】 and other inclusive communities.\nL251: \nL252: Made with love and 【51†Ruby on Rails】. DEV Community © 2016 - 2023.\nL253: \nL254: [Image 14: DEV Community] \nL255: \nL256: We're a place where coders share, stay up-to-date and grow their careers. \nL257: \nL258: 【3† Log in 】 【4† Create account 】 \nL259: \nL260:  [Image 15] [Image 16] [Image 17] [Image 18] [Image 19]\nVisible: 0% - 100%","summary":"Simple Data Validation in NestJS: A Practical Guide - DEV Community (dev.to)\n","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide - DEV Community","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"L0: \nL1: URL: https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m\nL2:   \nL3: \nL4:   Skip to content \nL5: \nL6: Navigation menu   \nL7: \nL8:  Search\nL9: \nL10:  Search  \nL11: \nL12:    Log in    Create account  \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30:  Share to Twitter   Share to LinkedIn   Share to Reddit   Share to Hacker News   Share to Facebook   Share to Mastodon  \nL31: \nL32:  Share Post via...  Report Abuse \nL33: \nL34: [Image 6: Vishnu C Prasad]\nL35: \nL36: Vishnu C Prasad \nL37: \nL38: Posted on Aug 15 • Originally published at vishnucprasad.Medium \nL39: \nL40: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL41: \nL42: #  Simple Data Validation in NestJS: A Practical Guide \nL43: \nL44: # nestjs # passportjs # node # typescript \nL45: \nL46: [Image 12: NestJS Data Validation]\nL47: \nL48: In modern web applications, data validation plays a crucial role in ensuring the integrity and security of the information being processed. NestJS, a popular Node.js framework, provides a robust and easy-to-use mechanism for data validation, making it easier for developers to handle incoming data and prevent common vulnerabilities like injection attacks or invalid inputs. In this article, we will explore the basics of data validation in NestJS, complete with code examples to illustrate the concepts.\nL49: \nL50: ###    Why Data Validation Matters \nL51: \nL52: Data validation involves checking whether input data conforms to predefined rules or patterns before processing it further. This step helps prevent incorrect or malicious data from compromising the application’s functionality or security. In the context of a NestJS application, proper data validation can help mitigate risks such as:\nL53: \nL54:   1. Injection Attacks: By validating and sanitizing input data, you can prevent SQL injection, NoSQL injection, and other types of code injection attacks.\nL55: \nL56:   2. Invalid Inputs: Avoid errors and exceptions resulting from unexpected data types or formats.\nL57: \nL58:   3. Data Integrity: Ensure that the data being processed adheres to the expected structure and rules, preventing inconsistencies.\nL59: \nL60: ###    Using class-validator with NestJS \nL61: \nL62: NestJS seamlessly integrates with the class-validator library, which provides decorators and utilities for validating data using class-based validation rules. To get started, let's assume we're building an API endpoint to create users. We want to validate the incoming data, such as the user's name and email, before saving it to the database.\nL63: \nL64: ####    Step 1: Install Dependencies \nL65: \nL66: First, create a new NestJS application or navigate to your existing project directory and install the required packages:  \nL67: \nL68:     npm install --save class-validator\nL69: \nL70: Enter fullscreen mode Exit fullscreen mode\nL71: \nL72: ####    Step 2: Create a DTO (Data Transfer Object) \nL73: \nL74: In NestJS, DTOs are used to define the shape of the incoming data and its validation rules. Let’s create a CreateUserDto class to represent the data expected when creating a new user:  \nL75: \nL76:     // src/users/dto/create-user.dto.ts\nL77: \nL78:     import { IsNotEmpty, IsEmail } from 'class-validator';\nL79: \nL80:     export class CreateUserDto {\nL81:       @IsNotEmpty()\nL82:       name: string;\nL83: \nL84:       @IsNotEmpty()\nL85:       @IsEmail()\nL86:       email: string;\nL87:     }\nL88: \nL89: Enter fullscreen mode Exit fullscreen mode\nL90: \nL91: In the CreateUserDto class, we've used the @IsNotEmpty() and @IsEmail() decorators from the class-validator library to specify that the name and email fields should not be empty and the email should be a valid email address.\nL92: \nL93: ####    Step 3: Create the Controller \nL94: \nL95: Now, let’s create a controller to handle the incoming requests and validate the data using the CreateUserDto class:  \nL96: \nL97:     // src/users/users.controller.ts\nL98: \nL99:     import { Controller, Post, Body } from '@nestjs/common';\nL100:     import { CreateUserDto } from './dto/create-user.dto';\nL101: \nL102:     @Controller('users')\nL103:     export class UsersController {\nL104:       @Post()\nL105:       async createUser(@Body() dto: CreateUserDto) {\nL106:         // At this point, \"dto\" has already been validated\nL107:         // You can now proceed with processing and saving the user data\nL108:         return 'User created successfully';\nL109:       }\nL110:     }\nL111: \nL112: Enter fullscreen mode Exit fullscreen mode\nL113: \nL114: In the createUser method of the UsersController, the @Body() decorator automatically maps the incoming request body to the createUserDto object and validates it according to the rules defined in the DTO.\nL115: \nL116: ####    Step 4: Enable Validation Globally \nL117: \nL118: By default, NestJS won’t perform automatic validation for DTOs unless you enable it. You can enable global validation by modifying your main.ts file:  \nL119: \nL120:     // src/main.ts\nL121: \nL122:     import { ValidationPipe } from '@nestjs/common';\nL123:     import { NestFactory } from '@nestjs/core';\nL124:     import { AppModule } from './app.module';\nL125: \nL126:     async function bootstrap() {\nL127:       const app = await NestFactory.create(AppModule);\nL128: \nL129:       // Enable global validation pipe\nL130:       app.useGlobalPipes(new ValidationPipe());\nL131: \nL132:       await app.listen(3000);\nL133:     }\nL134:     bootstrap();\nL135: \nL136: Enter fullscreen mode Exit fullscreen mode\nL137: \nL138: With this setup, the ValidationPipe will automatically validate incoming data using the DTO's validation rules for all routes.\nL139: \nL140: ###    Conclusion \nL141: \nL142: Data validation is a crucial aspect of building secure and reliable applications. NestJS, combined with the class-validator library, provides an elegant way to validate incoming data using decorators and class-based validation rules. By creating DTOs and enabling global validation, you can ensure that your NestJS application processes only valid and safe data, reducing the risk of vulnerabilities and errors.\nL143: \nL144: Remember that while this article covers the basics of data validation, more advanced scenarios might require additional validation techniques and error handling. Always tailor your validation strategies to your specific application’s needs and security requirements.\nL145: \nL146: ##  Top comments (0)\nL147: \nL148: Subscribe\nL149: \nL150:     [Image 13: pic] \nL151: \nL152: Personal Trusted User\nL153: \nL154:  Create template  \nL155: \nL156: Templates let you quickly answer FAQs or store snippets for re-use.\nL157: \nL158: Submit Preview Dismiss \nL159: \nL160: Code of Conduct • Report abuse \nL161: \nL162: Are you sure you want to hide this comment? It will become hidden in your post, but will still be visible via the comment's permalink. \nL163: \nL164: Hide child comments as well\nL165: \nL166: Confirm \nL167: \nL168: For further actions, you may consider blocking this person and/or reporting abuse\nL169: \nL170: ## Read next\nL171: \nL172:  Build a full stack app with Rust, Next.js and Docker Francesco Ciulla - Dec 19   Angular Addicts #20: unit testing the new defer blocks, NGRX Signal store extensions, app architectures \u0026 more Gergely Szerovay - Dec 12   Tech Talk: React in the Terminal? Hold my Beer Manuel Artero Anguita - Dec 20   How to know node vs react versions compatibility? suresh - Nov 17  \nL173: \nL174:  Vishnu C Prasad  \nL175: \nL176: Follow\nL177: \nL178: Pragmatic and Ambitious developer with extensive expertise in app development and web development. \nL179: \nL180:   * Work \nL181: \nL182: Flutter \u0026 Nest JS Developer \nL183: \nL184:   * Joined \nL185: \nL186: Jan 3, 2023\nL187: \nL188: ###  More from Vishnu C Prasad \nL189: \nL190:  Implementing the CQRS Pattern in NestJS with a Note API Example # nestjs # cqrs # node # typescript   Establishing PostgreSQL Connection with TypeORM in NestJS # nestjs # typeorm # postgres # node   Passport JWT Authentication in NestJS # nestjs # passportjs # jwt # node  \nL191: \nL192: Once suspended, vishnucprasad will not be able to comment or publish posts until their suspension is removed. \nL193: \nL194: Note:  \nL195: \nL196:  Submit \u0026 Suspend \nL197: \nL198: Once unsuspended, vishnucprasad will be able to comment and publish posts again. \nL199: \nL200: Note:  \nL201: \nL202:  Submit \u0026 Unsuspend \nL203: \nL204: Once unpublished, all posts by vishnucprasad will become hidden and only accessible to themselves. \nL205: \nL206: If vishnucprasad is not suspended, they can still re-publish their posts from their dashboard. \nL207: \nL208: Note: \nL209: \nL210:  Unpublish all posts \nL211: \nL212: Once unpublished, this post will become invisible to the public and only accessible to Vishnu C Prasad. \nL213: \nL214: They can still re-publish the post if they are not suspended.\nL215: \nL216:  Unpublish Post \nL217: \nL218: Thanks for keeping DEV Community safe. Here is what you can do to flag vishnucprasad: \nL219: \nL220:  Make all posts by vishnucprasad less visible \nL221: \nL222: vishnucprasad consistently posts content that violates DEV Community's code of conduct because it is harassing, offensive or spammy. \nL223: \nL224:  Report other inappropriate conduct  \nL225: \nL226:  Confirm Flag \nL227: \nL228: Unflagging vishnucprasad will restore default visibility to their posts. \nL229: \nL230:  Confirm Unflag \nL231: \nL232: DEV Community — A constructive and inclusive social network for software developers. With you every step of your journey. \nL233: \nL234: *  Home  \nL235: *  Podcasts  \nL236: *  Videos  \nL237: *  Tags  \nL238: *  FAQ  \nL239: *  Forem Shop  \nL240: *  Advertise on DEV  \nL241: *  About  \nL242: *  Contact  \nL243: *  Guides  \nL244: *  Software comparisons  \nL245: \nL246: *  Code of Conduct  \nL247: *  Privacy Policy  \nL248: *  Terms of use  \nL249: \nL250: Built on Forem — the open source software that powers DEV and other inclusive communities.\nL251: \nL252: Made with love and Ruby on Rails. DEV Community © 2016 - 2023.\nL253: \nL254: [Image 14: DEV Community] \nL255: \nL256: We're a place where coders share, stay up-to-date and grow their careers. \nL257: \nL258:  Log in   Create account  \nL259: \nL260:  [Image 15] [Image 16] [Image 17] [Image 18] [Image 19]\nVisible: 0% - 100%"}]},"command":"click","args":[4],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"4aff2089-c41b-4702-8a1c-e4c9f79722fc","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"4aff2089-c41b-4702-8a1c-e4c9f79722fc","children":["fddb10a2-d22b-4598-baf5-5f1109b22ccf"]},{"id":"fddb10a2-d22b-4598-baf5-5f1109b22ccf","message":{"id":"fddb10a2-d22b-4598-baf5-5f1109b22ccf","author":{"role":"assistant","metadata":{}},"create_time":1703480183.267101,"content":{"content_type":"code","language":"unknown","text":"scroll(3)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"a4f0184b-a826-484a-a54a-78465cdb0067","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"a4f0184b-a826-484a-a54a-78465cdb0067","children":["1c5e95d3-96f4-43cb-9ad6-f659d9f36f64"]},{"id":"1c5e95d3-96f4-43cb-9ad6-f659d9f36f64","message":{"id":"1c5e95d3-96f4-43cb-9ad6-f659d9f36f64","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.281676,"content":{"content_type":"tether_browsing_display","result":"L0: \nL1: URL: https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m\nL2:   \nL3: \nL4:   【0†Skip to content】 \nL5: \nL6: Navigation menu 【1† 】 \nL7: \nL8:  Search\nL9: \nL10: 【2† Search 】 \nL11: \nL12:   【3† Log in 】  【4† Create account 】 \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30: 【5† Share to Twitter †twitter.com】 【6† Share to LinkedIn †www.linkedin.com】 【7† Share to Reddit †www.reddit.com】 【8† Share to Hacker News †news.ycombinator.com】 【9† Share to Facebook †www.facebook.com】 【10† Share to Mastodon †toot.kytta.dev】 \nL31: \nL32:  Share Post via...  【11†Report Abuse】 \nL33: \nL34: [Image 6: Vishnu C Prasad]\nL35: \nL36: 【12†Vishnu C Prasad】 \nL37: \nL38: Posted on Aug 15 • Originally published at 【13†vishnucprasad.Medium†vishnucprasad.medium.com】 \nL39: \nL40: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL41: \nL42: #  Simple Data Validation in NestJS: A Practical Guide \nL43: \nL44: 【14†# nestjs】 【15†# passportjs】 【16†# node】 【17†# typescript】 \nL45: \nL46: [Image 12: NestJS Data Validation]\nL47: \nL48: In modern web applications, data validation plays a crucial role in ensuring the integrity and security of the information being processed. NestJS, a popular Node.js framework, provides a robust and easy-to-use mechanism for data validation, making it easier for developers to handle incoming data and prevent common vulnerabilities like injection attacks or invalid inputs. In this article, we will explore the basics of data validation in NestJS, complete with code examples to illustrate the concepts.\nL49: \nL50: ###  【18† 】 Why Data Validation Matters \nL51: \nL52: Data validation involves checking whether input data conforms to predefined rules or patterns before processing it further. This step helps prevent incorrect or malicious data from compromising the application’s functionality or security. In the context of a NestJS application, proper data validation can help mitigate risks such as:\nL53: \nL54:   1. Injection Attacks: By validating and sanitizing input data, you can prevent SQL injection, NoSQL injection, and other types of code injection attacks.\nL55: \nL56:   2. Invalid Inputs: Avoid errors and exceptions resulting from unexpected data types or formats.\nL57: \nL58:   3. Data Integrity: Ensure that the data being processed adheres to the expected structure and rules, preventing inconsistencies.\nL59: \nL60: ###  【19† 】 Using class-validator with NestJS \nL61: \nL62: NestJS seamlessly integrates with the class-validator library, which provides decorators and utilities for validating data using class-based validation rules. To get started, let's assume we're building an API endpoint to create users. We want to validate the incoming data, such as the user's name and email, before saving it to the database.\nL63: \nL64: ####  【20† 】 Step 1: Install Dependencies \nL65: \nL66: First, create a new NestJS application or navigate to your existing project directory and install the required packages:  \nL67: \nL68:     npm install --save class-validator\nL69: \nL70: Enter fullscreen mode Exit fullscreen mode\nL71: \nL72: ####  【21† 】 Step 2: Create a DTO (Data Transfer Object) \nL73: \nL74: In NestJS, DTOs are used to define the shape of the incoming data and its validation rules. Let’s create a CreateUserDto class to represent the data expected when creating a new user:  \nL75: \nL76:     // src/users/dto/create-user.dto.ts\nL77: \nL78:     import { IsNotEmpty, IsEmail } from 'class-validator';\nL79: \nL80:     export class CreateUserDto {\nL81:       @IsNotEmpty()\nL82:       name: string;\nL83: \nL84:       @IsNotEmpty()\nL85:       @IsEmail()\nL86:       email: string;\nL87:     }\nL88: \nL89: Enter fullscreen mode Exit fullscreen mode\nL90: \nL91: In the CreateUserDto class, we've used the @IsNotEmpty() and @IsEmail() decorators from the class-validator library to specify that the name and email fields should not be empty and the email should be a valid email address.\nL92: \nL93: ####  【22† 】 Step 3: Create the Controller \nL94: \nL95: Now, let’s create a controller to handle the incoming requests and validate the data using the CreateUserDto class:  \nL96: \nL97:     // src/users/users.controller.ts\nL98: \nL99:     import { Controller, Post, Body } from '@nestjs/common';\nL100:     import { CreateUserDto } from './dto/create-user.dto';\nL101: \nL102:     @Controller('users')\nL103:     export class UsersController {\nL104:       @Post()\nL105:       async createUser(@Body() dto: CreateUserDto) {\nL106:         // At this point, \"dto\" has already been validated\nL107:         // You can now proceed with processing and saving the user data\nL108:         return 'User created successfully';\nL109:       }\nL110:     }\nL111: \nL112: Enter fullscreen mode Exit fullscreen mode\nL113: \nL114: In the createUser method of the UsersController, the @Body() decorator automatically maps the incoming request body to the createUserDto object and validates it according to the rules defined in the DTO.\nL115: \nL116: ####  【23† 】 Step 4: Enable Validation Globally \nL117: \nL118: By default, NestJS won’t perform automatic validation for DTOs unless you enable it. You can enable global validation by modifying your main.ts file:  \nL119: \nL120:     // src/main.ts\nL121: \nL122:     import { ValidationPipe } from '@nestjs/common';\nL123:     import { NestFactory } from '@nestjs/core';\nL124:     import { AppModule } from './app.module';\nL125: \nL126:     async function bootstrap() {\nL127:       const app = await NestFactory.create(AppModule);\nL128: \nL129:       // Enable global validation pipe\nL130:       app.useGlobalPipes(new ValidationPipe());\nL131: \nL132:       await app.listen(3000);\nL133:     }\nL134:     bootstrap();\nL135: \nL136: Enter fullscreen mode Exit fullscreen mode\nL137: \nL138: With this setup, the ValidationPipe will automatically validate incoming data using the DTO's validation rules for all routes.\nL139: \nL140: ###  【24† 】 Conclusion \nL141: \nL142: Data validation is a crucial aspect of building secure and reliable applications. NestJS, combined with the class-validator library, provides an elegant way to validate incoming data using decorators and class-based validation rules. By creating DTOs and enabling global validation, you can ensure that your NestJS application processes only valid and safe data, reducing the risk of vulnerabilities and errors.\nL143: \nL144: Remember that while this article covers the basics of data validation, more advanced scenarios might require additional validation techniques and error handling. Always tailor your validation strategies to your specific application’s needs and security requirements.\nL145: \nL146: ##  Top comments (0)\nL147: \nL148: Subscribe\nL149: \nL150:     [Image 13: pic] \nL151: \nL152: Personal Trusted User\nL153: \nL154: 【25† Create template 】 \nL155: \nL156: Templates let you quickly answer FAQs or store snippets for re-use.\nL157: \nL158: Submit Preview 【26†Dismiss】 \nL159: \nL160: 【27†Code of Conduct】 • 【11†Report abuse】 \nL161: \nL162: Are you sure you want to hide this comment? It will become hidden in your post, but will still be visible via the comment's permalink. \nL163: \nL164: Hide child comments as well\nL165: \nL166: Confirm \nL167: \nL168: For further actions, you may consider blocking this person and/or 【11†reporting abuse】\nL169: \nL170: ## Read next\nL171: \nL172: 【28† Build a full stack app with Rust, Next.js and Docker Francesco Ciulla - Dec 19 】 【29† Angular Addicts #20: unit testing the new defer blocks, NGRX Signal store extensions, app architectures \u0026 more Gergely Szerovay - Dec 12 】 【30† Tech Talk: React in the Terminal? Hold my Beer Manuel Artero Anguita - Dec 20 】 【31† How to know node vs react versions compatibility? suresh - Nov 17 】 \nL173: \nL174: 【12† Vishnu C Prasad 】 \nL175: \nL176: Follow\nL177: \nL178: Pragmatic and Ambitious developer with extensive expertise in app development and web development. \nL179: \nL180:   * Work \nL181: \nL182: Flutter \u0026 Nest JS Developer \nL183: \nL184:   * Joined \nL185: \nL186: Jan 3, 2023\nL187: \nL188: ###  More from 【12†Vishnu C Prasad】 \nL189: \nL190: 【32† Implementing the CQRS Pattern in NestJS with a Note API Example # nestjs # cqrs # node # typescript 】 【33† Establishing PostgreSQL Connection with TypeORM in NestJS # nestjs # typeorm # postgres # node 】 【34† Passport JWT Authentication in NestJS # nestjs # passportjs # jwt # node 】 \nL191: \nL192: Once suspended, vishnucprasad will not be able to comment or publish posts until their suspension is removed. \nL193: \nL194: Note:  \nL195: \nL196:  Submit \u0026 Suspend \nL197: \nL198: Once unsuspended, vishnucprasad will be able to comment and publish posts again. \nL199: \nL200: Note:  \nL201: \nL202:  Submit \u0026 Unsuspend \nL203: \nL204: Once unpublished, all posts by vishnucprasad will become hidden and only accessible to themselves. \nL205: \nL206: If vishnucprasad is not suspended, they can still re-publish their posts from their dashboard. \nL207: \nL208: Note: \nL209: \nL210:  Unpublish all posts \nL211: \nL212: Once unpublished, this post will become invisible to the public and only accessible to Vishnu C Prasad. \nL213: \nL214: They can still re-publish the post if they are not suspended.\nL215: \nL216:  Unpublish Post \nL217: \nL218: Thanks for keeping DEV Community safe. Here is what you can do to flag vishnucprasad: \nL219: \nL220:  Make all posts by vishnucprasad less visible \nL221: \nL222: vishnucprasad consistently posts content that violates DEV Community's code of conduct because it is harassing, offensive or spammy. \nL223: \nL224: 【35† Report other inappropriate conduct †javascript:void(0);】 \nL225: \nL226:  Confirm Flag \nL227: \nL228: Unflagging vishnucprasad will restore default visibility to their posts. \nL229: \nL230:  Confirm Unflag \nL231: \nL232: 【1†DEV Community】 — A constructive and inclusive social network for software developers. With you every step of your journey. \nL233: \nL234: * 【1† Home 】 \nL235: * 【36† Podcasts 】 \nL236: * 【37† Videos 】 \nL237: * 【38† Tags 】 \nL238: * 【39† FAQ 】 \nL239: * 【40† Forem Shop †shop.forem.com】 \nL240: * 【41† Advertise on DEV 】 \nL241: * 【42† About 】 \nL242: * 【43† Contact 】 \nL243: * 【44† Guides 】 \nL244: * 【45† Software comparisons 】 \nL245: \nL246: * 【27† Code of Conduct 】 \nL247: * 【46† Privacy Policy 】 \nL248: * 【47† Terms of use 】 \nL249: \nL250: Built on 【48†Forem†www.forem.com】 — the 【49†open source】 software that powers 【50†DEV】 and other inclusive communities.\nL251: \nL252: Made with love and 【51†Ruby on Rails】. DEV Community © 2016 - 2023.\nL253: \nL254: [Image 14: DEV Community] \nL255: \nL256: We're a place where coders share, stay up-to-date and grow their careers. \nL257: \nL258: 【3† Log in 】 【4† Create account 】 \nL259: \nL260:  [Image 15] [Image 16] [Image 17] [Image 18] [Image 19]\nVisible: 0% - 100%","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide - DEV Community","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"L0: \nL1: URL: https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m\nL2:   \nL3: \nL4:   Skip to content \nL5: \nL6: Navigation menu   \nL7: \nL8:  Search\nL9: \nL10:  Search  \nL11: \nL12:    Log in    Create account  \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30:  Share to Twitter   Share to LinkedIn   Share to Reddit   Share to Hacker News   Share to Facebook   Share to Mastodon  \nL31: \nL32:  Share Post via...  Report Abuse \nL33: \nL34: [Image 6: Vishnu C Prasad]\nL35: \nL36: Vishnu C Prasad \nL37: \nL38: Posted on Aug 15 • Originally published at vishnucprasad.Medium \nL39: \nL40: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL41: \nL42: #  Simple Data Validation in NestJS: A Practical Guide \nL43: \nL44: # nestjs # passportjs # node # typescript \nL45: \nL46: [Image 12: NestJS Data Validation]\nL47: \nL48: In modern web applications, data validation plays a crucial role in ensuring the integrity and security of the information being processed. NestJS, a popular Node.js framework, provides a robust and easy-to-use mechanism for data validation, making it easier for developers to handle incoming data and prevent common vulnerabilities like injection attacks or invalid inputs. In this article, we will explore the basics of data validation in NestJS, complete with code examples to illustrate the concepts.\nL49: \nL50: ###    Why Data Validation Matters \nL51: \nL52: Data validation involves checking whether input data conforms to predefined rules or patterns before processing it further. This step helps prevent incorrect or malicious data from compromising the application’s functionality or security. In the context of a NestJS application, proper data validation can help mitigate risks such as:\nL53: \nL54:   1. Injection Attacks: By validating and sanitizing input data, you can prevent SQL injection, NoSQL injection, and other types of code injection attacks.\nL55: \nL56:   2. Invalid Inputs: Avoid errors and exceptions resulting from unexpected data types or formats.\nL57: \nL58:   3. Data Integrity: Ensure that the data being processed adheres to the expected structure and rules, preventing inconsistencies.\nL59: \nL60: ###    Using class-validator with NestJS \nL61: \nL62: NestJS seamlessly integrates with the class-validator library, which provides decorators and utilities for validating data using class-based validation rules. To get started, let's assume we're building an API endpoint to create users. We want to validate the incoming data, such as the user's name and email, before saving it to the database.\nL63: \nL64: ####    Step 1: Install Dependencies \nL65: \nL66: First, create a new NestJS application or navigate to your existing project directory and install the required packages:  \nL67: \nL68:     npm install --save class-validator\nL69: \nL70: Enter fullscreen mode Exit fullscreen mode\nL71: \nL72: ####    Step 2: Create a DTO (Data Transfer Object) \nL73: \nL74: In NestJS, DTOs are used to define the shape of the incoming data and its validation rules. Let’s create a CreateUserDto class to represent the data expected when creating a new user:  \nL75: \nL76:     // src/users/dto/create-user.dto.ts\nL77: \nL78:     import { IsNotEmpty, IsEmail } from 'class-validator';\nL79: \nL80:     export class CreateUserDto {\nL81:       @IsNotEmpty()\nL82:       name: string;\nL83: \nL84:       @IsNotEmpty()\nL85:       @IsEmail()\nL86:       email: string;\nL87:     }\nL88: \nL89: Enter fullscreen mode Exit fullscreen mode\nL90: \nL91: In the CreateUserDto class, we've used the @IsNotEmpty() and @IsEmail() decorators from the class-validator library to specify that the name and email fields should not be empty and the email should be a valid email address.\nL92: \nL93: ####    Step 3: Create the Controller \nL94: \nL95: Now, let’s create a controller to handle the incoming requests and validate the data using the CreateUserDto class:  \nL96: \nL97:     // src/users/users.controller.ts\nL98: \nL99:     import { Controller, Post, Body } from '@nestjs/common';\nL100:     import { CreateUserDto } from './dto/create-user.dto';\nL101: \nL102:     @Controller('users')\nL103:     export class UsersController {\nL104:       @Post()\nL105:       async createUser(@Body() dto: CreateUserDto) {\nL106:         // At this point, \"dto\" has already been validated\nL107:         // You can now proceed with processing and saving the user data\nL108:         return 'User created successfully';\nL109:       }\nL110:     }\nL111: \nL112: Enter fullscreen mode Exit fullscreen mode\nL113: \nL114: In the createUser method of the UsersController, the @Body() decorator automatically maps the incoming request body to the createUserDto object and validates it according to the rules defined in the DTO.\nL115: \nL116: ####    Step 4: Enable Validation Globally \nL117: \nL118: By default, NestJS won’t perform automatic validation for DTOs unless you enable it. You can enable global validation by modifying your main.ts file:  \nL119: \nL120:     // src/main.ts\nL121: \nL122:     import { ValidationPipe } from '@nestjs/common';\nL123:     import { NestFactory } from '@nestjs/core';\nL124:     import { AppModule } from './app.module';\nL125: \nL126:     async function bootstrap() {\nL127:       const app = await NestFactory.create(AppModule);\nL128: \nL129:       // Enable global validation pipe\nL130:       app.useGlobalPipes(new ValidationPipe());\nL131: \nL132:       await app.listen(3000);\nL133:     }\nL134:     bootstrap();\nL135: \nL136: Enter fullscreen mode Exit fullscreen mode\nL137: \nL138: With this setup, the ValidationPipe will automatically validate incoming data using the DTO's validation rules for all routes.\nL139: \nL140: ###    Conclusion \nL141: \nL142: Data validation is a crucial aspect of building secure and reliable applications. NestJS, combined with the class-validator library, provides an elegant way to validate incoming data using decorators and class-based validation rules. By creating DTOs and enabling global validation, you can ensure that your NestJS application processes only valid and safe data, reducing the risk of vulnerabilities and errors.\nL143: \nL144: Remember that while this article covers the basics of data validation, more advanced scenarios might require additional validation techniques and error handling. Always tailor your validation strategies to your specific application’s needs and security requirements.\nL145: \nL146: ##  Top comments (0)\nL147: \nL148: Subscribe\nL149: \nL150:     [Image 13: pic] \nL151: \nL152: Personal Trusted User\nL153: \nL154:  Create template  \nL155: \nL156: Templates let you quickly answer FAQs or store snippets for re-use.\nL157: \nL158: Submit Preview Dismiss \nL159: \nL160: Code of Conduct • Report abuse \nL161: \nL162: Are you sure you want to hide this comment? It will become hidden in your post, but will still be visible via the comment's permalink. \nL163: \nL164: Hide child comments as well\nL165: \nL166: Confirm \nL167: \nL168: For further actions, you may consider blocking this person and/or reporting abuse\nL169: \nL170: ## Read next\nL171: \nL172:  Build a full stack app with Rust, Next.js and Docker Francesco Ciulla - Dec 19   Angular Addicts #20: unit testing the new defer blocks, NGRX Signal store extensions, app architectures \u0026 more Gergely Szerovay - Dec 12   Tech Talk: React in the Terminal? Hold my Beer Manuel Artero Anguita - Dec 20   How to know node vs react versions compatibility? suresh - Nov 17  \nL173: \nL174:  Vishnu C Prasad  \nL175: \nL176: Follow\nL177: \nL178: Pragmatic and Ambitious developer with extensive expertise in app development and web development. \nL179: \nL180:   * Work \nL181: \nL182: Flutter \u0026 Nest JS Developer \nL183: \nL184:   * Joined \nL185: \nL186: Jan 3, 2023\nL187: \nL188: ###  More from Vishnu C Prasad \nL189: \nL190:  Implementing the CQRS Pattern in NestJS with a Note API Example # nestjs # cqrs # node # typescript   Establishing PostgreSQL Connection with TypeORM in NestJS # nestjs # typeorm # postgres # node   Passport JWT Authentication in NestJS # nestjs # passportjs # jwt # node  \nL191: \nL192: Once suspended, vishnucprasad will not be able to comment or publish posts until their suspension is removed. \nL193: \nL194: Note:  \nL195: \nL196:  Submit \u0026 Suspend \nL197: \nL198: Once unsuspended, vishnucprasad will be able to comment and publish posts again. \nL199: \nL200: Note:  \nL201: \nL202:  Submit \u0026 Unsuspend \nL203: \nL204: Once unpublished, all posts by vishnucprasad will become hidden and only accessible to themselves. \nL205: \nL206: If vishnucprasad is not suspended, they can still re-publish their posts from their dashboard. \nL207: \nL208: Note: \nL209: \nL210:  Unpublish all posts \nL211: \nL212: Once unpublished, this post will become invisible to the public and only accessible to Vishnu C Prasad. \nL213: \nL214: They can still re-publish the post if they are not suspended.\nL215: \nL216:  Unpublish Post \nL217: \nL218: Thanks for keeping DEV Community safe. Here is what you can do to flag vishnucprasad: \nL219: \nL220:  Make all posts by vishnucprasad less visible \nL221: \nL222: vishnucprasad consistently posts content that violates DEV Community's code of conduct because it is harassing, offensive or spammy. \nL223: \nL224:  Report other inappropriate conduct  \nL225: \nL226:  Confirm Flag \nL227: \nL228: Unflagging vishnucprasad will restore default visibility to their posts. \nL229: \nL230:  Confirm Unflag \nL231: \nL232: DEV Community — A constructive and inclusive social network for software developers. With you every step of your journey. \nL233: \nL234: *  Home  \nL235: *  Podcasts  \nL236: *  Videos  \nL237: *  Tags  \nL238: *  FAQ  \nL239: *  Forem Shop  \nL240: *  Advertise on DEV  \nL241: *  About  \nL242: *  Contact  \nL243: *  Guides  \nL244: *  Software comparisons  \nL245: \nL246: *  Code of Conduct  \nL247: *  Privacy Policy  \nL248: *  Terms of use  \nL249: \nL250: Built on Forem — the open source software that powers DEV and other inclusive communities.\nL251: \nL252: Made with love and Ruby on Rails. DEV Community © 2016 - 2023.\nL253: \nL254: [Image 14: DEV Community] \nL255: \nL256: We're a place where coders share, stay up-to-date and grow their careers. \nL257: \nL258:  Log in   Create account  \nL259: \nL260:  [Image 15] [Image 16] [Image 17] [Image 18] [Image 19]\nVisible: 0% - 100%"}]},"command":"scroll","args":[3],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"fddb10a2-d22b-4598-baf5-5f1109b22ccf","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"fddb10a2-d22b-4598-baf5-5f1109b22ccf","children":["ec87bf06-4149-4177-936a-ac8348a92088"]},{"id":"ec87bf06-4149-4177-936a-ac8348a92088","message":{"id":"ec87bf06-4149-4177-936a-ac8348a92088","author":{"role":"assistant","metadata":{}},"create_time":1703480183.295242,"content":{"content_type":"code","language":"unknown","text":"back()"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"1c5e95d3-96f4-43cb-9ad6-f659d9f36f64","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"1c5e95d3-96f4-43cb-9ad6-f659d9f36f64","children":["83061f03-06af-456f-a695-1731d6f213fc"]},{"id":"83061f03-06af-456f-a695-1731d6f213fc","message":{"id":"83061f03-06af-456f-a695-1731d6f213fc","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.309356,"content":{"content_type":"tether_browsing_display","result":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Validation | NestJS - A progressive Node.js framework","url":"https://docs.nestjs.com/techniques/validation","text":"\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: "},{"type":"webpage","title":"Custom validation with database in NestJS - DEV Community","url":"https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao","text":"\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: "},{"type":"webpage","title":"Validation - GitHub: Let’s build from here","url":"https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md","text":"\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: "},{"type":"webpage","title":"Injecting request object to a custom validation class in NestJS","url":"https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal","text":"\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: "},{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: "},{"type":"webpage","title":"NestJS and ‘class validator’ cheat sheet - DEV Community","url":"https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao","text":"\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: "},{"type":"webpage","title":"How to implement input validation with NestJS - Sébastien Dubois","url":"https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/","text":"\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: "},{"type":"webpage","title":"How to use class-validator and generate custom error object in nest.js","url":"https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h","text":"\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: "},{"type":"webpage","title":"Building a REST API with NestJS and Prisma: Input Validation ...","url":"https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1","text":"\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: "},{"type":"webpage","title":"NestJS Custom Payload Validation - DEV Community","url":"https://dev.to/shubham_kadam/nestjs-custom-payload-validation-3hh7","text":"\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: "},{"type":"webpage","title":"Mastering Email Validation in NestJS: A Comprehensive Guide","url":"https://emaillistvalidation.com/blog/mastering-email-validation-in-nestjs-a-comprehensive-guide/","text":"\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: "},{"type":"webpage","title":"Custom Card v2 Signature Validation in NestJS - community.hubspot.com","url":"https://community.hubspot.com/t5/APIs-Integrations/Custom-Card-v2-Signature-Validation-in-NestJS/m-p/897350","text":"\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"},{"type":"webpage","title":"Search results for query: 'nestjs class-validator custom validation method documentation'","url":"","text":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"}]},"command":"back","args":[],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"ec87bf06-4149-4177-936a-ac8348a92088","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"ec87bf06-4149-4177-936a-ac8348a92088","children":["fd73d626-e230-4190-8443-f44e4f74398d"]},{"id":"fd73d626-e230-4190-8443-f44e4f74398d","message":{"id":"fd73d626-e230-4190-8443-f44e4f74398d","author":{"role":"assistant","metadata":{}},"create_time":1703480183.322245,"content":{"content_type":"code","language":"unknown","text":"click(7)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"83061f03-06af-456f-a695-1731d6f213fc","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"83061f03-06af-456f-a695-1731d6f213fc","children":["330b0eaf-03de-4922-bea8-1a6d942e1dea"]},{"id":"330b0eaf-03de-4922-bea8-1a6d942e1dea","message":{"id":"330b0eaf-03de-4922-bea8-1a6d942e1dea","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.336923,"content":{"content_type":"tether_browsing_display","result":"L0: \nL1: URL: https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h\nL2:   \nL3: \nL4:   【0†Skip to content】 \nL5: \nL6: Navigation menu 【1† 】 \nL7: \nL8:  Search\nL9: \nL10: 【2† Search 】 \nL11: \nL12:   【3† Log in 】  【4† Create account 】 \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30: 【5† Share to Twitter †twitter.com】 【6† Share to LinkedIn †www.linkedin.com】 【7† Share to Reddit †www.reddit.com】 【8† Share to Hacker News †news.ycombinator.com】 【9† Share to Facebook †www.facebook.com】 【10† Share to Mastodon †toot.kytta.dev】 \nL31: \nL32:  Share Post via...  【11†Report Abuse】 \nL33: \nL34: [Image 6: Nithin K Joy]\nL35: \nL36: 【12†Nithin K Joy】 \nL37: \nL38: Posted on Jun 6\nL39: \nL40: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL41: \nL42: #  How to use class-validator and generate custom error object in nest.js \nL43: \nL44: 【13†# javascript】 【14†# nest】 【15†# classvalidator】 【16†# typescript】 \nL45: \nL46: ##  【17† 】 Objective \nL47: \nL48: The main objective of this article is showing how to generate custom error object when the validation fails, but we will go through the process of using class-validator and later about generating custom error object.\nL49: \nL50: ##  【18† 】 What is class-validator \nL51: \nL52: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms.\nL53: \nL54: ##  【19† 】 How to use it \nL55: \nL56: In order to use class-validator in nest.js we need to install class-validator and class-transformer.  \nL57: `npm i --save class-validator class-transformer`\nL58: \nL59: To configure, in `main.ts` file we need to invoke `ValidationPipe()` constructor function imported form `@nestjs/common` and pass it as a argument for `app.useGlobalPipes` method.  \nL60: \nL61:     import { NestFactory } from '@nestjs/core';\nL62:     import { AppModule } from './app.module';\nL63:     import { ValidationPipe } from '@nestjs/common';\nL64: \nL65:     async function bootstrap() {\nL66:       const app = await NestFactory.create(AppModule);\nL67:       app.useGlobalPipes(new ValidationPipe({ stopAtFirstError: true }));\nL68:       await app.listen(3500);\nL69:     }\nL70: \nL71:     bootstrap();\nL72: \nL73: Enter fullscreen mode Exit fullscreen mode\nL74: \nL75: `{ stopAtFirstError: true }` is just an optional argument to stop after getting the first error and return it. we can always customize it.\nL76: \nL77: [Image 12: main.ts file]\nL78: \nL79: Let us assume we have a `users` resource. We need a create `create-user.dto.ts` file inside a `dto` folder under `users` resource as in image given below.\nL80: \nL81: [Image 13: create-user.to.ts file location]\nL82: \nL83: Inside `create-user.dto.ts` file add the class validation you need to add. Refer class-validator docs for which validation you need to apply. docs: 【20†https://www.npmjs.com/package/class-validator†www.npmjs.com】\nL84: \nL85: This is my `create-user.dto.ts` file  \nL86: \nL87:     import {\nL88:       IsNotEmpty,\nL89:       IsString,\nL90:       MinLength,\nL91:       IsAlpha,\nL92:       Matches,\nL93:       IsEnum,\nL94:     } from 'class-validator';\nL95: \nL96:     export enum UserState {\nL97:       ACTIVE = 'Active',\nL98:       IN_ACTIVE = 'Inactive',\nL99:     }\nL100: \nL101:     export class CreateUserDto {\nL102:       @IsNotEmpty()\nL103:       @IsString()\nL104:       @IsAlpha()\nL105:       @MinLength(1)\nL106:       readonly firstName: string;\nL107: \nL108:       @IsNotEmpty()\nL109:       @IsString()\nL110:       readonly lastName: string;\nL111: \nL112:       @IsNotEmpty()\nL113:       @IsString()\nL114:       @IsNotEmpty()\nL115:       @Matches(/^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,3}$/g)\nL116:       readonly email: string;\nL117: \nL118:       @IsNotEmpty()\nL119:       @IsString()\nL120:       @Matches(/^[6789]\\d{9}$/)\nL121:       readonly phoneNumber: string;\nL122: \nL123:       @IsNotEmpty()\nL124:       @IsString()\nL125:       @MinLength(3)\nL126:       readonly companyName: string;\nL127: \nL128:       @IsEnum(UserState)\nL129:       readonly userState: UserState;\nL130:     }\nL131: \nL132: Enter fullscreen mode Exit fullscreen mode\nL133: \nL134: Next import `CreateUserDto` class and use it inside the user controller.  \nL135: \nL136:     import { Controller, Post, Body } from '@nestjs/common';\nL137:     import { UsersService } from './users.service';\nL138:     import { CreateUserDto } from './dto/create-user.dto';\nL139: \nL140:     @Controller('users')\nL141:     export class UsersController {\nL142:       constructor(private readonly usersService: UsersService) {}\nL143: \nL144:       @Post()\nL145:       create(@Body() user: CreateUserDto) {\nL146:         return this.usersService.create(user);\nL147:       }\nL148:     }\nL149: \nL150: Enter fullscreen mode Exit fullscreen mode\nL151: \nL152: After sending request in postman or any other api testing application this will automatically validate and send error message as shown below  \nL153: Request body  \nL154: \nL155:     {\nL156:       \"firstName\":\"\",\nL157:       \"lastName\":\"K Joy\",\nL158:       \"email\":\"Nn@gail.com\",\nL159:       \"phoneNumber\":\"9160000000\",\nL160:       \"companyName\":\"abcgf\",\nL161:       \"userState\":\"Active\"\nL162:     }\nL163: \nL164: Enter fullscreen mode Exit fullscreen mode\nL165: \nL166: Response  \nL167: \nL168:     {\nL169:       \"statusCode\": 400,\nL170:       \"message\": [\nL171:         \"firstName must be longer than or equal to 1 characters\"\nL172:       ],\nL173:       \"error\": \"Bad Request\"\nL174:     }\nL175: \nL176: Enter fullscreen mode Exit fullscreen mode\nL177: \nL178: [Image 14: image of a non customized class-validator]\nL179: \nL180: ##  【21† 】 How to generate custom error message object \nL181: \nL182: But we need to get which property just gave us this error along with the error message. In order to do that we need to configure the `ValidationPipe()` in `main.ts` file with some configurations.  \nL183: \nL184:     import { NestFactory } from '@nestjs/core';\nL185:     import { AppModule } from './app.module';\nL186:     import { ValidationPipe, BadRequestException } from '@nestjs/common';\nL187: \nL188:     async function bootstrap() {\nL189:       const app = await NestFactory.create(AppModule);\nL190:       app.useGlobalPipes(\nL191:         new ValidationPipe({\nL192:           exceptionFactory: (errors) =\u003e {\nL193:             const result = errors.map((error) =\u003e ({\nL194:               property: error.property,\nL195:               message: error.constraints[Object.keys(error.constraints)[0]],\nL196:             }));\nL197:             return new BadRequestException(result);\nL198:           },\nL199:           stopAtFirstError: true,\nL200:         }),\nL201:       );\nL202:       await app.listen(3500);\nL203:     }\nL204: \nL205:     bootstrap();\nL206: \nL207: Enter fullscreen mode Exit fullscreen mode\nL208: \nL209: Let me break down the above code. The object below is the error object.  \nL210: \nL211:     {\nL212:       property: 'firstName',\nL213:       children: [],\nL214:       constraints: {\nL215:         minLength: 'firstName must be longer than or equal to 1 characters'\nL216:       }\nL217:     }\nL218: \nL219: Enter fullscreen mode Exit fullscreen mode\nL220: \nL221: `property: error.property` usage is straight forward.   \nL222: `message` is basically the value inside the the constraints object. But the key for the constraint object (here `minLength`) is not static. The key will be different for different validation failure.\nL223: \nL224: `Object.keys(error.constraints)[0]` Object.keys just changes all object keys to array and we access the first key by `[0]`. \nL225: \nL226: Request body  \nL227: \nL228:     {\nL229:       \"firstName\":\"\",\nL230:       \"lastName\":\"K Joy\",\nL231:       \"email\":\"Nn@gail.com\",\nL232:       \"phoneNumber\":\"9160000000\",\nL233:       \"companyName\":\"abcgf\",\nL234:       \"userState\":\"Active\"\nL235:     }\nL236: \nL237: Enter fullscreen mode Exit fullscreen mode\nL238: \nL239: Response  \nL240: \nL241:     {\nL242:       \"statusCode\": 400,\nL243:       \"message\": [\nL244:         {\nL245:           \"property\": \"firstName\",\nL246:           \"message\": \"firstName must be longer than or equal to 1 characters\"\nL247:         }\nL248:       ],\nL249:       \"error\": \"Bad Request\"\nL250:     }\nL251: \nL252: Enter fullscreen mode Exit fullscreen mode\nL253: \nL254: If you found this helpful, be sure to leave a on the post. Thank you!\nL255: \nL256: ##  Top comments (5)\nL257: \nL258: Subscribe\nL259: \nL260:     [Image 15: pic] \nL261: \nL262: Personal Trusted User\nL263: \nL264: 【22† Create template 】 \nL265: \nL266: Templates let you quickly answer FAQs or store snippets for re-use.\nL267: \nL268: Submit Preview 【23†Dismiss】 \nL269: \nL270:   Collapse Expand\nL271: \nL272: 【24† 】 \nL273: \nL274: 【24† davistran86 】 \nL275: \nL276:  davistran86 \nL277: \nL278: 【24† davistran86 】 \nL279: \nL280: Follow\nL281: \nL282:   * Joined \nL283: \nL284: Mar 27, 2019\nL285: \nL286: • 【25† Aug 11 】 \nL287: \nL288:  Dropdown menu\nL289: \nL290:   * 【25†Copy link】\nL291:   *   * Hide \nL292:   *   *   * \nL293: \nL294: Thanks alot, custom error message is what I'm looking for :)\nL295: \nL296:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL297: \nL298: Collapse Expand\nL299: \nL300: 【12† 】 \nL301: \nL302: 【12† Nithin K Joy 】 \nL303: \nL304:  Nithin K Joy \nL305: \nL306: 【12† Nithin K Joy 】 \nL307: \nL308: Follow\nL309: \nL310: I am a passionate Node.js, React.js developer who is more focused on developing Scalable FullStack Web Applications. \nL311: \nL312:   * Location \nL313: \nL314: Bangalore \nL315: \nL316:   * Education \nL317: \nL318: NMAM Institute of Technology, Nitte \nL319: \nL320:   * Work \nL321: \nL322: Clover Bay Technologies Pvt Ltd \nL323: \nL324:   * Joined \nL325: \nL326: May 14, 2023\nL327: \nL328: • 【26† Aug 12 】 \nL329: \nL330:  Dropdown menu\nL331: \nL332:   * 【26†Copy link】\nL333:   *   * Hide \nL334:   *   *   * \nL335: \nL336: You're welcome\nL337: \nL338:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL339: \nL340: Collapse Expand\nL341: \nL342: 【27† 】 \nL343: \nL344: 【27† mohamed 】 \nL345: \nL346:  mohamed \nL347: \nL348: 【27† mohamed 】 \nL349: \nL350: Follow\nL351: \nL352:   * Joined \nL353: \nL354: Aug 23, 2023\nL355: \nL356: • 【28† Aug 23 】 \nL357: \nL358:  Dropdown menu\nL359: \nL360:   * 【28†Copy link】\nL361:   *   * Hide \nL362:   *   *   * \nL363: \nL364: i need to custom like this  \nL365: {  \nL366: \"statusCode\": 400,  \nL367: \"message\": \"firstName must be longer than or equal to 1 characters\"  \nL368: }\nL369: \nL370: any idea please\nL371: \nL372:  Like comment:  Like comment:  3 likes Like  Comment button Reply \nL373: \nL374: Collapse Expand\nL375: \nL376: 【29† 】 \nL377: \nL378: 【29† Rafael Rossi 】 \nL379: \nL380:  Rafael Rossi \nL381: \nL382: 【29† Rafael Rossi 】 \nL383: \nL384: Follow\nL385: \nL386:   * Joined \nL387: \nL388: Jun 22, 2023\nL389: \nL390: • 【30† Nov 24 】 \nL391: \nL392:  Dropdown menu\nL393: \nL394:   * 【30†Copy link】\nL395:   *   * Hide \nL396:   *   *   * \nL397: \nL398: Tks sir\nL399: \nL400:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL401: \nL402: Collapse Expand\nL403: \nL404: 【31† 】 \nL405: \nL406: 【31† mundzirmuin 】 \nL407: \nL408:  mundzirmuin \nL409: \nL410: 【31† mundzirmuin 】 \nL411: \nL412: Follow\nL413: \nL414:   * Joined \nL415: \nL416: Aug 10, 2023\nL417: \nL418: • 【32† Aug 19 】 \nL419: \nL420:  Dropdown menu\nL421: \nL422:   * 【32†Copy link】\nL423:   *   * Hide \nL424:   *   *   * \nL425: \nL426: This really saves me, thanks!\nL427: \nL428:  Like comment:  Like comment:  Like  Comment button Reply \nL429: \nL430: 【33†Code of Conduct】 • 【11†Report abuse】 \nL431: \nL432: Are you sure you want to hide this comment? It will become hidden in your post, but will still be visible via the comment's permalink. \nL433: \nL434: Hide child comments as well\nL435: \nL436: Confirm \nL437: \nL438: For further actions, you may consider blocking this person and/or 【11†reporting abuse】\nL439: \nL440: ## Read next\nL441: \nL442: 【34† Tech Talk: React in the Terminal? Hold my Beer Manuel Artero Anguita - Dec 20 】 【35† Download Best 800+ VST Plugins Collection for Music Production Extraplugins extraplugins - Nov 22 】 【36† 14 tips to write better Javascript Melvinvmegen - Dec 12 】 【37† The One Thing Every Developer Should Know Brock Chestwall - Dec 18 】 \nL443: \nL444: 【12† Nithin K Joy 】 \nL445: \nL446: Follow\nL447: \nL448: I am a passionate Node.js, React.js developer who is more focused on developing Scalable FullStack Web Applications. \nL449: \nL450:   * Location \nL451: \nL452: Bangalore \nL453: \nL454:   * Education \nL455: \nL456: NMAM Institute of Technology, Nitte \nL457: \nL458:   * Work \nL459: \nL460: Clover Bay Technologies Pvt Ltd \nL461: \nL462:   * Joined \nL463: \nL464: May 14, 2023\nL465: \nL466: ###  More from 【12†Nithin K Joy】 \nL467: \nL468: 【38† How to call React Query hooks conditionally! # react # javascript # hooks # reactquery 】 \nL469: \nL470: Once suspended, nithinkjoy will not be able to comment or publish posts until their suspension is removed. \nL471: \nL472: Note:  \nL473: \nL474:  Submit \u0026 Suspend \nL475: \nL476: Once unsuspended, nithinkjoy will be able to comment and publish posts again. \nL477: \nL478: Note:  \nL479: \nL480:  Submit \u0026 Unsuspend \nL481: \nL482: Once unpublished, all posts by nithinkjoy will become hidden and only accessible to themselves. \nL483: \nL484: If nithinkjoy is not suspended, they can still re-publish their posts from their dashboard. \nL485: \nL486: Note: \nL487: \nL488:  Unpublish all posts \nL489: \nL490: Once unpublished, this post will become invisible to the public and only accessible to Nithin K Joy. \nL491: \nL492: They can still re-publish the post if they are not suspended.\nL493: \nL494:  Unpublish Post \nL495: \nL496: Thanks for keeping DEV Community safe. Here is what you can do to flag nithinkjoy: \nL497: \nL498:  Make all posts by nithinkjoy less visible \nL499: \nL500: nithinkjoy consistently posts content that violates DEV Community's code of conduct because it is harassing, offensive or spammy. \nL501: \nL502: 【39† Report other inappropriate conduct †javascript:void(0);】 \nL503: \nL504:  Confirm Flag \nL505: \nL506: Unflagging nithinkjoy will restore default visibility to their posts. \nL507: \nL508:  Confirm Unflag \nL509: \nL510: 【1†DEV Community】 — A constructive and inclusive social network for software developers. With you every step of your journey. \nL511: \nL512: * 【1† Home 】 \nL513: * 【40† Podcasts 】 \nL514: * 【41† Videos 】 \nL515: * 【42† Tags 】 \nL516: * 【43† FAQ 】 \nL517: * 【44† Forem Shop †shop.forem.com】 \nL518: * 【45† Advertise on DEV 】 \nL519: * 【46† About 】 \nL520: * 【47† Contact 】 \nL521: * 【48† Guides 】 \nL522: * 【49† Software comparisons 】 \nL523: \nL524: * 【33† Code of Conduct 】 \nL525: * 【50† Privacy Policy 】 \nL526: * 【51† Terms of use 】 \nL527: \nL528: Built on 【52†Forem†www.forem.com】 — the 【53†open source】 software that powers 【54†DEV】 and other inclusive communities.\nL529: \nL530: Made with love and 【55†Ruby on Rails】. DEV Community © 2016 - 2023.\nL531: \nL532: [Image 16: DEV Community] \nL533: \nL534: We're a place where coders share, stay up-to-date and grow their careers. \nL535: \nL536: 【3† Log in 】 【4† Create account 】 \nL537: \nL538:  [Image 17] [Image 18] [Image 19] [Image 20] [Image 21]\nVisible: 0% - 100%","summary":"How to use class-validator and generate custom error object in nest.js - DEV Community (dev.to)\n","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"How to use class-validator and generate custom error object in nest.js - DEV Community","url":"https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h","text":"L0: \nL1: URL: https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h\nL2:   \nL3: \nL4:   Skip to content \nL5: \nL6: Navigation menu   \nL7: \nL8:  Search\nL9: \nL10:  Search  \nL11: \nL12:    Log in    Create account  \nL13: \nL14: ## DEV Community\nL15: \nL16: Close\nL17: \nL18:     [Image 0]    Add reaction \nL19: \nL20:   [Image 1]   Like    [Image 2]   Unicorn    [Image 3]   Exploding Head    [Image 4]   Raised Hands    [Image 5]   Fire \nL21: \nL22:     Jump to Comments     Save \nL23: \nL24:  More...\nL25: \nL26:  Copy link Copy link\nL27: \nL28: Copied to Clipboard\nL29: \nL30:  Share to Twitter   Share to LinkedIn   Share to Reddit   Share to Hacker News   Share to Facebook   Share to Mastodon  \nL31: \nL32:  Share Post via...  Report Abuse \nL33: \nL34: [Image 6: Nithin K Joy]\nL35: \nL36: Nithin K Joy \nL37: \nL38: Posted on Jun 6\nL39: \nL40: [Image 7]   [Image 8]   [Image 9]   [Image 10]   [Image 11]  \nL41: \nL42: #  How to use class-validator and generate custom error object in nest.js \nL43: \nL44: # javascript # nest # classvalidator # typescript \nL45: \nL46: ##    Objective \nL47: \nL48: The main objective of this article is showing how to generate custom error object when the validation fails, but we will go through the process of using class-validator and later about generating custom error object.\nL49: \nL50: ##    What is class-validator \nL51: \nL52: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms.\nL53: \nL54: ##    How to use it \nL55: \nL56: In order to use class-validator in nest.js we need to install class-validator and class-transformer.  \nL57: `npm i --save class-validator class-transformer`\nL58: \nL59: To configure, in `main.ts` file we need to invoke `ValidationPipe()` constructor function imported form `@nestjs/common` and pass it as a argument for `app.useGlobalPipes` method.  \nL60: \nL61:     import { NestFactory } from '@nestjs/core';\nL62:     import { AppModule } from './app.module';\nL63:     import { ValidationPipe } from '@nestjs/common';\nL64: \nL65:     async function bootstrap() {\nL66:       const app = await NestFactory.create(AppModule);\nL67:       app.useGlobalPipes(new ValidationPipe({ stopAtFirstError: true }));\nL68:       await app.listen(3500);\nL69:     }\nL70: \nL71:     bootstrap();\nL72: \nL73: Enter fullscreen mode Exit fullscreen mode\nL74: \nL75: `{ stopAtFirstError: true }` is just an optional argument to stop after getting the first error and return it. we can always customize it.\nL76: \nL77: [Image 12: main.ts file]\nL78: \nL79: Let us assume we have a `users` resource. We need a create `create-user.dto.ts` file inside a `dto` folder under `users` resource as in image given below.\nL80: \nL81: [Image 13: create-user.to.ts file location]\nL82: \nL83: Inside `create-user.dto.ts` file add the class validation you need to add. Refer class-validator docs for which validation you need to apply. docs: https://www.npmjs.com/package/class-validator\nL84: \nL85: This is my `create-user.dto.ts` file  \nL86: \nL87:     import {\nL88:       IsNotEmpty,\nL89:       IsString,\nL90:       MinLength,\nL91:       IsAlpha,\nL92:       Matches,\nL93:       IsEnum,\nL94:     } from 'class-validator';\nL95: \nL96:     export enum UserState {\nL97:       ACTIVE = 'Active',\nL98:       IN_ACTIVE = 'Inactive',\nL99:     }\nL100: \nL101:     export class CreateUserDto {\nL102:       @IsNotEmpty()\nL103:       @IsString()\nL104:       @IsAlpha()\nL105:       @MinLength(1)\nL106:       readonly firstName: string;\nL107: \nL108:       @IsNotEmpty()\nL109:       @IsString()\nL110:       readonly lastName: string;\nL111: \nL112:       @IsNotEmpty()\nL113:       @IsString()\nL114:       @IsNotEmpty()\nL115:       @Matches(/^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,3}$/g)\nL116:       readonly email: string;\nL117: \nL118:       @IsNotEmpty()\nL119:       @IsString()\nL120:       @Matches(/^[6789]\\d{9}$/)\nL121:       readonly phoneNumber: string;\nL122: \nL123:       @IsNotEmpty()\nL124:       @IsString()\nL125:       @MinLength(3)\nL126:       readonly companyName: string;\nL127: \nL128:       @IsEnum(UserState)\nL129:       readonly userState: UserState;\nL130:     }\nL131: \nL132: Enter fullscreen mode Exit fullscreen mode\nL133: \nL134: Next import `CreateUserDto` class and use it inside the user controller.  \nL135: \nL136:     import { Controller, Post, Body } from '@nestjs/common';\nL137:     import { UsersService } from './users.service';\nL138:     import { CreateUserDto } from './dto/create-user.dto';\nL139: \nL140:     @Controller('users')\nL141:     export class UsersController {\nL142:       constructor(private readonly usersService: UsersService) {}\nL143: \nL144:       @Post()\nL145:       create(@Body() user: CreateUserDto) {\nL146:         return this.usersService.create(user);\nL147:       }\nL148:     }\nL149: \nL150: Enter fullscreen mode Exit fullscreen mode\nL151: \nL152: After sending request in postman or any other api testing application this will automatically validate and send error message as shown below  \nL153: Request body  \nL154: \nL155:     {\nL156:       \"firstName\":\"\",\nL157:       \"lastName\":\"K Joy\",\nL158:       \"email\":\"Nn@gail.com\",\nL159:       \"phoneNumber\":\"9160000000\",\nL160:       \"companyName\":\"abcgf\",\nL161:       \"userState\":\"Active\"\nL162:     }\nL163: \nL164: Enter fullscreen mode Exit fullscreen mode\nL165: \nL166: Response  \nL167: \nL168:     {\nL169:       \"statusCode\": 400,\nL170:       \"message\": [\nL171:         \"firstName must be longer than or equal to 1 characters\"\nL172:       ],\nL173:       \"error\": \"Bad Request\"\nL174:     }\nL175: \nL176: Enter fullscreen mode Exit fullscreen mode\nL177: \nL178: [Image 14: image of a non customized class-validator]\nL179: \nL180: ##    How to generate custom error message object \nL181: \nL182: But we need to get which property just gave us this error along with the error message. In order to do that we need to configure the `ValidationPipe()` in `main.ts` file with some configurations.  \nL183: \nL184:     import { NestFactory } from '@nestjs/core';\nL185:     import { AppModule } from './app.module';\nL186:     import { ValidationPipe, BadRequestException } from '@nestjs/common';\nL187: \nL188:     async function bootstrap() {\nL189:       const app = await NestFactory.create(AppModule);\nL190:       app.useGlobalPipes(\nL191:         new ValidationPipe({\nL192:           exceptionFactory: (errors) =\u003e {\nL193:             const result = errors.map((error) =\u003e ({\nL194:               property: error.property,\nL195:               message: error.constraints[Object.keys(error.constraints)[0]],\nL196:             }));\nL197:             return new BadRequestException(result);\nL198:           },\nL199:           stopAtFirstError: true,\nL200:         }),\nL201:       );\nL202:       await app.listen(3500);\nL203:     }\nL204: \nL205:     bootstrap();\nL206: \nL207: Enter fullscreen mode Exit fullscreen mode\nL208: \nL209: Let me break down the above code. The object below is the error object.  \nL210: \nL211:     {\nL212:       property: 'firstName',\nL213:       children: [],\nL214:       constraints: {\nL215:         minLength: 'firstName must be longer than or equal to 1 characters'\nL216:       }\nL217:     }\nL218: \nL219: Enter fullscreen mode Exit fullscreen mode\nL220: \nL221: `property: error.property` usage is straight forward.   \nL222: `message` is basically the value inside the the constraints object. But the key for the constraint object (here `minLength`) is not static. The key will be different for different validation failure.\nL223: \nL224: `Object.keys(error.constraints)[0]` Object.keys just changes all object keys to array and we access the first key by `[0]`. \nL225: \nL226: Request body  \nL227: \nL228:     {\nL229:       \"firstName\":\"\",\nL230:       \"lastName\":\"K Joy\",\nL231:       \"email\":\"Nn@gail.com\",\nL232:       \"phoneNumber\":\"9160000000\",\nL233:       \"companyName\":\"abcgf\",\nL234:       \"userState\":\"Active\"\nL235:     }\nL236: \nL237: Enter fullscreen mode Exit fullscreen mode\nL238: \nL239: Response  \nL240: \nL241:     {\nL242:       \"statusCode\": 400,\nL243:       \"message\": [\nL244:         {\nL245:           \"property\": \"firstName\",\nL246:           \"message\": \"firstName must be longer than or equal to 1 characters\"\nL247:         }\nL248:       ],\nL249:       \"error\": \"Bad Request\"\nL250:     }\nL251: \nL252: Enter fullscreen mode Exit fullscreen mode\nL253: \nL254: If you found this helpful, be sure to leave a on the post. Thank you!\nL255: \nL256: ##  Top comments (5)\nL257: \nL258: Subscribe\nL259: \nL260:     [Image 15: pic] \nL261: \nL262: Personal Trusted User\nL263: \nL264:  Create template  \nL265: \nL266: Templates let you quickly answer FAQs or store snippets for re-use.\nL267: \nL268: Submit Preview Dismiss \nL269: \nL270:   Collapse Expand\nL271: \nL272:   \nL273: \nL274:  davistran86  \nL275: \nL276:  davistran86 \nL277: \nL278:  davistran86  \nL279: \nL280: Follow\nL281: \nL282:   * Joined \nL283: \nL284: Mar 27, 2019\nL285: \nL286: •  Aug 11  \nL287: \nL288:  Dropdown menu\nL289: \nL290:   * Copy link\nL291:   *   * Hide \nL292:   *   *   * \nL293: \nL294: Thanks alot, custom error message is what I'm looking for :)\nL295: \nL296:  Like comment:  Like comment:  2 likes Like  Comment button Reply \nL297: \nL298: Collapse Expand\nL299: \nL300:   \nL301: \nL302:  Nithin K Joy  \nL303: \nL304:  Nithin K Joy \nL305: \nL306:  Nithin K Joy  \nL307: \nL308: Follow\nL309: \nL310: I am a passionate Node.js, React.js developer who is more focused on developing Scalable FullStack Web Applications. \nL311: \nL312:   * Location \nL313: \nL314: Bangalore \nL315: \nL316:   * Education \nL317: \nL318: NMAM Institute of Technology, Nitte \nL319: \nL320:   * Work \nL321: \nL322: Clover Bay Technologies Pvt Ltd \nL323: \nL324:   * Joined \nL325: \nL326: May 14, 2023\nL327: \nL328: •  Aug 12  \nL329: \nL330:  Dropdown menu\nL331: \nL332:   * Copy link\nL333:   *   * Hide \nL334:   *   *   * \nL335: \nL336: You're welcome\nL337: \nL338:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL339: \nL340: Collapse Expand\nL341: \nL342:   \nL343: \nL344:  mohamed  \nL345: \nL346:  mohamed \nL347: \nL348:  mohamed  \nL349: \nL350: Follow\nL351: \nL352:   * Joined \nL353: \nL354: Aug 23, 2023\nL355: \nL356: •  Aug 23  \nL357: \nL358:  Dropdown menu\nL359: \nL360:   * Copy link\nL361:   *   * Hide \nL362:   *   *   * \nL363: \nL364: i need to custom like this  \nL365: {  \nL366: \"statusCode\": 400,  \nL367: \"message\": \"firstName must be longer than or equal to 1 characters\"  \nL368: }\nL369: \nL370: any idea please\nL371: \nL372:  Like comment:  Like comment:  3 likes Like  Comment button Reply \nL373: \nL374: Collapse Expand\nL375: \nL376:   \nL377: \nL378:  Rafael Rossi  \nL379: \nL380:  Rafael Rossi \nL381: \nL382:  Rafael Rossi  \nL383: \nL384: Follow\nL385: \nL386:   * Joined \nL387: \nL388: Jun 22, 2023\nL389: \nL390: •  Nov 24  \nL391: \nL392:  Dropdown menu\nL393: \nL394:   * Copy link\nL395:   *   * Hide \nL396:   *   *   * \nL397: \nL398: Tks sir\nL399: \nL400:  Like comment:  Like comment:  1 like Like  Comment button Reply \nL401: \nL402: Collapse Expand\nL403: \nL404:   \nL405: \nL406:  mundzirmuin  \nL407: \nL408:  mundzirmuin \nL409: \nL410:  mundzirmuin  \nL411: \nL412: Follow\nL413: \nL414:   * Joined \nL415: \nL416: Aug 10, 2023\nL417: \nL418: •  Aug 19  \nL419: \nL420:  Dropdown menu\nL421: \nL422:   * Copy link\nL423:   *   * Hide \nL424:   *   *   * \nL425: \nL426: This really saves me, thanks!\nL427: \nL428:  Like comment:  Like comment:  Like  Comment button Reply \nL429: \nL430: Code of Conduct • Report abuse \nL431: \nL432: Are you sure you want to hide this comment? It will become hidden in your post, but will still be visible via the comment's permalink. \nL433: \nL434: Hide child comments as well\nL435: \nL436: Confirm \nL437: \nL438: For further actions, you may consider blocking this person and/or reporting abuse\nL439: \nL440: ## Read next\nL441: \nL442:  Tech Talk: React in the Terminal? Hold my Beer Manuel Artero Anguita - Dec 20   Download Best 800+ VST Plugins Collection for Music Production Extraplugins extraplugins - Nov 22   14 tips to write better Javascript Melvinvmegen - Dec 12   The One Thing Every Developer Should Know Brock Chestwall - Dec 18  \nL443: \nL444:  Nithin K Joy  \nL445: \nL446: Follow\nL447: \nL448: I am a passionate Node.js, React.js developer who is more focused on developing Scalable FullStack Web Applications. \nL449: \nL450:   * Location \nL451: \nL452: Bangalore \nL453: \nL454:   * Education \nL455: \nL456: NMAM Institute of Technology, Nitte \nL457: \nL458:   * Work \nL459: \nL460: Clover Bay Technologies Pvt Ltd \nL461: \nL462:   * Joined \nL463: \nL464: May 14, 2023\nL465: \nL466: ###  More from Nithin K Joy \nL467: \nL468:  How to call React Query hooks conditionally! # react # javascript # hooks # reactquery  \nL469: \nL470: Once suspended, nithinkjoy will not be able to comment or publish posts until their suspension is removed. \nL471: \nL472: Note:  \nL473: \nL474:  Submit \u0026 Suspend \nL475: \nL476: Once unsuspended, nithinkjoy will be able to comment and publish posts again. \nL477: \nL478: Note:  \nL479: \nL480:  Submit \u0026 Unsuspend \nL481: \nL482: Once unpublished, all posts by nithinkjoy will become hidden and only accessible to themselves. \nL483: \nL484: If nithinkjoy is not suspended, they can still re-publish their posts from their dashboard. \nL485: \nL486: Note: \nL487: \nL488:  Unpublish all posts \nL489: \nL490: Once unpublished, this post will become invisible to the public and only accessible to Nithin K Joy. \nL491: \nL492: They can still re-publish the post if they are not suspended.\nL493: \nL494:  Unpublish Post \nL495: \nL496: Thanks for keeping DEV Community safe. Here is what you can do to flag nithinkjoy: \nL497: \nL498:  Make all posts by nithinkjoy less visible \nL499: \nL500: nithinkjoy consistently posts content that violates DEV Community's code of conduct because it is harassing, offensive or spammy. \nL501: \nL502:  Report other inappropriate conduct  \nL503: \nL504:  Confirm Flag \nL505: \nL506: Unflagging nithinkjoy will restore default visibility to their posts. \nL507: \nL508:  Confirm Unflag \nL509: \nL510: DEV Community — A constructive and inclusive social network for software developers. With you every step of your journey. \nL511: \nL512: *  Home  \nL513: *  Podcasts  \nL514: *  Videos  \nL515: *  Tags  \nL516: *  FAQ  \nL517: *  Forem Shop  \nL518: *  Advertise on DEV  \nL519: *  About  \nL520: *  Contact  \nL521: *  Guides  \nL522: *  Software comparisons  \nL523: \nL524: *  Code of Conduct  \nL525: *  Privacy Policy  \nL526: *  Terms of use  \nL527: \nL528: Built on Forem — the open source software that powers DEV and other inclusive communities.\nL529: \nL530: Made with love and Ruby on Rails. DEV Community © 2016 - 2023.\nL531: \nL532: [Image 16: DEV Community] \nL533: \nL534: We're a place where coders share, stay up-to-date and grow their careers. \nL535: \nL536:  Log in   Create account  \nL537: \nL538:  [Image 17] [Image 18] [Image 19] [Image 20] [Image 21]\nVisible: 0% - 100%"}]},"command":"click","args":[7],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"fd73d626-e230-4190-8443-f44e4f74398d","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"fd73d626-e230-4190-8443-f44e4f74398d","children":["6bf8eb2b-c717-48a3-b498-f30187a2bc6d"]},{"id":"6bf8eb2b-c717-48a3-b498-f30187a2bc6d","message":{"id":"6bf8eb2b-c717-48a3-b498-f30187a2bc6d","author":{"role":"assistant","metadata":{}},"create_time":1703480183.350667,"content":{"content_type":"code","language":"unknown","text":"back()"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"330b0eaf-03de-4922-bea8-1a6d942e1dea","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"330b0eaf-03de-4922-bea8-1a6d942e1dea","children":["c88fb854-0ca4-4542-9d2c-7e40febea1ed"]},{"id":"c88fb854-0ca4-4542-9d2c-7e40febea1ed","message":{"id":"c88fb854-0ca4-4542-9d2c-7e40febea1ed","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.366223,"content":{"content_type":"tether_browsing_display","result":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Validation | NestJS - A progressive Node.js framework","url":"https://docs.nestjs.com/techniques/validation","text":"\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: "},{"type":"webpage","title":"Custom validation with database in NestJS - DEV Community","url":"https://dev.to/avantar/custom-validation-with-database-in-nestjs-gao","text":"\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: "},{"type":"webpage","title":"Validation - GitHub: Let’s build from here","url":"https://github.com/nestjs/docs.nestjs.com/blob/master/content/techniques/validation.md","text":"\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: "},{"type":"webpage","title":"Injecting request object to a custom validation class in NestJS","url":"https://dev.to/avantar/injecting-request-object-to-a-custom-validation-class-in-nestjs-5dal","text":"\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: "},{"type":"webpage","title":"Simple Data Validation in NestJS: A Practical Guide","url":"https://dev.to/vishnucprasad/simple-data-validation-in-nestjs-a-practical-guide-102m","text":"\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: "},{"type":"webpage","title":"NestJS and ‘class validator’ cheat sheet - DEV Community","url":"https://dev.to/sarathsantoshdamaraju/nestjs-and-class-validator-cheat-sheet-13ao","text":"\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: "},{"type":"webpage","title":"How to implement input validation with NestJS - Sébastien Dubois","url":"https://www.dsebastien.net/2020-07-23-input-validation-with-nestjs/","text":"\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: "},{"type":"webpage","title":"How to use class-validator and generate custom error object in nest.js","url":"https://dev.to/nithinkjoy/how-to-use-class-validator-and-return-custom-error-object-in-nestjs-562h","text":"\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: "},{"type":"webpage","title":"Building a REST API with NestJS and Prisma: Input Validation ...","url":"https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1","text":"\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: "},{"type":"webpage","title":"NestJS Custom Payload Validation - DEV Community","url":"https://dev.to/shubham_kadam/nestjs-custom-payload-validation-3hh7","text":"\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: "},{"type":"webpage","title":"Mastering Email Validation in NestJS: A Comprehensive Guide","url":"https://emaillistvalidation.com/blog/mastering-email-validation-in-nestjs-a-comprehensive-guide/","text":"\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: "},{"type":"webpage","title":"Custom Card v2 Signature Validation in NestJS - community.hubspot.com","url":"https://community.hubspot.com/t5/APIs-Integrations/Custom-Card-v2-Signature-Validation-in-NestJS/m-p/897350","text":"\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"},{"type":"webpage","title":"Search results for query: 'nestjs class-validator custom validation method documentation'","url":"","text":"L0: # 【0†Validation | NestJS - A progressive Node.js framework†docs.nestjs.com】\nL1: To begin using it, we first install the required dependency. $ npm i --save class-validator class-transformer Hint The ValidationPipe is exported from the @nestjs/common package. Because this pipe uses the class-validator and class-transformer libraries, there are many options available.\nL2: # 【1†Custom validation with database in NestJS - DEV Community†dev.to】\nL3: Class-Validator library is a powerful tool, which brings whole set of differential validation decorators like @Length (10, 20), @IsInt (), @Contains ('example') etc. I won't introduce to you how to use basic validation in NestJS, documentation explains it quite accurately.\nL4: # 【2†Validation - GitHub: Let’s build from here†github.com】\nL5: The \u003ccode\u003eValidationPipe\u003c/code\u003e can automatically transform payloads to be objects typed according to their DTO classes. To enable auto-transformation, set \u003ccode\u003etransform\u003c/code\u003e to \u003ccode\u003etrue\u003c/code\u003e.\nL6: # 【3†Injecting request object to a custom validation class in NestJS†dev.to】\nL7: 1 Custom validation with database in NestJS 2 Validating nested objects with class-validator in NestJS 3 Validating numeric query parameters in NestJS 4 Injecting request object to a custom validation class in NestJS I'm a big fan of how NestJS handle validation using class-validator library.\nL8: # 【4†Simple Data Validation in NestJS: A Practical Guide†dev.to】\nL9: Step 1: Install Dependencies First, create a new NestJS application or navigate to your existing project directory and install the required packages: npm install --save class-validator Step 2: Create a DTO (Data Transfer Object) In NestJS, DTOs are used to define the shape of the incoming data and its validation rules.\nL10: # 【5†NestJS and ‘class validator’ cheat sheet - DEV Community†dev.to】\nL11: NestJs along with `class-validator` is a good combination for validating API responses. Both are well documented but some needed use cases are not covered assuming developer to figure out. Below are some few cheat sheets which helps in defining those cases and you can use these to scale to some extent. Tagged with nestjs, validation, node, typescript.\nL12: # 【6†How to implement input validation with NestJS - Sébastien Dubois†www.dsebastien.net】\nL13: NestJS pipes have two main use cases: transformation of input data. validation of input data. When used for validation, pipes either let the data through unchanged or throw an exception if the data is incorrect/invalid. But, of course, it’s also possible to combine validation and transformation in a single pipe.\nL14: # 【7†How to use class-validator and generate custom error object in nest.js†dev.to】\nL15: class-validator allows use of decorator and non-decorator based validation. Internally uses validator.js to perform validation. class-validator works on both browser and node.js platforms. How to use it In order to use class-validator in nest.js we need to install class-validator and class-transformer. npm i --save class-validator class-transformer\nL16: # 【8†Building a REST API with NestJS and Prisma: Input Validation ...†www.prisma.io】\nL17: Add validation rules to CreateArticleDto. You will now use the class-validator package to add validation decorators to CreateArticleDto.You will apply the following rules to CreateArticleDto:. title can't be empty or shorter than 5 characters.; description has to have a maximum length of 300.; body and description can't be empty.; title, description and body must be of type string and ...\nL18: # 【9†NestJS Custom Payload Validation - DEV Community†dev.to】\nL19: In order to perform custom payload validation we need to implement ValidatorConstraintInterface interface and its validate method and post implementing the interface we need to apply @ValidatorConstraint decorator to the class (which implements the interface).\nL20: # 【10†Mastering Email Validation in NestJS: A Comprehensive Guide†emaillistvalidation.com】\nL21: Use Validation Pipe: NestJS provides a ValidationPipe that can be used to validate incoming request data, including email addresses. Leverage Class Validators: Decorators like @IsEmail() from libraries like class-validator make email validation more straightforward. Custom Validation: For complex scenarios, create custom validation pipes or use ...\nL22: # 【11†Custom Card v2 Signature Validation in NestJS - community.hubspot.com†community.hubspot.com】\nL23: If I hardcode the example source string from the v2 documentation here, it generates a matching hash and validates. And like I said, GET works fine. My thought is that the order the body is in when hubspot generates the hash is different than the order I'm getting them in, or NestJS is parsing the body into an object and it's changing the order.\nVisible: 0% - 100%"}]},"command":"back","args":[],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"6bf8eb2b-c717-48a3-b498-f30187a2bc6d","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"6bf8eb2b-c717-48a3-b498-f30187a2bc6d","children":["94a31171-0a47-4435-b86e-4bfbbc484882"]},{"id":"94a31171-0a47-4435-b86e-4bfbbc484882","message":{"id":"94a31171-0a47-4435-b86e-4bfbbc484882","author":{"role":"assistant","metadata":{}},"create_time":1703480183.38036,"content":{"content_type":"code","language":"unknown","text":"click(8)"},"status":"finished_successfully","end_turn":false,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100265]},"is_complete":true,"model_slug":"gpt-4","parent_id":"c88fb854-0ca4-4542-9d2c-7e40febea1ed","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"browser"},"parent":"c88fb854-0ca4-4542-9d2c-7e40febea1ed","children":["7de6f89c-d331-4865-b726-ad1847f2d9b4"]},{"id":"7de6f89c-d331-4865-b726-ad1847f2d9b4","message":{"id":"7de6f89c-d331-4865-b726-ad1847f2d9b4","author":{"role":"tool","name":"browser","metadata":{}},"create_time":1703480183.395778,"content":{"content_type":"tether_browsing_display","result":"L0: \nL1: URL: https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1\nL2: \nL3: \nL4: [Image 0: prisma_logo]\nL5: \nL6: Products \nL7: \nL8: #### Prisma ORM\nL9: \nL10: 【0†Client Write Queries the way you think】【1†Migrate Generate customizable SQL migrations】\nL11: \nL12: #### Prisma Data Platform\nL13: \nL14: 【2†Accelerate Query up to 1000x faster】【3†Pulse Early Access Real-time database events】\nL15: \nL16: 【4†Pricing】\nL17: \nL18: Resources\nL19: \nL20: 【5†Documentation】【6†Get started】【7†Tutorials】【8†Examples†github.com】【9†Prisma in your stack】【10†Ecosystem】【11†Customer stories】【12†Data guide】\nL21: \nL22: 【13†Playground†playground.prisma.io】\nL23: \nL24: 【14†Blog】\nL25: \nL26: 【15†Login†console.prisma.io】【6†Get started】\nL27: \nL28: July 19, 2022 \nL29: \nL30: # Building a REST API with NestJS and Prisma: Input Validation \u0026 Transformation\nL31: \nL32: 【16†Series】\nL33: \nL34: 【17†Tasin Ishmam @ tasinishmam†twitter.com】\nL35: \nL36: 8 min read\nL37: \nL38: Welcome to the second tutorial on the series about building a REST API with NestJS, Prisma and PostgreSQL! In this tutorial, you will learn how to perform input validation and transformation in your API.\nL39: \nL40: [Image 1]\nL41: \nL42: 【18†Part 1 Building a REST API with NestJS and Prisma】\nL43: \nL44: Part 2\nL45: \nL46: (Currently reading)\nL47: \nL48: Building a REST API with NestJS and Prisma: Input Validation \u0026 Transformation\nL49: \nL50: 【19†Part 3 Building a REST API with NestJS and Prisma: Error Handling】【20†Part 4 Building a REST API with NestJS and Prisma: Handling Relational Data】【21†Part 5 Building a REST API with NestJS and Prisma: Authentication】\nL51: \nL52: ## Table Of Contents\nL53: \nL54:   * 【22†Introduction】\nL55:     * 【23†Development environment】\nL56:     * 【24†Clone the repository】\nL57:     * 【25†Project structure and files】\nL58:   * 【26†Perform input validation】\nL59:     * 【27†Set up ValidationPipe globally】\nL60:     * 【28†Add validation rules to CreateArticleDto】\nL61:     * 【29†Strip unnecessary properties from client requests】\nL62:   * 【30†Use ParseIntPipe to transform dynamic URL paths】\nL63:   * 【31†Summary and final remarks】\nL64: \nL65: ## Introduction \nL66: \nL67: In the 【18†first part】 of this series, you created a new NestJS project and integrated it with Prisma, PostgreSQL and Swagger. Then, you built a rudimentary REST API for the backend of a blog application.\nL68: \nL69: In this part, you will learn how to validate the input, so it conforms to your API specifications. Input validation is performed to ensure only properly formed data from the client passes through your API. It is best practice to validate the correctness of any data sent into a web application. This can help prevent malformed data and abuse of your API.\nL70: \nL71: You will also learn how to perform input transformation. Input transformation is a technique that allows you to intercept and transform data sent from the client before being processed by the route handler for that request. This is useful for converting data to appropriate types, applying default values to missing fields, sanitizing input, etc.\nL72: \nL73: ### Development environment \nL74: \nL75: To follow along with this tutorial, you will be expected to have:\nL76: \nL77:   * 【32†Node.js†nodejs.org】 installed.\nL78:   * 【33†Docker†www.docker.com】 or 【34†PostgreSQL†www.postgresql.org】 installed.\nL79:   * Installed the 【35†Prisma VSCode Extension†marketplace.visualstudio.com】. (optional)\nL80:   * Access to a Unix shell (like the terminal/shell in Linux and macOS) to run the commands provided in this series. (optional)\nL81: \nL82: \u003e Note:\nL83: \u003e \nL84: \u003e   1. The optional Prisma VS Code extension adds some nice IntelliSense and syntax highlighting for Prisma.\nL85: \u003e \nL86: \u003e   2. If you don't have a Unix shell (for example, you are on a Windows machine), you can still follow along, but the shell commands may need to be modified for your machine.\nL87: \u003e \nL88: \u003e \nL89: \nL90: ### Clone the repository \nL91: \nL92: The starting point for this tutorial is the ending of 【18†part one】 of this series. It contains a rudimentary REST API built with NestJS. I would recommend finishing the first tutorial before starting this one.\nL93: \nL94: The starting point for this tutorial is available in the 【36†begin-validation†github.com】 branch of the 【37†GitHub repository†github.com】. To get started, clone the repository and checkout the `begin-validation` branch:\nL95: \nL96:     git clone -b begin-validation git@github.com:prisma/blog-backend-rest-api-nestjs-prisma.git \nL97: \nL98:     Copy\nL99: \nL100: Now, perform the following actions to get started:\nL101: \nL102:   1. Navigate to the cloned directory:\nL103: \nL104:         cd blog-backend-rest-api-nestjs-prisma \nL105: \nL106:     Copy\nL107: \nL108:   2. Install dependencies:\nL109: \nL110:         npm install \nL111: \nL112:     Copy\nL113: \nL114:   3. Start the PostgreSQL database with docker:\nL115: \nL116:         docker-compose up -d \nL117: \nL118:     Copy\nL119: \nL120:   4. Apply database migrations:\nL121: \nL122:         npx prisma migrate dev \nL123: \nL124:     Copy\nL125: \nL126:   5. Start the project:\nL127: \nL128:         npm run start:dev \nL129: \nL130:     Copy\nL131: \nL132: \u003e Note: Step 4 will also generate Prisma Client and seed the database.\nL133: \nL134: Now, you should be able to access the API documentation at 【38†http://localhost:3000/api/†localhost:3000】.\nL135: \nL136: ### Project structure and files \nL137: \nL138: The repository you cloned should have the following structure:\nL139: \nL140:     median\nL141: \nL142:       ├── node_modules\nL143: \nL144:       ├── prisma\nL145: \nL146:       │   ├── migrations\nL147: \nL148:       │   ├── schema.prisma\nL149: \nL150:       │   └── seed.ts\nL151: \nL152:       ├── src\nL153: \nL154:       │   ├── app.controller.spec.ts\nL155: \nL156:       │   ├── app.controller.ts\nL157: \nL158:       │   ├── app.module.ts\nL159: \nL160:       │   ├── app.service.ts\nL161: \nL162:       │   ├── main.ts\nL163: \nL164:       │   ├── articles\nL165: \nL166:       │   └── prisma\nL167: \nL168:       ├── test\nL169: \nL170:       │   ├── app.e2e-spec.ts\nL171: \nL172:       │   └── jest-e2e.json\nL173: \nL174:       ├── README.md\nL175: \nL176:       ├── .env\nL177: \nL178:       ├── docker-compose.yml\nL179: \nL180:       ├── nest-cli.json\nL181: \nL182:       ├── package-lock.json\nL183: \nL184:       ├── package.json\nL185: \nL186:       ├── tsconfig.build.json\nL187: \nL188:       └── tsconfig.json \nL189: \nL190: The notable files and directories in this repository are:\nL191: \nL192:   * The `src` directory contains the source code for the application. There are three modules:\nL193:     * The `app` module is situated in the root of the `src` directory and is the entry point of the application. It is responsible for starting the web server.\nL194:     * The `prisma` module contains the Prisma Client, your database query builder.\nL195:     * The `articles` module defines the endpoints for the `/articles` route and accompanying business logic.\nL196:   * The `prisma` module has the following:\nL197:     * The `schema.prisma` file defines the database schema.\nL198:     * The `migrations` directory contains the database migration history.\nL199:     * The `seed.ts` file contains a script to seed your development database with dummy data.\nL200:   * The `docker-compose.yml` file defines the Docker image for your PostgreSQL database.\nL201:   * The `.env` file contains the database connection string for your PostgreSQL database.\nL202: \nL203: \u003e Note: For more information about these components, go through 【18†part one】 of this tutorial series.\nL204: \nL205: ## Perform input validation \nL206: \nL207: To perform input validation, you will be using 【39†NestJS Pipes†docs.nestjs.com】. Pipes operate on the arguments being processed by a route handler. Nest invokes a pipe before the route handler, and the pipe receives the arguments destined for the route handler. Pipes can do a number of things, like validate the input, add fields to the input, etc. Pipes are similar to 【40†middleware†docs.nestjs.com】, but the scope of pipes is limited to processing input arguments. NestJS provides a few pipes out-of-the-box, but you can also create your own 【41†custom pipes†docs.nestjs.com】.\nL208: \nL209: Pipes have two typical use cases:\nL210: \nL211:   * Validation: Evaluate input data and, if valid, pass it through unchanged; otherwise, throw an exception when the data is incorrect.\nL212:   * Transformation: Transform input data to the desired form (e.g., from string to integer).\nL213: \nL214: A NestJS validation pipe will check the arguments passed to a route. If the arguments are vaid, the pipe will pass the arguments to the route handler without any modification. However, if the arguments violate any of the specified validation rules, the pipe will throw an exception.\nL215: \nL216: The following two diagrams shows how validation pipe works, for an arbitrary `/example` route.\nL217: \nL218: [Image 2] [Image 3]\nL219: \nL220: In this section, you will focus on the validation use case.\nL221: \nL222: ### Set up `ValidationPipe` globally \nL223: \nL224: To perform input validation, you will be using the built-in NestJS `ValidationPipe`. The `ValidationPipe` provides a convenient approach to enforce validation rules for all incoming client payloads, where the validation rules are declared with decorators from the `class-validator` package.\nL225: \nL226: To use this feature, you will need to add two packages to your project:\nL227: \nL228:     npm install class-validator class-transformer \nL229: \nL230:     Copy\nL231: \nL232: The class-validator package provides decorators for validating input data, and the class-transformer package provides decorators to transform input data to the desired form. Both packages are well integrated with NestJS pipes.\nL233: \nL234: Now import the `ValidationPipe` in your `main.ts` file and use the `app.useGlobalPipes` method to make it available globally in your application:\nL235: \nL236:     // src/main.ts\nL237: \nL238:     import { NestFactory } from '@nestjs/core';\nL239: \nL240:     import { AppModule } from './app.module';\nL241: \nL242:     import { SwaggerModule, DocumentBuilder } from '@nestjs/swagger';\nL243: \nL244:     +import { ValidationPipe } from '@nestjs/common';\nL245: \nL246:     async function bootstrap() {\nL247: \nL248:       const app = await NestFactory.create(AppModule);\nL249: \nL250:     +  app.useGlobalPipes(new ValidationPipe());\nL251: \nL252:       const config = new DocumentBuilder()\nL253: \nL254:         .setTitle('Median')\nL255: \nL256:         .setDescription('The Median API description')\nL257: \nL258:         .setVersion('0.1')\nL259: \nL260:         .build();\nL261: \nL262:       const document = SwaggerModule.createDocument(app, config);\nL263: \nL264:       SwaggerModule.setup('api', app, document);\nL265: \nL266:       await app.listen(3000);\nL267: \nL268:     }\nL269: \nL270:     bootstrap();\nL271: \nL272:     Copy\nL273: \nL274: ### Add validation rules to `CreateArticleDto `\nL275: \nL276: You will now use the 【42†class-validator†github.com】 package to add validation decorators to `CreateArticleDto`. You will apply the following rules to `CreateArticleDto`:\nL277: \nL278:   1. `title` can't be empty or shorter than 5 characters.\nL279:   2. `description` has to have a maximum length of 300.\nL280:   3. `body` and `description` can't be empty.\nL281:   4. `title`, `description` and `body` must be of type `string` and `published` must be of type `boolean`.\nL282: \nL283: Open the `src/articles/dto/create-article.dto.ts` file and replace its contents with the following:\nL284: \nL285:     // src/articles/dto/create-article.dto.ts\nL286: \nL287:     import { ApiProperty } from '@nestjs/swagger';\nL288: \nL289:     import {\nL290: \nL291:       IsBoolean,\nL292: \nL293:       IsNotEmpty,\nL294: \nL295:       IsOptional,\nL296: \nL297:       IsString,\nL298: \nL299:       MaxLength,\nL300: \nL301:       MinLength,\nL302: \nL303:     } from 'class-validator';\nL304: \nL305:     export class CreateArticleDto {\nL306: \nL307:       @IsString()\nL308: \nL309:       @IsNotEmpty()\nL310: \nL311:       @MinLength(5)\nL312: \nL313:       @ApiProperty()\nL314: \nL315:       title: string;\nL316: \nL317:       @IsString()\nL318: \nL319:       @IsOptional()\nL320: \nL321:       @IsNotEmpty()\nL322: \nL323:       @MaxLength(300)\nL324: \nL325:       @ApiProperty({ required: false })\nL326: \nL327:       description?: string;\nL328: \nL329:       @IsString()\nL330: \nL331:       @IsNotEmpty()\nL332: \nL333:       @ApiProperty()\nL334: \nL335:       body: string;\nL336: \nL337:       @IsBoolean()\nL338: \nL339:       @IsOptional()\nL340: \nL341:       @ApiProperty({ required: false, default: false })\nL342: \nL343:       published?: boolean = false;\nL344: \nL345:     }\nL346: \nL347:     Copy\nL348: \nL349: These rules will be picked up by the `ValidationPipe` and applied automatically to your route handlers. One of the advantages of using decorators for validation is that the `CreateArticleDto` remains the single source of truth for all arguments to the `POST /articles` endpoint. So you don't need to define a separate validation class.\nL350: \nL351: Test out the validation rules you have in place. Try creating an article using the `POST /articles` endpoint with a very short placeholder `title` like this:\nL352: \nL353:     {\nL354: \nL355:       \"title\": \"Temp\",\nL356: \nL357:       \"description\": \"Learn about input validation\",\nL358: \nL359:       \"body\": \"Input validation is...\",\nL360: \nL361:       \"published\": false\nL362: \nL363:     }\nL364: \nL365:     Copy\nL366: \nL367: You should get an HTTP 400 error response along with details in the response body about what validation rule was broken.\nL368: \nL369: [Image 4: HTTP 400 response with descriptive error message]\nL370: \nL371: This diagram explains what the `ValidationPipe` is doing under the hood for invalid inputs to the `/articles` route:\nL372: \nL373: [Image 5: Input validation flow with ValidationPipe]\nL374: \nL375: ### Strip unnecessary properties from client requests \nL376: \nL377: The `CreateArticleDTO` defines the properties that need to be sent to the `POST /articles` endpoint to create a new article. `UpdateArticleDTO` does the same, but for the `PATCH /articles/{id}` endpoint.\nL378: \nL379: Currently, for both of these endpoints it is possible to send additional properties that are not defined in the DTO. This can lead to unforeseen bugs or security issues. For example, you could manually pass invalid `createdAt` and `updatedAt` values to the `POST /articles` endpoint. Since TypeScript type information is not available at run-time, your application will not be able to identify that these fields are not available in the DTO.\nL380: \nL381: To give an example, try sending the following request to the `POST /articles` endpoint:\nL382: \nL383:     {\nL384: \nL385:       \"title\": \"example-title\",\nL386: \nL387:       \"description\": \"example-description\",\nL388: \nL389:       \"body\": \"example-body\",\nL390: \nL391:       \"published\": true,\nL392: \nL393:       \"createdAt\": \"2010-06-08T18:20:29.309Z\",\nL394: \nL395:       \"updatedAt\": \"2021-06-02T18:20:29.310Z\"\nL396: \nL397:     }\nL398: \nL399:     Copy\nL400: \nL401: [Image 6]\nL402: \nL403: In this way, you can inject invalid values. Here you have created an article that has an `updatedAt` value that precedes `createdAt`, which does not make sense.\nL404: \nL405: To prevent this, you will need to filter any unnecessary fields/properties from client requests. Fortunately, NestJS provides an out-of-the-box for this as well. All you need to do is pass the `whitelist: true` option when initializing the `ValidationPipe` inside your application.\nL406: \nL407:     // src/main.ts\nL408: \nL409:     import { NestFactory } from '@nestjs/core';\nL410: \nL411:     import { AppModule } from './app.module';\nL412: \nL413:     import { SwaggerModule, DocumentBuilder } from '@nestjs/swagger';\nL414: \nL415:     import { ValidationPipe } from '@nestjs/common';\nL416: \nL417:     async function bootstrap() {\nL418: \nL419:       const app = await NestFactory.create(AppModule);\nL420: \nL421:     +  app.useGlobalPipes(new ValidationPipe({ whitelist: true }));\nL422: \nL423:       const config = new DocumentBuilder()\nL424: \nL425:         .setTitle('Median')\nL426: \nL427:         .setDescription('The Median API description')\nL428: \nL429:         .setVersion('0.1')\nL430: \nL431:         .build();\nL432: \nL433:       const document = SwaggerModule.createDocument(app, config);\nL434: \nL435:       SwaggerModule.setup('api', app, document);\nL436: \nL437:       await app.listen(3000);\nL438: \nL439:     }\nL440: \nL441:     bootstrap();\nL442: \nL443:     Copy\nL444: \nL445: With this option set to true, `ValidationPipe` will automatically remove all non-whitelisted properties, where “non-whitelisted” means properties without any validation decorators. It’s important to note that this option will filter all properties without validation decorators, even if they are defined in the DTO.\nL446: \nL447: Now, any additional fields/properties that are passed to the request will be stripped automatically by NestJS, preventing the previously shown exploit.\nL448: \nL449: \u003e Note: The NestJS `ValidationPipe` is highly configurable. All configuration options available are documented in the 【43†NestJS docs†docs.nestjs.com】. If necessary, you can also build 【41†custom validation pipes†docs.nestjs.com】 for your application.\nL450: \nL451: ## Transform dynamic URL paths with `ParseIntPipe `\nL452: \nL453: Inside your API, you are currently accepting the id parameter for the `GET /articles/{id}` , `PATCH /articles/{id}` and `DELETE /articles/{id}` endpoints as a part of the path. NestJS parses the `id` parameter as a string from the URL path. Then, the string is cast to a number inside your application code before being passed to the ArticlesService. For example, take a look at the `DELETE /articles/{id}` route handler:\nL454: \nL455:     // src/articles/articles.controller.ts\nL456: \nL457:     @Delete(':id')\nL458: \nL459:     @ApiOkResponse({ type: ArticleEntity })\nL460: \nL461:     remove(@Param('id') id: string) {   // id is parsed as a string\nL462: \nL463:       return this.articlesService.remove(+id); // id is converted to number using the expression '+id'\nL464: \nL465:     }\nL466: \nL467: Since `id` is defined as a string type, the Swagger API also documents this argument as a string in the generated API documentation. This is unintuitive and incorrect.\nL468: \nL469: [Image 7]\nL470: \nL471: Instead of doing this transformation manually inside the route handler, you can use a NestJS pipe to convert `id` to a number automatically. Add the built-in `ParseIntPipe` to the controller route handlers for these three endpoints:\nL472: \nL473:     // src/articles/articles.controller.ts\nL474: \nL475:     import {\nL476: \nL477:       Controller,\nL478: \nL479:       Get,\nL480: \nL481:       Post,\nL482: \nL483:       Body,\nL484: \nL485:       Patch,\nL486: \nL487:       Param,\nL488: \nL489:       Delete,\nL490: \nL491:       NotFoundException,\nL492: \nL493:     +  ParseIntPipe,\nL494: \nL495:     } from '@nestjs/common';\nL496: \nL497:     export class ArticlesController {\nL498: \nL499:       // ...\nL500: \nL501:       @Get(':id')\nL502: \nL503:       @ApiOkResponse({ type: ArticleEntity })\nL504: \nL505:     +  findOne(@Param('id', ParseIntPipe) id: number) {\nL506: \nL507:     +    return this.articlesService.findOne(id);\nL508: \nL509:       }\nL510: \nL511:       @Patch(':id')\nL512: \nL513:       @ApiCreatedResponse({ type: ArticleEntity })\nL514: \nL515:       update(\nL516: \nL517:     +    @Param('id', ParseIntPipe) id: number,\nL518: \nL519:         @Body() updateArticleDto: UpdateArticleDto,\nL520: \nL521:       ) {\nL522: \nL523:     +    return this.articlesService.update(id, updateArticleDto);\nL524: \nL525:       }\nL526: \nL527:       @Delete(':id')\nL528: \nL529:       @ApiOkResponse({ type: ArticleEntity })\nL530: \nL531:     +  remove(@Param('id', ParseIntPipe) id: number) {\nL532: \nL533:     +    return this.articlesService.remove(id);\nL534: \nL535:       }\nL536: \nL537:     }\nL538: \nL539:     Copy\nL540: \nL541: The `ParseIntPipe` will intercept the `id` parameter of string type and automatically parse it to a number before passing it to the appropriate route handler. This also has the advantage of documenting the `id` parameter correctly as a number inside Swagger.\nL542: \nL543: [Image 8]\nL544: \nL545: ## Summary and final remarks \nL546: \nL547: Congratulations! In this tutorial, you took an existing REST API and:\nL548: \nL549:   * Integrated validation using the `ValidationPipe`.\nL550:   * Stripped client request of unnecessary properties.\nL551:   * Integrated `ParseIntPipe` to parse a `string` path variable and convert it to a `number`.\nL552: \nL553: You might have noticed that NestJS heavily relies on decorators. This is a very intentional design choice. NestJS aims to improve code readability and modularity by heavily leveraging decorators for various kinds of 【44†cross-cutting concerns†en.wikipedia.org】. As a result, controllers and service methods do not need to be bloated with boilerplate code for doing things like validation, caching, logging, etc.\nL554: \nL555: You can find the finished code for this tutorial in the 【45†end-validation branch†github.com】 of the 【37†GitHub repository†github.com】. Please feel free to raise an issue in the repository or submit a PR if you notice a problem. You can also reach out to me directly on 【17†Twitter†twitter.com】.\nL556: \nL557: 【46†Education】\nL558: \nL559: ### Don’t miss the next post!\nL560: \nL561: Sign up for the Prisma Newsletter\nL562: \nL563: 【47†Key takeaways from the Discover Data DX virtual event December 13, 2023 Explore the insights from the Discover Data DX virtual event held on December 7th, 2023. The event brought together industry leaders to discuss the significance and principles of the emerging Data DX category. Announcement】\nL564: \nL565: 【50†Prisma Accelerate now in General Availability October 26, 2023 Now in General Availability: Dive into Prisma Accelerate , enhancing global database connections with connection pooling and edge caching for fast data access. Announcement Data Platform】\nL566: \nL567: 【53†Support for Serverless Database Drivers in Prisma ORM Is Now in Preview October 06, 2023 Prisma is releasing Preview support for serverless database drivers from Neon and PlanetScale . This feature allows Prisma users to leverage the existing database drivers for communication with their database without long-lived TCP connections! Prisma ORM Serverless Release】\nL568: \nL569: #### Product\nL570: \nL571: 【0†Client】【1†Migrate】【2†Accelerate】【3†Pulse Early Access】【4†Pricing】\nL572: \nL573: #### Developers\nL574: \nL575: 【5†Docs】【6†Get Started】【8†Prisma Examples†github.com】【12†Data Guide】【9†Prisma in your Stack】【57†Support】【58†Community】【59†Data Platform Status†www.prisma-status.com】【35†VS Code Extension†marketplace.visualstudio.com】\nL576: \nL577: #### Use Cases\nL578: \nL579: 【11†Customer Stories】【60†Enterprise】\nL580: \nL581: #### Company\nL582: \nL583: 【61†About】【14†Blog】【62†Careers 】【63†Events】【64†Causes†pris.ly】【65†Terms \u0026 Privacy†pris.ly】【66†Service Level Agreement†pris.ly】\nL584: \nL585: #### Newsletter\nL586: \nL587: [Image 9: prisma_logo]\nL588: \nL589: © 2023 Prisma Data, Inc.\nL590: \nL591:\nVisible: 0% - 100%","summary":"Learn how to add Input Validation to a REST API with NestJS and Prisma (www.prisma.io)\n","assets":[]},"status":"finished_successfully","weight":0,"metadata":{"_cite_metadata":{"citation_format":{"name":"tether_og"},"metadata_list":[{"type":"webpage","title":"Learn how to add Input Validation to a REST API with NestJS and Prisma","url":"https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1","text":"L0: \nL1: URL: https://www.prisma.io/blog/nestjs-prisma-validation-7D056s1kOla1\nL2: \nL3: \nL4: [Image 0: prisma_logo]\nL5: \nL6: Products \nL7: \nL8: #### Prisma ORM\nL9: \nL10: Client Write Queries the way you thinkMigrate Generate customizable SQL migrations\nL11: \nL12: #### Prisma Data Platform\nL13: \nL14: Accelerate Query up to 1000x fasterPulse Early Access Real-time database events\nL15: \nL16: Pricing\nL17: \nL18: Resources\nL19: \nL20: DocumentationGet startedTutorialsExamplesPrisma in your stackEcosystemCustomer storiesData guide\nL21: \nL22: Playground\nL23: \nL24: Blog\nL25: \nL26: LoginGet started\nL27: \nL28: July 19, 2022 \nL29: \nL30: # Building a REST API with NestJS and Prisma: Input Validation \u0026 Transformation\nL31: \nL32: Series\nL33: \nL34: Tasin Ishmam @ tasinishmam\nL35: \nL36: 8 min read\nL37: \nL38: Welcome to the second tutorial on the series about building a REST API with NestJS, Prisma and PostgreSQL! In this tutorial, you will learn how to perform input validation and transformation in your API.\nL39: \nL40: [Image 1]\nL41: \nL42: Part 1 Building a REST API with NestJS and Prisma\nL43: \nL44: Part 2\nL45: \nL46: (Currently reading)\nL47: \nL48: Building a REST API with NestJS and Prisma: Input Validation \u0026 Transformation\nL49: \nL50: Part 3 Building a REST API with NestJS and Prisma: Error HandlingPart 4 Building a REST API with NestJS and Prisma: Handling Relational DataPart 5 Building a REST API with NestJS and Prisma: Authentication\nL51: \nL52: ## Table Of Contents\nL53: \nL54:   * Introduction\nL55:     * Development environment\nL56:     * Clone the repository\nL57:     * Project structure and files\nL58:   * Perform input validation\nL59:     * Set up ValidationPipe globally\nL60:     * Add validation rules to CreateArticleDto\nL61:     * Strip unnecessary properties from client requests\nL62:   * Use ParseIntPipe to transform dynamic URL paths\nL63:   * Summary and final remarks\nL64: \nL65: ## Introduction \nL66: \nL67: In the first part of this series, you created a new NestJS project and integrated it with Prisma, PostgreSQL and Swagger. Then, you built a rudimentary REST API for the backend of a blog application.\nL68: \nL69: In this part, you will learn how to validate the input, so it conforms to your API specifications. Input validation is performed to ensure only properly formed data from the client passes through your API. It is best practice to validate the correctness of any data sent into a web application. This can help prevent malformed data and abuse of your API.\nL70: \nL71: You will also learn how to perform input transformation. Input transformation is a technique that allows you to intercept and transform data sent from the client before being processed by the route handler for that request. This is useful for converting data to appropriate types, applying default values to missing fields, sanitizing input, etc.\nL72: \nL73: ### Development environment \nL74: \nL75: To follow along with this tutorial, you will be expected to have:\nL76: \nL77:   * Node.js installed.\nL78:   * Docker or PostgreSQL installed.\nL79:   * Installed the Prisma VSCode Extension. (optional)\nL80:   * Access to a Unix shell (like the terminal/shell in Linux and macOS) to run the commands provided in this series. (optional)\nL81: \nL82: \u003e Note:\nL83: \u003e \nL84: \u003e   1. The optional Prisma VS Code extension adds some nice IntelliSense and syntax highlighting for Prisma.\nL85: \u003e \nL86: \u003e   2. If you don't have a Unix shell (for example, you are on a Windows machine), you can still follow along, but the shell commands may need to be modified for your machine.\nL87: \u003e \nL88: \u003e \nL89: \nL90: ### Clone the repository \nL91: \nL92: The starting point for this tutorial is the ending of part one of this series. It contains a rudimentary REST API built with NestJS. I would recommend finishing the first tutorial before starting this one.\nL93: \nL94: The starting point for this tutorial is available in the begin-validation branch of the GitHub repository. To get started, clone the repository and checkout the `begin-validation` branch:\nL95: \nL96:     git clone -b begin-validation git@github.com:prisma/blog-backend-rest-api-nestjs-prisma.git \nL97: \nL98:     Copy\nL99: \nL100: Now, perform the following actions to get started:\nL101: \nL102:   1. Navigate to the cloned directory:\nL103: \nL104:         cd blog-backend-rest-api-nestjs-prisma \nL105: \nL106:     Copy\nL107: \nL108:   2. Install dependencies:\nL109: \nL110:         npm install \nL111: \nL112:     Copy\nL113: \nL114:   3. Start the PostgreSQL database with docker:\nL115: \nL116:         docker-compose up -d \nL117: \nL118:     Copy\nL119: \nL120:   4. Apply database migrations:\nL121: \nL122:         npx prisma migrate dev \nL123: \nL124:     Copy\nL125: \nL126:   5. Start the project:\nL127: \nL128:         npm run start:dev \nL129: \nL130:     Copy\nL131: \nL132: \u003e Note: Step 4 will also generate Prisma Client and seed the database.\nL133: \nL134: Now, you should be able to access the API documentation at http://localhost:3000/api/.\nL135: \nL136: ### Project structure and files \nL137: \nL138: The repository you cloned should have the following structure:\nL139: \nL140:     median\nL141: \nL142:       ├── node_modules\nL143: \nL144:       ├── prisma\nL145: \nL146:       │   ├── migrations\nL147: \nL148:       │   ├── schema.prisma\nL149: \nL150:       │   └── seed.ts\nL151: \nL152:       ├── src\nL153: \nL154:       │   ├── app.controller.spec.ts\nL155: \nL156:       │   ├── app.controller.ts\nL157: \nL158:       │   ├── app.module.ts\nL159: \nL160:       │   ├── app.service.ts\nL161: \nL162:       │   ├── main.ts\nL163: \nL164:       │   ├── articles\nL165: \nL166:       │   └── prisma\nL167: \nL168:       ├── test\nL169: \nL170:       │   ├── app.e2e-spec.ts\nL171: \nL172:       │   └── jest-e2e.json\nL173: \nL174:       ├── README.md\nL175: \nL176:       ├── .env\nL177: \nL178:       ├── docker-compose.yml\nL179: \nL180:       ├── nest-cli.json\nL181: \nL182:       ├── package-lock.json\nL183: \nL184:       ├── package.json\nL185: \nL186:       ├── tsconfig.build.json\nL187: \nL188:       └── tsconfig.json \nL189: \nL190: The notable files and directories in this repository are:\nL191: \nL192:   * The `src` directory contains the source code for the application. There are three modules:\nL193:     * The `app` module is situated in the root of the `src` directory and is the entry point of the application. It is responsible for starting the web server.\nL194:     * The `prisma` module contains the Prisma Client, your database query builder.\nL195:     * The `articles` module defines the endpoints for the `/articles` route and accompanying business logic.\nL196:   * The `prisma` module has the following:\nL197:     * The `schema.prisma` file defines the database schema.\nL198:     * The `migrations` directory contains the database migration history.\nL199:     * The `seed.ts` file contains a script to seed your development database with dummy data.\nL200:   * The `docker-compose.yml` file defines the Docker image for your PostgreSQL database.\nL201:   * The `.env` file contains the database connection string for your PostgreSQL database.\nL202: \nL203: \u003e Note: For more information about these components, go through part one of this tutorial series.\nL204: \nL205: ## Perform input validation \nL206: \nL207: To perform input validation, you will be using NestJS Pipes. Pipes operate on the arguments being processed by a route handler. Nest invokes a pipe before the route handler, and the pipe receives the arguments destined for the route handler. Pipes can do a number of things, like validate the input, add fields to the input, etc. Pipes are similar to middleware, but the scope of pipes is limited to processing input arguments. NestJS provides a few pipes out-of-the-box, but you can also create your own custom pipes.\nL208: \nL209: Pipes have two typical use cases:\nL210: \nL211:   * Validation: Evaluate input data and, if valid, pass it through unchanged; otherwise, throw an exception when the data is incorrect.\nL212:   * Transformation: Transform input data to the desired form (e.g., from string to integer).\nL213: \nL214: A NestJS validation pipe will check the arguments passed to a route. If the arguments are vaid, the pipe will pass the arguments to the route handler without any modification. However, if the arguments violate any of the specified validation rules, the pipe will throw an exception.\nL215: \nL216: The following two diagrams shows how validation pipe works, for an arbitrary `/example` route.\nL217: \nL218: [Image 2] [Image 3]\nL219: \nL220: In this section, you will focus on the validation use case.\nL221: \nL222: ### Set up `ValidationPipe` globally \nL223: \nL224: To perform input validation, you will be using the built-in NestJS `ValidationPipe`. The `ValidationPipe` provides a convenient approach to enforce validation rules for all incoming client payloads, where the validation rules are declared with decorators from the `class-validator` package.\nL225: \nL226: To use this feature, you will need to add two packages to your project:\nL227: \nL228:     npm install class-validator class-transformer \nL229: \nL230:     Copy\nL231: \nL232: The class-validator package provides decorators for validating input data, and the class-transformer package provides decorators to transform input data to the desired form. Both packages are well integrated with NestJS pipes.\nL233: \nL234: Now import the `ValidationPipe` in your `main.ts` file and use the `app.useGlobalPipes` method to make it available globally in your application:\nL235: \nL236:     // src/main.ts\nL237: \nL238:     import { NestFactory } from '@nestjs/core';\nL239: \nL240:     import { AppModule } from './app.module';\nL241: \nL242:     import { SwaggerModule, DocumentBuilder } from '@nestjs/swagger';\nL243: \nL244:     +import { ValidationPipe } from '@nestjs/common';\nL245: \nL246:     async function bootstrap() {\nL247: \nL248:       const app = await NestFactory.create(AppModule);\nL249: \nL250:     +  app.useGlobalPipes(new ValidationPipe());\nL251: \nL252:       const config = new DocumentBuilder()\nL253: \nL254:         .setTitle('Median')\nL255: \nL256:         .setDescription('The Median API description')\nL257: \nL258:         .setVersion('0.1')\nL259: \nL260:         .build();\nL261: \nL262:       const document = SwaggerModule.createDocument(app, config);\nL263: \nL264:       SwaggerModule.setup('api', app, document);\nL265: \nL266:       await app.listen(3000);\nL267: \nL268:     }\nL269: \nL270:     bootstrap();\nL271: \nL272:     Copy\nL273: \nL274: ### Add validation rules to `CreateArticleDto `\nL275: \nL276: You will now use the class-validator package to add validation decorators to `CreateArticleDto`. You will apply the following rules to `CreateArticleDto`:\nL277: \nL278:   1. `title` can't be empty or shorter than 5 characters.\nL279:   2. `description` has to have a maximum length of 300.\nL280:   3. `body` and `description` can't be empty.\nL281:   4. `title`, `description` and `body` must be of type `string` and `published` must be of type `boolean`.\nL282: \nL283: Open the `src/articles/dto/create-article.dto.ts` file and replace its contents with the following:\nL284: \nL285:     // src/articles/dto/create-article.dto.ts\nL286: \nL287:     import { ApiProperty } from '@nestjs/swagger';\nL288: \nL289:     import {\nL290: \nL291:       IsBoolean,\nL292: \nL293:       IsNotEmpty,\nL294: \nL295:       IsOptional,\nL296: \nL297:       IsString,\nL298: \nL299:       MaxLength,\nL300: \nL301:       MinLength,\nL302: \nL303:     } from 'class-validator';\nL304: \nL305:     export class CreateArticleDto {\nL306: \nL307:       @IsString()\nL308: \nL309:       @IsNotEmpty()\nL310: \nL311:       @MinLength(5)\nL312: \nL313:       @ApiProperty()\nL314: \nL315:       title: string;\nL316: \nL317:       @IsString()\nL318: \nL319:       @IsOptional()\nL320: \nL321:       @IsNotEmpty()\nL322: \nL323:       @MaxLength(300)\nL324: \nL325:       @ApiProperty({ required: false })\nL326: \nL327:       description?: string;\nL328: \nL329:       @IsString()\nL330: \nL331:       @IsNotEmpty()\nL332: \nL333:       @ApiProperty()\nL334: \nL335:       body: string;\nL336: \nL337:       @IsBoolean()\nL338: \nL339:       @IsOptional()\nL340: \nL341:       @ApiProperty({ required: false, default: false })\nL342: \nL343:       published?: boolean = false;\nL344: \nL345:     }\nL346: \nL347:     Copy\nL348: \nL349: These rules will be picked up by the `ValidationPipe` and applied automatically to your route handlers. One of the advantages of using decorators for validation is that the `CreateArticleDto` remains the single source of truth for all arguments to the `POST /articles` endpoint. So you don't need to define a separate validation class.\nL350: \nL351: Test out the validation rules you have in place. Try creating an article using the `POST /articles` endpoint with a very short placeholder `title` like this:\nL352: \nL353:     {\nL354: \nL355:       \"title\": \"Temp\",\nL356: \nL357:       \"description\": \"Learn about input validation\",\nL358: \nL359:       \"body\": \"Input validation is...\",\nL360: \nL361:       \"published\": false\nL362: \nL363:     }\nL364: \nL365:     Copy\nL366: \nL367: You should get an HTTP 400 error response along with details in the response body about what validation rule was broken.\nL368: \nL369: [Image 4: HTTP 400 response with descriptive error message]\nL370: \nL371: This diagram explains what the `ValidationPipe` is doing under the hood for invalid inputs to the `/articles` route:\nL372: \nL373: [Image 5: Input validation flow with ValidationPipe]\nL374: \nL375: ### Strip unnecessary properties from client requests \nL376: \nL377: The `CreateArticleDTO` defines the properties that need to be sent to the `POST /articles` endpoint to create a new article. `UpdateArticleDTO` does the same, but for the `PATCH /articles/{id}` endpoint.\nL378: \nL379: Currently, for both of these endpoints it is possible to send additional properties that are not defined in the DTO. This can lead to unforeseen bugs or security issues. For example, you could manually pass invalid `createdAt` and `updatedAt` values to the `POST /articles` endpoint. Since TypeScript type information is not available at run-time, your application will not be able to identify that these fields are not available in the DTO.\nL380: \nL381: To give an example, try sending the following request to the `POST /articles` endpoint:\nL382: \nL383:     {\nL384: \nL385:       \"title\": \"example-title\",\nL386: \nL387:       \"description\": \"example-description\",\nL388: \nL389:       \"body\": \"example-body\",\nL390: \nL391:       \"published\": true,\nL392: \nL393:       \"createdAt\": \"2010-06-08T18:20:29.309Z\",\nL394: \nL395:       \"updatedAt\": \"2021-06-02T18:20:29.310Z\"\nL396: \nL397:     }\nL398: \nL399:     Copy\nL400: \nL401: [Image 6]\nL402: \nL403: In this way, you can inject invalid values. Here you have created an article that has an `updatedAt` value that precedes `createdAt`, which does not make sense.\nL404: \nL405: To prevent this, you will need to filter any unnecessary fields/properties from client requests. Fortunately, NestJS provides an out-of-the-box for this as well. All you need to do is pass the `whitelist: true` option when initializing the `ValidationPipe` inside your application.\nL406: \nL407:     // src/main.ts\nL408: \nL409:     import { NestFactory } from '@nestjs/core';\nL410: \nL411:     import { AppModule } from './app.module';\nL412: \nL413:     import { SwaggerModule, DocumentBuilder } from '@nestjs/swagger';\nL414: \nL415:     import { ValidationPipe } from '@nestjs/common';\nL416: \nL417:     async function bootstrap() {\nL418: \nL419:       const app = await NestFactory.create(AppModule);\nL420: \nL421:     +  app.useGlobalPipes(new ValidationPipe({ whitelist: true }));\nL422: \nL423:       const config = new DocumentBuilder()\nL424: \nL425:         .setTitle('Median')\nL426: \nL427:         .setDescription('The Median API description')\nL428: \nL429:         .setVersion('0.1')\nL430: \nL431:         .build();\nL432: \nL433:       const document = SwaggerModule.createDocument(app, config);\nL434: \nL435:       SwaggerModule.setup('api', app, document);\nL436: \nL437:       await app.listen(3000);\nL438: \nL439:     }\nL440: \nL441:     bootstrap();\nL442: \nL443:     Copy\nL444: \nL445: With this option set to true, `ValidationPipe` will automatically remove all non-whitelisted properties, where “non-whitelisted” means properties without any validation decorators. It’s important to note that this option will filter all properties without validation decorators, even if they are defined in the DTO.\nL446: \nL447: Now, any additional fields/properties that are passed to the request will be stripped automatically by NestJS, preventing the previously shown exploit.\nL448: \nL449: \u003e Note: The NestJS `ValidationPipe` is highly configurable. All configuration options available are documented in the NestJS docs. If necessary, you can also build custom validation pipes for your application.\nL450: \nL451: ## Transform dynamic URL paths with `ParseIntPipe `\nL452: \nL453: Inside your API, you are currently accepting the id parameter for the `GET /articles/{id}` , `PATCH /articles/{id}` and `DELETE /articles/{id}` endpoints as a part of the path. NestJS parses the `id` parameter as a string from the URL path. Then, the string is cast to a number inside your application code before being passed to the ArticlesService. For example, take a look at the `DELETE /articles/{id}` route handler:\nL454: \nL455:     // src/articles/articles.controller.ts\nL456: \nL457:     @Delete(':id')\nL458: \nL459:     @ApiOkResponse({ type: ArticleEntity })\nL460: \nL461:     remove(@Param('id') id: string) {   // id is parsed as a string\nL462: \nL463:       return this.articlesService.remove(+id); // id is converted to number using the expression '+id'\nL464: \nL465:     }\nL466: \nL467: Since `id` is defined as a string type, the Swagger API also documents this argument as a string in the generated API documentation. This is unintuitive and incorrect.\nL468: \nL469: [Image 7]\nL470: \nL471: Instead of doing this transformation manually inside the route handler, you can use a NestJS pipe to convert `id` to a number automatically. Add the built-in `ParseIntPipe` to the controller route handlers for these three endpoints:\nL472: \nL473:     // src/articles/articles.controller.ts\nL474: \nL475:     import {\nL476: \nL477:       Controller,\nL478: \nL479:       Get,\nL480: \nL481:       Post,\nL482: \nL483:       Body,\nL484: \nL485:       Patch,\nL486: \nL487:       Param,\nL488: \nL489:       Delete,\nL490: \nL491:       NotFoundException,\nL492: \nL493:     +  ParseIntPipe,\nL494: \nL495:     } from '@nestjs/common';\nL496: \nL497:     export class ArticlesController {\nL498: \nL499:       // ...\nL500: \nL501:       @Get(':id')\nL502: \nL503:       @ApiOkResponse({ type: ArticleEntity })\nL504: \nL505:     +  findOne(@Param('id', ParseIntPipe) id: number) {\nL506: \nL507:     +    return this.articlesService.findOne(id);\nL508: \nL509:       }\nL510: \nL511:       @Patch(':id')\nL512: \nL513:       @ApiCreatedResponse({ type: ArticleEntity })\nL514: \nL515:       update(\nL516: \nL517:     +    @Param('id', ParseIntPipe) id: number,\nL518: \nL519:         @Body() updateArticleDto: UpdateArticleDto,\nL520: \nL521:       ) {\nL522: \nL523:     +    return this.articlesService.update(id, updateArticleDto);\nL524: \nL525:       }\nL526: \nL527:       @Delete(':id')\nL528: \nL529:       @ApiOkResponse({ type: ArticleEntity })\nL530: \nL531:     +  remove(@Param('id', ParseIntPipe) id: number) {\nL532: \nL533:     +    return this.articlesService.remove(id);\nL534: \nL535:       }\nL536: \nL537:     }\nL538: \nL539:     Copy\nL540: \nL541: The `ParseIntPipe` will intercept the `id` parameter of string type and automatically parse it to a number before passing it to the appropriate route handler. This also has the advantage of documenting the `id` parameter correctly as a number inside Swagger.\nL542: \nL543: [Image 8]\nL544: \nL545: ## Summary and final remarks \nL546: \nL547: Congratulations! In this tutorial, you took an existing REST API and:\nL548: \nL549:   * Integrated validation using the `ValidationPipe`.\nL550:   * Stripped client request of unnecessary properties.\nL551:   * Integrated `ParseIntPipe` to parse a `string` path variable and convert it to a `number`.\nL552: \nL553: You might have noticed that NestJS heavily relies on decorators. This is a very intentional design choice. NestJS aims to improve code readability and modularity by heavily leveraging decorators for various kinds of cross-cutting concerns. As a result, controllers and service methods do not need to be bloated with boilerplate code for doing things like validation, caching, logging, etc.\nL554: \nL555: You can find the finished code for this tutorial in the end-validation branch of the GitHub repository. Please feel free to raise an issue in the repository or submit a PR if you notice a problem. You can also reach out to me directly on Twitter.\nL556: \nL557: Education\nL558: \nL559: ### Don’t miss the next post!\nL560: \nL561: Sign up for the Prisma Newsletter\nL562: \nL563: Key takeaways from the Discover Data DX virtual event December 13, 2023 Explore the insights from the Discover Data DX virtual event held on December 7th, 2023. The event brought together industry leaders to discuss the significance and principles of the emerging Data DX category. Announcement\nL564: \nL565: Prisma Accelerate now in General Availability October 26, 2023 Now in General Availability: Dive into Prisma Accelerate , enhancing global database connections with connection pooling and edge caching for fast data access. Announcement Data Platform\nL566: \nL567: Support for Serverless Database Drivers in Prisma ORM Is Now in Preview October 06, 2023 Prisma is releasing Preview support for serverless database drivers from Neon and PlanetScale . This feature allows Prisma users to leverage the existing database drivers for communication with their database without long-lived TCP connections! Prisma ORM Serverless Release\nL568: \nL569: #### Product\nL570: \nL571: ClientMigrateAcceleratePulse Early AccessPricing\nL572: \nL573: #### Developers\nL574: \nL575: DocsGet StartedPrisma ExamplesData GuidePrisma in your StackSupportCommunityData Platform StatusVS Code Extension\nL576: \nL577: #### Use Cases\nL578: \nL579: Customer StoriesEnterprise\nL580: \nL581: #### Company\nL582: \nL583: AboutBlogCareers EventsCausesTerms \u0026 PrivacyService Level Agreement\nL584: \nL585: #### Newsletter\nL586: \nL587: [Image 9: prisma_logo]\nL588: \nL589: © 2023 Prisma Data, Inc.\nL590: \nL591:\nVisible: 0% - 100%"}]},"command":"click","args":[8],"status":"finished","is_complete":true,"model_slug":"gpt-4","parent_id":"94a31171-0a47-4435-b86e-4bfbbc484882","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"94a31171-0a47-4435-b86e-4bfbbc484882","children":["7bc77edd-f6ab-457e-9664-a09a0d5c5b80"]},{"id":"7bc77edd-f6ab-457e-9664-a09a0d5c5b80","message":{"id":"7bc77edd-f6ab-457e-9664-a09a0d5c5b80","author":{"role":"assistant","metadata":{}},"create_time":1703480183.410437,"content":{"content_type":"text","parts":["I wasn't able to find a specific documentation reference that describes the use of a function in a DTO class for custom validation in NestJS with class-validator. The official class-validator documentation and NestJS documentation primarily focus on using decorators for validation rules.\n\nHowever, based on the principles of class-validator and NestJS, custom validation logic can be implemented in various ways, including custom decorators or custom validation classes. The approach I suggested earlier aligns with the extensibility and customization options provided by these libraries, but it might not be explicitly documented in this exact form.\n\nFor detailed information and official documentation, you may want to refer to the following resources:\n1. [NestJS Techniques - Validation](https://docs.nestjs.com/techniques/validation): This section in the NestJS documentation provides information on how to use class-validator and class-transformer for validation in NestJS.\n2. [class-validator GitHub Repository](https://github.com/typestack/class-validator): The GitHub repository of class-validator might have examples and issues that discuss various ways to implement custom validation logic.\n3. [class-validator Documentation](https://github.com/typestack/class-validator#readme): This provides detailed information about decorators and how to create custom validation decorators.\n\nIf you have a specific implementation in mind, you might also consider seeking assistance from the NestJS community or on platforms like Stack Overflow, where you can find discussions and solutions for custom validation scenarios in NestJS."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"7de6f89c-d331-4865-b726-ad1847f2d9b4","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"7de6f89c-d331-4865-b726-ad1847f2d9b4","children":["aaa28eab-e061-443d-b65c-633006394439"]},{"id":"aaa28eab-e061-443d-b65c-633006394439","message":{"id":"aaa28eab-e061-443d-b65c-633006394439","author":{"role":"user","metadata":{}},"create_time":1703480282.937129,"content":{"content_type":"text","parts":["Can we do it by defining a custom validator?"]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"7bc77edd-f6ab-457e-9664-a09a0d5c5b80","children":["40f666c6-d848-4bc1-8ce4-d7407c40b2eb"]},{"id":"40f666c6-d848-4bc1-8ce4-d7407c40b2eb","message":{"id":"40f666c6-d848-4bc1-8ce4-d7407c40b2eb","author":{"role":"assistant","metadata":{}},"create_time":1703480311.456641,"content":{"content_type":"text","parts":["Yes, you can achieve your validation requirement by defining a custom validator in NestJS using `class-validator`. This approach is well-suited for more complex validation logic that isn't directly achievable through the standard decorators. Here's how you can do it:\n\n1. **Define a Custom Validation Class**: You'll need to create a custom validation class that implements the `ValidatorConstraintInterface`. This class will contain the logic for your conditional validation.\n\n2. **Register the Custom Validator**: Use the `@ValidatorConstraint` decorator to register your custom validation class.\n\n3. **Use the Custom Validator in your DTO**: Apply your custom validator to the relevant field in your DTO using the `@Validate` decorator.\n\nHere's an example of how you might implement this for your `CreateRoomDto`:\n\n```typescript\nimport { ValidatorConstraint, ValidatorConstraintInterface, ValidationArguments, Validate } from 'class-validator';\n\n@ValidatorConstraint({ name: 'passwordConditional', async: false })\nexport class PasswordConditionalValidator implements ValidatorConstraintInterface {\n  validate(password: string | undefined, args: ValidationArguments) {\n    const object = args.object as CreateRoomDto;\n    if (object.accessLevel === 'PROTECTED' \u0026\u0026 !password) {\n      return false; // Fail validation if accessLevel is PROTECTED and password is not provided\n    }\n    if (object.accessLevel !== 'PROTECTED' \u0026\u0026 password) {\n      return false; // Fail validation if accessLevel is not PROTECTED and password is provided\n    }\n    return true; // Pass validation in all other cases\n  }\n\n  defaultMessage(args: ValidationArguments) {\n    return `Password is ${args.value ? 'not allowed' : 'required'} when access level is ${args.object['accessLevel']}`;\n  }\n}\n\nexport class CreateRoomDto {\n  @IsString()\n  @IsNotEmpty()\n  name: string;\n\n  @IsString()\n  @IsNotEmpty()\n  accessLevel: 'PUBLIC' | 'PRIVATE' | 'PROTECTED';\n\n  @Validate(PasswordConditionalValidator)\n  password?: string;\n}\n```\n\nIn this example:\n- The `PasswordConditionalValidator` class defines the custom logic for validating the `password` field based on the `accessLevel`.\n- The `@ValidatorConstraint` decorator registers this class as a custom validator.\n- The `validate` method contains the conditional logic, and the `defaultMessage` method provides a custom error message.\n- The `CreateRoomDto` uses the `@Validate` decorator to apply this custom validation to the `password` field.\n\nThis approach allows you to encapsulate complex validation logic in a reusable and testable format, making your DTOs cleaner and more maintainable."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa28eab-e061-443d-b65c-633006394439","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"aaa28eab-e061-443d-b65c-633006394439","children":["aaa2ecb4-ccb2-431a-b4e9-145f33a5feb3"]},{"id":"aaa2ecb4-ccb2-431a-b4e9-145f33a5feb3","message":{"id":"aaa2ecb4-ccb2-431a-b4e9-145f33a5feb3","author":{"role":"user","metadata":{}},"create_time":1703480544.369137,"content":{"content_type":"text","parts":["How about when updating?"]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"40f666c6-d848-4bc1-8ce4-d7407c40b2eb","children":["665ec06c-e0c2-420e-b5d9-8b018ecae498"]},{"id":"665ec06c-e0c2-420e-b5d9-8b018ecae498","message":{"id":"665ec06c-e0c2-420e-b5d9-8b018ecae498","author":{"role":"assistant","metadata":{}},"create_time":1703480568.049924,"content":{"content_type":"text","parts":["When updating data in NestJS, especially when using Data Transfer Objects (DTOs), you might encounter different validation requirements compared to creating new data. For instance, certain fields might be optional during an update but required during creation. To handle this, you can use a separate DTO for updates or modify your validation logic to accommodate update scenarios.\n\nHere are two common approaches:\n\n### 1. Using a Separate Update DTO\n\nYou can create a separate DTO for update operations. This Update DTO may have more optional fields compared to the Create DTO, reflecting the fact that not all fields need to be provided during an update.\n\n```typescript\nimport { PartialType } from '@nestjs/mapped-types';\n\nexport class UpdateRoomDto extends PartialType(CreateRoomDto) {\n    // Additional fields or overrides for update-specific logic can be added here\n}\n```\n\nIn this `UpdateRoomDto`, fields from `CreateRoomDto` are made optional using `PartialType`. This is a NestJS utility that automatically sets all fields of a class to optional.\n\n### 2. Adjusting Validation in the Existing DTO\n\nAlternatively, you can adjust the validation logic within your existing DTO to account for updates. This might involve using additional decorators or custom validation logic to distinguish between creation and update scenarios.\n\nFor example, you might add a flag to your DTO that indicates whether it's being used for creation or updating:\n\n```typescript\nexport class RoomDto {\n    @IsDefined({ groups: ['create'] })\n    @IsOptional({ groups: ['update'] })\n    name: string;\n\n    // ... other fields and validations\n\n    // Custom validation logic for password\n    @Validate(PasswordConditionalValidator, { groups: ['create', 'update'] })\n    password?: string;\n}\n```\n\nHere, the `groups` option in the decorators is used to apply different validation rules based on the context ('create' or 'update'). When you validate this DTO, you specify the group:\n\n```typescript\n// For creation\nawait validate(dto, { groups: ['create'] });\n\n// For updating\nawait validate(dto, { groups: ['update'] });\n```\n\n### Choosing the Right Approach\n\nThe choice between these two approaches depends on your specific use case:\n\n- If the validation logic for creating and updating is significantly different, using separate DTOs can keep your code cleaner and more understandable.\n- If the differences are minor, adjusting the validation logic within the same DTO may be more efficient and easier to maintain.\n\nIn both cases, it's important to carefully consider the validation requirements for each field in the context of both creation and updating, ensuring that your API remains consistent and secure."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa2ecb4-ccb2-431a-b4e9-145f33a5feb3","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"aaa2ecb4-ccb2-431a-b4e9-145f33a5feb3","children":["aaa2cd63-819a-444a-a7b1-c1857916edbf"]},{"id":"aaa2cd63-819a-444a-a7b1-c1857916edbf","message":{"id":"aaa2cd63-819a-444a-a7b1-c1857916edbf","author":{"role":"user","metadata":{}},"create_time":1703480641.069343,"content":{"content_type":"text","parts":["can you give an example of separate DTO? Since accessLevel and password are option when updating, I'm not sure how to validate it"]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"665ec06c-e0c2-420e-b5d9-8b018ecae498","children":["dcfaddbb-a32d-4f75-a371-144f0edbfd05"]},{"id":"dcfaddbb-a32d-4f75-a371-144f0edbfd05","message":{"id":"dcfaddbb-a32d-4f75-a371-144f0edbfd05","author":{"role":"assistant","metadata":{}},"create_time":1703480660.9539,"content":{"content_type":"text","parts":["Certainly! When dealing with an update operation in NestJS, especially when certain fields become optional and require conditional validation, using a separate DTO can be very effective. Let's create an `UpdateRoomDto` based on your `CreateRoomDto` scenario, where `accessLevel` and `password` are optional during an update, but still need to be validated conditionally.\n\n### Base CreateRoomDto\n\nFirst, here's your `CreateRoomDto` for reference:\n\n```typescript\nimport { IsString, IsNotEmpty, ValidateIf } from 'class-validator';\n\nexport class CreateRoomDto {\n  @IsString()\n  @IsNotEmpty()\n  name: string;\n\n  @IsString()\n  @IsNotEmpty()\n  accessLevel: 'PUBLIC' | 'PRIVATE' | 'PROTECTED';\n\n  @ValidateIf((o) =\u003e o.accessLevel === 'PROTECTED')\n  @IsString()\n  password?: string;\n}\n```\n\n### UpdateRoomDto\n\nNow, let's create an `UpdateRoomDto`. In this DTO, both `accessLevel` and `password` are optional. We'll add conditional validation to ensure that if `accessLevel` is set to `'PROTECTED'`, a `password` must also be provided.\n\n```typescript\nimport { IsString, IsOptional, ValidateIf } from 'class-validator';\n\nexport class UpdateRoomDto {\n  @IsOptional()\n  @IsString()\n  name?: string;\n\n  @IsOptional()\n  @IsString()\n  accessLevel?: 'PUBLIC' | 'PRIVATE' | 'PROTECTED';\n\n  @IsOptional()\n  @IsString()\n  @ValidateIf((o) =\u003e o.accessLevel === 'PROTECTED')\n  password?: string;\n}\n```\n\nIn `UpdateRoomDto`, both `name` and `accessLevel` are marked as optional. The password field is also optional but has a conditional validator. The `@ValidateIf` decorator ensures that `password` is validated only if `accessLevel` is set to `'PROTECTED'`.\n\n### Handling Partial Updates\n\nWhen updating, you often deal with partial updates, where not all fields are provided. In such cases, it's important to merge the existing data with the new data before validation. This ensures that the validation logic takes into account the full context of the data, including both existing and new values.\n\n### Usage in a Service or Controller\n\nWhen using this DTO in your service or controller, you'll typically fetch the existing data from your database, merge it with the incoming update data, and then perform validation on the merged object. This approach ensures that your validation logic correctly handles partial updates.\n\n### Conclusion\n\nThis setup allows you to have different validation rules for creation and updating operations, which is a common requirement in many applications. The use of separate DTOs helps in maintaining clear separation of concerns and makes your codebase more maintainable and understandable."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa2cd63-819a-444a-a7b1-c1857916edbf","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"aaa2cd63-819a-444a-a7b1-c1857916edbf","children":["aaa238be-7e18-4c4e-b13a-2a7c9d4e4a3b"]},{"id":"aaa238be-7e18-4c4e-b13a-2a7c9d4e4a3b","message":{"id":"aaa238be-7e18-4c4e-b13a-2a7c9d4e4a3b","author":{"role":"user","metadata":{}},"create_time":1703481245.417429,"content":{"content_type":"text","parts":["Add PasswordConditionalValidator to updateRoomDto"]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"dcfaddbb-a32d-4f75-a371-144f0edbfd05","children":["12b9d84a-60de-4ae5-be06-79a4d209f317"]},{"id":"12b9d84a-60de-4ae5-be06-79a4d209f317","message":{"id":"12b9d84a-60de-4ae5-be06-79a4d209f317","author":{"role":"assistant","metadata":{}},"create_time":1703481278.035425,"content":{"content_type":"text","parts":["Certainly! Let's integrate the `PasswordConditionalValidator` into the `UpdateRoomDto`. This custom validator will ensure that a password is provided if the `accessLevel` is set to `'PROTECTED'` and reject the password if the `accessLevel` is not `'PROTECTED'`.\n\n### PasswordConditionalValidator\n\nFirst, here's a reminder of what the `PasswordConditionalValidator` looks like:\n\n```typescript\nimport { ValidatorConstraint, ValidatorConstraintInterface, ValidationArguments, Validate } from 'class-validator';\n\n@ValidatorConstraint({ name: 'passwordConditional', async: false })\nexport class PasswordConditionalValidator implements ValidatorConstraintInterface {\n  validate(password: string | undefined, args: ValidationArguments) {\n    const object = args.object as UpdateRoomDto; // Now using UpdateRoomDto\n    if (object.accessLevel === 'PROTECTED' \u0026\u0026 !password) {\n      return false; // Fail validation if accessLevel is PROTECTED and password is not provided\n    }\n    if (object.accessLevel !== 'PROTECTED' \u0026\u0026 password) {\n      return false; // Fail validation if accessLevel is not PROTECTED and password is provided\n    }\n    return true; // Pass validation in all other cases\n  }\n\n  defaultMessage(args: ValidationArguments) {\n    return `Password is ${args.value ? 'not allowed' : 'required'} when access level is ${args.object['accessLevel']}`;\n  }\n}\n```\n\n### UpdateRoomDto with PasswordConditionalValidator\n\nNow, let's integrate this validator into the `UpdateRoomDto`:\n\n```typescript\nimport { IsString, IsOptional, Validate } from 'class-validator';\n\nexport class UpdateRoomDto {\n  @IsOptional()\n  @IsString()\n  name?: string;\n\n  @IsOptional()\n  @IsString()\n  accessLevel?: 'PUBLIC' | 'PRIVATE' | 'PROTECTED';\n\n  @IsOptional()\n  @IsString()\n  @Validate(PasswordConditionalValidator)\n  password?: string;\n}\n```\n\nIn this `UpdateRoomDto`, both `accessLevel` and `password` are optional fields. The `PasswordConditionalValidator` is applied to the `password` field to enforce the conditional logic:\n\n- If `accessLevel` is `'PROTECTED'`, a `password` must be provided, and it must be a string.\n- If `accessLevel` is anything other than `'PROTECTED'`, the `password` must not be provided.\n- If `accessLevel` is not provided at all, the `password` field is ignored since it's marked as optional.\n\n### Usage in Application\n\nWhen using this DTO for update operations, it's important to handle partial updates correctly. Typically, you should fetch the existing data from the database and compare it with the incoming DTO to apply the validation rules effectively.\n\nThis approach allows you to maintain robust validation rules that are specific to the update operation, ensuring the integrity of your data while accommodating the flexible nature of update requests."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa238be-7e18-4c4e-b13a-2a7c9d4e4a3b","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"aaa238be-7e18-4c4e-b13a-2a7c9d4e4a3b","children":["aaa2e8a4-7ddd-4f91-817c-d92f6b2e6912"]},{"id":"aaa2e8a4-7ddd-4f91-817c-d92f6b2e6912","message":{"id":"aaa2e8a4-7ddd-4f91-817c-d92f6b2e6912","author":{"role":"user","metadata":{}},"create_time":1703482268.283456,"content":{"content_type":"text","parts":["The problem with this approach is when room's access level is already \"PROTECTED\", this doesn't allow update of password, which it should"]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"12b9d84a-60de-4ae5-be06-79a4d209f317","children":["af5a3730-98f1-4780-bfff-c5705fdf777c"]},{"id":"af5a3730-98f1-4780-bfff-c5705fdf777c","message":{"id":"af5a3730-98f1-4780-bfff-c5705fdf777c","author":{"role":"assistant","metadata":{}},"create_time":1703482308.312524,"content":{"content_type":"text","parts":["You're right. The validation logic needs to accommodate the scenario where the room's `accessLevel` is already set to `\"PROTECTED\"` and you want to update the `password`. For this, we need to adjust the validation logic to consider the current state of the room's access level in the database.\n\nSince DTOs in NestJS are typically stateless and do not have access to the database or the current state of the entity, you need a way to incorporate this state into your validation logic. This can be achieved by using a custom validation class that has access to the necessary services to fetch the current state from the database.\n\nHere's an example of how you can modify the `PasswordConditionalValidator` to include a service that fetches the current state of the room:\n\n1. **Modify the PasswordConditionalValidator**:\n\n   Modify the `PasswordConditionalValidator` to include a service that can fetch the current state of the room from the database. This service can be injected into the validator.\n\n    ```typescript\n    import { Injectable } from '@nestjs/common';\n    import { ValidatorConstraint, ValidatorConstraintInterface, ValidationArguments } from 'class-validator';\n    import { RoomService } from './room.service'; // Import your Room service\n\n    @ValidatorConstraint({ async: true })\n    @Injectable()\n    export class PasswordConditionalValidator implements ValidatorConstraintInterface {\n      constructor(private roomService: RoomService) {}\n\n      async validate(password: string, args: ValidationArguments) {\n        const roomDto = args.object as UpdateRoomDto;\n        const roomId = roomDto.id; // Assume you have the room's ID in the DTO\n\n        if (!roomId) {\n          return true; // If no room ID is provided, skip the check (or handle as needed)\n        }\n\n        const room = await this.roomService.findOne(roomId); // Fetch the current room state\n\n        if (room.accessLevel === 'PROTECTED' \u0026\u0026 !password) {\n          return false; // Fail validation if accessLevel is PROTECTED and no password is provided\n        }\n\n        if (room.accessLevel !== 'PROTECTED' \u0026\u0026 password) {\n          return false; // Fail validation if accessLevel is not PROTECTED and password is provided\n        }\n\n        return true; // Pass validation in all other cases\n      }\n\n      defaultMessage(args: ValidationArguments) {\n        return `Password is ${args.value ? 'not allowed' : 'required'} when access level is ${args.object['accessLevel']}`;\n      }\n    }\n    ```\n\n2. **Register the Custom Validator as a Provider**:\n\n   Since the custom validator now has a dependency (the `RoomService`), you need to register it as a provider in your module.\n\n    ```typescript\n    import { Module } from '@nestjs/common';\n    import { APP_PIPE } from '@nestjs/core';\n    import { PasswordConditionalValidator } from './password-conditional.validator';\n\n    @Module({\n      // ... other module settings\n      providers: [\n        PasswordConditionalValidator,\n        // ... other providers\n      ],\n    })\n    export class YourModule {}\n    ```\n\n3. **Usage in UpdateRoomDto**:\n\n   The usage in `UpdateRoomDto` remains the same, but ensure that you provide the necessary room ID or other identifiers needed for the validator to fetch the current room state.\n\n    ```typescript\n    // UpdateRoomDto remains the same as before\n    ```\n\nThis approach allows you to use the current state of the entity in your validation logic, enabling more complex scenarios like the one you described. Make sure your services and modules are set up correctly to support dependency injection into the custom validator."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa2e8a4-7ddd-4f91-817c-d92f6b2e6912","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"aaa2e8a4-7ddd-4f91-817c-d92f6b2e6912","children":["aaa2617c-c30f-407b-a203-78064781d8cd"]},{"id":"aaa2617c-c30f-407b-a203-78064781d8cd","message":{"id":"aaa2617c-c30f-407b-a203-78064781d8cd","author":{"role":"user","metadata":{}},"create_time":1703482652.598723,"content":{"content_type":"text","parts":["When there are multiple validations like this, how to reduce the DB calls?"]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"af5a3730-98f1-4780-bfff-c5705fdf777c","children":["e53a760d-6e97-4f88-b80e-9af86a2210dc"]},{"id":"e53a760d-6e97-4f88-b80e-9af86a2210dc","message":{"id":"e53a760d-6e97-4f88-b80e-9af86a2210dc","author":{"role":"assistant","metadata":{}},"create_time":1703482684.764403,"content":{"content_type":"text","parts":["Reducing database calls when performing multiple validations in NestJS, especially when dealing with complex conditional validations, is crucial for optimizing performance. Here are several strategies to minimize database interactions:\n\n### 1. **Aggregate Validations into a Single Custom Validator**\n\nInstead of having multiple custom validators each making their own database calls, you can create a single, more comprehensive validator that handles all the necessary logic. This validator can make a single database call to retrieve all the required information and then perform all validations.\n\nFor example, if you have multiple validations that depend on the current state of a `Room`, you can fetch the `Room` once and then perform all the validations against this fetched data.\n\n### 2. **Cache the Required Data**\n\nIf the data required for validation is relatively static or doesn't change frequently, you can cache it. This way, you can avoid repetitive database calls for data that hasn’t changed.\n\nYou can implement caching at the service level or use a dedicated caching mechanism like Redis. The cache can store the fetched data for a predetermined amount of time, and subsequent validation requests can first check the cache before querying the database.\n\n### 3. **Optimize Your Database Queries**\n\nEnsure that your database queries are optimized and fetch only the necessary data. Sometimes, using projections to select only specific fields or using efficient query methods can significantly reduce the load and improve performance.\n\n### 4. **Use Database Transactions**\n\nIf you are performing multiple update operations that each require validation, consider using database transactions. This way, you can group multiple operations into a single transaction. Although this doesn't reduce the number of validation checks, it can optimize the update operations and ensure data consistency.\n\n### 5. **Front-End Validation as a Preliminary Step**\n\nWhile front-end validation is not a substitute for back-end validation, it can reduce unnecessary requests to the server. By validating input on the client side first, you can catch many common errors before they even reach your back-end.\n\n### 6. **Service Layer Validation**\n\nPerform validation at the service layer where you can control the flow of operations more granularly. This allows you to make a single call to the database to retrieve all necessary information and then pass this data to various validation functions as needed.\n\n### 7. **Optimize Application Architecture**\n\nSometimes the solution lies in optimizing the overall application architecture. For instance, using a CQRS pattern (Command Query Responsibility Segregation) can separate read and write operations, allowing for more efficient handling of data and reducing unnecessary database interactions.\n\nImplementing these strategies requires a balance between maintaining data integrity and optimizing performance. The best approach depends on the specific requirements and constraints of your application."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa2617c-c30f-407b-a203-78064781d8cd","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"aaa2617c-c30f-407b-a203-78064781d8cd","children":["aaa21ec1-1afe-4091-ac4b-f798ade556fd"]},{"id":"aaa21ec1-1afe-4091-ac4b-f798ade556fd","message":{"id":"aaa21ec1-1afe-4091-ac4b-f798ade556fd","author":{"role":"user","metadata":{}},"create_time":1703482712.166885,"content":{"content_type":"text","parts":["can you provide an example source code for each case?"]},"status":"finished_successfully","weight":1,"metadata":{"timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"e53a760d-6e97-4f88-b80e-9af86a2210dc","children":["103a5ed8-66ec-4d8d-b0e9-a3b9123436fa"]},{"id":"103a5ed8-66ec-4d8d-b0e9-a3b9123436fa","message":{"id":"103a5ed8-66ec-4d8d-b0e9-a3b9123436fa","author":{"role":"assistant","metadata":{}},"create_time":1703482766.24832,"content":{"content_type":"text","parts":["Sure, I can provide example source code snippets for each of the strategies mentioned to reduce database calls during validation in NestJS.\n\n### 1. Aggregate Validations into a Single Custom Validator\n\n```typescript\nimport { Injectable } from '@nestjs/common';\nimport { ValidatorConstraint, ValidatorConstraintInterface, ValidationArguments } from 'class-validator';\nimport { RoomService } from './room.service';\n\n@ValidatorConstraint({ async: true })\n@Injectable()\nexport class RoomValidationConstraint implements ValidatorConstraintInterface {\n    constructor(private roomService: RoomService) {}\n\n    async validate(value: any, args: ValidationArguments) {\n        const room = await this.roomService.findOne(args.object['id']);\n        // Add all your complex validation logic here using the room data\n        return true; // or false based on validation\n    }\n\n    defaultMessage(args: ValidationArguments) {\n        // Default error message\n        return 'Validation failed';\n    }\n}\n```\n\n### 2. Cache the Required Data\n\nThis example assumes you have a caching mechanism like Redis in place:\n\n```typescript\n@Injectable()\nexport class RoomService {\n    async findOneWithCache(roomId: number) {\n        let room = await this.cacheManager.get(`room_${roomId}`);\n        if (!room) {\n            room = await this.roomRepository.findOne(roomId);\n            await this.cacheManager.set(`room_${roomId}`, room, { ttl: 3600 });\n        }\n        return room;\n    }\n}\n```\n\n### 3. Optimize Your Database Queries\n\n```typescript\n@Injectable()\nexport class RoomService {\n    async findOne(roomId: number) {\n        return this.roomRepository.findOne(roomId, { \n            select: ['id', 'accessLevel', 'name'] // Only fetch necessary fields\n        });\n    }\n}\n```\n\n### 4. Use Database Transactions\n\n```typescript\n@Injectable()\nexport class RoomService {\n    async updateRoom(roomId: number, updateDto: UpdateRoomDto) {\n        return this.connection.transaction(async entityManager =\u003e {\n            // multiple database operations within a single transaction\n            await entityManager.save(Room, updateDto);\n            // other operations...\n        });\n    }\n}\n```\n\n### 5. Front-End Validation as a Preliminary Step\n\nFront-end validation is typically handled in your client-side code (JavaScript/TypeScript), ensuring that the data sent to the back-end is already validated as per basic rules.\n\n### 6. Service Layer Validation\n\n```typescript\n@Injectable()\nexport class RoomService {\n    async validateAndUpdate(roomId: number, updateDto: UpdateRoomDto) {\n        const room = await this.findOne(roomId);\n        // perform validation using room data\n        // if validation passes, update the room\n        return this.roomRepository.update(roomId, updateDto);\n    }\n}\n```\n\n### 7. Optimize Application Architecture\n\nImplementing a CQRS pattern often involves a significant restructuring of your application. It's not just a simple code snippet but rather a design approach where you separate the read operations (queries) from the write operations (commands).\n\nFor example, you could have two different models: one for reading data (e.g., DTOs for API responses) and another for writing data (e.g., Commands for creating/updating data). Each model would be handled by separate services or controllers, optimized for their specific use case.\n\nImplementing these strategies will depend heavily on the specific context and needs of your application. Each approach has its own set of trade-offs and should be chosen based on the application's requirements and constraints."]},"status":"finished_successfully","end_turn":true,"weight":1,"metadata":{"finish_details":{"type":"stop","stop_tokens":[100260]},"is_complete":true,"model_slug":"gpt-4","parent_id":"aaa21ec1-1afe-4091-ac4b-f798ade556fd","timestamp_":"absolute","shared_conversation_id":"3b9e682b-9adb-464c-b749-e6aea774829d"},"recipient":"all"},"parent":"aaa21ec1-1afe-4091-ac4b-f798ade556fd","children":[]}],"has_user_editable_context":false,"continue_conversation_url":"https://chat.openai.com/share/3b9e682b-9adb-464c-b749-e6aea774829d/continue","model":{"slug":"gpt-4","max_tokens":32767,"title":"Retrieval (msearch, context stuffing)","description":"Browsing, Advanced Data Analysis, and DALL·E are now built into GPT-4","tags":["alpha","gpt4"]},"moderation_state":{"has_been_moderated":false,"has_been_blocked":false,"has_been_accepted":false,"has_been_auto_blocked":false,"has_been_auto_moderated":false}}},"continueMode":false,"moderationMode":false,"plugins":null,"chatPageProps":{"user":{"id":"user-DiQTGiGVFqze6dprFzmFn9HU","name":"Daniel Ogenrwot","email":"ogenrwot@unlv.nevada.edu","image":"https://lh3.googleusercontent.com/a/ACg8ocJs3eXuKK9Cvxw--rhfLSyMa7t75KLFfn8RZjuspp7ofw=s96-c","picture":"https://lh3.googleusercontent.com/a/ACg8ocJs3eXuKK9Cvxw--rhfLSyMa7t75KLFfn8RZjuspp7ofw=s96-c","idp":"google-oauth2","iat":1704763431,"mfa":false,"groups":[],"intercom_hash":"b1696c9b7c3e106e5e1562cebe511d91a2b7ecaada4affd27e426cd79ce86e2f"},"serviceStatus":{},"serviceAnnouncement":{"public":{},"paid":{}},"cfConnectingIp":"2600:8801:359a:b200:10b1:c381:2196:e960","statsig":{"payload":{"feature_gates":{"mC7arE5IsSMGuGv+JtQNn6PkLNjGMgnPGm4lNwCVcd4=":{"name":"mC7arE5IsSMGuGv+JtQNn6PkLNjGMgnPGm4lNwCVcd4=","value":false,"rule_id":"default","secondary_exposures":[{"gate":"segment:chatgpt_voice_team","gateValue":"false","ruleID":"default"}]},"4bxrZiqrvUhz7pNmrq7/hje8GGth3CK38a+UCoGT55w=":{"name":"4bxrZiqrvUhz7pNmrq7/hje8GGth3CK38a+UCoGT55w=","value":false,"rule_id":"6Usmt3Th0mkUkVQJ0oyeST:0.00:1","secondary_exposures":[]},"BwgqaCydMQQ3DfMuT3le70YG2UMR90ZQUizkz8s87Og=":{"name":"BwgqaCydMQQ3DfMuT3le70YG2UMR90ZQUizkz8s87Og=","value":false,"rule_id":"default","secondary_exposures":[{"gate":"segment:chatgpt_voice_team","gateValue":"false","ruleID":"default"}]},"sB09rxeNC0dm+q105n4ilqzJPvZ+fb8Adgn7dgHyAJs=":{"name":"sB09rxeNC0dm+q105n4ilqzJPvZ+fb8Adgn7dgHyAJs=","value":false,"rule_id":"default","secondary_exposures":[{"gate":"segment:chatgpt_voice_team","gateValue":"false","ruleID":"default"}]},"/sqBSo8CbSfm33mGuPq/xK+GiRwPnbT26mPKmQkikn4=":{"name":"/sqBSo8CbSfm33mGuPq/xK+GiRwPnbT26mPKmQkikn4=","value":false,"rule_id":"default","secondary_exposures":[]},"8YdWfy6BaXA6MDnlnTc17AwNRhxQ4rcfy5G+sYaHQ/A=":{"name":"8YdWfy6BaXA6MDnlnTc17AwNRhxQ4rcfy5G+sYaHQ/A=","value":false,"rule_id":"63qNN95X7P6VSHVff2nL76","secondary_exposures":[]},"9frMP2Uapo9+GZFF/eyDv3qypmVGR3bBx7kQxlUjFL0=":{"name":"9frMP2Uapo9+GZFF/eyDv3qypmVGR3bBx7kQxlUjFL0=","value":false,"rule_id":"4Cs7bnD6u8s4FIa2CdgJ7i","secondary_exposures":[]},"zP79mMrzyNTmUIk4BvnRSRf1QyskcWqpVbgx/DuBSlk=":{"name":"zP79mMrzyNTmUIk4BvnRSRf1QyskcWqpVbgx/DuBSlk=","value":false,"rule_id":"default","secondary_exposures":[]},"G4FKkwqOMLlLXCjFizXkc6Fbyds7IQgmeDgcOnlzXcc=":{"name":"G4FKkwqOMLlLXCjFizXkc6Fbyds7IQgmeDgcOnlzXcc=","value":false,"rule_id":"default","secondary_exposures":[]},"Ot01tCFiILXHbMzQliq1LFtcH9p484nys9JQ3jNBBSc=":{"name":"Ot01tCFiILXHbMzQliq1LFtcH9p484nys9JQ3jNBBSc=","value":false,"rule_id":"default","secondary_exposures":[{"gate":"segment:european_legal_restricted","gateValue":"false","ruleID":"default"}]},"ZB1N+sYIfld1iUD73LMNp+7PHtb5fjkv1Fqd9stCmhM=":{"name":"ZB1N+sYIfld1iUD73LMNp+7PHtb5fjkv1Fqd9stCmhM=","value":false,"rule_id":"default","secondary_exposures":[]},"AmHQM8fzcDgvtrUTWfKdHeeC+liSx6Ap3mIjS2v2T7k=":{"name":"AmHQM8fzcDgvtrUTWfKdHeeC+liSx6Ap3mIjS2v2T7k=","value":false,"rule_id":"1IdfApkb0f3RHjOg804mYI:5.00:5","secondary_exposures":[]},"v6yV8GS0zH+VdEey3WZ8OCkuXSPit1tWZ1w5XGJKgwU=":{"name":"v6yV8GS0zH+VdEey3WZ8OCkuXSPit1tWZ1w5XGJKgwU=","value":true,"rule_id":"VNBdYfNSNNUyDdMpaiaZ9:100.00:1","secondary_exposures":[]},"bZIChv8u2y59nAdcmf3Sxu+c4LOtTeRmbLn99GUUOrQ=":{"name":"bZIChv8u2y59nAdcmf3Sxu+c4LOtTeRmbLn99GUUOrQ=","value":false,"rule_id":"default","secondary_exposures":[{"gate":"segment:gizmo_store_team","gateValue":"false","ruleID":"default"},{"gate":"segment:memory_team","gateValue":"false","ruleID":"default"}]},"NFLu/8gcH3+m9yHiY/kPxE83zLFYMhk3cWVEq2zR+NM=":{"name":"NFLu/8gcH3+m9yHiY/kPxE83zLFYMhk3cWVEq2zR+NM=","value":false,"rule_id":"default","secondary_exposures":[{"gate":"segment:employees","gateValue":"false","ruleID":"default"}]},"XrhPGbeUzfIBQaHMWl4/GYZzdDnDMzHb96RYes5lw2w=":{"name":"XrhPGbeUzfIBQaHMWl4/GYZzdDnDMzHb96RYes5lw2w=","value":false,"rule_id":"default","secondary_exposures":[{"gate":"segment:employees","gateValue":"false","ruleID":"default"}]},"FEo7XK0f7Hn3U2RwSds2DTiEYNIpKCqrSVA2UP0BK2M=":{"name":"FEo7XK0f7Hn3U2RwSds2DTiEYNIpKCqrSVA2UP0BK2M=","value":true,"rule_id":"6sEu91zwlBGSKOqFiNpGlA:100.00:2","secondary_exposures":[{"gate":"segment:employees","gateValue":"false","ruleID":"default"},{"gate":"segment:enterprise","gateValue":"false","ruleID":"default"},{"gate":"segment:teams_plan","gateValue":"false","ruleID":"default"}]},"9WcM78XE5AQPxf3Yv9FxM5g14rV2Sk3HsGRha1mAnxc=":{"name":"9WcM78XE5AQPxf3Yv9FxM5g14rV2Sk3HsGRha1mAnxc=","value":false,"rule_id":"default","secondary_exposures":[{"gate":"segment:employees","gateValue":"false","ruleID":"default"}]},"+ZnfGOKTXqj/PUluVHtQHH4xXcWomraW0OeynJkthMA=":{"name":"+ZnfGOKTXqj/PUluVHtQHH4xXcWomraW0OeynJkthMA=","value":true,"rule_id":"2LpyNTIfbYC4R6XS6dfdIL","secondary_exposures":[{"gate":"segment:employees","gateValue":"false","ruleID":"default"}]},"a2qAmsyD94P0/7pZ6SpRYRKL9Odkp+5z2KgEZEYvsJg=":{"name":"a2qAmsyD94P0/7pZ6SpRYRKL9Odkp+5z2KgEZEYvsJg=","value":false,"rule_id":"default","secondary_exposures":[]}},"dynamic_configs":{"krxquX5lr9NsWYuE6AxcgDMKBdc3hX7WV56L3qm2h+k=":{"name":"krxquX5lr9NsWYuE6AxcgDMKBdc3hX7WV56L3qm2h+k=","value":{},"group":"default","rule_id":"default","is_device_based":false,"secondary_exposures":[{"gate":"segment:employees","gateValue":"false","ruleID":"default"},{"gate":"chatgpt-browse-sahara","gateValue":"false","ruleID":"default"}]},"Xxhhbjq3NEImgVIfGzx+Ubl6ebJS1kwRjV/2YlHJ3Zs=":{"name":"Xxhhbjq3NEImgVIfGzx+Ubl6ebJS1kwRjV/2YlHJ3Zs=","value":{"google.com":["google.com","googleapis.com","www.googleapis.com","oauth2.googleapis.com"],"microsoftonline.com":["microsoft.com","microsoftonline.com"],"adobelogin.com":["adobe.com","adobelogin.com"],"useflorian.com":["useflorian.com","convex.site"],"yahoo.com":["yahooapis.com","yahoo.com"],"app.vssps.visualstudio.com":["app.vssps.visualstudio.com","dev.azure.com"]},"group":"default","rule_id":"default","is_device_based":true,"secondary_exposures":[]},"LH4aXUWdAthHnhoeezgqr9XUAj+EyFN9/INZTPgB8Rw=":{"name":"LH4aXUWdAthHnhoeezgqr9XUAj+EyFN9/INZTPgB8Rw=","value":{},"group":"prestart","rule_id":"prestart","is_device_based":false,"secondary_exposures":[],"is_user_in_experiment":false,"is_experiment_active":false},"/NA6RKoyvTPtJS+65jbxYPRbn4zCKaPi28t+RGlIi74=":{"name":"/NA6RKoyvTPtJS+65jbxYPRbn4zCKaPi28t+RGlIi74=","value":{},"group":"prestart","rule_id":"prestart","is_device_based":false,"secondary_exposures":[],"is_user_in_experiment":false,"is_experiment_active":false},"d88zqiv5tj+jTJIQj6D5/mZRDEaFP6YEIqcwlz6Nh+8=":{"name":"d88zqiv5tj+jTJIQj6D5/mZRDEaFP6YEIqcwlz6Nh+8=","value":{},"group":"targetingGate","rule_id":"targetingGate","is_device_based":false,"secondary_exposures":[{"gate":"targeting-aa-web-240206","gateValue":"false","ruleID":"63qNN95X7P6VSHVff2nL76"}],"is_user_in_experiment":false,"is_experiment_active":true},"hxxW3hikZ7rigchg97AizJTpHbpMCwkwvbZd7t9sblc=":{"name":"hxxW3hikZ7rigchg97AizJTpHbpMCwkwvbZd7t9sblc=","value":{},"group":"targetingGate","rule_id":"targetingGate","is_device_based":false,"secondary_exposures":[{"gate":"targeting-aa-web-anon-240206","gateValue":"false","ruleID":"4Cs7bnD6u8s4FIa2CdgJ7i"}],"is_user_in_experiment":false,"is_experiment_active":true},"2gcgWHw6EUQ7WzuausBVbg88/jglfC1LmtqhBF35u2c=":{"name":"2gcgWHw6EUQ7WzuausBVbg88/jglfC1LmtqhBF35u2c=","value":{"show_new_ui":true},"group":"launchedGroup","rule_id":"launchedGroup","is_device_based":false,"secondary_exposures":[],"is_user_in_experiment":false,"is_experiment_active":false}},"layer_configs":{},"sdkParams":{},"has_updates":true,"generator":"statsig-node-sdk","time":0,"evaluated_keys":{"userID":"user-DiQTGiGVFqze6dprFzmFn9HU","customIDs":{"WebAnonymousCookieID":"d05bbaf3-27d4-4fc2-bdd4-5faafc9a8093","DeviceId":"d05bbaf3-27d4-4fc2-bdd4-5faafc9a8093","stableID":"d05bbaf3-27d4-4fc2-bdd4-5faafc9a8093"}},"hash_used":"sha256","user_hash":"2623322862"},"user":{"country":"US","custom":{"auth_status":"logged_in","is_paid":false},"customIDs":{"WebAnonymousCookieID":"d05bbaf3-27d4-4fc2-bdd4-5faafc9a8093","DeviceId":"d05bbaf3-27d4-4fc2-bdd4-5faafc9a8093","stableID":"d05bbaf3-27d4-4fc2-bdd4-5faafc9a8093"},"ip":"2600:8801:359a:b200:10b1:c381:2196:e960","locale":"en-US","privateAttributes":{"email":"ogenrwot@unlv.nevada.edu"},"userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36","userID":"user-DiQTGiGVFqze6dprFzmFn9HU"}},"serverPrimedAllowBrowserStorageValue":true,"showCookieConsentBanner":false,"isStorageComplianceEnabled":false,"ageVerificationDeadline":null,"ageVerificationType":"none","logOutUser":false},"isGizmoLive":true},"__N_SSP":true},"page":"/share/[[...shareParams]]","query":{"shareParams":["3b9e682b-9adb-464c-b749-e6aea774829d"]},"buildId":"P9LodNv0xkZ1kyW4nyx7S","assetPrefix":"https://cdn.oaistatic.com","isFallback":false,"gssp":true,"scriptLoader":[]}</script><next-route-announcer><p aria-live="assertive" id="__next-route-announcer__" role="alert" style="border: 0px; clip: rect(0px, 0px, 0px, 0px); height: 1px; margin: -1px; overflow: hidden; padding: 0px; position: absolute; top: 0px; width: 1px; white-space: nowrap; overflow-wrap: normal;"></p></next-route-announcer><div portal-container=""><span class="pointer-events-none fixed inset-0 z-[60] mx-auto my-2 flex max-w-[560px] flex-col items-stretch justify-start md:pb-5"></span></div><iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom" src="./55_files/saved_resource.html"></iframe><script crossorigin="anonymous" src="./55_files/3975-727132bb57222b04.js"></script><script crossorigin="anonymous" src="./55_files/3754-c5372f0c589e2443.js"></script><script crossorigin="anonymous" src="./55_files/login-001159e4899e6e7a.js"></script><script crossorigin="anonymous" src="./55_files/gpts-5e3c4c0a2618076d.js"></script><div class="intercom-lightweight-app"><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    0% {
      opacity: 0;
      transform: scale(0);
    }
    40% {
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    padding: 0 !important;
    margin: 0 !important;
    border: none;
    bottom: 20px;
    right: 20px;
    max-width: 48px;
    width: 48px;
    max-height: 48px;
    height: 48px;
    border-radius: 50%;
    background: #202123;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    transition: transform 167ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    box-sizing: content-box;
  }


  .intercom-lightweight-app-launcher:hover {
    transition: transform 250ms cubic-bezier(0.33, 0.00, 0.00, 1.00);
    transform: scale(1.1)
  }

  .intercom-lightweight-app-launcher:active {
    transform: scale(0.85);
    transition: transform 134ms cubic-bezier(0.45, 0, 0.2, 1);
  }


  .intercom-lightweight-app-launcher:focus {
    outline: none;

    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 48px;
    height: 48px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 24px;
    height: 24px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 44px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 24px;
    max-width: 24px;

    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: rgb(255, 255, 255);
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms cubic-bezier(0, 1, 1, 1);
    transform-origin: bottom right;

    
        width: 400px;
        height: calc(100% - 40px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 20px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
      

    border-radius: 16px;
  }

  .intercom-lightweight-app-messenger-header {
    height: 64px;
    border-bottom: none;
    background: #202123

    
  }

  .intercom-lightweight-app-messenger-footer{
    position:absolute;
    bottom:0;
    width: 100%;
    height: 80px;
    background: #fff;
    font-size: 14px;
    line-height: 21px;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0px 0px 25px rgba(0, 0, 0, 0.05);
    
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div></body></html>